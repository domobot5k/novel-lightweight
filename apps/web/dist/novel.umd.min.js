!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Novel=e(t.React,t.ReactDOM)}(this,function(t,e){"use strict";function n(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}),e.default=t,Object.freeze(e)}var r=n(t),o=n(e);function i(t){this.content=t}function s(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(let t=0;o.text[t]==i.text[t];t++)n++;return n}if(o.content.size||i.content.size){let t=s(o.content,i.content,n+1);if(null!=t)return t}n+=o.nodeSize}else n+=o.nodeSize}}function a(t,e,n,r){for(let o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};let s=t.child(--o),l=e.child(--i),c=s.nodeSize;if(s!=l){if(!s.sameMarkup(l))return{a:n,b:r};if(s.isText&&s.text!=l.text){let t=0,e=Math.min(s.text.length,l.text.length);for(;t<e&&s.text[s.text.length-t-1]==l.text[l.text.length-t-1];)t++,n--,r--;return{a:n,b:r}}if(s.content.size||l.content.size){let t=a(s.content,l.content,n-1,r-1);if(t)return t}n-=c,r-=c}else n-=c,r-=c}}i.prototype={constructor:i,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,o=r.find(t),s=r.content.slice();return-1==o?s.push(n||t,e):(s[o+1]=e,n&&(s[o]=n)),new i(s)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new i(n)},addToStart:function(t,e){return new i([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new i(n)},addBefore:function(t,e,n){var r=this.remove(e),o=r.content.slice(),s=r.find(t);return o.splice(-1==s?o.length:s,0,e,n),new i(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=i.from(t)).size?new i(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=i.from(t)).size?new i(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=i.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}},i.from=function(t){if(t instanceof i)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new i(e)};class l{constructor(t,e){if(this.content=t,this.size=e||0,null==e)for(let e=0;e<t.length;e++)this.size+=t[e].nodeSize}nodesBetween(t,e,n,r=0,o){for(let i=0,s=0;s<e;i++){let a=this.content[i],l=s+a.nodeSize;if(l>t&&!1!==n(a,r+s,o||null,i)&&a.content.size){let o=s+1;a.nodesBetween(Math.max(0,t-o),Math.min(a.content.size,e-o),n,r+o)}s=l}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,n,r){let o="",i=!0;return this.nodesBetween(t,e,(s,a)=>{let l=s.isText?s.text.slice(Math.max(t,a)-a,e-a):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(i?i=!1:o+=n),o+=l},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new l(r,this.size+t.size)}cut(t,e=this.size){if(0==t&&e==this.size)return this;let n=[],r=0;if(e>t)for(let o=0,i=0;i<e;o++){let s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new l(n,r)}cutByIndex(t,e){return t==e?l.empty:0==t&&e==this.content.length?this:new l(this.content.slice(t,e))}replaceChild(t,e){let n=this.content[t];if(n==e)return this;let r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new l(r,o)}addToStart(t){return new l([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new l(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,n=0;e<this.content.length;e++){let r=this.content[e];t(r,n,e),n+=r.nodeSize}}findDiffStart(t,e=0){return s(this,t,e)}findDiffEnd(t,e=this.size,n=t.size){return a(this,t,e,n)}findIndex(t,e=-1){if(0==t)return u(0,t);if(t==this.size)return u(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let n=0,r=0;;n++){let o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?u(n+1,o):u(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return l.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new l(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return l.empty;let e,n=0;for(let r=0;r<t.length;r++){let o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new l(e||t,n)}static from(t){if(!t)return l.empty;if(t instanceof l)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new l([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}l.empty=new l([],0);const c={index:0,offset:0};function u(t,e){return c.index=t,c.offset=e,c}function d(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!d(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!d(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}let p=class t{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,n=!1;for(let r=0;r<t.length;r++){let o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&d(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[e.type];if(!n)throw new RangeError(`There is no mark type ${e.type} in this schema`);let r=n.create(e.attrs);return n.checkAttrs(r.attrs),r}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return t.none;if(e instanceof t)return[e];let n=e.slice();return n.sort((t,e)=>t.type.rank-e.type.rank),n}};p.none=[];class f extends Error{}class h{constructor(t,e,n){this.content=t,this.openStart=e,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let n=g(this.content,t+this.openStart,e);return n&&new h(n,this.openStart,this.openEnd)}removeBetween(t,e){return new h(m(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return h.empty;let n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new h(l.fromJSON(t,e.content),n,r)}static maxOpen(t,e=!0){let n=0,r=0;for(let r=t.firstChild;r&&!r.isLeaf&&(e||!r.type.spec.isolating);r=r.firstChild)n++;for(let n=t.lastChild;n&&!n.isLeaf&&(e||!n.type.spec.isolating);n=n.lastChild)r++;return new h(t,n,r)}}function m(t,e,n){let{index:r,offset:o}=t.findIndex(e),i=t.maybeChild(r),{index:s,offset:a}=t.findIndex(n);if(o==e||i.isText){if(a!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(m(i.content,e-o-1,n-o-1)))}function g(t,e,n,r){let{index:o,offset:i}=t.findIndex(e),s=t.maybeChild(o);if(i==e||s.isText)return t.cut(0,e).append(n).append(t.cut(e));let a=g(s.content,e-i-1,n);return a&&t.replaceChild(o,s.copy(a))}function v(t,e,n){if(n.openStart>t.depth)throw new f("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new f("Inconsistent open depths");return y(t,e,n,0)}function y(t,e,n,r){let o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){let s=y(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){let{start:o,end:s}=function(t,e){let n=e.depth-t.openStart,r=e.node(n).copy(t.content);for(let t=n-1;t>=0;t--)r=e.node(t).copy(l.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return E(i,C(t,o,s,e,r))}{let r=t.parent,o=r.content;return E(r,o.cut(0,t.parentOffset).append(n.content).append(o.cut(e.parentOffset)))}}return E(i,S(t,e,r))}function b(t,e){if(!e.type.compatibleContent(t.type))throw new f("Cannot join "+e.type.name+" onto "+t.type.name)}function x(t,e,n){let r=t.node(n);return b(r,e.node(n)),r}function w(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function k(t,e,n,r){let o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(w(t.nodeAfter,r),i++));for(let t=i;t<s;t++)w(o.child(t),r);e&&e.depth==n&&e.textOffset&&w(e.nodeBefore,r)}function E(t,e){return t.type.checkContent(e),t.copy(e)}function C(t,e,n,r,o){let i=t.depth>o&&x(t,e,o+1),s=r.depth>o&&x(n,r,o+1),a=[];return k(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(b(i,s),w(E(i,C(t,e,n,r,o+1)),a)):(i&&w(E(i,S(t,e,o+1)),a),k(e,n,o,a),s&&w(E(s,S(n,r,o+1)),a)),k(r,null,o,a),new l(a)}function S(t,e,n){let r=[];if(k(null,t,n,r),t.depth>n){w(E(x(t,e,n+1),S(t,e,n+1)),r)}return k(e,null,n,r),new l(r)}h.empty=new h(l.empty,0,0);class D{constructor(t,e,n){this.pos=t,this.path=e,this.parentOffset=n,this.depth=e.length/3-1}resolveDepth(t){return null==t?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[3*this.resolveDepth(t)]}index(t){return this.path[3*this.resolveDepth(t)+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)}start(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]}after(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1;for(let e=0;e<t;e++)r+=n.child(e).nodeSize;return r}marks(){let t=this.parent,e=this.index();if(0==t.content.size)return p.none;if(this.textOffset)return t.child(e).marks;let n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){let t=n;n=r,r=t}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let n=e.marks,r=t.parent.maybeChild(t.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new A(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let n=[],r=0,o=e;for(let e=t;;){let{index:t,offset:i}=e.content.findIndex(o),s=o-i;if(n.push(e,t,r+i),!s)break;if(e=e.child(t),e.isText)break;o=s-1,r+=i+1}return new D(e,n,o)}static resolveCached(t,e){let n=_.get(t);if(n)for(let t=0;t<n.elts.length;t++){let r=n.elts[t];if(r.pos==e)return r}else _.set(t,n=new M);let r=n.elts[n.i]=D.resolve(t,e);return n.i=(n.i+1)%O,r}}class M{constructor(){this.elts=[],this.i=0}}const O=12,_=new WeakMap;class A{constructor(t,e,n){this.$from=t,this.$to=e,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const T=Object.create(null);let R=class t{constructor(t,e,n,r=p.none){this.type=t,this.attrs=e,this.marks=r,this.content=n||l.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,n,r=0){this.content.nodesBetween(t,e,n,r,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,n,r){return this.content.textBetween(t,e,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,n){return this.type==t&&d(this.attrs,e||t.defaultAttrs||T)&&p.sameSet(this.marks,n||p.none)}copy(e=null){return e==this.content?this:new t(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new t(this.type,this.attrs,this.content,e)}cut(t,e=this.content.size){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,n=!1){if(t==e)return h.empty;let r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new h(a,r.depth-i,o.depth-i)}replace(t,e,n){return v(this.resolve(t),this.resolve(e),n)}nodeAt(t){for(let e=this;;){let{index:n,offset:r}=e.content.findIndex(t);if(e=e.maybeChild(n),!e)return null;if(r==t||e.isText)return e;t-=r+1}}childAfter(t){let{index:e,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:n}}childBefore(t){if(0==t)return{node:null,index:0,offset:0};let{index:e,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(e),index:e,offset:n};let r=this.content.child(e-1);return{node:r,index:e-1,offset:n-r.nodeSize}}resolve(t){return D.resolveCached(this,t)}resolveNoCache(t){return D.resolve(this,t)}rangeHasMark(t,e,n){let r=!1;return e>t&&this.nodesBetween(t,e,t=>(n.isInSet(t.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),P(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,n=l.empty,r=0,o=n.childCount){let i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(let t=r;t<o;t++)if(!this.type.allowsMarks(n.child(t).marks))return!1;return!0}canReplaceWith(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=p.none;for(let e=0;e<this.marks.length;e++){let n=this.marks[e];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!p.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(t=>t.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let n;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}let r=l.fromJSON(t,e.content),o=t.nodeType(e.type).create(e.attrs,r,n);return o.type.checkAttrs(o.attrs),o}};R.prototype.text=void 0;class N extends R{constructor(t,e,n,r){if(super(t,e,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):P(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new N(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new N(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return 0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function P(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class L{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let n=new I(t,e);if(null==n.next)return L.empty;let r=z(n);n.next&&n.err("Unexpected trailing text");let o=function(t){let e=Object.create(null);return n(q(t,0));function n(r){let o=[];r.forEach(e=>{t[e].forEach(({term:e,to:n})=>{if(!e)return;let r;for(let t=0;t<o.length;t++)o[t][0]==e&&(r=o[t][1]);q(t,n).forEach(t=>{r||o.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})})});let i=e[r.join(",")]=new L(r.indexOf(t.length-1)>-1);for(let t=0;t<o.length;t++){let r=o[t][1].sort($);i.next.push({type:o[t][0],next:e[r.join(",")]||n(r)})}return i}}(function(t){let e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){let o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach(t=>t.to=e)}function i(t,e){if("choice"==t.type)return t.exprs.reduce((t,n)=>t.concat(i(n,e)),[]);if("seq"!=t.type){if("star"==t.type){let s=n();return r(e,s),o(i(t.expr,s),s),[r(s)]}if("plus"==t.type){let s=n();return o(i(t.expr,e),s),o(i(t.expr,s),s),[r(s)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){let s=e;for(let e=0;e<t.min;e++){let e=n();o(i(t.expr,s),e),s=e}if(-1==t.max)o(i(t.expr,s),s);else for(let e=t.min;e<t.max;e++){let e=n();r(s,e),o(i(t.expr,s),e),s=e}return[r(s)]}if("name"==t.type)return[r(e,void 0,t.value)];throw new Error("Unknown expr type")}for(let r=0;;r++){let s=i(t.exprs[r],e);if(r==t.exprs.length-1)return s;o(s,e=n())}}}(r));return function(t,e){for(let n=0,r=[t];n<r.length;n++){let t=r[n],o=!t.validEnd,i=[];for(let e=0;e<t.next.length;e++){let{type:n,next:s}=t.next[e];i.push(n.name),!o||n.isText||n.hasRequiredAttrs()||(o=!1),-1==r.indexOf(s)&&r.push(s)}o&&e.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,n=t.childCount){let r=this;for(let o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let n=0;n<t.next.length;n++)if(this.next[e].type==t.next[n].type)return!0;return!1}fillBefore(t,e=!1,n=0){let r=[this];return function o(i,s){let a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return l.from(s.map(t=>t.createAndFill()));for(let t=0;t<i.next.length;t++){let{type:e,next:n}=i.next[t];if(!e.isText&&!e.hasRequiredAttrs()&&-1==r.indexOf(n)){r.push(n);let t=o(n,s.concat(e));if(t)return t}}return null}(this,[])}findWrapping(t){for(let e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(t)){let t=[];for(let e=r;e.type;e=e.via)t.push(e.type);return t.reverse()}for(let t=0;t<o.next.length;t++){let{type:i,next:s}=o.next[t];i.isLeaf||i.hasRequiredAttrs()||i.name in e||r.type&&!s.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),e[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];return function e(n){t.push(n);for(let r=0;r<n.next.length;r++)-1==t.indexOf(n.next[r].next)&&e(n.next[r].next)}(this),t.map((e,n)=>{let r=n+(e.validEnd?"*":" ")+" ";for(let n=0;n<e.next.length;n++)r+=(n?", ":"")+e.next[n].type.name+"->"+t.indexOf(e.next[n].next);return r}).join("\n")}}L.empty=new L(!0);class I{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function z(t){let e=[];do{e.push(F(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function F(t){let e=[];do{e.push(B(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function B(t){let e=function(t){if(t.eat("(")){let e=z(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){let e=function(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let o=[];for(let t in n){let r=n[t];r.isInGroup(e)&&o.push(r)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}t.err("Unexpected token '"+t.next+"'")}(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=H(t,e)}return e}function j(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function H(t,e){let n=j(t),r=n;return t.eat(",")&&(r="}"!=t.next?j(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function $(t,e){return e-t}function q(t,e){let n=[];return function e(r){let o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(let t=0;t<o.length;t++){let{term:r,to:i}=o[t];r||-1!=n.indexOf(i)||e(i)}}(e),n.sort($)}function V(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function W(t,e){let n=Object.create(null);for(let r in t){let o=e&&e[r];if(void 0===o){let e=t[r];if(!e.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=e.default}n[r]=o}return n}function G(t,e,n,r){for(let r in e)if(!(r in t))throw new RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let n in t){let r=t[n];r.validate&&r.validate(e[n])}}function U(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new K(t,r,e[r]);return n}let Y=class t{constructor(t,e,n){this.name=t,this.schema=e,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=U(t,n.attrs),this.defaultAttrs=V(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==L.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:W(this.attrs,t)}create(t=null,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new R(this,this.computeAttrs(t),l.from(e),p.setFrom(n))}createChecked(t=null,e,n){return e=l.from(e),this.checkContent(e),new R(this,this.computeAttrs(t),e,p.setFrom(n))}createAndFill(t=null,e,n){if(t=this.computeAttrs(t),(e=l.from(e)).size){let t=this.contentMatch.fillBefore(e);if(!t)return null;e=t.append(e)}let r=this.contentMatch.matchFragment(e),o=r&&r.fillBefore(l.empty,!0);return o?new R(this,t,e.append(o),p.setFrom(n)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let e=0;e<t.childCount;e++)if(!this.allowsMarks(t.child(e).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){G(this.attrs,t,"node",this.name)}allowsMarkType(t){return null==this.markSet||this.markSet.indexOf(t)>-1}allowsMarks(t){if(null==this.markSet)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(null==this.markSet)return t;let e;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:p.none:t}static compile(e,n){let r=Object.create(null);e.forEach((e,o)=>r[e]=new t(e,n,o));let o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let t in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class K{constructor(t,e,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(t,e,n){let r=n.split("|");return n=>{let o=null===n?"null":typeof n;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}(t,e,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class X{constructor(t,e,n,r){this.name=t,this.rank=e,this.schema=n,this.spec=r,this.attrs=U(t,r.attrs),this.excluded=null;let o=V(this.attrs);this.instance=o?new p(this,o):null}create(t=null){return!t&&this.instance?this.instance:new p(this,W(this.attrs,t))}static compile(t,e){let n=Object.create(null),r=0;return t.forEach((t,o)=>n[t]=new X(t,r++,e,o)),n}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){G(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class J{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let n in t)e[n]=t[n];e.nodes=i.from(t.nodes),e.marks=i.from(t.marks||{}),this.nodes=Y.compile(this.spec.nodes,this),this.marks=X.compile(this.spec.marks,this);let n=Object.create(null);for(let t in this.nodes){if(t in this.marks)throw new RangeError(t+" can not be both a node and a mark");let e=this.nodes[t],r=e.spec.content||"",o=e.spec.marks;if(e.contentMatch=n[r]||(n[r]=L.parse(r,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==o?null:o?Z(this,o.split(" ")):""!=o&&e.inlineContent?null:[]}for(let t in this.marks){let e=this.marks[t],n=e.spec.excludes;e.excluded=null==n?[e]:""==n?[]:Z(this,n.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Y))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)}text(t,e){let n=this.nodes.text;return new N(n,n.defaultAttrs,t,p.setFrom(e))}mark(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return R.fromJSON(this,t)}markFromJSON(t){return p.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function Z(t,e){let n=[];for(let r=0;r<e.length;r++){let o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(let e in t.marks){let r=t.marks[e];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=r)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}class Q{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let n=this.matchedStyles=[];e.forEach(t=>{if(function(t){return null!=t.tag}(t))this.tags.push(t);else if(function(t){return null!=t.style}(t)){let e=/[^=]*/.exec(t.style)[0];n.indexOf(e)<0&&n.push(e),this.styles.push(t)}}),this.normalizeLists=!this.tags.some(e=>{if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;let n=t.nodes[e.node];return n.contentMatch.matchType(n)})}parse(t,e={}){let n=new it(this,e,!1);return n.addAll(t,p.none,e.from,e.to),n.finish()}parseSlice(t,e={}){let n=new it(this,e,!0);return n.addAll(t,p.none,e.from,e.to),h.maxOpen(n.finish())}matchTag(t,e,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let n=this.tags[r];if(st(t,n.tag)&&(void 0===n.namespace||t.namespaceURI==n.namespace)&&(!n.context||e.matchesContext(n.context))){if(n.getAttrs){let e=n.getAttrs(t);if(!1===e)continue;n.attrs=e||void 0}return n}}}matchStyle(t,e,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(!(0!=i.indexOf(t)||r.context&&!n.matchesContext(r.context)||i.length>t.length&&(61!=i.charCodeAt(t.length)||i.slice(t.length+1)!=e))){if(r.getAttrs){let t=r.getAttrs(e);if(!1===t)continue;r.attrs=t||void 0}return r}}}static schemaRules(t){let e=[];function n(t){let n=null==t.priority?50:t.priority,r=0;for(;r<e.length;r++){let t=e[r];if((null==t.priority?50:t.priority)<n)break}e.splice(r,0,t)}for(let e in t.marks){let r=t.marks[e].spec.parseDOM;r&&r.forEach(t=>{n(t=at(t)),t.mark||t.ignore||t.clearMark||(t.mark=e)})}for(let e in t.nodes){let r=t.nodes[e].spec.parseDOM;r&&r.forEach(t=>{n(t=at(t)),t.node||t.ignore||t.mark||(t.node=e)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Q(t,Q.schemaRules(t)))}}const tt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},et={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nt={ol:!0,ul:!0};function rt(t,e,n){return null!=e?(e?1:0)|("full"===e?2:0):t&&"pre"==t.whitespace?3:-5&n}class ot{constructor(t,e,n,r,o,i){this.type=t,this.attrs=e,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=p.none,this.match=o||(4&i?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(l.from(t));if(!e){let e,n=this.type.contentMatch;return(e=n.findWrapping(t.type))?(this.match=n,e):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)}finish(t){if(!(1&this.options)){let t,e=this.content[this.content.length-1];if(e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))){let n=e;e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length))}}let e=l.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(l.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!tt.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class it{constructor(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r,o=e.topNode,i=rt(null,e.preserveWhitespace,0)|(n?4:0);r=o?new ot(o.type,o.attrs,p.none,!0,e.topMatch||o.type.contentMatch,i):new ot(n?null:t.schema.topNodeType,null,p.none,!0,null,i),this.nodes=[r],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){3==t.nodeType?this.addTextNode(t,e):1==t.nodeType&&this.addElement(t,e)}addTextNode(t,e){let n=t.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===o||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(o)n="full"!==o?n.replace(/\r?\n|\r/g," "):n.replace(/\r\n?/g,"\n");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let e=r.content[r.content.length-1],o=t.previousSibling;(!e||o&&"BR"==o.nodeName||e.isText&&/[ \t\r\n\u000c]$/.test(e.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),e,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,e,n){let r=this.localPreserveWS,o=this.top;("PRE"==t.tagName||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let i,s=t.nodeName.toLowerCase();nt.hasOwnProperty(s)&&this.parser.normalizeLists&&function(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let t=1==e.nodeType?e.nodeName.toLowerCase():null;t&&nt.hasOwnProperty(t)&&n?(n.appendChild(e),e=n):"li"==t?n=e:t&&(n=null)}}(t);let a=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,n));t:if(a?a.ignore:et.hasOwnProperty(s))this.findInside(t),this.ignoreFallback(t,e);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(t=a.skip);let n,r=this.needsBlock;if(tt.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let i=a&&a.skip?e:this.readStyles(t,e);i&&this.addAll(t,i),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(t,e);n&&this.addElementByRule(t,a,n,!1===a.consuming?i:void 0)}this.localPreserveWS=r}leafFallback(t,e){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"),e)}ignoreFallback(t,e){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let n=t.style;if(n&&n.length)for(let t=0;t<this.parser.matchedStyles.length;t++){let r=this.parser.matchedStyles[t],o=n.getPropertyValue(r);if(o)for(let t;;){let n=this.parser.matchStyle(r,o,this,t);if(!n)break;if(n.ignore)return null;if(e=n.clearMark?e.filter(t=>!n.clearMark(t)):e.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1!==n.consuming)break;t=n}}return e}addElementByRule(t,e,n,r){let o,i;if(e.node)if(i=this.parser.schema.nodes[e.node],i.isLeaf)this.insertNode(i.create(e.attrs),n,"BR"==t.nodeName)||this.leafFallback(t,n);else{let t=this.enter(i,e.attrs||null,n,e.preserveWhitespace);t&&(o=!0,n=t)}else{let t=this.parser.schema.marks[e.mark];n=n.concat(t.create(e.attrs))}let s=this.top;if(i&&i.isLeaf)this.findInside(t);else if(r)this.addElement(t,n,r);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(t=>this.insertNode(t,n,!1));else{let r=t;"string"==typeof e.contentElement?r=t.querySelector(e.contentElement):"function"==typeof e.contentElement?r=e.contentElement(t):e.contentElement&&(r=e.contentElement),this.findAround(t,r,!0),this.addAll(r,n),this.findAround(t,r,!1)}o&&this.sync(s)&&this.open--}addAll(t,e,n,r){let o=n||0;for(let i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i,e);this.findAtPoint(t,o)}findPlace(t,e,n){let r,o;for(let e=this.open,i=0;e>=0;e--){let s=this.nodes[e],a=s.findWrapping(t);if(a&&(!r||r.length>a.length+i)&&(r=a,o=s,!a.length))break;if(s.solid){if(n)break;i+=2}}if(!r)return null;this.sync(o);for(let t=0;t<r.length;t++)e=this.enterInner(r[t],null,e,!1);return e}insertNode(t,e,n){if(t.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&(e=this.enterInner(t,null,e))}let r=this.findPlace(t,e,n);if(r){this.closeExtra();let e=this.top;e.match&&(e.match=e.match.matchType(t.type));let n=p.none;for(let o of r.concat(t.marks))(e.type?e.type.allowsMarkType(o.type):lt(o.type,t.type))&&(n=o.addToSet(n));return e.content.push(t.mark(n)),!0}return!1}enter(t,e,n,r){let o=this.findPlace(t.create(e),n,!1);return o&&(o=this.enterInner(t,e,n,!0,r)),o}enterInner(t,e,n,r=!1,o){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(t);let s=rt(t,o,i.options);4&i.options&&0==i.content.length&&(s|=4);let a=p.none;return n=n.filter(e=>!(i.type?i.type.allowsMarkType(e.type):lt(e.type,t))||(a=e.addToSet(a),!1)),this.nodes.push(new ot(t,e,a,r,null,s)),this.open++,n}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=1)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let n=this.nodes[e].content;for(let e=n.length-1;e>=0;e--)t+=n[e].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,n){if(t!=e&&this.find)for(let r=0;r<this.find.length;r++)if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node)){e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),n=this.options.context,r=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),i=(t,s)=>{for(;t>=0;t--){let a=e[t];if(""==a){if(t==e.length-1||0==t)continue;for(;s>=o;s--)if(i(t-1,s))return!0;return!1}{let t=s>0||0==s&&r?this.nodes[s].type:n&&s>=o?n.node(s-o).type:null;if(!t||t.name!=a&&!t.isInGroup(a))return!1;s--}}return!0};return i(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function st(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function at(t){let e={};for(let n in t)e[n]=t[n];return e}function lt(t,e){let n=e.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(t))continue;let i=[],s=t=>{i.push(t);for(let n=0;n<t.edgeCount;n++){let{type:r,next:o}=t.edge(n);if(r==e)return!0;if(i.indexOf(o)<0&&s(o))return!0}};if(s(o.contentMatch))return!0}}class ct{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},n){n||(n=dt(e).createDocumentFragment());let r=n,o=[];return t.forEach(t=>{if(o.length||t.marks.length){let n=0,i=0;for(;n<o.length&&i<t.marks.length;){let e=t.marks[i];if(this.marks[e.type.name]){if(!e.eq(o[n][0])||!1===e.type.spec.spanning)break;n++,i++}else i++}for(;n<o.length;)r=o.pop()[1];for(;i<t.marks.length;){let n=t.marks[i++],s=this.serializeMark(n,t.isInline,e);s&&(o.push([n,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(t,e))}),n}serializeNodeInner(t,e){let{dom:n,contentDOM:r}=ht(dt(e),this.nodes[t.type.name](t),null,t.attrs);if(r){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,r)}return n}serializeNode(t,e={}){let n=this.serializeNodeInner(t,e);for(let r=t.marks.length-1;r>=0;r--){let o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(t,e,n={}){let r=this.marks[t.type.name];return r&&ht(dt(n),r(t,e),null,t.attrs)}static renderSpec(t,e,n=null,r){return ht(t,e,n,r)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new ct(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=ut(t.nodes);return e.text||(e.text=t=>t.text),e}static marksFromSchema(t){return ut(t.marks)}}function ut(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function dt(t){return t.document||window.document}const pt=new WeakMap;function ft(t){let e=pt.get(t);return void 0===e&&pt.set(t,e=function(t){let e=null;function n(t){if(t&&"object"==typeof t)if(Array.isArray(t))if("string"==typeof t[0])e||(e=[]),e.push(t);else for(let e=0;e<t.length;e++)n(t[e]);else for(let e in t)n(t[e])}return n(t),e}(t)),e}function ht(t,e,n,r){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;let o,i=e[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=ft(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s,a=i.indexOf(" ");a>0&&(n=i.slice(0,a),i=i.slice(a+1));let l=n?t.createElementNS(n,i):t.createElement(i),c=e[1],u=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){u=2;for(let t in c)if(null!=c[t]){let e=t.indexOf(" ");e>0?l.setAttributeNS(t.slice(0,e),t.slice(e+1),c[t]):l.setAttribute(t,c[t])}}for(let o=u;o<e.length;o++){let i=e[o];if(0===i){if(o<e.length-1||o>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:e,contentDOM:o}=ht(t,i,n,r);if(l.appendChild(e),o){if(s)throw new RangeError("Multiple content holes");s=o}}}return{dom:l,contentDOM:s}}const mt=Math.pow(2,16);function gt(t,e){return t+e*mt}function vt(t){return 65535&t}class yt{constructor(t,e,n){this.pos=t,this.delInfo=e,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class bt{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&bt.empty)return bt.empty}recover(t){let e=0,n=vt(t);if(!this.inverted)for(let t=0;t<n;t++)e+=this.ranges[3*t+2]-this.ranges[3*t+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/mt}(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,n){let r=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;let l=this.ranges[s+o],c=this.ranges[s+i],u=a+l;if(t<=u){let o=a+r+((l?t==a?-1:t==u?1:e:e)<0?0:c);if(n)return o;let i=t==(e<0?a:u)?null:gt(s/3,t-a),d=t==a?2:t==u?1:4;return(e<0?t!=a:t!=u)&&(d|=8),new yt(o,d,i)}r+=c-l}return n?t+r:new yt(t+r,0,null)}touches(t,e){let n=0,r=vt(e),o=this.inverted?2:1,i=this.inverted?1:2;for(let e=0;e<this.ranges.length;e+=3){let s=this.ranges[e]-(this.inverted?n:0);if(s>t)break;let a=this.ranges[e+o];if(t<=s+a&&e==3*r)return!0;n+=this.ranges[e+i]-a}return!1}forEach(t){let e=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),l=this.ranges[r+e],c=this.ranges[r+n];t(s,s+l,a,a+c),o+=c-l}}invert(){return new bt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?bt.empty:new bt(t<0?[0,-t,0]:[0,0,t])}}bt.empty=new bt([]);class xt{constructor(t,e,n=0,r=(t?t.length:0)){this.mirror=e,this.from=n,this.to=r,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new xt(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),null!=e&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,n=this._maps.length;e<t._maps.length;e++){let r=t.getMirror(e);this.appendMap(t._maps[e],null!=r&&r<e?n+r:void 0)}}getMirror(t){if(this.mirror)for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,n=this._maps.length+t._maps.length;e>=0;e--){let r=t.getMirror(e);this.appendMap(t._maps[e].invert(),null!=r&&r>e?n-r-1:void 0)}}invert(){let t=new xt;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,n){let r=0;for(let n=this.from;n<this.to;n++){let o=this._maps[n].mapResult(t,e);if(null!=o.recover){let e=this.getMirror(n);if(null!=e&&e>n&&e<this.to){n=e,t=this._maps[e].recover(o.recover);continue}}r|=o.delInfo,t=o.pos}return n?t:new yt(t,r,null)}}const wt=Object.create(null);class kt{getMap(){return bt.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=wt[e.stepType];if(!n)throw new RangeError(`No step type ${e.stepType} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in wt)throw new RangeError("Duplicate use of step JSON ID "+t);return wt[t]=e,e.prototype.jsonID=t,e}}class Et{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new Et(t,null)}static fail(t){return new Et(null,t)}static fromReplace(t,e,n,r){try{return Et.ok(t.replace(e,n,r))}catch(t){if(t instanceof f)return Et.fail(t.message);throw t}}}function Ct(t,e,n){let r=[];for(let o=0;o<t.childCount;o++){let i=t.child(o);i.content.size&&(i=i.copy(Ct(i.content,e,i))),i.isInline&&(i=e(i,n,o)),r.push(i)}return l.fromArray(r)}class St extends kt{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=t.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new h(Ct(e.content,(t,e)=>t.isAtom&&e.type.allowsMarkType(this.mark.type)?t.mark(this.mark.addToSet(t.marks)):t,r),e.openStart,e.openEnd);return Et.fromReplace(t,this.from,this.to,o)}invert(){return new Dt(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new St(e.pos,n.pos,this.mark)}merge(t){return t instanceof St&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new St(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new St(e.from,e.to,t.markFromJSON(e.mark))}}kt.jsonID("addMark",St);class Dt extends kt{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=new h(Ct(e.content,t=>t.mark(this.mark.removeFromSet(t.marks)),t),e.openStart,e.openEnd);return Et.fromReplace(t,this.from,this.to,n)}invert(){return new St(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new Dt(e.pos,n.pos,this.mark)}merge(t){return t instanceof Dt&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Dt(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Dt(e.from,e.to,t.markFromJSON(e.mark))}}kt.jsonID("removeMark",Dt);class Mt extends kt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Et.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return Et.fromReplace(t,this.pos,this.pos+1,new h(l.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let t=this.mark.addToSet(e.marks);if(t.length==e.marks.length){for(let n=0;n<e.marks.length;n++)if(!e.marks[n].isInSet(t))return new Mt(this.pos,e.marks[n]);return new Mt(this.pos,this.mark)}}return new Ot(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Mt(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Mt(e.pos,t.markFromJSON(e.mark))}}kt.jsonID("addNodeMark",Mt);class Ot extends kt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Et.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return Et.fromReplace(t,this.pos,this.pos+1,new h(l.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new Mt(this.pos,this.mark):this}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Ot(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ot(e.pos,t.markFromJSON(e.mark))}}kt.jsonID("removeNodeMark",Ot);class _t extends kt{constructor(t,e,n,r=!1){super(),this.from=t,this.to=e,this.slice=n,this.structure=r}apply(t){return this.structure&&Tt(t,this.from,this.to)?Et.fail("Structure replace would overwrite content"):Et.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new bt([this.from,this.to-this.from,this.slice.size])}invert(t){return new _t(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deletedAcross&&n.deletedAcross?null:new _t(e.pos,Math.max(e.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof _t)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let e=this.slice.size+t.slice.size==0?h.empty:new h(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new _t(t.from,this.to,e,this.structure)}}{let e=this.slice.size+t.slice.size==0?h.empty:new h(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new _t(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new _t(e.from,e.to,h.fromJSON(t,e.slice),!!e.structure)}}kt.jsonID("replace",_t);class At extends kt{constructor(t,e,n,r,o,i,s=!1){super(),this.from=t,this.to=e,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=s}apply(t){if(this.structure&&(Tt(t,this.from,this.gapFrom)||Tt(t,this.gapTo,this.to)))return Et.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Et.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,e.content);return n?Et.fromReplace(t,this.from,this.to,n):Et.fail("Content does not fit in gap")}getMap(){return new bt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new At(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),r=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return e.deletedAcross&&n.deletedAcross||r<e.pos||o>n.pos?null:new At(e.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to||"number"!=typeof e.gapFrom||"number"!=typeof e.gapTo||"number"!=typeof e.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new At(e.from,e.to,e.gapFrom,e.gapTo,h.fromJSON(t,e.slice),e.insert,!!e.structure)}}function Tt(t,e,n){let r=t.resolve(e),o=n-e,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let t=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!t||t.isLeaf)return!0;t=t.firstChild,o--}}return!1}function Rt(t,e,n,r=n.contentMatch,o=!0){let i=t.doc.nodeAt(e),s=[],a=e+1;for(let e=0;e<i.childCount;e++){let c=i.child(e),u=a+c.nodeSize,d=r.matchType(c.type);if(d){r=d;for(let e=0;e<c.marks.length;e++)n.allowsMarkType(c.marks[e].type)||t.step(new Dt(a,u,c.marks[e]));if(o&&c.isText&&"pre"!=n.whitespace){let t,e,r=/\r?\n|\r/g;for(;t=r.exec(c.text);)e||(e=new h(l.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),s.push(new _t(a+t.index,a+t.index+t[0].length,e))}}else s.push(new _t(a,u,h.empty));a=u}if(!r.validEnd){let e=r.fillBefore(l.empty,!0);t.replace(a,a,new h(e,0,0))}for(let e=s.length-1;e>=0;e--)t.step(s[e])}function Nt(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Pt(t){let e=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth;;--n){let r=t.$from.node(n),o=t.$from.index(n),i=t.$to.indexAfter(n);if(n<t.depth&&r.canReplace(o,i,e))return n;if(0==n||r.type.spec.isolating||!Nt(r,o,i))break}return null}function Lt(t,e,n=null,r=t){let o=function(t,e){let{parent:n,startIndex:r,endIndex:o}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let s=i.length?i[0]:e;return n.canReplaceWith(r,o,s)?i:null}(t,e),i=o&&function(t,e){let{parent:n,startIndex:r,endIndex:o}=t,i=n.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let t=r;a&&t<o;t++)a=a.matchType(n.child(t).type);return a&&a.validEnd?s:null}(r,e);return i?o.map(It).concat({type:e,attrs:n}).concat(i.map(It)):null}function It(t){return{type:t,attrs:null}}function zt(t,e,n,r){e.forEach((o,i)=>{if(o.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(o.text);){let o=t.mapping.slice(r).map(n+1+i+s.index);t.replaceWith(o,o+1,e.type.schema.linebreakReplacement.create())}}})}function Ft(t,e,n,r){e.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+i);t.replaceWith(o,o+1,e.type.schema.text("\n"))}})}function Bt(t,e,n=1,r){let o=t.resolve(e),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let t=o.depth-1,e=n-2;t>i;t--,e--){let n=o.node(t),i=o.index(t);if(n.type.spec.isolating)return!1;let s=n.content.cutByIndex(i,n.childCount),a=r&&r[e+1];a&&(s=s.replaceChild(0,a.type.create(a.attrs)));let l=r&&r[e]||n;if(!n.canReplace(i+1,n.childCount)||!l.type.validContent(s))return!1}let a=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(a,a,l?l.type:o.node(i+1).type)}function jt(t,e){let n=t.resolve(e),r=n.index();return Ht(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Ht(t,e){return!(!t||!e||t.isLeaf||!function(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let o=0;o<e.childCount;o++){let i=e.child(o),s=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(s),!n)return!1;if(!t.type.allowsMarks(i.marks))return!1}return n.validEnd}(t,e))}function $t(t,e,n=-1){let r=t.resolve(e);for(let t=r.depth;;t--){let o,i,s=r.index(t);if(t==r.depth?(o=r.nodeBefore,i=r.nodeAfter):n>0?(o=r.node(t+1),s++,i=r.node(t).maybeChild(s)):(o=r.node(t).maybeChild(s-1),i=r.node(t+1)),o&&!o.isTextblock&&Ht(o,i)&&r.node(t).canReplace(s,s+1))return e;if(0==t)break;e=n<0?r.before(t):r.after(t)}}function qt(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let o=n.content;for(let t=0;t<n.openStart;t++)o=o.firstChild.content;for(let t=1;t<=(0==n.openStart&&n.size?2:1);t++)for(let e=r.depth;e>=0;e--){let n=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,i=r.index(e)+(n>0?1:0),s=r.node(e),a=!1;if(1==t)a=s.canReplace(i,i,o);else{let t=s.contentMatchAt(i).findWrapping(o.firstChild.type);a=t&&s.canReplaceWith(i,i,t[0])}if(a)return 0==n?r.pos:n<0?r.before(e+1):r.after(e+1)}return null}function Vt(t,e,n=e,r=h.empty){if(e==n&&!r.size)return null;let o=t.resolve(e),i=t.resolve(n);return Wt(o,i,r)?new _t(e,n,r):new Gt(o,i,r).fit()}function Wt(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}kt.jsonID("replaceAround",At);class Gt{constructor(t,e,n){this.$from=t,this.$to=e,this.unplaced=n,this.frontier=[],this.placed=l.empty;for(let e=0;e<=t.depth;e++){let n=t.node(e);this.frontier.push({type:n.type,match:n.contentMatchAt(t.indexAfter(e))})}for(let e=t.depth;e>0;e--)this.placed=l.from(t.node(e).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(t<0?this.$to:n.doc.resolve(t));if(!r)return null;let o=this.placed,i=n.depth,s=r.depth;for(;i&&s&&1==o.childCount;)o=o.firstChild.content,i--,s--;let a=new h(o,i,s);return t>-1?new At(n.pos,t,this.$to.pos,this.$to.end(),a,e):a.size||n.pos!=this.$to.pos?new _t(n.pos,r.pos,a):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<t;n++){let o=e.firstChild;if(e.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){t=n;break}e=o.content}for(let e=1;e<=2;e++)for(let n=1==e?t:this.unplaced.openStart;n>=0;n--){let t,r=null;n?(r=Kt(this.unplaced.content,n-1).firstChild,t=r.content):t=this.unplaced.content;let o=t.firstChild;for(let t=this.depth;t>=0;t--){let i,{type:s,match:a}=this.frontier[t],c=null;if(1==e&&(o?a.matchType(o.type)||(c=a.fillBefore(l.from(o),!1)):r&&s.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:t,parent:r,inject:c};if(2==e&&o&&(i=a.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:t,parent:r,wrap:i};if(r&&a.matchType(r.type))break}}}openMore(){let{content:t,openStart:e,openEnd:n}=this.unplaced,r=Kt(t,e);return!(!r.childCount||r.firstChild.isLeaf)&&(this.unplaced=new h(t,e+1,Math.max(n,r.size+e>=t.size-n?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:n}=this.unplaced,r=Kt(t,e);if(r.childCount<=1&&e>0){let o=t.size-e<=e+r.size;this.unplaced=new h(Ut(t,e-1,1),e-1,o?e-1:n)}else this.unplaced=new h(Ut(t,e,1),e,n)}placeNodes({sliceDepth:t,frontierDepth:e,parent:n,inject:r,wrap:o}){for(;this.depth>e;)this.closeFrontierNode();if(o)for(let t=0;t<o.length;t++)this.openFrontierNode(o[t]);let i=this.unplaced,s=n?n.content:i.content,a=i.openStart-t,c=0,u=[],{match:d,type:p}=this.frontier[e];if(r){for(let t=0;t<r.childCount;t++)u.push(r.child(t));d=d.matchFragment(r)}let f=s.size+t-(i.content.size-i.openEnd);for(;c<s.childCount;){let t=s.child(c),e=d.matchType(t.type);if(!e)break;c++,(c>1||0==a||t.content.size)&&(d=e,u.push(Xt(t.mark(p.allowedMarks(t.marks)),1==c?a:0,c==s.childCount?f:-1)))}let m=c==s.childCount;m||(f=-1),this.placed=Yt(this.placed,e,l.from(u)),this.frontier[e].match=d,m&&f<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let t=0,e=s;t<f;t++){let t=e.lastChild;this.frontier.push({type:t.type,match:t.contentMatchAt(t.childCount)}),e=t.content}this.unplaced=m?0==t?h.empty:new h(Ut(i.content,t-1,1),t-1,f<0?i.openEnd:t-1):new h(Ut(i.content,t,c),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t,e=this.frontier[this.depth];if(!e.type.isTextblock||!Jt(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:n,type:r}=this.frontier[e],o=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),i=Jt(t,e,r,n,o);if(i){for(let n=e-1;n>=0;n--){let{match:e,type:r}=this.frontier[n],o=Jt(t,n,r,e,!0);if(!o||o.childCount)continue t}return{depth:e,fit:i,move:o?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Yt(this.placed,e.depth,e.fit)),t=e.move;for(let n=e.depth+1;n<=t.depth;n++){let e=t.node(n),r=e.type.contentMatch.fillBefore(e.content,!0,t.index(n));this.openFrontierNode(e.type,e.attrs,r)}return t}openFrontierNode(t,e=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=Yt(this.placed,this.depth,l.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(l.empty,!0);t.childCount&&(this.placed=Yt(this.placed,this.frontier.length,t))}}function Ut(t,e,n){return 0==e?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Ut(t.firstChild.content,e-1,n)))}function Yt(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Yt(t.lastChild.content,e-1,n)))}function Kt(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function Xt(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,Xt(r.firstChild,e-1,1==r.childCount?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(l.empty,!0)))),t.copy(r)}function Jt(t,e,n,r,o){let i=t.node(e),s=o?t.indexAfter(e):t.index(e);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,s);return a&&!function(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function Zt(t){return t.spec.defining||t.spec.definingForContent}function Qt(t,e,n,r,o){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(Qt(o.content,e+1,n,r,o)))}if(e>r){let e=o.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(l.empty,!0))}return t}function te(t,e){let n=[];for(let r=Math.min(t.depth,e.depth);r>=0;r--){let o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(o==e.start(r)||r==t.depth&&r==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==o-1)&&n.push(r)}return n}class ee extends kt{constructor(t,e,n){super(),this.pos=t,this.attr=e,this.value=n}apply(t){let e=t.nodeAt(this.pos);if(!e)return Et.fail("No node at attribute step's position");let n=Object.create(null);for(let t in e.attrs)n[t]=e.attrs[t];n[this.attr]=this.value;let r=e.type.create(n,null,e.marks);return Et.fromReplace(t,this.pos,this.pos+1,new h(l.from(r),0,e.isLeaf?0:1))}getMap(){return bt.empty}invert(t){return new ee(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new ee(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if("number"!=typeof e.pos||"string"!=typeof e.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new ee(e.pos,e.attr,e.value)}}kt.jsonID("attr",ee);class ne extends kt{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;let n=t.type.create(e,t.content,t.marks);return Et.ok(n)}getMap(){return bt.empty}invert(t){return new ne(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if("string"!=typeof e.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ne(e.attr,e.value)}}kt.jsonID("docAttr",ne);let re=class extends Error{};re=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n},(re.prototype=Object.create(Error.prototype)).constructor=re,re.prototype.name="TransformError";class oe{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new xt}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new re(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,n=h.empty){let r=Vt(this.doc,t,e,n);return r&&this.step(r),this}replaceWith(t,e,n){return this.replace(t,e,new h(l.from(n),0,0))}delete(t,e){return this.replace(t,e,h.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,n){return function(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let o=t.doc.resolve(e),i=t.doc.resolve(n);if(Wt(o,i,r))return t.step(new _t(e,n,r));let s=te(o,t.doc.resolve(n));0==s[s.length-1]&&s.pop();let a=-(o.depth+1);s.unshift(a);for(let t=o.depth,e=o.pos-1;t>0;t--,e--){let n=o.node(t).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;s.indexOf(t)>-1?a=t:o.before(t)==e&&s.splice(1,0,-t)}let l=s.indexOf(a),c=[],u=r.openStart;for(let t=r.content,e=0;;e++){let n=t.firstChild;if(c.push(n),e==r.openStart)break;t=n.content}for(let t=u-1;t>=0;t--){let e=c[t],n=Zt(e.type);if(n&&!e.sameMarkup(o.node(Math.abs(a)-1)))u=t;else if(n||!e.type.isTextblock)break}for(let e=r.openStart;e>=0;e--){let a=(e+u+1)%(r.openStart+1),d=c[a];if(d)for(let e=0;e<s.length;e++){let c=s[(e+l)%s.length],u=!0;c<0&&(u=!1,c=-c);let p=o.node(c-1),f=o.index(c-1);if(p.canReplaceWith(f,f,d.type,d.marks))return t.replace(o.before(c),u?i.after(c):n,new h(Qt(r.content,0,r.openStart,a),a,r.openEnd))}}let d=t.steps.length;for(let a=s.length-1;a>=0&&(t.replace(e,n,r),!(t.steps.length>d));a--){let t=s[a];t<0||(e=o.before(t),n=i.after(t))}}(this,t,e,n),this}replaceRangeWith(t,e,n){return function(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let o=function(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(let t=r.depth-1;t>=0;t--){let e=r.index(t);if(r.node(t).canReplaceWith(e,e,n))return r.before(t+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let t=r.depth-1;t>=0;t--){let e=r.indexAfter(t);if(r.node(t).canReplaceWith(e,e,n))return r.after(t+1);if(e<r.node(t).childCount)return null}return null}(t.doc,e,r.type);null!=o&&(e=n=o)}t.replaceRange(e,n,new h(l.from(r),0,0))}(this,t,e,n),this}deleteRange(t,e){return function(t,e,n){let r=t.doc.resolve(e),o=t.doc.resolve(n),i=te(r,o);for(let e=0;e<i.length;e++){let n=i[e],s=e==i.length-1;if(s&&0==n||r.node(n).type.contentMatch.validEnd)return t.delete(r.start(n),o.end(n));if(n>0&&(s||r.node(n-1).canReplace(r.index(n-1),o.indexAfter(n-1))))return t.delete(r.before(n),o.after(n))}for(let i=1;i<=r.depth&&i<=o.depth;i++)if(e-r.start(i)==r.depth-i&&n>r.end(i)&&o.end(i)-n!=o.depth-i&&r.start(i-1)==o.start(i-1)&&r.node(i-1).canReplace(r.index(i-1),o.index(i-1)))return t.delete(r.before(i),n);t.delete(e,n)}(this,t,e),this}lift(t,e){return function(t,e,n){let{$from:r,$to:o,depth:i}=e,s=r.before(i+1),a=o.after(i+1),c=s,u=a,d=l.empty,p=0;for(let t=i,e=!1;t>n;t--)e||r.index(t)>0?(e=!0,d=l.from(r.node(t).copy(d)),p++):c--;let f=l.empty,m=0;for(let t=i,e=!1;t>n;t--)e||o.after(t+1)<o.end(t)?(e=!0,f=l.from(o.node(t).copy(f)),m++):u++;t.step(new At(c,u,s,a,new h(d.append(f),p,m),d.size-p,!0))}(this,t,e),this}join(t,e=1){return function(t,e,n){let r=null,{linebreakReplacement:o}=t.doc.type.schema,i=t.doc.resolve(e-n),s=i.node().type;if(o&&s.inlineContent){let t="pre"==s.whitespace,e=!!s.contentMatch.matchType(o);t&&!e?r=!1:!t&&e&&(r=!0)}let a=t.steps.length;if(!1===r){let r=t.doc.resolve(e+n);Ft(t,r.node(),r.before(),a)}s.inlineContent&&Rt(t,e+n-1,s,i.node().contentMatchAt(i.index()),null==r);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new _t(c,l.map(e+n,-1),h.empty,!0)),!0===r){let e=t.doc.resolve(c);zt(t,e.node(),e.before(),t.steps.length)}}(this,t,e),this}wrap(t,e){return function(t,e,n){let r=l.empty;for(let t=n.length-1;t>=0;t--){if(r.size){let e=n[t].type.contentMatch.matchFragment(r);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=l.from(n[t].type.create(n[t].attrs,r))}let o=e.start,i=e.end;t.step(new At(o,i,o,i,new h(r,0,0),n.length,!0))}(this,t,e),this}setBlockType(t,e=t,n,r=null){return function(t,e,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(e,n)=>{let s="function"==typeof o?o(e):o;if(e.isTextblock&&!e.hasMarkup(r,s)&&function(t,e,n){let r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(t.doc,t.mapping.slice(i).map(n),r)){let o=null;if(r.schema.linebreakReplacement){let t="pre"==r.whitespace,e=!!r.contentMatch.matchType(r.schema.linebreakReplacement);t&&!e?o=!1:!t&&e&&(o=!0)}!1===o&&Ft(t,e,n,i),Rt(t,t.mapping.slice(i).map(n,1),r,void 0,null===o);let a=t.mapping.slice(i),c=a.map(n,1),u=a.map(n+e.nodeSize,1);return t.step(new At(c,u,c+1,u-1,new h(l.from(r.create(s,null,e.marks)),0,0),1,!0)),!0===o&&zt(t,e,n,i),!1}})}(this,t,e,n,r),this}setNodeMarkup(t,e,n=null,r){return function(t,e,n,r,o){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let s=n.create(r,null,o||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,s);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new At(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new h(l.from(s),0,0),1,!0))}(this,t,e,n,r),this}setNodeAttribute(t,e,n){return this.step(new ee(t,e,n)),this}setDocAttribute(t,e){return this.step(new ne(t,e)),this}addNodeMark(t,e){return this.step(new Mt(t,e)),this}removeNodeMark(t,e){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(e instanceof p)e.isInSet(n.marks)&&this.step(new Ot(t,e));else{let r,o=n.marks,i=[];for(;r=e.isInSet(o);)i.push(new Ot(t,r)),o=r.removeFromSet(o);for(let t=i.length-1;t>=0;t--)this.step(i[t])}return this}split(t,e=1,n){return function(t,e,n=1,r){let o=t.doc.resolve(e),i=l.empty,s=l.empty;for(let t=o.depth,e=o.depth-n,a=n-1;t>e;t--,a--){i=l.from(o.node(t).copy(i));let e=r&&r[a];s=l.from(e?e.type.create(e.attrs,s):o.node(t).copy(s))}t.step(new _t(e,e,new h(i.append(s),n,n),!0))}(this,t,e,n),this}addMark(t,e,n){return function(t,e,n,r){let o,i,s=[],a=[];t.doc.nodesBetween(e,n,(t,l,c)=>{if(!t.isInline)return;let u=t.marks;if(!r.isInSet(u)&&c.type.allowsMarkType(r.type)){let c=Math.max(l,e),d=Math.min(l+t.nodeSize,n),p=r.addToSet(u);for(let t=0;t<u.length;t++)u[t].isInSet(p)||(o&&o.to==c&&o.mark.eq(u[t])?o.to=d:s.push(o=new Dt(c,d,u[t])));i&&i.to==c?i.to=d:a.push(i=new St(c,d,r))}}),s.forEach(e=>t.step(e)),a.forEach(e=>t.step(e))}(this,t,e,n),this}removeMark(t,e,n){return function(t,e,n,r){let o=[],i=0;t.doc.nodesBetween(e,n,(t,s)=>{if(!t.isInline)return;i++;let a=null;if(r instanceof X){let e,n=t.marks;for(;e=r.isInSet(n);)(a||(a=[])).push(e),n=e.removeFromSet(n)}else r?r.isInSet(t.marks)&&(a=[r]):a=t.marks;if(a&&a.length){let r=Math.min(s+t.nodeSize,n);for(let t=0;t<a.length;t++){let n,l=a[t];for(let t=0;t<o.length;t++){let e=o[t];e.step==i-1&&l.eq(o[t].style)&&(n=e)}n?(n.to=r,n.step=i):o.push({style:l,from:Math.max(s,e),to:r,step:i})}}}),o.forEach(e=>t.step(new Dt(e.from,e.to,e.style)))}(this,t,e,n),this}clearIncompatible(t,e,n){return Rt(this,t,e,n),this}}const ie=Object.create(null);class se{constructor(t,e,n){this.$anchor=t,this.$head=e,this.ranges=n||[new ae(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=h.empty){let n=e.content.lastChild,r=null;for(let t=0;t<e.openEnd;t++)r=n,n=n.lastChild;let o=t.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:a,$to:l}=i[s],c=t.mapping.slice(o);t.replaceRange(c.map(a.pos),c.map(l.pos),s?h.empty:e),0==s&&ve(t,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(t,e){let n=t.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],a=t.mapping.slice(n),l=a.map(i.pos),c=a.map(s.pos);o?t.deleteRange(l,c):(t.replaceRangeWith(l,c,e),ve(t,n,e.isInline?-1:1))}}static findFrom(t,e,n=!1){let r=t.parent.inlineContent?new ue(t):ge(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(let r=t.depth-1;r>=0;r--){let o=e<0?ge(t.node(0),t.node(r),t.before(r+1),t.index(r),e,n):ge(t.node(0),t.node(r),t.after(r+1),t.index(r)+1,e,n);if(o)return o}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new he(t.node(0))}static atStart(t){return ge(t,t,0,0,1)||new he(t)}static atEnd(t){return ge(t,t,t.content.size,t.childCount,-1)||new he(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=ie[e.type];if(!n)throw new RangeError(`No selection type ${e.type} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in ie)throw new RangeError("Duplicate use of selection JSON ID "+t);return ie[t]=e,e.prototype.jsonID=t,e}getBookmark(){return ue.between(this.$anchor,this.$head).getBookmark()}}se.prototype.visible=!0;class ae{constructor(t,e){this.$from=t,this.$to=e}}let le=!1;function ce(t){le||t.parent.inlineContent||(le=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class ue extends se{constructor(t,e=t){ce(t),ce(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let n=t.resolve(e.map(this.head));if(!n.parent.inlineContent)return se.near(n);let r=t.resolve(e.map(this.anchor));return new ue(r.parent.inlineContent?r:n,n)}replace(t,e=h.empty){if(super.replace(t,e),e==h.empty){let e=this.$from.marksAcross(this.$to);e&&t.ensureMarks(e)}}eq(t){return t instanceof ue&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new de(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if("number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new ue(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,n=e){let r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))}static between(t,e,n){let r=t.pos-e.pos;if(n&&!r||(n=r>=0?1:-1),!e.parent.inlineContent){let t=se.findFrom(e,n,!0)||se.findFrom(e,-n,!0);if(!t)return se.near(e,n);e=t.$head}return t.parent.inlineContent||(0==r||(t=(se.findFrom(t,-n,!0)||se.findFrom(t,n,!0)).$anchor).pos<e.pos!=r<0)&&(t=e),new ue(t,e)}}se.jsonID("text",ue);class de{constructor(t,e){this.anchor=t,this.head=e}map(t){return new de(t.map(this.anchor),t.map(this.head))}resolve(t){return ue.between(t.resolve(this.anchor),t.resolve(this.head))}}class pe extends se{constructor(t){let e=t.nodeAfter,n=t.node(0).resolve(t.pos+e.nodeSize);super(t,n),this.node=e}map(t,e){let{deleted:n,pos:r}=e.mapResult(this.anchor),o=t.resolve(r);return n?se.near(o):new pe(o)}content(){return new h(l.from(this.node),0,0)}eq(t){return t instanceof pe&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new fe(this.anchor)}static fromJSON(t,e){if("number"!=typeof e.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new pe(t.resolve(e.anchor))}static create(t,e){return new pe(t.resolve(e))}static isSelectable(t){return!t.isText&&!1!==t.type.spec.selectable}}pe.prototype.visible=!1,se.jsonID("node",pe);class fe{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:n}=t.mapResult(this.anchor);return e?new de(n,n):new fe(n)}resolve(t){let e=t.resolve(this.anchor),n=e.nodeAfter;return n&&pe.isSelectable(n)?new pe(e):se.near(e)}}class he extends se{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=h.empty){if(e==h.empty){t.delete(0,t.doc.content.size);let e=se.atStart(t.doc);e.eq(t.selection)||t.setSelection(e)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new he(t)}map(t){return new he(t)}eq(t){return t instanceof he}getBookmark(){return me}}se.jsonID("all",he);const me={map(){return this},resolve:t=>new he(t)};function ge(t,e,n,r,o,i=!1){if(e.inlineContent)return ue.create(t,n);for(let s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){let r=e.child(s);if(r.isAtom){if(!i&&pe.isSelectable(r))return pe.create(t,n-(o<0?r.nodeSize:0))}else{let e=ge(t,r,n+o,o<0?r.childCount:0,o,i);if(e)return e}n+=r.nodeSize*o}return null}function ve(t,e,n){let r=t.steps.length-1;if(r<e)return;let o,i=t.steps[r];(i instanceof _t||i instanceof At)&&(t.mapping.maps[r].forEach((t,e,n,r)=>{null==o&&(o=r)}),t.setSelection(se.near(t.doc.resolve(o),n)))}class ye extends oe{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=2,this}ensureMarks(t){return p.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(t,e){super.addStep(t,e),this.updated=-3&this.updated,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let n=this.selection;return e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||p.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,n){let r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();{if(null==n&&(n=e),n=null==n?e:n,!t)return this.deleteRange(e,n);let o=this.storedMarks;if(!o){let t=this.doc.resolve(e);o=n==e?t.marks():t.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(se.near(this.selection.$to)),this}}setMeta(t,e){return this.meta["string"==typeof t?t:t.key]=e,this}getMeta(t){return this.meta["string"==typeof t?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function be(t,e){return e&&t?t.bind(e):t}class xe{constructor(t,e,n){this.name=t,this.init=be(e.init,n),this.apply=be(e.apply,n)}}const we=[new xe("doc",{init:t=>t.doc||t.schema.topNodeType.createAndFill(),apply:t=>t.doc}),new xe("selection",{init:(t,e)=>t.selection||se.atStart(e.doc),apply:t=>t.selection}),new xe("storedMarks",{init:t=>t.storedMarks||null,apply:(t,e,n,r)=>r.selection.$cursor?t.storedMarks:null}),new xe("scrollToSelection",{init:()=>0,apply:(t,e)=>t.scrolledIntoView?e+1:e})];class ke{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=we.slice(),e&&e.forEach(t=>{if(this.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");this.plugins.push(t),this.pluginsByKey[t.key]=t,t.spec.state&&this.fields.push(new xe(t.key,t.spec.state,t))})}}class Ee{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=e){let e=this.config.plugins[n];if(e.spec.filterTransaction&&!e.spec.filterTransaction.call(e,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],n=this.applyInner(t),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let s=this.config.plugins[i];if(s.spec.appendTransaction){let a=r?r[i].n:0,l=r?r[i].state:this,c=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",t),!r){r=[];for(let t=0;t<this.config.plugins.length;t++)r.push(t<i?{state:n,n:e.length}:{state:this,n:0})}e.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new Ee(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}return e}get tr(){return new ye(this)}static create(t){let e=new ke(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new Ee(e);for(let r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n}reconfigure(t){let e=new ke(this.schema,t.plugins),n=e.fields,r=new Ee(e);for(let e=0;e<n.length;e++){let o=n[e].name;r[o]=this.hasOwnProperty(o)?this[o]:n[e].init(t,r)}return r}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(t=>t.toJSON())),t&&"object"==typeof t)for(let n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e}static fromJSON(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let r=new ke(t.schema,t.plugins),o=new Ee(r);return r.fields.forEach(r=>{if("doc"==r.name)o.doc=R.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=se.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let i in n){let s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}}),o}}function Ce(t,e,n){for(let r in t){let o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Ce(o,e,{})),n[r]=o}return n}class Se{constructor(t){this.spec=t,this.props={},t.props&&Ce(t.props,this,this.props),this.key=t.key?t.key.key:Me("plugin")}getState(t){return t[this.key]}}const De=Object.create(null);function Me(t){return t in De?t+"$"+ ++De[t]:(De[t]=0,t+"$")}class Oe{constructor(t="key"){this.key=Me(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const _e=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Ae=function(t){let e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e};let Te=null;const Re=function(t,e,n){let r=Te||(Te=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},Ne=function(t,e,n,r){return n&&(Le(t,e,n,r,-1)||Le(t,e,n,r,1))},Pe=/^(img|br|input|textarea|hr)$/i;function Le(t,e,n,r,o){for(var i;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Ie(t))){let n=t.parentNode;if(!n||1!=n.nodeType||ze(t)||Pe.test(t.nodeName)||"false"==t.contentEditable)return!1;e=_e(t)+(o<0?0:1),t=n}else{if(1!=t.nodeType)return!1;{let n=t.childNodes[e+(o<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(i=n.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;e+=o}else t=n,e=o<0?Ie(t):0}}}}function Ie(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function ze(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Fe=function(t){return t.focusNode&&Ne(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Be(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}const je="undefined"!=typeof navigator?navigator:null,He="undefined"!=typeof document?document:null,$e=je&&je.userAgent||"",qe=/Edge\/(\d+)/.exec($e),Ve=/MSIE \d/.exec($e),We=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec($e),Ge=!!(Ve||We||qe),Ue=Ve?document.documentMode:We?+We[1]:qe?+qe[1]:0,Ye=!Ge&&/gecko\/(\d+)/i.test($e);Ye&&(/Firefox\/(\d+)/.exec($e)||[0,0])[1];const Ke=!Ge&&/Chrome\/(\d+)/.exec($e),Xe=!!Ke,Je=Ke?+Ke[1]:0,Ze=!Ge&&!!je&&/Apple Computer/.test(je.vendor),Qe=Ze&&(/Mobile\/\w+/.test($e)||!!je&&je.maxTouchPoints>2),tn=Qe||!!je&&/Mac/.test(je.platform),en=!!je&&/Win/.test(je.platform),nn=/Android \d/.test($e),rn=!!He&&"webkitFontSmoothing"in He.documentElement.style,on=rn?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function sn(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function an(t,e){return"number"==typeof t?t:t[e]}function ln(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function cn(t,e,n){let r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(1!=s.nodeType){s=Ae(s);continue}let t=s,n=t==i.body,a=n?sn(i):ln(t),l=0,c=0;if(e.top<a.top+an(r,"top")?c=-(a.top-e.top+an(o,"top")):e.bottom>a.bottom-an(r,"bottom")&&(c=e.bottom-e.top>a.bottom-a.top?e.top+an(o,"top")-a.top:e.bottom-a.bottom+an(o,"bottom")),e.left<a.left+an(r,"left")?l=-(a.left-e.left+an(o,"left")):e.right>a.right-an(r,"right")&&(l=e.right-a.right+an(o,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=t.scrollLeft,r=t.scrollTop;c&&(t.scrollTop+=c),l&&(t.scrollLeft+=l);let o=t.scrollLeft-n,i=t.scrollTop-r;e={left:e.left-o,top:e.top-i,right:e.right-o,bottom:e.bottom-i}}let u=n?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(u))break;s="absolute"==u?s.offsetParent:Ae(s)}}function un(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Ae(r));return e}function dn(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:o,left:i}=t[n];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let pn=null;function fn(t,e){let n,r,o,i,s=2e8,a=0,l=e.top,c=e.top;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let t;if(1==u.nodeType)t=u.getClientRects();else{if(3!=u.nodeType)continue;t=Re(u).getClientRects()}for(let p=0;p<t.length;p++){let f=t[p];if(f.top<=l&&f.bottom>=c){l=Math.max(f.bottom,l),c=Math.min(f.top,c);let t=f.left>e.left?f.left-e.left:f.right<e.left?e.left-f.right:0;if(t<s){n=u,s=t,r=t&&3==n.nodeType?{left:f.right<e.left?f.right:f.left,top:e.top}:e,1==u.nodeType&&t&&(a=d+(e.left>=(f.left+f.right)/2?1:0));continue}}else f.top>e.top&&!o&&f.left<=e.left&&f.right>=e.left&&(o=u,i={left:Math.max(f.left,Math.min(f.right,e.left)),top:f.top});!n&&(e.left>=f.right&&e.top>=f.top||e.left>=f.left&&e.top>=f.bottom)&&(a=d+1)}}return!n&&o&&(n=o,r=i,s=0),n&&3==n.nodeType?function(t,e){let n=t.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let n=yn(r,1);if(n.top!=n.bottom&&hn(e,n))return{node:t,offset:o+(e.left>=(n.left+n.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||s&&1==n.nodeType?{node:t,offset:a}:fn(n,r)}function hn(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function mn(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){let n=t.childNodes[i];if(1==n.nodeType){let t=n.getClientRects();for(let r=0;r<t.length;r++){let o=t[r];if(hn(e,o))return mn(n,e,o)}}if((i=(i+1)%r)==o)break}return t}function gn(t,e){let n,r=t.dom.ownerDocument,o=0,i=function(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Ie(r.offsetNode),r.offset)}}catch(t){}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Ie(r.startContainer),r.startOffset)}}}(r,e.left,e.top);i&&({node:n,offset:o}=i);let s,a=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top);if(!a||!t.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=t.dom.getBoundingClientRect();if(!hn(e,n))return null;if(a=mn(t.dom,e,n),!a)return null}if(Ze)for(let t=a;n&&t;t=Ae(t))t.draggable&&(n=void 0);if(a=function(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(a,e),n){if(Ye&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let t,r=n.childNodes[o];"IMG"==r.nodeName&&(t=r.getBoundingClientRect()).right<=e.left&&t.bottom>e.top&&o++}let r;rn&&o&&1==n.nodeType&&1==(r=n.childNodes[o-1]).nodeType&&"false"==r.contentEditable&&r.getBoundingClientRect().top>=e.top&&o--,n==t.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&e.top>n.lastChild.getBoundingClientRect().bottom?s=t.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(s=function(t,e,n,r){let o=-1;for(let n=e,i=!1;n!=t.dom;){let e,s=t.docView.nearestDesc(n,!0);if(!s)return null;if(1==s.dom.nodeType&&(s.node.isBlock&&s.parent||!s.contentDOM)&&((e=s.dom.getBoundingClientRect()).width||e.height)&&(s.node.isBlock&&s.parent&&(!i&&e.left>r.left||e.top>r.top?o=s.posBefore:(!i&&e.right<r.left||e.bottom<r.top)&&(o=s.posAfter),i=!0),!s.contentDOM&&o<0&&!s.node.isText))return(s.node.isBlock?r.top<(e.top+e.bottom)/2:r.left<(e.left+e.right)/2)?s.posBefore:s.posAfter;n=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,-1)}(t,n,o,e))}null==s&&(s=function(t,e,n){let{node:r,offset:o}=fn(e,n),i=-1;if(1==r.nodeType&&!r.firstChild){let t=r.getBoundingClientRect();i=t.left!=t.right&&n.left>(t.left+t.right)/2?1:-1}return t.docView.posFromDOM(r,o,i)}(t,a,e));let l=t.docView.nearestDesc(a,!0);return{pos:s,inside:l?l.posAtStart-l.border:-1}}function vn(t){return t.top<t.bottom||t.left<t.right}function yn(t,e){let n=t.getClientRects();if(n.length){let t=n[e<0?0:n.length-1];if(vn(t))return t}return Array.prototype.find.call(n,vn)||t.getBoundingClientRect()}const bn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function xn(t,e,n){let{node:r,offset:o,atom:i}=t.docView.domFromPos(e,n<0?-1:1),s=rn||Ye;if(3==r.nodeType){if(!s||!bn.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let t=o,e=o,i=n<0?1:-1;return n<0&&!o?(e++,i=-1):n>=0&&o==r.nodeValue.length?(t--,i=1):n<0?t--:e++,wn(yn(Re(r,t,e),i),i<0)}{let t=yn(Re(r,o,o),n);if(Ye&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let e=yn(Re(r,o-1,o-1),-1);if(e.top==t.top){let n=yn(Re(r,o,o+1),-1);if(n.top!=t.top)return wn(n,n.left<e.left)}}return t}}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(null==i&&o&&(n<0||o==Ie(r))){let t=r.childNodes[o-1];if(1==t.nodeType)return kn(t.getBoundingClientRect(),!1)}if(null==i&&o<Ie(r)){let t=r.childNodes[o];if(1==t.nodeType)return kn(t.getBoundingClientRect(),!0)}return kn(r.getBoundingClientRect(),n>=0)}if(null==i&&o&&(n<0||o==Ie(r))){let t=r.childNodes[o-1],e=3==t.nodeType?Re(t,Ie(t)-(s?0:1)):1!=t.nodeType||"BR"==t.nodeName&&t.nextSibling?null:t;if(e)return wn(yn(e,1),!1)}if(null==i&&o<Ie(r)){let t=r.childNodes[o];for(;t.pmViewDesc&&t.pmViewDesc.ignoreForCoords;)t=t.nextSibling;let e=t?3==t.nodeType?Re(t,0,s?0:1):1==t.nodeType?t:null:null;if(e)return wn(yn(e,-1),!0)}return wn(yn(3==r.nodeType?Re(r):r,-n),n>=0)}function wn(t,e){if(0==t.width)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function kn(t,e){if(0==t.height)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function En(t,e,n){let r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}const Cn=/[\u0590-\u08ac]/;let Sn=null,Dn=null,Mn=!1;function On(t,e,n){return Sn==e&&Dn==n?Mn:(Sn=e,Dn=n,Mn="up"==n||"down"==n?function(t,e,n){let r=e.selection,o="up"==n?r.$from:r.$to;return En(t,e,()=>{let{node:e}=t.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let n=t.docView.nearestDesc(e,!0);if(!n)break;if(n.node.isBlock){e=n.contentDOM||n.dom;break}e=n.dom.parentNode}let r=xn(t,o.pos,1);for(let t=e.firstChild;t;t=t.nextSibling){let e;if(1==t.nodeType)e=t.getClientRects();else{if(3!=t.nodeType)continue;e=Re(t,0,t.nodeValue.length).getClientRects()}for(let t=0;t<e.length;t++){let o=e[t];if(o.bottom>o.top+1&&("up"==n?r.top-o.top>2*(o.bottom-r.top):o.bottom-r.bottom>2*(r.bottom-o.top)))return!1}}return!0})}(t,e,n):function(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=t.domSelection();return a?Cn.test(r.parent.textContent)&&a.modify?En(t,e,()=>{let{focusNode:e,focusOffset:o,anchorNode:i,anchorOffset:s}=t.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:u,focusOffset:d}=t.domSelectionRange(),p=u&&!c.contains(1==u.nodeType?u:u.parentNode)||e==u&&o==d;try{a.collapse(i,s),e&&(e!=i||o!=s)&&a.extend&&a.extend(e,o)}catch(t){}return null!=l&&(a.caretBidiLevel=l),p}):"left"==n||"backward"==n?i:s:r.pos==r.start()||r.pos==r.end()}(t,e,n))}class _n{constructor(t,e,n,r){this.parent=t,this.children=e,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,n=this.posAtStart;;e++){let r=this.children[e];if(r==t)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){let n,r;if(t==this.contentDOM)n=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;n=t.previousSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(t==this.contentDOM)n=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;n=t.nextSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}let r;if(t==this.dom&&this.contentDOM)r=e>_e(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let e=t;;e=e.parentNode){if(e==this.dom){r=!1;break}if(e.previousSibling)break}if(null==r&&e==t.childNodes.length)for(let e=t;;e=e.parentNode){if(e==this.dom){r=!0;break}if(e.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let n=!0,r=t;r;r=r.parentNode){let o,i=this.getDesc(r);if(i&&(!e||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==t.nodeType?t:t.parentNode):o==t))return i;n=!1}}}getDesc(t){let e=t.pmViewDesc;for(let t=e;t;t=t.parent)if(t==this)return e}posFromDOM(t,e,n){for(let r=t;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}return-1}descAt(t){for(let e=0,n=0;e<this.children.length;e++){let r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)for(let t=0;t<r.children.length;t++){let e=r.children[t];if(e.size){r=e;break}}return r}if(t<o)return r.descAt(t-n-r.border);n=o}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,r=0;for(let e=0;n<this.children.length;n++){let o=this.children[n],i=e+o.size;if(i>t||o instanceof In){r=t-e;break}e=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,e);for(let t;n&&!(t=this.children[n-1]).size&&t instanceof An&&t.side>=0;n--);if(e<=0){let t,r=!0;for(;t=n?this.children[n-1]:null,t&&t.dom.parentNode!=this.contentDOM;n--,r=!1);return t&&e&&r&&!t.border&&!t.domAtom?t.domFromPos(t.size,e):{node:this.contentDOM,offset:t?_e(t.dom)+1:0}}{let t,r=!0;for(;t=n<this.children.length?this.children[n]:null,t&&t.dom.parentNode!=this.contentDOM;n++,r=!1);return t&&r&&!t.border&&!t.domAtom?t.domFromPos(0,e):{node:this.contentDOM,offset:t?_e(t.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,n=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let i=n,s=0;;s++){let n=this.children[s],a=i+n.size;if(-1==r&&t<=a){let o=i+n.border;if(t>=o&&e<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(t,e,o);t=i;for(let e=s;e>0;e--){let n=this.children[e-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=_e(n.dom)+1;break}t-=n.size}-1==r&&(r=0)}if(r>-1&&(a>e||s==this.children.length-1)){e=a;for(let t=s+1;t<this.children.length;t++){let n=this.children[t];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){o=_e(n.dom);break}e+=n.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=a}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:n}=this.domFromPos(t,0);if(1!=e.nodeType||n==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[n]}setSelection(t,e,n,r=!1){let o=Math.min(t,e),i=Math.max(t,e);for(let s=0,a=0;s<this.children.length;s++){let l=this.children[s],c=a+l.size;if(o>a&&i<c)return l.setSelection(t-a-l.border,e-a-l.border,n,r);a=c}let s=this.domFromPos(t,t?-1:1),a=e==t?s:this.domFromPos(e,e?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((Ye||Ze)&&t==e){let{node:t,offset:e}=s;if(3==t.nodeType){if(u=!(!e||"\n"!=t.nodeValue[e-1]),u&&e==t.nodeValue.length)for(let e,n=t;n;n=n.parentNode){if(e=n.nextSibling){"BR"==e.nodeName&&(s=a={node:e.parentNode,offset:_e(e)+1});break}let t=n.pmViewDesc;if(t&&t.node&&t.node.isBlock)break}}else{let n=t.childNodes[e-1];u=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(Ye&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let t=c.focusNode.childNodes[c.focusOffset];t&&"false"==t.contentEditable&&(r=!0)}if(!(r||u&&Ze)&&Ne(s.node,s.offset,c.anchorNode,c.anchorOffset)&&Ne(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((l.extend||t==e)&&!u){l.collapse(s.node,s.offset);try{t!=e&&l.extend(a.node,a.offset),d=!0}catch(t){}}if(!d){if(t>e){let t=s;s=a,a=t}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){let r=n+o.border,s=i-o.border;if(t>=r&&e<=s)return this.dirty=t==n||e==i?2:1,void(t!=r||e!=s||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-r,e-r):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let n=1==t?2:1;e.dirty<n&&(e.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class An extends _n{constructor(t,e,n,r){let o,i=e.type.toDOM;if("function"==typeof i&&(i=i(n,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:r)),!e.type.spec.raw){if(1!=i.nodeType){let t=document.createElement("span");t.appendChild(i),i=t}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(t,[],i,null),this.widget=e,this.widget=e,o=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Tn extends _n{constructor(t,e,n,r){super(t,[],e,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class Rn extends _n{constructor(t,e,n,r,o){super(t,[],n,r),this.mark=e,this.spec=o}static create(t,e,n,r){let o=r.nodeViews[e.type.name],i=o&&o(e,r,n);return i&&i.dom||(i=ct.renderSpec(document,e.type.spec.toDOM(e,n),null,e.attrs)),new Rn(t,e,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let t=this.parent;for(;!t.node;)t=t.parent;t.dirty<this.dirty&&(t.dirty=this.dirty),this.dirty=0}}slice(t,e,n){let r=Rn.create(this.parent,this.mark,!0,n),o=this.children,i=this.size;e<i&&(o=Kn(o,e,i,n)),t>0&&(o=Kn(o,0,t,n));for(let t=0;t<o.length;t++)o[t].parent=r;return r.children=o,r}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Nn extends _n{constructor(t,e,n,r,o,i,s,a,l){super(t,[],o,i),this.node=e,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=s}static create(t,e,n,r,o,i){let s,a=o.nodeViews[e.type.name],l=a&&a(e,o,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:i,n,r),c=l&&l.dom,u=l&&l.contentDOM;if(e.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(e.text);else if(!c){let t=ct.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs);({dom:c,contentDOM:u}=t)}u||e.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),e.type.spec.draggable&&(c.draggable=!0));let d=c;return c=Vn(c,n,e),l?s=new zn(t,e,n,r,c,u||null,d,l,o,i+1):e.isText?new Ln(t,e,n,r,c,d,o):new Nn(t,e,n,r,c,u||null,d,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let n=this.children[e];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>l.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,n){return 0==this.dirty&&t.eq(this.node)&&Wn(e,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let n=this.node.inlineContent,r=e,o=t.composing?this.localCompositionInfo(t,e):null,i=o&&o.pos>-1?o:null,s=o&&o.pos<0,a=new Un(this,i&&i.node,t);!function(t,e,n,r){let o=e.locals(t),i=0;if(0==o.length){for(let n=0;n<t.childCount;n++){let s=t.child(n);r(s,o,e.forChild(i,s),n),i+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d,p,f;for(;s<o.length&&o[s].to==i;){let t=o[s++];t.widget&&(u?(d||(d=[u])).push(t):u=t)}if(u)if(d){d.sort(Yn);for(let t=0;t<d.length;t++)n(d[t],c,!!l)}else n(u,c,!!l);if(l)f=-1,p=l,l=null;else{if(!(c<t.childCount))break;f=c,p=t.child(c++)}for(let t=0;t<a.length;t++)a[t].to<=i&&a.splice(t--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);let h=i+p.nodeSize;if(p.isText){let t=h;s<o.length&&o[s].from<t&&(t=o[s].from);for(let e=0;e<a.length;e++)a[e].to<t&&(t=a[e].to);t<h&&(l=p.cut(t-i),p=p.cut(0,t-i),h=t,f=-1)}else for(;s<o.length&&o[s].to<h;)s++;r(p,p.isInline&&!p.isLeaf?a.filter(t=>!t.inline):a.slice(),e.forChild(i,p),f),i=h}}(this.node,this.innerDeco,(e,o,i)=>{e.spec.marks?a.syncToMarks(e.spec.marks,n,t):e.type.side>=0&&!i&&a.syncToMarks(o==this.node.childCount?p.none:this.node.child(o).marks,n,t),a.placeWidget(e,t,r)},(e,i,l,c)=>{let u;a.syncToMarks(e.marks,n,t),a.findNodeMatch(e,i,l,c)||s&&t.state.selection.from>r&&t.state.selection.to<r+e.nodeSize&&(u=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(e,i,l,u,t)||a.updateNextNode(e,i,l,t,c,r)||a.addNode(e,i,l,t,r),r+=e.nodeSize}),a.syncToMarks([],n,t),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(t,i),Fn(this.contentDOM,this.children,t),Qe&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom))}localCompositionInfo(t,e){let{from:n,to:r}=t.state.selection;if(!(t.state.selection instanceof ue)||n<e||r>e+this.node.content.size)return null;let o=t.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let t=o.nodeValue,i=function(t,e,n,r){for(let o=0,i=0;o<t.childCount&&i<=r;){let s=t.child(o++),a=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;o<t.childCount;){let e=t.child(o++);if(i+=e.nodeSize,!e.isText)break;l+=e.text}if(i>=n){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let t=a<r?l.lastIndexOf(e,r-a-1):-1;if(t>=0&&t+e.length+a>=n)return a+t;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}(this.node.content,t,n-e,r-e);return i<0?null:{node:o,pos:i,text:t}}return{node:o,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:n,text:r}){if(this.getDesc(e))return;let o=e;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let i=new Tn(this,o,e,r);t.input.compositionNodes.push(i),this.children=Kn(this.children,n,n+r.length,t,i)}update(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)}updateInner(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(Wn(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=$n(this.dom,this.nodeDOM,Hn(this.outerDeco,this.node,e),Hn(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Pn(t,e,n,r,o){Vn(r,e,t);let i=new Nn(void 0,t,e,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class Ln extends Nn{constructor(t,e,n,r,o,i,s){super(t,e,n,r,o,null,i,s,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=0,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,n){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,n)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,n){let r=this.node.cut(t,e),o=document.createTextNode(r.text);return new Ln(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(t,e){super.markDirty(t,e),this.dom==this.nodeDOM||0!=t&&e!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(t){return this.node.text==t}}class In extends _n{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class zn extends Nn{constructor(t,e,n,r,o,i,s,a,l,c){super(t,e,n,r,o,i,s,l,c),this.spec=a}update(t,e,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let o=this.spec.update(t,e,n);return o&&this.updateInner(t,e,n,r),o}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,n,r){this.spec.setSelection?this.spec.setSelection(t,e,n.root):super.setSelection(t,e,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Fn(t,e,n){let r=t.firstChild,o=!1;for(let i=0;i<e.length;i++){let s=e[i],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=Gn(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(a,r);if(s instanceof Rn){let e=r?r.previousSibling:t.lastChild;Fn(s.contentDOM,s.children,n),r=e?e.nextSibling:t.firstChild}}for(;r;)r=Gn(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}const Bn=function(t){t&&(this.nodeName=t)};Bn.prototype=Object.create(null);const jn=[new Bn];function Hn(t,e,n){if(0==t.length)return jn;let r=n?jn[0]:new Bn,o=[r];for(let i=0;i<t.length;i++){let s=t[i].type.attrs;if(s){s.nodeName&&o.push(r=new Bn(s.nodeName));for(let t in s){let i=s[t];null!=i&&(n&&1==o.length&&o.push(r=new Bn(e.isInline?"span":"div")),"class"==t?r.class=(r.class?r.class+" ":"")+i:"style"==t?r.style=(r.style?r.style+";":"")+i:"nodeName"!=t&&(r[t]=i))}}}return o}function $n(t,e,n,r){if(n==jn&&r==jn)return e;let o=e;for(let e=0;e<r.length;e++){let i=r[e],s=n[e];if(e){let e;s&&s.nodeName==i.nodeName&&o!=t&&(e=o.parentNode)&&e.nodeName.toLowerCase()==i.nodeName||(e=document.createElement(i.nodeName),e.pmIsDeco=!0,e.appendChild(o),s=jn[0]),o=e}qn(o,s||jn[0],i)}return o}function qn(t,e,n){for(let r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let e=0;e<r.length;e++)-1==o.indexOf(r[e])&&t.classList.remove(r[e]);for(let e=0;e<o.length;e++)-1==r.indexOf(o[e])&&t.classList.add(o[e]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let n,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=r.exec(e.style);)t.style.removeProperty(n[1])}n.style&&(t.style.cssText+=n.style)}}function Vn(t,e,n){return $n(t,t,jn,Hn(e,n,1!=t.nodeType))}function Wn(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Gn(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Un{constructor(t,e,n){this.lock=e,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(t,e){let n=e,r=n.children.length,o=t.childCount,i=new Map,s=[];t:for(;o>0;){let a;for(;;)if(r){let t=n.children[r-1];if(!(t instanceof Rn)){a=t,r--;break}n=t,r=t.children.length}else{if(n==e)break t;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,n){let r=0,o=this.stack.length>>1,i=Math.min(o,t.length);for(;r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let e=this.index;e<Math.min(this.index+3,this.top.children.length);e++){let n=this.top.children[e];if(n.matchesMark(t[o])&&!this.isLocked(n.dom)){r=e;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=Rn.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,o++}}findNodeMatch(t,e,n,r){let o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,n))i=this.top.children.indexOf(o,this.index);else for(let r=this.index,o=Math.min(this.top.children.length,r+5);r<o;r++){let o=this.top.children[r];if(o.matchesNode(t,e,n)&&!this.preMatch.matched.has(o)){i=r;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(t,e,n,r,o){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(t,e,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let e=t.pmViewDesc;if(e)for(let t=this.index;t<this.top.children.length;t++)if(this.top.children[t]==e)return t;return-1}t=e}}updateNextNode(t,e,n,r,o,i){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof Nn){let l=this.preMatch.matched.get(a);if(null!=l&&l!=o)return!1;let c,u=a.dom,d=this.isLocked(u)&&!(t.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==t.text&&3!=a.dirty&&Wn(e,a.outerDeco));if(!d&&a.update(t,e,n,r))return this.destroyBetween(this.index,s),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(c=this.recreateWrapper(a,t,e,n,r,i)))return this.destroyBetween(this.index,s),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(r,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,n,r,o,i){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!Wn(n,t.outerDeco)||!r.eq(t.innerDeco))return null;let s=Nn.create(this.top,e,n,r,o,i);if(s.contentDOM){s.children=t.children,t.children=[];for(let t of s.children)t.parent=s}return t.destroy(),s}addNode(t,e,n,r,o){let i=Nn.create(this.top,t,e,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(t,e,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode){let r=new An(this.top,t,e,n);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof Rn;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof Ln)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Ze||Xe)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);"IMG"==t&&(n.className="ProseMirror-separator",n.alt=""),"BR"==t&&(n.className="ProseMirror-trailingBreak");let r=new In(this.top,[],n,null);e!=this.top?e.children.push(r):e.children.splice(this.index++,0,r),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||1==t.nodeType&&t.contains(this.lock.parentNode))}}function Yn(t,e){return t.type.side-e.type.side}function Kn(t,e,n,r,o){let i=[];for(let s=0,a=0;s<t.length;s++){let l=t[s],c=a,u=a+=l.size;c>=n||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),o&&(i.push(o),o=void 0),u>n&&i.push(l.slice(n-c,l.size,r)))}return i}function Xn(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let o=t.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a,l,c=r.resolve(s);if(Fe(n)){for(a=s;o&&!o.node;)o=o.parent;let t=o.node;if(o&&t.isAtom&&pe.isSelectable(t)&&o.parent&&(!t.isInline||!function(t,e,n){for(let r=0==e,o=e==Ie(t);r||o;){if(t==n)return!0;let e=_e(t);if(!(t=t.parentNode))return!1;r=r&&0==e,o=o&&e==Ie(t)}}(n.focusNode,n.focusOffset,o.dom))){let t=o.posBefore;l=new pe(s==t?c:r.resolve(t))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let e=s,o=s;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);e=Math.min(e,t.docView.posFromDOM(i.startContainer,i.startOffset,1)),o=Math.max(o,t.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(e<0)return null;[a,s]=o==t.state.selection.anchor?[o,e]:[e,o],c=r.resolve(s)}else a=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let u=r.resolve(a);if(!l){l=ir(t,u,c,"pointer"==e||t.state.selection.head<c.pos&&!i?1:-1)}return l}function Jn(t){return t.editable?t.hasFocus():ar(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Zn(t,e=!1){let n=t.state.selection;if(rr(t,n),Jn(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Xe){let e=t.domSelectionRange(),n=t.domObserver.currentSelection;if(e.anchorNode&&n.anchorNode&&Ne(e.anchorNode,e.anchorOffset,n.anchorNode,n.anchorOffset))return t.input.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setStart(r.parentNode,_e(r)+1):n.setStart(r,0);n.collapse(!0),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&Ge&&Ue<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{let r,o,{anchor:i,head:s}=n;!Qn||n instanceof ue||(n.$from.parent.inlineContent||(r=tr(t,n.from)),n.empty||n.$from.parent.inlineContent||(o=tr(t,n.to))),t.docView.setSelection(i,s,t,e),Qn&&(r&&nr(r),o&&nr(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{Jn(t)&&!t.state.selection.visible||t.dom.classList.remove("ProseMirror-hideselection")},20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Qn=Ze||Xe&&Je<63;function tr(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),o=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(Ze&&o&&"false"==o.contentEditable)return er(o);if(!(o&&"false"!=o.contentEditable||i&&"false"!=i.contentEditable)){if(o)return er(o);if(i)return er(i)}}function er(t){return t.contentEditable="true",Ze&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function nr(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function rr(t,e){if(e instanceof pe){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(or(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else or(t)}function or(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function ir(t,e,n,r){return t.someProp("createSelectionBetween",r=>r(t,e,n))||ue.between(e,n,r)}function sr(t){return!(t.editable&&!t.hasFocus())&&ar(t)}function ar(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function lr(t,e){let{$anchor:n,$head:r}=t.selection,o=e>0?n.max(r):n.min(r),i=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return i&&se.findFrom(i,e)}function cr(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function ur(t,e,n){let r=t.state.selection;if(!(r instanceof ue)){if(r instanceof pe&&r.node.isInline)return cr(t,new ue(e>0?r.$to:r.$from));{let n=lr(t.state,e);return!!n&&cr(t,n)}}if(n.indexOf("s")>-1){let{$head:n}=r,o=n.textOffset?null:e<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=t.state.doc.resolve(n.pos+o.nodeSize*(e<0?-1:1));return cr(t,new ue(r.$anchor,i))}if(!r.empty)return!1;if(t.endOfTextblock(e>0?"forward":"backward")){let n=lr(t.state,e);return!!(n&&n instanceof pe)&&cr(t,n)}if(!(tn&&n.indexOf("m")>-1)){let n,o=r.$head,i=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText)return!1;let s=e<0?o.pos-i.nodeSize:o.pos;return!!(i.isAtom||(n=t.docView.descAt(s))&&!n.contentDOM)&&(pe.isSelectable(i)?cr(t,new pe(e<0?t.state.doc.resolve(o.pos-i.nodeSize):o)):!!rn&&cr(t,new ue(t.state.doc.resolve(e<0?s:s+i.nodeSize))))}}function dr(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function pr(t,e){let n=t.pmViewDesc;return n&&0==n.size&&(e<0||t.nextSibling||"BR"!=t.nodeName)}function fr(t,e){return e<0?function(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,i,s=!1;Ye&&1==n.nodeType&&r<dr(n)&&pr(n.childNodes[r],-1)&&(s=!0);for(;;)if(r>0){if(1!=n.nodeType)break;{let t=n.childNodes[r-1];if(pr(t,-1))o=n,i=--r;else{if(3!=t.nodeType)break;n=t,r=n.nodeValue.length}}}else{if(hr(n))break;{let e=n.previousSibling;for(;e&&pr(e,-1);)o=n.parentNode,i=_e(e),e=e.previousSibling;if(e)n=e,r=dr(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?mr(t,n,r):o&&mr(t,o,i)}(t):function(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,i,s=dr(n);for(;;)if(r<s){if(1!=n.nodeType)break;if(!pr(n.childNodes[r],1))break;o=n,i=++r}else{if(hr(n))break;{let e=n.nextSibling;for(;e&&pr(e,1);)o=e.parentNode,i=_e(e)+1,e=e.nextSibling;if(e)n=e,r=0,s=dr(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}o&&mr(t,o,i)}(t)}function hr(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function mr(t,e,n){if(3!=e.nodeType){let t,r;(r=function(t,e){for(;t&&e==t.childNodes.length&&!ze(t);)e=_e(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=n,e=0}}(e,n))?(e=r,n=0):(t=function(t,e){for(;t&&!e&&!ze(t);)e=_e(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=(t=n).childNodes.length}}(e,n))&&(e=t,n=t.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Fe(r)){let t=document.createRange();t.setEnd(e,n),t.setStart(e,n),r.removeAllRanges(),r.addRange(t)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:o}=t;setTimeout(()=>{t.state==o&&Zn(t)},50)}function gr(t,e){let n=t.state.doc.resolve(e);if(!Xe&&!en&&n.parent.inlineContent){let r=t.coordsAtPos(e);if(e>n.start()){let n=t.coordsAtPos(e-1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(e<n.end()){let n=t.coordsAtPos(e+1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(t.dom).direction?"rtl":"ltr"}function vr(t,e,n){let r=t.state.selection;if(r instanceof ue&&!r.empty||n.indexOf("s")>-1)return!1;if(tn&&n.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let n=lr(t.state,e);if(n&&n instanceof pe)return cr(t,n)}if(!o.parent.inlineContent){let n=e<0?o:i,s=r instanceof he?se.near(n,e):se.findFrom(n,e);return!!s&&cr(t,s)}return!1}function yr(t,e){if(!(t.state.selection instanceof ue))return!0;let{$head:n,$anchor:r,empty:o}=t.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=t.state.tr;return e<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),t.dispatch(r),!0}return!1}function br(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function xr(t,e){let n=e.keyCode,r=function(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);if(8==n||tn&&72==n&&"c"==r)return yr(t,-1)||fr(t,-1);if(46==n&&!e.shiftKey||tn&&68==n&&"c"==r)return yr(t,1)||fr(t,1);if(13==n||27==n)return!0;if(37==n||tn&&66==n&&"c"==r){let e=37==n?"ltr"==gr(t,t.state.selection.from)?-1:1:-1;return ur(t,e,r)||fr(t,e)}if(39==n||tn&&70==n&&"c"==r){let e=39==n?"ltr"==gr(t,t.state.selection.from)?1:-1:1;return ur(t,e,r)||fr(t,e)}return 38==n||tn&&80==n&&"c"==r?vr(t,-1,r)||fr(t,-1):40==n||tn&&78==n&&"c"==r?function(t){if(!Ze||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){let n=e.firstChild;br(t,n,"true"),setTimeout(()=>br(t,n,"false"),20)}return!1}(t)||vr(t,1,r)||fr(t,1):r==(tn?"m":"c")&&(66==n||73==n||89==n||90==n)}function wr(t,e){t.someProp("transformCopied",n=>{e=n(e,t)});let n=[],{content:r,openStart:o,openEnd:i}=e;for(;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;let t=r.firstChild;n.push(t.type.name,t.attrs!=t.type.defaultAttrs?t.attrs:null),r=t.content}let s=t.someProp("clipboardSerializer")||ct.fromSchema(t.state.schema),a=Tr(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c,u=l.firstChild,d=0;for(;u&&1==u.nodeType&&(c=_r[u.nodeName.toLowerCase()]);){for(let t=c.length-1;t>=0;t--){let e=a.createElement(c[t]);for(;l.firstChild;)e.appendChild(l.firstChild);l.appendChild(e),d++}u=l.firstChild}return u&&1==u.nodeType&&u.setAttribute("data-pm-slice",`${o} ${i}${d?` -${d}`:""} ${JSON.stringify(n)}`),{dom:l,text:t.someProp("clipboardTextSerializer",n=>n(e,t))||e.content.textBetween(0,e.content.size,"\n\n"),slice:e}}function kr(t,e,n,r,o){let i,s,a=o.parent.type.spec.code;if(!n&&!e)return null;let c=e&&(r||a||!n);if(c){if(t.someProp("transformPastedText",n=>{e=n(e,a||r,t)}),a)return e?new h(l.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):h.empty;let n=t.someProp("clipboardTextParser",n=>n(e,o,r,t));if(n)s=n;else{let n=o.marks(),{schema:r}=t.state,s=ct.fromSchema(r);i=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(t=>{let e=i.appendChild(document.createElement("p"));t&&e.appendChild(s.serializeNode(r.text(t,n)))})}}else t.someProp("transformPastedHTML",e=>{n=e(n,t)}),i=function(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n,r=Tr().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(t);(n=o&&_r[o[1].toLowerCase()])&&(t=n.map(t=>"<"+t+">").join("")+t+n.map(t=>"</"+t+">").reverse().join(""));if(r.innerHTML=function(t){let e=window.trustedTypes;if(!e)return t;Rr||(Rr=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t}));return Rr.createHTML(t)}(t),n)for(let t=0;t<n.length;t++)r=r.querySelector(n[t])||r;return r}(n),rn&&function(t){let e=t.querySelectorAll(Xe?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];1==r.childNodes.length&&""==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}(i);let u=i&&i.querySelector("[data-pm-slice]"),d=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let t=+d[3];t>0;t--){let t=i.firstChild;for(;t&&1!=t.nodeType;)t=t.nextSibling;if(!t)break;i=t}if(!s){let e=t.someProp("clipboardParser")||t.someProp("domParser")||Q.fromSchema(t.state.schema);s=e.parseSlice(i,{preserveWhitespace:!(!c&&!d),context:o,ruleFromNode:t=>"BR"!=t.nodeName||t.nextSibling||!t.parentNode||Er.test(t.parentNode.nodeName)?null:{ignore:!0}})}if(d)s=function(t,e){if(!t.size)return t;let n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}let{content:o,openStart:i,openEnd:s}=t;for(let t=n.length-2;t>=0;t-=2){let e=r.nodes[n[t]];if(!e||e.hasRequiredAttrs())break;o=l.from(e.create(n[t+1],o)),i++,s++}return new h(o,i,s)}(Or(s,+d[1],+d[2]),d[4]);else if(s=h.maxOpen(function(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let r,o=e.node(n).contentMatchAt(e.index(n)),i=[];if(t.forEach(t=>{if(!i)return;let e,n=o.findWrapping(t.type);if(!n)return i=null;if(e=i.length&&r.length&&Sr(n,r,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=Dr(i[i.length-1],r.length));let e=Cr(t,n);i.push(e),o=o.matchType(e.type),r=n}}),i)return l.from(i)}return t}(s.content,o),!0),s.openStart||s.openEnd){let t=0,e=0;for(let e=s.content.firstChild;t<s.openStart&&!e.type.spec.isolating;t++,e=e.firstChild);for(let t=s.content.lastChild;e<s.openEnd&&!t.type.spec.isolating;e++,t=t.lastChild);s=Or(s,t,e)}return t.someProp("transformPasted",e=>{s=e(s,t)}),s}const Er=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Cr(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,l.from(t));return t}function Sr(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){let i=Sr(t,e,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(l.from(Cr(n,t,o+1))))}}function Dr(t,e){if(0==e)return t;let n=t.content.replaceChild(t.childCount-1,Dr(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(l.empty,!0);return t.copy(n.append(r))}function Mr(t,e,n,r,o,i){let s=e<0?t.firstChild:t.lastChild,a=s.content;return t.childCount>1&&(i=0),o<r-1&&(a=Mr(a,e,n,r,o+1,i)),o>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(l.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function Or(t,e,n){return e<t.openStart&&(t=new h(Mr(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new h(Mr(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const _r={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ar=null;function Tr(){return Ar||(Ar=document.implementation.createHTMLDocument("title"))}let Rr=null;const Nr={},Pr={},Lr={touchstart:!0,touchmove:!0};class Ir{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function zr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Fr(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=e=>Br(t,e))})}function Br(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)})}function jr(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Hr(t){return{left:t.clientX,top:t.clientY}}function $r(t,e,n,r,o){if(-1==r)return!1;let i=t.state.doc.resolve(r);for(let r=i.depth+1;r>0;r--)if(t.someProp(e,e=>r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)))return!0;return!1}function qr(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function Vr(t,e,n,r,o){return $r(t,"handleClickOn",e,n,r)||t.someProp("handleClick",n=>n(t,e,r))||(o?function(t,e){if(-1==e)return!1;let n,r,o=t.state.selection;o instanceof pe&&(n=o.node);let i=t.state.doc.resolve(e);for(let t=i.depth+1;t>0;t--){let e=t>i.depth?i.nodeAfter:i.node(t);if(pe.isSelectable(e)){r=n&&o.$from.depth>0&&t>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(t);break}}return null!=r&&(qr(t,pe.create(t.state.doc,r)),!0)}(t,n):function(t,e){if(-1==e)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&pe.isSelectable(r))&&(qr(t,new pe(n)),!0)}(t,n))}function Wr(t,e,n,r){return $r(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",n=>n(t,e,r))}function Gr(t,e,n,r){return $r(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",n=>n(t,e,r))||function(t,e,n){if(0!=n.button)return!1;let r=t.state.doc;if(-1==e)return!!r.inlineContent&&(qr(t,ue.create(r,0,r.content.size)),!0);let o=r.resolve(e);for(let e=o.depth+1;e>0;e--){let n=e>o.depth?o.nodeAfter:o.node(e),i=o.before(e);if(n.inlineContent)qr(t,ue.create(r,i+1,i+1+n.content.size));else{if(!pe.isSelectable(n))continue;qr(t,pe.create(r,i))}return!0}}(t,n,r)}function Ur(t){return eo(t)}Pr.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=16==n.keyCode||n.shiftKey,!Xr(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!nn||!Xe||13!=n.keyCode))if(229!=n.keyCode&&t.domObserver.forceFlush(),!Qe||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)t.someProp("handleKeyDown",e=>e(t,n))||xr(t,n)?n.preventDefault():zr(t,"key");else{let e=Date.now();t.input.lastIOSEnter=e,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==e&&(t.someProp("handleKeyDown",e=>e(t,Be(13,"Enter"))),t.input.lastIOSEnter=0)},200)}},Pr.keyup=(t,e)=>{16==e.keyCode&&(t.input.shiftKey=!1)},Pr.keypress=(t,e)=>{let n=e;if(Xr(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||tn&&n.metaKey)return;if(t.someProp("handleKeyPress",e=>e(t,n)))return void n.preventDefault();let r=t.state.selection;if(!(r instanceof ue&&r.$from.sameParent(r.$to))){let e=String.fromCharCode(n.charCode),o=()=>t.state.tr.insertText(e).scrollIntoView();/[\r\n]/.test(e)||t.someProp("handleTextInput",n=>n(t,r.$from.pos,r.$to.pos,e,o))||t.dispatch(o()),n.preventDefault()}};const Yr=tn?"metaKey":"ctrlKey";Nr.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Ur(t),o=Date.now(),i="singleClick";o-t.input.lastClick.time<500&&function(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(n,t.input.lastClick)&&!n[Yr]&&t.input.lastClick.button==n.button&&("singleClick"==t.input.lastClick.type?i="doubleClick":"doubleClick"==t.input.lastClick.type&&(i="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i,button:n.button};let s=t.posAtCoords(Hr(n));s&&("singleClick"==i?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new Kr(t,s,n,!!r)):("doubleClick"==i?Wr:Gr)(t,s.pos,s.inside,n)?n.preventDefault():zr(t,"pointer"))};class Kr{constructor(t,e,n,r){let o,i;if(this.view=t,this.pos=e,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Yr],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),i=e.inside;else{let n=t.state.doc.resolve(e.pos);o=n.parent,i=n.depth?n.before():0}const s=r?null:n.target,a=s?t.docView.nearestDesc(s,!0):null;this.target=a&&1==a.dom.nodeType?a.dom:null;let{selection:l}=t.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof pe&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Ye||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),zr(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Zn(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Hr(t))),this.updateAllowDefault(t),this.allowDefault||!e?zr(this.view,"pointer"):Vr(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||Ze&&this.mightDrag&&!this.mightDrag.node.isAtom||Xe&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(qr(this.view,se.near(this.view.state.doc.resolve(e.pos))),t.preventDefault()):zr(this.view,"pointer")}move(t){this.updateAllowDefault(t),zr(this.view,"pointer"),0==t.buttons&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}function Xr(t,e){return!!t.composing||!!(Ze&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500)&&(t.input.compositionEndedAt=-2e8,!0)}Nr.touchstart=t=>{t.input.lastTouch=Date.now(),Ur(t),zr(t,"pointer")},Nr.touchmove=t=>{t.input.lastTouch=Date.now(),zr(t,"pointer")},Nr.contextmenu=t=>Ur(t);const Jr=nn?5e3:-1;function Zr(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>eo(t),e))}function Qr(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=function(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function to(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=function(t,e){for(;;){if(3==t.nodeType&&e)return t;if(1==t.nodeType&&e>0){if("false"==t.contentEditable)return null;e=Ie(t=t.childNodes[e-1])}else{if(!t.parentNode||ze(t))return null;e=_e(t),t=t.parentNode}}}(e.focusNode,e.focusOffset),r=function(t,e){for(;;){if(3==t.nodeType&&e<t.nodeValue.length)return t;if(1==t.nodeType&&e<t.childNodes.length){if("false"==t.contentEditable)return null;t=t.childNodes[e],e=0}else{if(!t.parentNode||ze(t))return null;e=_e(t)+1,t=t.parentNode}}}(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let e=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!e||!e.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let t=n.pmViewDesc;if(t&&t.isText(n.nodeValue))return r}}return n||r}function eo(t,e=!1){if(!(nn&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Qr(t),e||t.docView&&t.docView.dirty){let n=Xn(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):!t.markCursor&&!e||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.updateState(t.state):t.dispatch(t.state.tr.deleteSelection()),!0}return!1}}Pr.compositionstart=Pr.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof ue&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(t=>!1===t.type.spec.inclusive)))t.markCursor=t.state.storedMarks||n.marks(),eo(t,!0),t.markCursor=null;else if(eo(t,!e.selection.empty),Ye&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let e=t.domSelectionRange();for(let n=e.focusNode,r=e.focusOffset;n&&1==n.nodeType&&0!=r;){let e=r<0?n.lastChild:n.childNodes[r-1];if(!e)break;if(3==e.nodeType){let n=t.domSelection();n&&n.collapse(e,e.nodeValue.length);break}n=e,r=-1}}t.input.composing=!0}Zr(t,Jr)},Pr.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Zr(t,20))};const no=Ge&&Ue<15||Qe&&on<604;function ro(t,e,n,r,o){let i=kr(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",e=>e(t,o,i||h.empty)))return!0;if(!i)return!1;let s=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(i),a=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(i);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function oo(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Nr.copy=Pr.cut=(t,e)=>{let n=e,r=t.state.selection,o="cut"==n.type;if(r.empty)return;let i=no?null:n.clipboardData,s=r.content(),{dom:a,text:l}=wr(t,s);i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):function(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}(t,a),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Pr.paste=(t,e)=>{let n=e;if(t.composing&&!nn)return;let r=no?null:n.clipboardData,o=t.input.shiftKey&&45!=t.input.lastKeyCode;r&&ro(t,oo(r),r.getData("text/html"),o,n)?n.preventDefault():function(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=t.input.shiftKey&&45!=t.input.lastKeyCode;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ro(t,r.value,null,o,e):ro(t,r.textContent,r.innerHTML,o,e)},50)}(t,n)};class io{constructor(t,e,n){this.slice=t,this.move=e,this.node=n}}const so=tn?"altKey":"ctrlKey";function ao(t,e){let n=t.someProp("dragCopies",t=>!t(e));return null!=n?n:!e[so]}Nr.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o,i=t.state.selection,s=i.empty?null:t.posAtCoords(Hr(n));if(s&&s.pos>=i.from&&s.pos<=(i instanceof pe?i.to-1:i.to));else if(r&&r.mightDrag)o=pe.create(t.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let e=t.docView.nearestDesc(n.target,!0);e&&e.node.type.spec.draggable&&e!=t.docView&&(o=pe.create(t.state.doc,e.posBefore))}let a=(o||t.state.selection).content(),{dom:l,text:c,slice:u}=wr(t,a);(!n.dataTransfer.files.length||!Xe||Je>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(no?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",no||n.dataTransfer.setData("text/plain",c),t.dragging=new io(u,ao(t,n),o)},Nr.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)},Pr.dragover=Pr.dragenter=(t,e)=>e.preventDefault(),Pr.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let o=t.posAtCoords(Hr(n));if(!o)return;let i=t.state.doc.resolve(o.pos),s=r&&r.slice;s?t.someProp("transformPasted",e=>{s=e(s,t)}):s=kr(t,oo(n.dataTransfer),no?null:n.dataTransfer.getData("text/html"),!1,i);let a=!(!r||!ao(t,n));if(t.someProp("handleDrop",e=>e(t,n,s||h.empty,a)))return void n.preventDefault();if(!s)return;n.preventDefault();let l=s?qt(t.state.doc,i.pos,s):i.pos;null==l&&(l=i.pos);let c=t.state.tr;if(a){let{node:t}=r;t?t.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,p=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(p))return;let f=c.doc.resolve(u);if(d&&pe.isSelectable(s.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new pe(f));else{let e=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((t,n,r,o)=>e=o),c.setSelection(ir(t,f,c.doc.resolve(e)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))},Nr.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Zn(t)},20))},Nr.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},Nr.beforeinput=(t,e)=>{if(Xe&&nn&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();let{domChangeCount:e}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=e)return;if(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",e=>e(t,Be(8,"Backspace"))))return;let{$cursor:n}=t.state.selection;n&&n.pos>0&&t.dispatch(t.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let t in Pr)Nr[t]=Pr[t];function lo(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class co{constructor(t,e){this.toDOM=t,this.spec=e||mo,this.side=this.spec.side||0}map(t,e,n,r){let{pos:o,deleted:i}=t.mapResult(e.from+r,this.side<0?-1:1);return i?null:new fo(o-n,o-n,this)}valid(){return!0}eq(t){return this==t||t instanceof co&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&lo(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class uo{constructor(t,e){this.attrs=t,this.spec=e||mo}map(t,e,n,r){let o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new fo(o,i,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof uo&&lo(this.attrs,t.attrs)&&lo(this.spec,t.spec)}static is(t){return t.type instanceof uo}destroy(){}}class po{constructor(t,e){this.attrs=t,this.spec=e||mo}map(t,e,n,r){let o=t.mapResult(e.from+r,1);if(o.deleted)return null;let i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new fo(o.pos-n,i.pos-n,this)}valid(t,e){let n,{index:r,offset:o}=t.content.findIndex(e.from);return o==e.from&&!(n=t.child(r)).isText&&o+n.nodeSize==e.to}eq(t){return this==t||t instanceof po&&lo(this.attrs,t.attrs)&&lo(this.spec,t.spec)}destroy(){}}class fo{constructor(t,e,n){this.from=t,this.to=e,this.type=n}copy(t,e){return new fo(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,n){return this.type.map(t,this,e,n)}static widget(t,e,n){return new fo(t,t,new co(e,n))}static inline(t,e,n,r){return new fo(t,e,new uo(n,r))}static node(t,e,n,r){return new fo(t,e,new po(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof uo}get widget(){return this.type instanceof co}}const ho=[],mo={};class go{constructor(t,e){this.local=t.length?t:ho,this.children=e.length?e:ho}static create(t,e){return e.length?ko(e,t,0,mo):vo}find(t,e,n){let r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r}findInner(t,e,n,r,o){for(let i=0;i<this.local.length;i++){let s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<e&&this.children[i+1]>t){let s=this.children[i]+1;this.children[i+2].findInner(t-s,e-s,n,r+s,o)}}map(t,e,n){return this==vo||0==t.maps.length?this:this.mapInner(t,e,0,0,n||mo)}mapInner(t,e,n,r,o){let i;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){let a=t.slice();for(let t=0,e=i;t<n.maps.length;t++){let r=0;n.maps[t].forEach((t,n,o,i)=>{let s=i-o-(n-t);for(let o=0;o<a.length;o+=3){let i=a[o+1];if(i<0||t>i+e-r)continue;let l=a[o]+e-r;n>=l?a[o+1]=t<=l?-2:-1:t>=e&&s&&(a[o]+=s,a[o+1]+=s)}r+=s}),e=n.maps[t].map(e,-1)}let l=!1;for(let e=0;e<a.length;e+=3)if(a[e+1]<0){if(-2==a[e+1]){l=!0,a[e+1]=-1;continue}let c=n.map(t[e]+i),u=c-o;if(u<0||u>=r.content.size){l=!0;continue}let d=n.map(t[e+1]+i,-1)-o,{index:p,offset:f}=r.content.findIndex(u),h=r.maybeChild(p);if(h&&f==u&&f+h.nodeSize==d){let r=a[e+2].mapInner(n,h,c+1,t[e]+i+1,s);r!=vo?(a[e]=u,a[e+1]=d,a[e+2]=r):(a[e+1]=-2,l=!0)}else l=!0}if(l){let l=function(t,e,n,r,o,i,s){function a(t,e){for(let i=0;i<t.local.length;i++){let a=t.local[i].map(r,o,e);a?n.push(a):s.onRemove&&s.onRemove(t.local[i].spec)}for(let n=0;n<t.children.length;n+=3)a(t.children[n+2],t.children[n]+e+1)}for(let n=0;n<t.length;n+=3)-1==t[n+1]&&a(t[n+2],e[n]+i+1);return n}(a,t,e,n,o,i,s),c=ko(l,r,0,s);e=c.local;for(let t=0;t<a.length;t+=3)a[t+1]<0&&(a.splice(t,3),t-=3);for(let t=0,e=0;t<c.children.length;t+=3){let n=c.children[t];for(;e<a.length&&a[e]<n;)e+=3;a.splice(e,0,c.children[t],c.children[t+1],c.children[t+2])}}return new go(e.sort(Eo),a)}(this.children,i||[],t,e,n,r,o):i?new go(i.sort(Eo),ho):vo}add(t,e){return e.length?this==vo?go.create(t,e):this.addInner(t,e,0):this}addInner(t,e,n){let r,o=0;t.forEach((t,i)=>{let s,a=i+n;if(s=xo(e,t,a)){for(r||(r=this.children.slice());o<r.length&&r[o]<i;)o+=3;r[o]==i?r[o+2]=r[o+2].addInner(t,s,a+1):r.splice(o,0,i,i+t.nodeSize,ko(s,t,a+1,mo)),o+=3}});let i=bo(o?wo(e):e,-n);for(let e=0;e<i.length;e++)i[e].type.valid(t,i[e])||i.splice(e--,1);return new go(i.length?this.local.concat(i).sort(Eo):this.local,r||this.children)}remove(t){return 0==t.length||this==vo?this:this.removeInner(t,0)}removeInner(t,e){let n=this.children,r=this.local;for(let r=0;r<n.length;r+=3){let o,i=n[r]+e,s=n[r+1]+e;for(let e,n=0;n<t.length;n++)(e=t[n])&&e.from>i&&e.to<s&&(t[n]=null,(o||(o=[])).push(e));if(!o)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(o,i+1);a!=vo?n[r+2]=a:(n.splice(r,3),r-=3)}if(r.length)for(let n,o=0;o<t.length;o++)if(n=t[o])for(let t=0;t<r.length;t++)r[t].eq(n,e)&&(r==this.local&&(r=this.local.slice()),r.splice(t--,1));return n==this.children&&r==this.local?this:r.length||n.length?new go(r,n):vo}forChild(t,e){if(this==vo)return this;if(e.isLeaf)return go.empty;let n,r;for(let e=0;e<this.children.length;e+=3)if(this.children[e]>=t){this.children[e]==t&&(n=this.children[e+2]);break}let o=t+1,i=o+e.content.size;for(let t=0;t<this.local.length;t++){let e=this.local[t];if(e.from<i&&e.to>o&&e.type instanceof uo){let t=Math.max(o,e.from)-o,n=Math.min(i,e.to)-o;t<n&&(r||(r=[])).push(e.copy(t,n))}}if(r){let t=new go(r.sort(Eo),ho);return n?new yo([t,n]):t}return n||vo}eq(t){if(this==t)return!0;if(!(t instanceof go)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return Co(this.localsInner(t))}localsInner(t){if(this==vo)return ho;if(t.inlineContent||!this.local.some(uo.is))return this.local;let e=[];for(let t=0;t<this.local.length;t++)this.local[t].type instanceof uo||e.push(this.local[t]);return e}forEachSet(t){t(this)}}go.empty=new go([],[]),go.removeOverlap=Co;const vo=go.empty;class yo{constructor(t){this.members=t}map(t,e){const n=this.members.map(n=>n.map(t,e,mo));return yo.from(n)}forChild(t,e){if(e.isLeaf)return go.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(t,e);o!=vo&&(o instanceof yo?n=n.concat(o.members):n.push(o))}return yo.from(n)}eq(t){if(!(t instanceof yo)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(let t=0;t<o.length;t++)e.push(o[t])}else e=o}return e?Co(n?e:e.sort(Eo)):ho}static from(t){switch(t.length){case 0:return vo;case 1:return t[0];default:return new yo(t.every(t=>t instanceof go)?t:t.reduce((t,e)=>t.concat(e instanceof go?e:e.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function bo(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let o=t[r];n.push(new fo(o.from+e,o.to+e,o.type))}return n}function xo(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,o=null;for(let e,i=0;i<t.length;i++)(e=t[i])&&e.from>n&&e.to<r&&((o||(o=[])).push(e),t[i]=null);return o}function wo(t){let e=[];for(let n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function ko(t,e,n,r){let o=[],i=!1;e.forEach((e,s)=>{let a=xo(t,e,s+n);if(a){i=!0;let t=ko(a,e,n+s+1,r);t!=vo&&o.push(s,s+e.nodeSize,t)}});let s=bo(i?wo(t):t,-n).sort(Eo);for(let t=0;t<s.length;t++)s[t].type.valid(e,s[t])||(r.onRemove&&r.onRemove(s[t].spec),s.splice(t--,1));return s.length||o.length?new go(s,o):vo}function Eo(t,e){return t.from-e.from||t.to-e.to}function Co(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let o=n+1;o<e.length;o++){let i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),So(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),So(e,o+1,i.copy(r.to,i.to)))}}return e}function So(t,e,n){for(;e<t.length&&Eo(n,t[e])>0;)e++;t.splice(e,0,n)}function Do(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=vo&&e.push(r)}),t.cursorWrapper&&e.push(go.create(t.state.doc,[t.cursorWrapper.deco])),yo.from(e)}const Mo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Oo=Ge&&Ue<=11;class _o{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Ao{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new _o,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(t=>{for(let e=0;e<t.length;e++)this.queue.push(t[e]);Ge&&Ue<=11&&t.some(t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length)?this.flushSoon():this.flush()}),Oo&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Mo)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(sr(this.view)){if(this.suppressingSelectionUpdates)return Zn(this.view);if(Ge&&Ue<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Ne(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e,n=new Set;for(let e=t.focusNode;e;e=Ae(e))n.add(e);for(let r=t.anchorNode;r;r=Ae(r))if(n.has(r)){e=r;break}let r=e&&this.view.docView.nearestDesc(e);return r&&r.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let n=t.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&sr(t)&&!this.ignoreSelectionChange(n),o=-1,i=-1,s=!1,a=[];if(t.editable)for(let t=0;t<e.length;t++){let n=this.registerMutation(e[t],a);n&&(o=o<0?n.from:Math.min(n.from,o),i=i<0?n.to:Math.max(n.to,i),n.typeOver&&(s=!0))}if(Ye&&a.length){let e=a.filter(t=>"BR"==t.nodeName);if(2==e.length){let[t,n]=e;t.parentNode&&t.parentNode.parentNode==n.parentNode?n.remove():t.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of e){let e=r.parentNode;!e||"LI"!=e.nodeName||n&&Po(t,n)==e||r.remove()}}}let l=null;o<0&&r&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Fe(n)&&(l=Xn(t))&&l.eq(se.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Zn(t),this.currentSelection.set(n),t.scrollToSelection()):(o>-1||r)&&(o>-1&&(t.docView.markDirty(o,i),function(t){if(To.has(t))return;if(To.set(t,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)){if(t.requiresGeckoHackNode=Ye,Ro)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Ro=!0}}(t)),this.handleDOMChange(o,i,s,a),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Zn(t),this.currentSelection.set(n))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){for(let n=0;n<t.addedNodes.length;n++){let r=t.addedNodes[n];e.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let r=t.previousSibling,o=t.nextSibling;if(Ge&&Ue<=11&&t.addedNodes.length)for(let e=0;e<t.addedNodes.length;e++){let{previousSibling:n,nextSibling:i}=t.addedNodes[e];(!n||Array.prototype.indexOf.call(t.addedNodes,n)<0)&&(r=n),(!i||Array.prototype.indexOf.call(t.addedNodes,i)<0)&&(o=i)}let i=r&&r.parentNode==t.target?_e(r)+1:0,s=n.localPosFromDOM(t.target,i,-1),a=o&&o.parentNode==t.target?_e(o):t.target.childNodes.length;return{from:s,to:n.localPosFromDOM(t.target,a,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let To=new WeakMap,Ro=!1;function No(t,e){let n=e.startContainer,r=e.startOffset,o=e.endContainer,i=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Ne(s.node,s.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function Po(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let e=t.docView.nearestDesc(n,!0);if(e&&e.node.isBlock)return n}return null}function Lo(t){let e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(Ze&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}if(t.parentNode.lastChild==t||Ze&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Io=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function zo(t,e,n,r,o){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let e=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,n=Xn(t,e);if(n&&!t.state.selection.eq(n)){if(Xe&&nn&&13===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",e=>e(t,Be(13,"Enter"))))return;let r=t.state.tr.setSelection(n);"pointer"==e?r.setMeta("pointer",!0):"key"==e&&r.scrollIntoView(),i&&r.setMeta("composition",i),t.dispatch(r)}return}let s=t.state.doc.resolve(e),a=s.sharedDepth(n);e=s.before(a+1),n=t.state.doc.resolve(n).after(a+1);let c,u,d=t.state.selection,p=function(t,e,n){let r,{node:o,fromOffset:i,toOffset:s,from:a,to:l}=t.docView.parseRange(e,n),c=t.domSelectionRange(),u=c.anchorNode;if(u&&t.dom.contains(1==u.nodeType?u:u.parentNode)&&(r=[{node:u,offset:c.anchorOffset}],Fe(c)||r.push({node:c.focusNode,offset:c.focusOffset})),Xe&&8===t.input.lastKeyCode)for(let t=s;t>i;t--){let e=o.childNodes[t-1],n=e.pmViewDesc;if("BR"==e.nodeName&&!n){s=t;break}if(!n||n.size)break}let d=t.state.doc,p=t.someProp("domParser")||Q.fromSchema(t.state.schema),f=d.resolve(a),h=null,m=p.parse(o,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=f.parent.type.whitespace||"full",findPositions:r,ruleFromNode:Lo,context:f});if(r&&null!=r[0].pos){let t=r[0].pos,e=r[1]&&r[1].pos;null==e&&(e=t),h={anchor:t+a,head:e+a}}return{doc:m,sel:h,from:a,to:l}}(t,e,n),f=t.state.doc,h=f.slice(p.from,p.to);8===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime?(c=t.state.selection.to,u="end"):(c=t.state.selection.from,u="start"),t.input.lastKeyCode=null;let m=function(t,e,n,r,o){let i=t.findDiffStart(e,n);if(null==i)return null;let{a:s,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if("end"==o){r-=s+Math.max(0,i-Math.min(s,a))-i}if(s<i&&t.size<e.size){let t=r<=i&&r>=s?i-r:0;i-=t,i&&i<e.size&&jo(e.textBetween(i-1,i+1))&&(i+=t?1:-1),a=i+(a-s),s=i}else if(a<i){let e=r<=i&&r>=a?i-r:0;i-=e,i&&i<t.size&&jo(t.textBetween(i-1,i+1))&&(i+=e?1:-1),s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}(h.content,p.doc.content,p.from,c,u);if(m&&t.input.domChangeCount++,(Qe&&t.input.lastIOSEnter>Date.now()-225||nn)&&o.some(t=>1==t.nodeType&&!Io.test(t.nodeName))&&(!m||m.endA>=m.endB)&&t.someProp("handleKeyDown",e=>e(t,Be(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(!m){if(!(r&&d instanceof ue&&!d.empty&&d.$head.sameParent(d.$anchor))||t.composing||p.sel&&p.sel.anchor!=p.sel.head){if(p.sel){let e=Fo(t,t.state.doc,p.sel);if(e&&!e.eq(t.state.selection)){let n=t.state.tr.setSelection(e);i&&n.setMeta("composition",i),t.dispatch(n)}}return}m={start:d.from,endA:d.to,endB:d.to}}t.state.selection.from<t.state.selection.to&&m.start==m.endB&&t.state.selection instanceof ue&&(m.start>t.state.selection.from&&m.start<=t.state.selection.from+2&&t.state.selection.from>=p.from?m.start=t.state.selection.from:m.endA<t.state.selection.to&&m.endA>=t.state.selection.to-2&&t.state.selection.to<=p.to&&(m.endB+=t.state.selection.to-m.endA,m.endA=t.state.selection.to)),Ge&&Ue<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>p.from&&" "==p.doc.textBetween(m.start-p.from-1,m.start-p.from+1)&&(m.start--,m.endA--,m.endB--);let g,v=p.doc.resolveNoCache(m.start-p.from),y=p.doc.resolveNoCache(m.endB-p.from),b=f.resolve(m.start),x=v.sameParent(y)&&v.parent.inlineContent&&b.end()>=m.endA;if((Qe&&t.input.lastIOSEnter>Date.now()-225&&(!x||o.some(t=>"DIV"==t.nodeName||"P"==t.nodeName))||!x&&v.pos<p.doc.content.size&&(!v.sameParent(y)||!v.parent.inlineContent)&&!/\S/.test(p.doc.textBetween(v.pos,y.pos,"",""))&&(g=se.findFrom(p.doc.resolve(v.pos+1),1,!0))&&g.head>v.pos)&&t.someProp("handleKeyDown",e=>e(t,Be(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(t.state.selection.anchor>m.start&&function(t,e,n,r,o){if(n-e<=o.pos-r.pos||Bo(r,!0,!1)<o.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let t=i.nodeAfter;return null!=t&&n==e+t.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=t.resolve(Bo(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||Bo(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(f,m.start,m.endA,v,y)&&t.someProp("handleKeyDown",e=>e(t,Be(8,"Backspace"))))return void(nn&&Xe&&t.domObserver.suppressSelectionUpdates());Xe&&m.endB==m.start&&(t.input.lastChromeDelete=Date.now()),nn&&!x&&v.start()!=y.start()&&0==y.parentOffset&&v.depth==y.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==m.endA&&(m.endB-=2,y=p.doc.resolveNoCache(m.endB-p.from),setTimeout(()=>{t.someProp("handleKeyDown",function(e){return e(t,Be(13,"Enter"))})},20));let w,k=m.start,E=m.endA,C=e=>{let n=e||t.state.tr.replace(k,E,p.doc.slice(m.start-p.from,m.endB-p.from));if(p.sel){let e=Fo(t,n.doc,p.sel);e&&!(Xe&&t.composing&&e.empty&&(m.start!=m.endB||t.input.lastChromeDelete<Date.now()-100)&&(e.head==k||e.head==n.mapping.map(E)-1)||Ge&&e.empty&&e.head==k)&&n.setSelection(e)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(x){if(v.pos==y.pos){Ge&&Ue<=11&&0==v.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Zn(t),20));let e=C(t.state.tr.delete(k,E)),n=f.resolve(m.start).marksAcross(f.resolve(m.endA));n&&e.ensureMarks(n),t.dispatch(e)}else if(m.endA==m.endB&&(w=function(t,e){let n,r,o,i=t.firstChild.marks,s=e.firstChild.marks,a=i,c=s;for(let t=0;t<s.length;t++)a=s[t].removeFromSet(a);for(let t=0;t<i.length;t++)c=i[t].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=t=>t.mark(r.addToSet(t.marks));else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=t=>t.mark(r.removeFromSet(t.marks))}let u=[];for(let t=0;t<e.childCount;t++)u.push(o(e.child(t)));if(l.from(u).eq(t))return{mark:r,type:n}}(v.parent.content.cut(v.parentOffset,y.parentOffset),b.parent.content.cut(b.parentOffset,m.endA-b.start())))){let e=C(t.state.tr);"add"==w.type?e.addMark(k,E,w.mark):e.removeMark(k,E,w.mark),t.dispatch(e)}else if(v.parent.child(v.index()).isText&&v.index()==y.index()-(y.textOffset?0:1)){let e=v.parent.textBetween(v.parentOffset,y.parentOffset),n=()=>C(t.state.tr.insertText(e,k,E));t.someProp("handleTextInput",r=>r(t,k,E,e,n))||t.dispatch(n())}}else t.dispatch(C())}function Fo(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:ir(t,e.resolve(n.anchor),e.resolve(n.head))}function Bo(t,e,n){let r=t.depth,o=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n){let e=t.node(r).maybeChild(t.indexAfter(r));for(;e&&!e.isLeaf;)e=e.firstChild,o++}return o}function jo(t){if(2!=t.length)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class Ho{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Ir,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(Go),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Vo(this),qo(this),this.nodeViews=Wo(this),this.docView=Pn(this.state.doc,$o(this),Do(this),this.dom,this),this.domObserver=new Ao(this,(t,e,n,r)=>zo(this,t,e,n,r)),this.domObserver.start(),function(t){for(let e in Nr){let n=Nr[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=e=>{!jr(t,e)||Br(t,e)||!t.editable&&e.type in Pr||n(t,e)},Lr[e]?{passive:!0}:void 0)}Ze&&t.dom.addEventListener("input",()=>null),Fr(t)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Fr(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(Go),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let t in this._props)e[t]=this._props[t];e.state=this.state;for(let n in t)e[n]=t[n];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var n;let r=this.state,o=!1,i=!1;t.storedMarks&&this.composing&&(Qr(this),i=!0),this.state=t;let s=r.plugins!=t.plugins||this._props.plugins!=e.plugins;if(s||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let t=Wo(this);(function(t,e){let n=0,r=0;for(let r in t){if(t[r]!=e[r])return!0;n++}for(let t in e)r++;return n!=r})(t,this.nodeViews)&&(this.nodeViews=t,o=!0)}(s||e.handleDOMEvents!=this._props.handleDOMEvents)&&Fr(this),this.editable=Vo(this),qo(this);let a=Do(this),l=$o(this),c=r.plugins==t.plugins||r.doc.eq(t.doc)?t.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",u=o||!this.docView.matchesNode(t.doc,l,a);!u&&t.selection.eq(r.selection)||(i=!0);let d="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(t){let e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top);for(let i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){let r=t.root.elementFromPoint(i,s);if(!r||r==t.dom||!t.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=o-20){e=r,n=a.top;break}}return{refDOM:e,refTop:n,stack:un(t.dom)}}(this);if(i){this.domObserver.stop();let e=u&&(Ge||Xe)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&function(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(r.selection,t.selection);if(u){let n=Xe?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=to(this)),!o&&this.docView.update(t.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=Pn(t.doc,l,a,this.dom,this)),n&&!this.trackWrites&&(e=!0)}e||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Ne(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?Zn(this,e):(rr(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():d&&function({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;dn(n,0==r?0:r-e)}(d)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(t&&this.dom.contains(1==t.nodeType?t:t.parentNode))if(this.someProp("handleScrollToSelection",t=>t(this)));else if(this.state.selection instanceof pe){let e=this.docView.domAfterPos(this.state.selection.from);1==e.nodeType&&cn(this,e.getBoundingClientRect(),t)}else cn(this,this.coordsAtPos(this.state.selection.head,1),t);else;}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let e=this.directPlugins[t];e.spec.view&&this.pluginViews.push(e.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let e=this.state.plugins[t];e.spec.view&&this.pluginViews.push(e.spec.view(this))}}}updateDraggedNode(t,e){let n=t.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let t=n.from+(this.state.doc.content.size-e.doc.content.size);(t>0&&this.state.doc.nodeAt(t))==n.node&&(r=t)}this.dragging=new io(t.slice,t.move,r<0?void 0:pe.create(this.state.doc,r))}someProp(t,e){let n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;for(let r=0;r<this.directPlugins.length;r++){let o=this.directPlugins[r].props[t];if(null!=o&&(n=e?e(o):o))return n}let o=this.state.plugins;if(o)for(let r=0;r<o.length;r++){let i=o[r].props[t];if(null!=i&&(n=e?e(i):i))return n}}hasFocus(){if(Ge){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if("false"==t.contentEditable)return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(pn)return t.focus(pn);let e=un(t);t.focus(null==pn?{get preventScroll(){return pn={preventScroll:!0},!0}}:void 0),pn||(pn=!1,dn(e,0))}(this.dom),Zn(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return t||document}updateRoot(){this._root=null}posAtCoords(t){return gn(this,t)}coordsAtPos(t,e=1){return xn(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,n=-1){let r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(t,e){return On(this,e||this.state,t)}pasteHTML(t,e){return ro(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return ro(this,t,null,!0,e||new ClipboardEvent("paste"))}serializeForClipboard(t){return wr(this,t)}destroy(){this.docView&&(!function(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Do(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Te=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(t,e){Br(t,e)||!Nr[e.type]||!t.editable&&e.type in Pr||Nr[e.type](t,e)}(this,t)}domSelectionRange(){let t=this.domSelection();return t?Ze&&11===this.root.nodeType&&function(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom&&function(t,e){if(e.getComposedRanges){let n=e.getComposedRanges(t.root)[0];if(n)return No(t,n)}let n;function r(t){t.preventDefault(),t.stopImmediatePropagation(),n=t.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?No(t,n):null}(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function $o(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if("function"==typeof n&&(n=n(t.state)),n)for(let t in n)"class"==t?e.class+=" "+n[t]:"style"==t?e.style=(e.style?e.style+";":"")+n[t]:e[t]||"contenteditable"==t||"nodeName"==t||(e[t]=String(n[t]))}),e.translate||(e.translate="no"),[fo.node(0,t.state.doc.content.size,e)]}function qo(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:fo.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Vo(t){return!t.someProp("editable",e=>!1===e(t.state))}function Wo(t){let e=Object.create(null);function n(t){for(let n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function Go(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}Ho.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};for(var Uo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Yo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ko="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Xo="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Jo=0;Jo<10;Jo++)Uo[48+Jo]=Uo[96+Jo]=String(Jo);for(Jo=1;Jo<=24;Jo++)Uo[Jo+111]="F"+Jo;for(Jo=65;Jo<=90;Jo++)Uo[Jo]=String.fromCharCode(Jo+32),Yo[Jo]=String.fromCharCode(Jo);for(var Zo in Uo)Yo.hasOwnProperty(Zo)||(Yo[Zo]=Uo[Zo]);const Qo="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),ti="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function ei(t){let e,n,r,o,i=t.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(let t=0;t<i.length-1;t++){let s=i[t];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else{if(!/^mod$/i.test(s))throw new Error("Unrecognized modifier name: "+s);Qo?o=!0:n=!0}}return e&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function ni(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function ri(t){let e=function(t){let e=Object.create(null);for(let n in t)e[ei(n)]=t[n];return e}(t);return function(t,n){let r,o=function(t){var e=!(Ko&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Xo&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?Yo:Uo)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),i=e[ni(o,n)];if(i&&i(t.state,t.dispatch,t))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=e[ni(o,n,!1)];if(r&&r(t.state,t.dispatch,t))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(ti&&n.ctrlKey&&n.altKey)&&(r=Uo[n.keyCode])&&r!=o){let o=e[ni(r,n)];if(o&&o(t.state,t.dispatch,t))return!0}}return!1}}const oi=(t,e)=>!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function ii(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const si=(t,e,n)=>{let r=ii(t,n);if(!r)return!1;let o=ui(r);if(!o){let n=r.blockRange(),o=n&&Pt(n);return null!=o&&(e&&e(t.tr.lift(n,o).scrollIntoView()),!0)}let i=o.nodeBefore;if(xi(t,o,e,-1))return!0;if(0==r.parent.content.size&&(li(i,"end")||pe.isSelectable(i)))for(let n=r.depth;;n--){let s=Vt(t.doc,r.before(n),r.after(n),h.empty);if(s&&s.slice.size<s.to-s.from){if(e){let n=t.tr.step(s);n.setSelection(li(i,"end")?se.findFrom(n.doc.resolve(n.mapping.map(o.pos,-1)),-1):pe.create(n.doc,o.pos-i.nodeSize)),e(n.scrollIntoView())}return!0}if(1==n||r.node(n-1).childCount>1)break}return!(!i.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0)};function ai(t,e,n){let r=e.nodeBefore,o=e.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let t=r.lastChild;if(!t)return!1;r=t}let i=e.nodeAfter,s=e.pos+1;for(;!i.isTextblock;s++){if(i.type.spec.isolating)return!1;let t=i.firstChild;if(!t)return!1;i=t}let a=Vt(t.doc,o,s,h.empty);if(!a||a.from!=o||a instanceof _t&&a.slice.size>=s-o)return!1;if(n){let e=t.tr.step(a);e.setSelection(ue.create(e.doc,o)),n(e.scrollIntoView())}return!0}function li(t,e,n=!1){for(let r=t;r;r="start"==e?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const ci=(t,e,n)=>{let{$head:r,empty:o}=t.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=ui(r)}let s=i&&i.nodeBefore;return!(!s||!pe.isSelectable(s))&&(e&&e(t.tr.setSelection(pe.create(t.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function ui(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function di(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const pi=(t,e,n)=>{let r=di(t,n);if(!r)return!1;let o=hi(r);if(!o)return!1;let i=o.nodeAfter;if(xi(t,o,e,1))return!0;if(0==r.parent.content.size&&(li(i,"start")||pe.isSelectable(i))){let n=Vt(t.doc,r.before(),r.after(),h.empty);if(n&&n.slice.size<n.to-n.from){if(e){let r=t.tr.step(n);r.setSelection(li(i,"start")?se.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):pe.create(r.doc,r.mapping.map(o.pos))),e(r.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)},fi=(t,e,n)=>{let{$head:r,empty:o}=t.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=hi(r)}let s=i&&i.nodeAfter;return!(!s||!pe.isSelectable(s))&&(e&&e(t.tr.setSelection(pe.create(t.doc,i.pos)).scrollIntoView()),!0)};function hi(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const mi=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!(!n.parent.type.spec.code||!n.sameParent(r))&&(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)};function gi(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const vi=(t,e)=>{let n=t.selection,{$from:r,$to:o}=n;if(n instanceof he||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=gi(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=t.tr.insert(n,i.createAndFill());s.setSelection(ue.create(s.doc,n+1)),e(s.scrollIntoView())}return!0},yi=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(Bt(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),o=r&&Pt(r);return null!=o&&(e&&e(t.tr.lift(r,o).scrollIntoView()),!0)};const bi=(t,e)=>{let{$from:n,$to:r}=t.selection;if(t.selection instanceof pe&&t.selection.node.isBlock)return!(!n.parentOffset||!Bt(t.doc,n.pos)||(e&&e(t.tr.split(n.pos).scrollIntoView()),0));if(!n.depth)return!1;let o,i,s=[],a=!1,l=!1;for(let t=n.depth;;t--){if(n.node(t).isBlock){a=n.end(t)==n.pos+(n.depth-t),l=n.start(t)==n.pos-(n.depth-t),i=gi(n.node(t-1).contentMatchAt(n.indexAfter(t-1))),s.unshift(a&&i?{type:i}:null),o=t;break}if(1==t)return!1;s.unshift(null)}let c=t.tr;(t.selection instanceof ue||t.selection instanceof he)&&c.deleteSelection();let u=c.mapping.map(n.pos),d=Bt(c.doc,u,s.length,s);if(d||(s[0]=i?{type:i}:null,d=Bt(c.doc,u,s.length,s)),!d)return!1;if(c.split(u,s.length,s),!a&&l&&n.node(o).type!=i){let t=c.mapping.map(n.before(o)),e=c.doc.resolve(t);i&&n.node(o-1).canReplaceWith(e.index(),e.index()+1,i)&&c.setNodeMarkup(c.mapping.map(n.before(o)),i)}return e&&e(c.scrollIntoView()),!0};function xi(t,e,n,r){let o,i,s=e.nodeBefore,a=e.nodeAfter,c=s.type.spec.isolating||a.type.spec.isolating;if(!c&&function(t,e,n){let r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(i,i+1)||!o.isTextblock&&!jt(t.doc,e.pos)||(n&&n(t.tr.join(e.pos).scrollIntoView()),0)))}(t,e,n))return!0;let u=!c&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(o=(i=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&i.matchType(o[0]||a.type).validEnd){if(n){let r=e.pos+a.nodeSize,i=l.empty;for(let t=o.length-1;t>=0;t--)i=l.from(o[t].create(null,i));i=l.from(s.copy(i));let c=t.tr.step(new At(e.pos-1,r,e.pos,r,new h(i,1,0),o.length,!0)),u=c.doc.resolve(r+2*o.length);u.nodeAfter&&u.nodeAfter.type==s.type&&jt(c.doc,u.pos)&&c.join(u.pos),n(c.scrollIntoView())}return!0}let d=a.type.spec.isolating||r>0&&c?null:se.findFrom(e,1),p=d&&d.$from.blockRange(d.$to),f=p&&Pt(p);if(null!=f&&f>=e.depth)return n&&n(t.tr.lift(p,f).scrollIntoView()),!0;if(u&&li(a,"start",!0)&&li(s,"end")){let r=s,o=[];for(;o.push(r),!r.isTextblock;)r=r.lastChild;let i=a,c=1;for(;!i.isTextblock;i=i.firstChild)c++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=l.empty;for(let t=o.length-1;t>=0;t--)r=l.from(o[t].copy(r));n(t.tr.step(new At(e.pos-o.length,e.pos+a.nodeSize,e.pos+c,e.pos+a.nodeSize-c,new h(r,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function wi(t){return function(e,n){let r=e.selection,o=t<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(e.tr.setSelection(ue.create(e.doc,t<0?o.start(i):o.end(i)))),!0)}}const ki=wi(-1),Ei=wi(1);function Ci(t,e=null){return function(n,r){let o=!1;for(let r=0;r<n.selection.ranges.length&&!o;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];n.doc.nodesBetween(i,s,(r,i)=>{if(o)return!1;if(r.isTextblock&&!r.hasMarkup(t,e))if(r.type==t)o=!0;else{let e=n.doc.resolve(i),r=e.index();o=e.parent.canReplaceWith(r,r+1,t)}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];o.setBlockType(i,s,t,e)}r(o.scrollIntoView())}return!0}}function Si(...t){return function(e,n,r){for(let o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}function Di(t,e=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i);if(!s)return!1;let a=r?n.tr:null;return!!function(t,e,n,r=null){let o=!1,i=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&0==e.startIndex){if(0==e.$from.index(e.depth-1))return!1;let t=s.resolve(e.start-2);i=new A(t,t,e.depth),e.endIndex<e.parent.childCount&&(e=new A(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),o=!0}let a=Lt(i,n,r,e);if(!a)return!1;t&&function(t,e,n,r,o){let i=l.empty;for(let t=n.length-1;t>=0;t--)i=l.from(n[t].type.create(n[t].attrs,i));t.step(new At(e.start-(r?2:0),e.end,e.start,e.end,new h(i,0,0),n.length,!0));let s=0;for(let t=0;t<n.length;t++)n[t].type==o&&(s=t+1);let a=n.length-s,c=e.start+n.length-(r?2:0),u=e.parent;for(let n=e.startIndex,r=e.endIndex,o=!0;n<r;n++,o=!1)!o&&Bt(t.doc,c,a)&&(t.split(c,a),c+=2*a),c+=u.child(n).nodeSize}(t,e,a,o,n);return!0}(a,s,t,e)&&(r&&r(a.scrollIntoView()),!0)}}function Mi(t){return function(e,n){let{$from:r,$to:o}=e.selection,i=r.blockRange(o,e=>e.childCount>0&&e.firstChild.type==t);return!!i&&(!n||(r.node(i.depth-1).type==t?function(t,e,n,r){let o=t.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new At(i-1,s,i,s,new h(l.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new A(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));const a=Pt(r);if(null==a)return!1;o.lift(r,a);let c=o.doc.resolve(o.mapping.map(i,-1)-1);jt(o.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&o.join(c.pos);return e(o.scrollIntoView()),!0}(e,n,t,i):function(t,e,n){let r=t.tr,o=n.parent;for(let t=n.end,e=n.endIndex-1,i=n.startIndex;e>i;e--)t-=o.child(e).nodeSize,r.delete(t-1,t+1);let i=r.doc.resolve(n.start),s=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,c=n.endIndex==o.childCount,u=i.node(-1),d=i.index(-1);if(!u.canReplace(d+(a?0:1),d+1,s.content.append(c?l.empty:l.from(o))))return!1;let p=i.pos,f=p+s.nodeSize;return r.step(new At(p-(a?1:0),f+(c?1:0),p+1,f-1,new h((a?l.empty:l.from(o.copy(l.empty))).append(c?l.empty:l.from(o.copy(l.empty))),a?0:1,c?0:1),a?0:1)),e(r.scrollIntoView()),!0}(e,n,i)))}}function Oi(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}}}Si(oi,si,ci),Si(oi,pi,fi),Si(mi,vi,yi,bi),"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class _i{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([t,e])=>[t,(...t)=>{const n=e(...t)(i);return o.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(o),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s=[],a=!!t,l=t||o.tr,c={...Object.fromEntries(Object.entries(n).map(([t,n])=>[t,(...t)=>{const r=this.buildProps(l,e),o=n(...t)(r);return s.push(o),c}])),run:()=>(a||!e||l.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(l),s.every(t=>!0===t))};return c}createCan(t){const{rawCommands:e,state:n}=this,r=!1,o=t||n.tr,i=this.buildProps(o,r),s=Object.fromEntries(Object.entries(e).map(([t,e])=>[t,(...t)=>e(...t)({...i,dispatch:void 0})]));return{...s,chain:()=>this.createChain(o,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s={tr:t,editor:r,view:i,state:Oi({state:o,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([t,e])=>[t,(...t)=>e(...t)(s)]))}};return s}}let Ai=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(t=>t.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(t=>t!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}};function Ti(t,e,n){if(void 0===t.config[e]&&t.parent)return Ti(t.parent,e,n);if("function"==typeof t.config[e]){return t.config[e].bind({...n,parent:t.parent?Ti(t.parent,e,n):null})}return t.config[e]}function Ri(t){return{baseExtensions:t.filter(t=>"extension"===t.type),nodeExtensions:t.filter(t=>"node"===t.type),markExtensions:t.filter(t=>"mark"===t.type)}}function Ni(t){const e=[],{nodeExtensions:n,markExtensions:r}=Ri(t),o=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(t=>{const n=Ti(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage,extensions:o});if(!n)return;n().forEach(t=>{t.types.forEach(n=>{Object.entries(t.attributes).forEach(([t,r])=>{e.push({type:n,name:t,attribute:{...i,...r}})})})})}),o.forEach(t=>{const n={name:t.name,options:t.options,storage:t.storage},r=Ti(t,"addAttributes",n);if(!r)return;const o=r();Object.entries(o).forEach(([n,r])=>{const o={...i,...r};"function"==typeof(null==o?void 0:o.default)&&(o.default=o.default()),(null==o?void 0:o.isRequired)&&void 0===(null==o?void 0:o.default)&&delete o.default,e.push({type:t.name,name:n,attribute:o})})}),e}function Pi(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function Li(...t){return t.filter(t=>!!t).reduce((t,e)=>{const n={...t};return Object.entries(e).forEach(([t,e])=>{if(n[t])if("class"===t){const r=e?String(e).split(" "):[],o=n[t]?n[t].split(" "):[],i=r.filter(t=>!o.includes(t));n[t]=[...o,...i].join(" ")}else if("style"===t){const r=e?e.split(";").map(t=>t.trim()).filter(Boolean):[],o=n[t]?n[t].split(";").map(t=>t.trim()).filter(Boolean):[],i=new Map;o.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());i.set(e,n)}),r.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());i.set(e,n)}),n[t]=Array.from(i.entries()).map(([t,e])=>`${t}: ${e}`).join("; ")}else n[t]=e;else n[t]=e}),n},{})}function Ii(t,e){return e.filter(e=>e.type===t.type.name).filter(t=>t.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]}).reduce((t,e)=>Li(t,e),{})}function zi(t){return"function"==typeof t}function Fi(t,e=void 0,...n){return zi(t)?e?t.bind(e)(...n):t(...n):t}function Bi(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===r)return!1;const o=e.reduce((t,e)=>{const r=e.attribute.parseHTML?e.attribute.parseHTML(n):function(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}(n.getAttribute(e.name));return null==r?t:{...t,[e.name]:r}},{});return{...r,...o}}}}function ji(t){return Object.fromEntries(Object.entries(t).filter(([t,e])=>("attrs"!==t||!function(t={}){return 0===Object.keys(t).length&&t.constructor===Object}(e))&&null!=e))}function Hi(t,e){return e.nodes[t]||e.marks[t]||null}function $i(t,e){return Array.isArray(e)?e.some(e=>("string"==typeof e?e:e.name)===t.name):e}function qi(t,e){const n=ct.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function Vi(t){return"[object RegExp]"===Object.prototype.toString.call(t)}class Wi{constructor(t){this.find=t.find,this.handler=t.handler}}function Gi(t){var e;const{editor:n,from:r,to:o,text:i,rules:s,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null===(e=c.nodeBefore||c.nodeAfter)||void 0===e?void 0:e.marks.find(t=>t.type.spec.code)))return!1;let u=!1;const d=((t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(t,e,o,i)=>{var s,a;const l=(null===(a=(s=t.type.spec).toText)||void 0===a?void 0:a.call(s,{node:t,pos:e,parent:o,index:i}))||t.textContent||"%leaf%";n+=t.isAtom&&!t.isText?l:l.slice(0,Math.max(0,r-e))}),n})(c)+i;return s.forEach(t=>{if(u)return;const e=((t,e)=>{if(Vi(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(d,t.find);if(!e)return;const s=l.state.tr,c=Oi({state:l.state,transaction:s}),p={from:r-(e[0].length-i.length),to:o},{commands:f,chain:h,can:m}=new _i({editor:n,state:c});null!==t.handler({state:c,range:p,match:e,commands:f,chain:h,can:m})&&s.steps.length&&(s.setMeta(a,{transform:s,from:r,to:o,text:i}),l.dispatch(s),u=!0)}),u}function Ui(t){const{editor:e,rules:n}=t,r=new Se({state:{init:()=>null,apply(t,o,i){const s=t.getMeta(r);if(s)return s;const a=t.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:t}=a;"string"==typeof t||(t=qi(l.from(t),i.schema));const{from:o}=a,s=o+t.length;Gi({editor:e,from:o,to:s,text:t,rules:n,plugin:r})}),t.selectionSet||t.docChanged?null:o}},props:{handleTextInput:(t,o,i,s)=>Gi({editor:e,from:o,to:i,text:s,rules:n,plugin:r}),handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:o}=t.state.selection;o&&Gi({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(t,o){if("Enter"!==o.key)return!1;const{$cursor:i}=t.state.selection;return!!i&&Gi({editor:e,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}function Yi(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&(t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)}function Ki(t,e){const n={...t};return Yi(t)&&Yi(e)&&Object.keys(e).forEach(r=>{Yi(e[r])&&Yi(t[r])?n[r]=Ki(t[r],e[r]):n[r]=e[r]}),n}class Xi{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Fi(Ti(this,"addOptions",{name:this.name}))),this.storage=Fi(Ti(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Xi(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Ki(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new Xi(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=Fi(Ti(e,"addOptions",{name:e.name})),e.storage=Fi(Ti(e,"addStorage",{name:e.name,options:e.options})),e}static handleExit({editor:t,mark:e}){const{tr:n}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(t=>(null==t?void 0:t.type.name)===e.name))return!1;const i=o.find(t=>(null==t?void 0:t.type.name)===e.name);return i&&n.removeStoredMark(i),n.insertText(" ",r.pos),t.view.dispatch(n),!0}return!1}}class Ji{constructor(t){this.find=t.find,this.handler=t.handler}}function Zi(t){const{editor:e,state:n,from:r,to:o,rule:i,pasteEvent:s,dropEvent:a}=t,{commands:l,chain:c,can:u}=new _i({editor:e,state:n}),d=[];n.doc.nodesBetween(r,o,(t,e)=>{if(!t.isTextblock||t.type.spec.code)return;const p=Math.max(r,e),f=Math.min(o,e+t.content.size),h=((t,e,n)=>{if(Vi(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(e=>{const n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n}):[]})(t.textBetween(p-e,f-e,void 0,""),i.find,s);h.forEach(t=>{if(void 0===t.index)return;const e=p+t.index+1,r=e+t[0].length,o={from:n.tr.mapping.map(e),to:n.tr.mapping.map(r)},f=i.handler({state:n,range:o,match:t,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(f)})});return d.every(t=>null!==t)}let Qi=null;function ts(t){const{editor:e,rules:n}=t;let r,o=null,i=!1,s=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}const c=({state:t,from:n,to:o,rule:i,pasteEvt:s})=>{const l=t.tr,c=Oi({state:t,transaction:l});if(Zi({editor:e,state:c,from:Math.max(n-1,0),to:o.b-1,rule:i,pasteEvent:s,dropEvent:r})&&l.steps.length){try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}return a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,l}},u=n.map(t=>new Se({view(t){const n=n=>{var r;o=(null===(r=t.dom.parentElement)||void 0===r?void 0:r.contains(n.target))?t.dom.parentElement:null,o&&(Qi=e)},r=()=>{Qi&&(Qi=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(t,e)=>{if(s=o===t.dom.parentElement,r=e,!s){const t=Qi;(null==t?void 0:t.isEditable)&&setTimeout(()=>{const e=t.state.selection;e&&t.commands.deleteRange({from:e.from,to:e.to})},10)}return!1},paste:(t,e)=>{var n;const r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return a=e,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(e,n,r)=>{const o=e[0],u="paste"===o.getMeta("uiEvent")&&!i,d="drop"===o.getMeta("uiEvent")&&!s,p=o.getMeta("applyPasteRules"),f=!!p;if(!u&&!d&&!f)return;if(f){let{text:e}=p;"string"==typeof e||(e=qi(l.from(e),r.schema));const{from:n}=p,o=n+e.length,i=(t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(e=n.clipboardData)||void 0===e||e.setData("text/html",t),n})(e);return c({rule:t,state:r,from:n,to:{b:o},pasteEvt:i})}const h=n.doc.content.findDiffStart(r.doc.content),m=n.doc.content.findDiffEnd(r.doc.content);return"number"==typeof h&&m&&h!==m.b?c({rule:t,state:r,from:h,to:m,pasteEvt:a}):void 0}}));return u}class es{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=es.resolve(t),this.schema=function(t,e){var n;const r=Ni(t),{nodeExtensions:o,markExtensions:i}=Ri(t),s=null===(n=o.find(t=>Ti(t,"topNode")))||void 0===n?void 0:n.name,a=Object.fromEntries(o.map(n=>{const o=r.filter(t=>t.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:e},s=ji({...t.reduce((t,e)=>{const r=Ti(e,"extendNodeSchema",i);return{...t,...r?r(n):{}}},{}),content:Fi(Ti(n,"content",i)),marks:Fi(Ti(n,"marks",i)),group:Fi(Ti(n,"group",i)),inline:Fi(Ti(n,"inline",i)),atom:Fi(Ti(n,"atom",i)),selectable:Fi(Ti(n,"selectable",i)),draggable:Fi(Ti(n,"draggable",i)),code:Fi(Ti(n,"code",i)),whitespace:Fi(Ti(n,"whitespace",i)),linebreakReplacement:Fi(Ti(n,"linebreakReplacement",i)),defining:Fi(Ti(n,"defining",i)),isolating:Fi(Ti(n,"isolating",i)),attrs:Object.fromEntries(o.map(t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]}))}),a=Fi(Ti(n,"parseHTML",i));a&&(s.parseDOM=a.map(t=>Bi(t,o)));const l=Ti(n,"renderHTML",i);l&&(s.toDOM=t=>l({node:t,HTMLAttributes:Ii(t,o)}));const c=Ti(n,"renderText",i);return c&&(s.toText=c),[n.name,s]})),l=Object.fromEntries(i.map(n=>{const o=r.filter(t=>t.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:e},s=ji({...t.reduce((t,e)=>{const r=Ti(e,"extendMarkSchema",i);return{...t,...r?r(n):{}}},{}),inclusive:Fi(Ti(n,"inclusive",i)),excludes:Fi(Ti(n,"excludes",i)),group:Fi(Ti(n,"group",i)),spanning:Fi(Ti(n,"spanning",i)),code:Fi(Ti(n,"code",i)),attrs:Object.fromEntries(o.map(t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]}))}),a=Fi(Ti(n,"parseHTML",i));a&&(s.parseDOM=a.map(t=>Bi(t,o)));const l=Ti(n,"renderHTML",i);return l&&(s.toDOM=t=>l({mark:t,HTMLAttributes:Ii(t,o)})),[n.name,s]}));return new J({topNode:s,nodes:a,marks:l})}(this.extensions,e),this.setupExtensions()}static resolve(t){const e=es.sort(es.flatten(t)),n=function(t){const e=t.filter((e,n)=>t.indexOf(e)!==n);return Array.from(new Set(e))}(e.map(t=>t.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(t=>`'${t}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(t=>{const e=Ti(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t,...this.flatten(e())]:t}).flat(10)}static sort(t){return t.sort((t,e)=>{const n=Ti(t,"priority")||100,r=Ti(e,"priority")||100;return n>r?-1:n<r?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const n=Ti(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Hi(e.name,this.schema)});return n?{...t,...n()}:t},{})}get plugins(){const{editor:t}=this,e=es.sort([...this.extensions].reverse()),n=[],r=[],o=e.map(e=>{const o={name:e.name,options:e.options,storage:e.storage,editor:t,type:Hi(e.name,this.schema)},i=[],s=Ti(e,"addKeyboardShortcuts",o);let a={};if("mark"===e.type&&Ti(e,"exitable",o)&&(a.ArrowRight=()=>Xi.handleExit({editor:t,mark:e})),s){const e=Object.fromEntries(Object.entries(s()).map(([e,n])=>[e,()=>n({editor:t})]));a={...a,...e}}const l=new Se({props:{handleKeyDown:ri(a)}});i.push(l);const c=Ti(e,"addInputRules",o);$i(e,t.options.enableInputRules)&&c&&n.push(...c());const u=Ti(e,"addPasteRules",o);$i(e,t.options.enablePasteRules)&&u&&r.push(...u());const d=Ti(e,"addProseMirrorPlugins",o);if(d){const t=d();i.push(...t)}return i}).flat();return[Ui({editor:t,rules:n}),...ts({editor:t,rules:r}),...o]}get attributes(){return Ni(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Ri(this.extensions);return Object.fromEntries(e.filter(t=>!!Ti(t,"addNodeView")).map(e=>{const n=this.attributes.filter(t=>t.type===e.name),r={name:e.name,options:e.options,storage:e.storage,editor:t,type:Pi(e.name,this.schema)},o=Ti(e,"addNodeView",r);if(!o)return[];return[e.name,(r,i,s,a,l)=>{const c=Ii(r,n);return o()({node:r,view:i,getPos:s,decorations:a,innerDecorations:l,editor:t,extension:e,HTMLAttributes:c})}]}))}setupExtensions(){this.extensions.forEach(t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Hi(t.name,this.schema)};if("mark"===t.type){(null===(e=Fi(Ti(t,"keepOnSplit",n)))||void 0===e||e)&&this.splittableMarks.push(t.name)}const r=Ti(t,"onBeforeCreate",n),o=Ti(t,"onCreate",n),i=Ti(t,"onUpdate",n),s=Ti(t,"onSelectionUpdate",n),a=Ti(t,"onTransaction",n),l=Ti(t,"onFocus",n),c=Ti(t,"onBlur",n),u=Ti(t,"onDestroy",n);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),s&&this.editor.on("selectionUpdate",s),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),u&&this.editor.on("destroy",u)})}}class ns{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Fi(Ti(this,"addOptions",{name:this.name}))),this.storage=Fi(Ti(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ns(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Ki(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new ns({...this.config,...t});return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=Fi(Ti(e,"addOptions",{name:e.name})),e.storage=Fi(Ti(e,"addStorage",{name:e.name,options:e.options})),e}}function rs(t,e,n){const{from:r,to:o}=e,{blockSeparator:i="\n\n",textSerializers:s={}}=n||{};let a="";return t.nodesBetween(r,o,(t,n,l,c)=>{var u;t.isBlock&&n>r&&(a+=i);const d=null==s?void 0:s[t.type.name];if(d)return l&&(a+=d({node:t,pos:n,parent:l,index:c,range:e})),!1;t.isText&&(a+=null===(u=null==t?void 0:t.text)||void 0===u?void 0:u.slice(Math.max(r,n)-n,o-n))}),a}function is(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const ss=ns.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new Se({key:new Oe("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:o}=e,{ranges:i}=o,s=Math.min(...i.map(t=>t.$from.pos)),a=Math.max(...i.map(t=>t.$to.pos)),l=is(n);return rs(r,{from:s,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});function as(t,e,n={strict:!0}){const r=Object.keys(e);return!r.length||r.every(r=>n.strict?e[r]===t[r]:Vi(e[r])?e[r].test(t[r]):e[r]===t[r])}function ls(t,e,n={}){return t.find(t=>t.type===e&&as(Object.fromEntries(Object.keys(n).map(e=>[e,t.attrs[e]])),n))}function cs(t,e,n={}){return!!ls(t,e,n)}function us(t,e,n){var r;if(!t||!e)return;let o=t.parent.childAfter(t.parentOffset);if(o.node&&o.node.marks.some(t=>t.type===e)||(o=t.parent.childBefore(t.parentOffset)),!o.node||!o.node.marks.some(t=>t.type===e))return;n=n||(null===(r=o.node.marks[0])||void 0===r?void 0:r.attrs);if(!ls([...o.node.marks],e,n))return;let i=o.index,s=t.start()+o.offset,a=i+1,l=s+o.node.nodeSize;for(;i>0&&cs([...t.parent.child(i-1).marks],e,n);)i-=1,s-=t.parent.child(i).nodeSize;for(;a<t.parent.childCount&&cs([...t.parent.child(a).marks],e,n);)l+=t.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function ds(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function ps(t){return t instanceof ue}function fs(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function hs(t,e=null){if(!e)return null;const n=se.atStart(t),r=se.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return r;const o=n.from,i=r.to;return"all"===e?ue.create(t,fs(0,o,i),fs(t.content.size,o,i)):ue.create(t,fs(e,o,i),fs(e,o,i))}function ms(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const gs=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):1===r.nodeType&&gs(r)}return t};function vs(t){const e=`<body>${t}</body>`,n=(new window.DOMParser).parseFromString(e,"text/html").body;return gs(n)}function ys(t,e,n){if(t instanceof R||t instanceof l)return t;n={slice:!0,parseOptions:{},...n};const r="string"==typeof t;if("object"==typeof t&&null!==t)try{if(Array.isArray(t)&&t.length>0)return l.fromArray(t.map(t=>e.nodeFromJSON(t)));const r=e.nodeFromJSON(t);return n.errorOnInvalidContent&&r.check(),r}catch(r){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),ys("",e,n)}if(r){if(n.errorOnInvalidContent){let r=!1,o="";const i=new J({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:t=>(r=!0,o="string"==typeof t?t:t.outerHTML,null)}]}})});if(n.slice?Q.fromSchema(i).parseSlice(vs(t),n.parseOptions):Q.fromSchema(i).parse(vs(t),n.parseOptions),n.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const r=Q.fromSchema(e);return n.slice?r.parseSlice(vs(t),n.parseOptions).content:r.parse(vs(t),n.parseOptions)}return ys("",e,n)}function bs(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function xs(t,e,n={}){const{from:r,to:o,empty:i}=t.selection,s=e?Pi(e,t.schema):null,a=[];t.doc.nodesBetween(r,o,(t,e)=>{if(t.isText)return;const n=Math.max(r,e),i=Math.min(o,e+t.nodeSize);a.push({node:t,from:n,to:i})});const l=o-r,c=a.filter(t=>!s||s.name===t.node.type.name).filter(t=>as(t.node.attrs,n,{strict:!1}));if(i)return!!c.length;const u=c.reduce((t,e)=>t+e.to-e.from,0);return u>=l}function ws(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function ks(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce((e,r)=>(n.includes(r)||(e[r]=t[r]),e),{})}function Es(t,e,n={},r={}){return ys(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}function Cs(t,e){const n=ds(e,t.schema),{from:r,to:o,empty:i}=t.selection,s=[];i?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,o,t=>{s.push(...t.marks)});const a=s.find(t=>t.type.name===n.name);return a?{...a.attrs}:{}}function Ss(t){return e=>function(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}(e.$from,t)}function Ds(t,e){const n=ws("string"==typeof e?e:e.name,t.schema);return"node"===n?function(t,e){const n=Pi(e,t.schema),{from:r,to:o}=t.selection,i=[];t.doc.nodesBetween(r,o,t=>{i.push(t)});const s=i.reverse().find(t=>t.type.name===n.name);return s?{...s.attrs}:{}}(t,e):"mark"===n?Cs(t,e):{}}function Ms(t){const e=function(t,e=JSON.stringify){const n={};return t.filter(t=>{const r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(t);return 1===e.length?e:e.filter((t,n)=>{const r=e.filter((t,e)=>e!==n);return!r.some(e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to)})}function Os(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(e=>{const o=us(n.resolve(t),e.type);o&&r.push({mark:e,...o})}):n.nodesBetween(t,e,(t,e)=>{t&&void 0!==(null==t?void 0:t.nodeSize)&&r.push(...t.marks.map(n=>({from:e,to:e+t.nodeSize,mark:n})))}),r}function _s(t,e,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{const r=t.find(t=>t.type===e&&t.name===n);return!!r&&r.attribute.keepOnSplit}))}function As(t,e,n={}){const{empty:r,ranges:o}=t.selection,i=e?ds(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(t=>!i||i.name===t.type.name).find(t=>as(t.attrs,n,{strict:!1}));let s=0;const a=[];if(o.forEach(({$from:e,$to:n})=>{const r=e.pos,o=n.pos;t.doc.nodesBetween(r,o,(t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(r,e),i=Math.min(o,e+t.nodeSize);s+=i-n,a.push(...t.marks.map(t=>({mark:t,from:n,to:i})))})}),0===s)return!1;const l=a.filter(t=>!i||i.name===t.mark.type.name).filter(t=>as(t.mark.attrs,n,{strict:!1})).reduce((t,e)=>t+e.to-e.from,0),c=a.filter(t=>!i||t.mark.type!==i&&t.mark.type.excludes(i)).reduce((t,e)=>t+e.to-e.from,0);return(l>0?l+c:l)>=s}function Ts(t,e){const{nodeExtensions:n}=Ri(e),r=n.find(e=>e.name===t);if(!r)return!1;const o=Fi(Ti(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"==typeof o&&o.split(" ").includes("list")}function Rs(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if("hardBreak"===t.type.name)return!0;if(t.isText)return/^\s*$/m.test(null!==(r=t.text)&&void 0!==r?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(0===t.content.childCount)return!0;if(e){let r=!0;return t.content.forEach(t=>{!1!==r&&(Rs(t,{ignoreWhitespace:n,checkChildren:e})||(r=!1))}),r}return!1}function Ns(t){return t instanceof pe}function Ps(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(t=>null==e?void 0:e.includes(t.type.name));t.tr.ensureMarks(r)}}const Ls=(t,e)=>{const n=Ss(t=>t.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const o=t.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!jt(t.doc,n.pos)||(t.join(n.pos),!0)},Is=(t,e)=>{const n=Ss(t=>t.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const o=t.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!jt(t.doc,r)||(t.join(r),!0)};var zs=Object.freeze({__proto__:null,blur:()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0),clearContent:(t=!1)=>({commands:e})=>e.setContent("",t),clearNodes:()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:o}=r;return!n||(o.forEach(({$from:n,$to:r})=>{t.doc.nodesBetween(n.pos,r.pos,(t,n)=>{if(t.type.isText)return;const{doc:r,mapping:o}=e,i=r.resolve(o.map(n)),s=r.resolve(o.map(n+t.nodeSize)),a=i.blockRange(s);if(!a)return;const l=Pt(a);if(t.type.isTextblock){const{defaultType:t}=i.parent.contentMatchAt(i.index());e.setNodeMarkup(a.start,t)}(l||0===l)&&e.lift(a,l)})}),!0)},command:t=>e=>t(e),createParagraphNear:()=>({state:t,dispatch:e})=>vi(t,e),cut:(t,e)=>({editor:n,tr:r})=>{const{state:o}=n,i=o.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,i.content),r.setSelection(new ue(r.doc.resolve(s-1))),!0},deleteCurrentNode:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const o=t.selection.$anchor;for(let n=o.depth;n>0;n-=1){if(o.node(n).type===r.type){if(e){const e=o.before(n),r=o.after(n);t.delete(e,r).scrollIntoView()}return!0}}return!1},deleteNode:t=>({tr:e,state:n,dispatch:r})=>{const o=Pi(t,n.schema),i=e.selection.$anchor;for(let t=i.depth;t>0;t-=1){if(i.node(t).type===o){if(r){const n=i.before(t),r=i.after(t);e.delete(n,r).scrollIntoView()}return!0}}return!1},deleteRange:t=>({tr:e,dispatch:n})=>{const{from:r,to:o}=t;return n&&e.delete(r,o),!0},deleteSelection:()=>({state:t,dispatch:e})=>oi(t,e),enter:()=>({commands:t})=>t.keyboardShortcut("Enter"),exitCode:()=>({state:t,dispatch:e})=>((t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),s=gi(o.contentMatchAt(i));if(!s||!o.canReplaceWith(i,i,s))return!1;if(e){let r=n.after(),o=t.tr.replaceWith(r,r,s.createAndFill());o.setSelection(se.near(o.doc.resolve(r),1)),e(o.scrollIntoView())}return!0})(t,e),extendMarkRange:(t,e={})=>({tr:n,state:r,dispatch:o})=>{const i=ds(t,r.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:u}=a;if(o){const t=us(l,i,e);if(t&&t.from<=c&&t.to>=u){const e=ue.create(s,t.from,t.to);n.setSelection(e)}}return!0},first:t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1},focus:(t=null,e={})=>({editor:n,view:r,tr:o,dispatch:i})=>{e={scrollIntoView:!0,...e};const s=()=>{(ms()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),(null==e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===t||!1===t)return!0;if(i&&null===t&&!ps(n.state.selection))return s(),!0;const a=hs(o.doc,t)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},forEach:(t,e)=>n=>t.every((t,r)=>e(t,{...n,index:r})),insertContent:(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),insertContentAt:(t,e,n)=>({tr:r,dispatch:o,editor:i})=>{var s;if(o){let o;const a=t=>{i.emit("contentError",{editor:i,error:t,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...(n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n}).parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{ys(e,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(t){a(t)}try{o=ys(e,i.schema,{parseOptions:c,errorOnInvalidContent:null!==(s=n.errorOnInvalidContent)&&void 0!==s?s:i.options.enableContentCheck})}catch(t){return a(t),!1}let{from:u,to:d}="number"==typeof t?{from:t,to:t}:{from:t.from,to:t.to},p=!0,f=!0;if(("type"in o?[o]:o).forEach(t=>{t.check(),p=!!p&&(t.isText&&0===t.marks.length),f=!!f&&t.isBlock}),u===d&&f){const{parent:t}=r.doc.resolve(u);t.isTextblock&&!t.type.spec.code&&!t.childCount&&(u-=1,d+=1)}let h;if(p){if(Array.isArray(e))h=e.map(t=>t.text||"").join("");else if(e instanceof l){let t="";e.forEach(e=>{e.text&&(t+=e.text)}),h=t}else h="object"==typeof e&&e&&e.text?e.text:e;r.insertText(h,u,d)}else h=o,r.replaceWith(u,d,h);n.updateSelection&&function(t,e,n){const r=t.steps.length-1;if(r<e)return;const o=t.steps[r];if(!(o instanceof _t||o instanceof At))return;const i=t.mapping.maps[r];let s=0;i.forEach((t,e,n,r)=>{0===s&&(s=r)}),t.setSelection(se.near(t.doc.resolve(s),n))}(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:h}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:h})}return!0},joinBackward:()=>({state:t,dispatch:e})=>si(t,e),joinDown:()=>({state:t,dispatch:e})=>((t,e)=>{let n,r=t.selection;if(r instanceof pe){if(r.node.isTextblock||!jt(t.doc,r.to))return!1;n=r.to}else if(n=$t(t.doc,r.to,1),null==n)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0})(t,e),joinForward:()=>({state:t,dispatch:e})=>pi(t,e),joinItemBackward:()=>({state:t,dispatch:e,tr:n})=>{try{const r=$t(t.doc,t.selection.$from.pos,-1);return null!=r&&(n.join(r,2),e&&e(n),!0)}catch{return!1}},joinItemForward:()=>({state:t,dispatch:e,tr:n})=>{try{const r=$t(t.doc,t.selection.$from.pos,1);return null!=r&&(n.join(r,2),e&&e(n),!0)}catch{return!1}},joinTextblockBackward:()=>({state:t,dispatch:e})=>((t,e,n)=>{let r=ii(t,n);if(!r)return!1;let o=ui(r);return!!o&&ai(t,o,e)})(t,e),joinTextblockForward:()=>({state:t,dispatch:e})=>((t,e,n)=>{let r=di(t,n);if(!r)return!1;let o=hi(r);return!!o&&ai(t,o,e)})(t,e),joinUp:()=>({state:t,dispatch:e})=>((t,e)=>{let n,r=t.selection,o=r instanceof pe;if(o){if(r.node.isTextblock||!jt(t.doc,r.from))return!1;n=r.from}else if(n=$t(t.doc,r.from,-1),null==n)return!1;if(e){let r=t.tr.join(n);o&&r.setSelection(pe.create(r.doc,n-t.doc.resolve(n).nodeBefore.nodeSize)),e(r.scrollIntoView())}return!0})(t,e),keyboardShortcut:t=>({editor:e,view:n,tr:r,dispatch:o})=>{const i=function(t){const e=t.split(/-(?!$)/);let n,r,o,i,s=e[e.length-1];"Space"===s&&(s=" ");for(let t=0;t<e.length-1;t+=1){const s=e[t];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))n=!0;else if(/^(c|ctrl|control)$/i.test(s))r=!0;else if(/^s(hift)?$/i.test(s))o=!0;else{if(!/^mod$/i.test(s))throw new Error(`Unrecognized modifier name: ${s}`);ms()||bs()?i=!0:r=!0}}return n&&(s=`Alt-${s}`),r&&(s=`Ctrl-${s}`),i&&(s=`Meta-${s}`),o&&(s=`Shift-${s}`),s}(t).split(/-(?!$)/),s=i.find(t=>!["Alt","Ctrl","Meta","Shift"].includes(t)),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",t=>t(n,a))});return null==l||l.steps.forEach(t=>{const e=t.map(r.mapping);e&&o&&r.maybeStep(e)}),!0},lift:(t,e={})=>({state:n,dispatch:r})=>!!xs(n,Pi(t,n.schema),e)&&((t,e)=>{let{$from:n,$to:r}=t.selection,o=n.blockRange(r),i=o&&Pt(o);return null!=i&&(e&&e(t.tr.lift(o,i).scrollIntoView()),!0)})(n,r),liftEmptyBlock:()=>({state:t,dispatch:e})=>yi(t,e),liftListItem:t=>({state:e,dispatch:n})=>Mi(Pi(t,e.schema))(e,n),newlineInCode:()=>({state:t,dispatch:e})=>mi(t,e),resetAttributes:(t,e)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=ws("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(i=Pi(t,r.schema)),"mark"===a&&(s=ds(t,r.schema)),o&&n.selection.ranges.forEach(t=>{r.doc.nodesBetween(t.$from.pos,t.$to.pos,(t,r)=>{i&&i===t.type&&n.setNodeMarkup(r,void 0,ks(t.attrs,e)),s&&t.marks.length&&t.marks.forEach(o=>{s===o.type&&n.addMark(r,r+t.nodeSize,s.create(ks(o.attrs,e)))})})}),!0)},scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),selectAll:()=>({tr:t,dispatch:e})=>{if(e){const e=new he(t.doc);t.setSelection(e)}return!0},selectNodeBackward:()=>({state:t,dispatch:e})=>ci(t,e),selectNodeForward:()=>({state:t,dispatch:e})=>fi(t,e),selectParentNode:()=>({state:t,dispatch:e})=>((t,e)=>{let n,{$from:r,to:o}=t.selection,i=r.sharedDepth(o);return 0!=i&&(n=r.before(i),e&&e(t.tr.setSelection(pe.create(t.doc,n))),!0)})(t,e),selectTextblockEnd:()=>({state:t,dispatch:e})=>Ei(t,e),selectTextblockStart:()=>({state:t,dispatch:e})=>ki(t,e),setContent:(t,e=!1,n={},r={})=>({editor:o,tr:i,dispatch:s,commands:a})=>{var l,c;const{doc:u}=i;if("full"!==n.preserveWhitespace){const a=Es(t,o.schema,n,{errorOnInvalidContent:null!==(l=r.errorOnInvalidContent)&&void 0!==l?l:o.options.enableContentCheck});return s&&i.replaceWith(0,u.content.size,a).setMeta("preventUpdate",!e),!0}return s&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:null!==(c=r.errorOnInvalidContent)&&void 0!==c?c:o.options.enableContentCheck})},setMark:(t,e={})=>({tr:n,state:r,dispatch:o})=>{const{selection:i}=n,{empty:s,ranges:a}=i,l=ds(t,r.schema);if(o)if(s){const t=Cs(r,l);n.addStoredMark(l.create({...t,...e}))}else a.forEach(t=>{const o=t.$from.pos,i=t.$to.pos;r.doc.nodesBetween(o,i,(t,r)=>{const s=Math.max(r,o),a=Math.min(r+t.nodeSize,i);t.marks.find(t=>t.type===l)?t.marks.forEach(t=>{l===t.type&&n.addMark(s,a,l.create({...t.attrs,...e}))}):n.addMark(s,a,l.create(e))})});return function(t,e,n){var r;const{selection:o}=e;let i=null;if(ps(o)&&(i=o.$cursor),i){const e=null!==(r=t.storedMarks)&&void 0!==r?r:i.marks();return!!n.isInSet(e)||!e.some(t=>t.type.excludes(n))}const{ranges:s}=o;return s.some(({$from:e,$to:r})=>{let o=0===e.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(e.pos,r.pos,(t,e,r)=>{if(o)return!1;if(t.isInline){const e=!r||r.type.allowsMarkType(n),i=!!n.isInSet(t.marks)||!t.marks.some(t=>t.type.excludes(n));o=e&&i}return!o}),o})}(r,n,l)},setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),setNode:(t,e={})=>({state:n,dispatch:r,chain:o})=>{const i=Pi(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),i.isTextblock?o().command(({commands:t})=>!!Ci(i,{...s,...e})(n)||t.clearNodes()).command(({state:t})=>Ci(i,{...s,...e})(t,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,r=fs(t,0,n.content.size),o=pe.create(n,r);e.setSelection(o)}return!0},setTextSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,{from:r,to:o}="number"==typeof t?{from:t,to:t}:t,i=ue.atStart(n).from,s=ue.atEnd(n).to,a=fs(r,i,s),l=fs(o,i,s),c=ue.create(n,a,l);e.setSelection(c)}return!0},sinkListItem:t=>({state:e,dispatch:n})=>{const r=Pi(t,e.schema);return(o=r,function(t,e){let{$from:n,$to:r}=t.selection,i=n.blockRange(r,t=>t.childCount>0&&t.firstChild.type==o);if(!i)return!1;let s=i.startIndex;if(0==s)return!1;let a=i.parent,c=a.child(s-1);if(c.type!=o)return!1;if(e){let n=c.lastChild&&c.lastChild.type==a.type,r=l.from(n?o.create():null),s=new h(l.from(o.create(null,l.from(a.type.create(null,r)))),n?3:1,0),u=i.start,d=i.end;e(t.tr.step(new At(u-(n?3:1),d,u,d,s,1,!0)).scrollIntoView())}return!0})(e,n);var o},splitBlock:({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:o})=>{const{selection:i,doc:s}=e,{$from:a,$to:l}=i,c=_s(o.extensionManager.attributes,a.node().type.name,a.node().attrs);if(i instanceof pe&&i.node.isBlock)return!(!a.parentOffset||!Bt(s,a.pos))&&(r&&(t&&Ps(n,o.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const u=l.parentOffset===l.parent.content.size,d=0===a.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=u&&d?[{type:d,attrs:c}]:void 0,f=Bt(e.doc,e.mapping.map(a.pos),1,p);if(p||f||!Bt(e.doc,e.mapping.map(a.pos),1,d?[{type:d}]:void 0)||(f=!0,p=d?[{type:d,attrs:c}]:void 0),r){if(f&&(i instanceof ue&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),d&&!u&&!a.parentOffset&&a.parent.type!==d)){const t=e.mapping.map(a.before()),n=e.doc.resolve(t);a.node(-1).canReplaceWith(n.index(),n.index()+1,d)&&e.setNodeMarkup(e.mapping.map(a.before()),d)}t&&Ps(n,o.extensionManager.splittableMarks),e.scrollIntoView()}return f},splitListItem:(t,e={})=>({tr:n,state:r,dispatch:o,editor:i})=>{var s;const a=Pi(t,r.schema),{$from:c,$to:u}=r.selection,d=r.selection.node;if(d&&d.isBlock||c.depth<2||!c.sameParent(u))return!1;const p=c.node(-1);if(p.type!==a)return!1;const f=i.extensionManager.attributes;if(0===c.parent.content.size&&c.node(-1).childCount===c.indexAfter(-1)){if(2===c.depth||c.node(-3).type!==a||c.index(-2)!==c.node(-2).childCount-1)return!1;if(o){let t=l.empty;const r=c.index(-1)?1:c.index(-2)?2:3;for(let e=c.depth-r;e>=c.depth-3;e-=1)t=l.from(c.node(e).copy(t));const o=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,i={..._s(f,c.node().type.name,c.node().attrs),...e},u=(null===(s=a.contentMatch.defaultType)||void 0===s?void 0:s.createAndFill(i))||void 0;t=t.append(l.from(a.createAndFill(null,u)||void 0));const d=c.before(c.depth-(r-1));n.replace(d,c.after(-o),new h(t,4-r,0));let p=-1;n.doc.nodesBetween(d,n.doc.content.size,(t,e)=>{if(p>-1)return!1;t.isTextblock&&0===t.content.size&&(p=e+1)}),p>-1&&n.setSelection(ue.near(n.doc.resolve(p))),n.scrollIntoView()}return!0}const m=u.pos===c.end()?p.contentMatchAt(0).defaultType:null,g={..._s(f,p.type.name,p.attrs),...e},v={..._s(f,c.node().type.name,c.node().attrs),...e};n.delete(c.pos,u.pos);const y=m?[{type:a,attrs:g},{type:m,attrs:v}]:[{type:a,attrs:g}];if(!Bt(n.doc,c.pos,2))return!1;if(o){const{selection:t,storedMarks:e}=r,{splittableMarks:s}=i.extensionManager,a=e||t.$to.parentOffset&&t.$from.marks();if(n.split(c.pos,2,y).scrollIntoView(),!a||!o)return!0;const l=a.filter(t=>s.includes(t.type.name));n.ensureMarks(l)}return!0},toggleList:(t,e,n,r={})=>({editor:o,tr:i,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:p}=o.extensionManager,f=Pi(t,s.schema),h=Pi(e,s.schema),{selection:m,storedMarks:g}=s,{$from:v,$to:y}=m,b=v.blockRange(y),x=g||m.$to.parentOffset&&m.$from.marks();if(!b)return!1;const w=Ss(t=>Ts(t.type.name,d))(m);if(b.depth>=1&&w&&b.depth-w.depth<=1){if(w.node.type===f)return c.liftListItem(h);if(Ts(w.node.type.name,d)&&f.validContent(w.node.content)&&a)return l().command(()=>(i.setNodeMarkup(w.pos,f),!0)).command(()=>Ls(i,f)).command(()=>Is(i,f)).run()}return n&&x&&a?l().command(()=>{const t=u().wrapInList(f,r),e=x.filter(t=>p.includes(t.type.name));return i.ensureMarks(e),!!t||c.clearNodes()}).wrapInList(f,r).command(()=>Ls(i,f)).command(()=>Is(i,f)).run():l().command(()=>!!u().wrapInList(f,r)||c.clearNodes()).wrapInList(f,r).command(()=>Ls(i,f)).command(()=>Is(i,f)).run()},toggleMark:(t,e={},n={})=>({state:r,commands:o})=>{const{extendEmptyMarkRange:i=!1}=n,s=ds(t,r.schema);return As(r,s,e)?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,e)},toggleNode:(t,e,n={})=>({state:r,commands:o})=>{const i=Pi(t,r.schema),s=Pi(e,r.schema),a=xs(r,i,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?o.setNode(s,l):o.setNode(i,{...l,...n})},toggleWrap:(t,e={})=>({state:n,commands:r})=>{const o=Pi(t,n.schema);return xs(n,o,e)?r.lift(o):r.wrapIn(o,e)},undoInputRule:()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const o=n[r];let i;if(o.spec.isInputRules&&(i=o.getState(t))){if(e){const e=t.tr,n=i.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(i.text){const n=e.doc.resolve(i.from).marks();e.replaceWith(i.from,i.to,t.schema.text(i.text,n))}else e.delete(i.from,i.to)}return!0}}return!1},unsetAllMarks:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:o}=n;return r||e&&o.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos)}),!0},unsetMark:(t,e={})=>({tr:n,state:r,dispatch:o})=>{var i;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=n,l=ds(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!o)return!0;if(u&&s){let{from:t,to:e}=a;const r=null===(i=c.marks().find(t=>t.type===l))||void 0===i?void 0:i.attrs,o=us(c,l,r);o&&(t=o.from,e=o.to),n.removeMark(t,e,l)}else d.forEach(t=>{n.removeMark(t.$from.pos,t.$to.pos,l)});return n.removeStoredMark(l),!0},updateAttributes:(t,e={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=ws("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(i=Pi(t,r.schema)),"mark"===a&&(s=ds(t,r.schema)),o&&n.selection.ranges.forEach(t=>{const o=t.$from.pos,a=t.$to.pos;let l,c,u,d;n.selection.empty?r.doc.nodesBetween(o,a,(t,e)=>{i&&i===t.type&&(u=Math.max(e,o),d=Math.min(e+t.nodeSize,a),l=e,c=t)}):r.doc.nodesBetween(o,a,(t,r)=>{r<o&&i&&i===t.type&&(u=Math.max(r,o),d=Math.min(r+t.nodeSize,a),l=r,c=t),r>=o&&r<=a&&(i&&i===t.type&&n.setNodeMarkup(r,void 0,{...t.attrs,...e}),s&&t.marks.length&&t.marks.forEach(i=>{if(s===i.type){const l=Math.max(r,o),c=Math.min(r+t.nodeSize,a);n.addMark(l,c,s.create({...i.attrs,...e}))}}))}),c&&(void 0!==l&&n.setNodeMarkup(l,void 0,{...c.attrs,...e}),s&&c.marks.length&&c.marks.forEach(t=>{s===t.type&&n.addMark(u,d,s.create({...t.attrs,...e}))}))}),!0)},wrapIn:(t,e={})=>({state:n,dispatch:r})=>function(t,e=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i),a=s&&Lt(s,t,e);return!!a&&(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0)}}(Pi(t,n.schema),e)(n,r),wrapInList:(t,e={})=>({state:n,dispatch:r})=>Di(Pi(t,n.schema),e)(n,r)});const Fs=ns.create({name:"commands",addCommands:()=>({...zs})}),Bs=ns.create({name:"drop",addProseMirrorPlugins(){return[new Se({key:new Oe("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),js=ns.create({name:"editable",addProseMirrorPlugins(){return[new Se({key:new Oe("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Hs=new Oe("focusEvents"),$s=ns.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Se({key:Hs,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),qs=ns.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:t})=>[()=>t.undoInputRule(),()=>t.command(({tr:e})=>{const{selection:n,doc:r}=e,{empty:o,$anchor:i}=n,{pos:s,parent:a}=i,l=i.parent.isTextblock&&s>0?e.doc.resolve(s-1):i,c=l.parent.type.spec.isolating,u=i.pos-i.parentOffset,d=c&&1===l.parent.childCount?u===i.pos:se.atStart(r).from===s;return!(!o||!a.type.isTextblock||a.textContent.length||!d||d&&"paragraph"===i.parent.type.name)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:t})=>[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},o={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ms()||bs()?o:r},addProseMirrorPlugins(){return[new Se({key:new Oe("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(t=>t.getMeta("composition")))return;const r=t.some(t=>t.docChanged)&&!e.doc.eq(n.doc),o=t.some(t=>t.getMeta("preventClearDocument"));if(!r||o)return;const{empty:i,from:s,to:a}=e.selection,l=se.atStart(e.doc).from,c=se.atEnd(e.doc).to;if(i||!(s===l&&a===c))return;if(!Rs(n.doc))return;const u=n.tr,d=Oi({state:n,transaction:u}),{commands:p}=new _i({editor:this.editor,state:d});return p.clearNodes(),u.steps.length?u:void 0}})]}}),Vs=ns.create({name:"paste",addProseMirrorPlugins(){return[new Se({key:new Oe("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),Ws=ns.create({name:"tabindex",addProseMirrorPlugins(){return[new Se({key:new Oe("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Gs=Object.freeze({__proto__:null,ClipboardTextSerializer:ss,Commands:Fs,Drop:Bs,Editable:js,FocusEvents:$s,Keymap:qs,Paste:Vs,Tabindex:Ws,focusEventsPluginKey:Hs});class Us{get name(){return this.node.type.name}constructor(t,e,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=e,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return null!==(t=this.actualDepth)&&void 0!==t?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);e=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:e,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),e=this.resolvedPos.doc.resolve(t);return new Us(e,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Us(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Us(t,this.editor)}get children(){const t=[];return this.node.content.forEach((e,n)=>{const r=e.isBlock&&!e.isTextblock,o=e.isAtom&&!e.isText,i=this.pos+n+(o?0:1);if(i<0||i>this.resolvedPos.doc.nodeSize-2)return;const s=this.resolvedPos.doc.resolve(i);if(!r&&s.depth<=this.depth)return;const a=new Us(s,this.editor,r,r?e:null);r&&(a.actualDepth=this.depth+1),t.push(new Us(s,this.editor,r,r?e:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===t)if(Object.keys(e).length>0){const t=r.node.attrs,n=Object.keys(e);for(let r=0;r<n.length;r+=1){const o=n[r];if(t[o]!==e[o])break}}else n=r;r=r.parent}return n}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},n=!1){let r=[];if(!this.children||0===this.children.length)return r;const o=Object.keys(e);return this.children.forEach(i=>{if(!(n&&r.length>0)){if(i.node.type.name===t){o.every(t=>e[t]===i.node.attrs[t])&&r.push(i)}n&&r.length>0||(r=r.concat(i.querySelectorAll(t,e,n)))}}),r}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}}let Ys=class extends Ai{constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:e,moved:n})=>this.options.onDrop(t,e,n)),this.on("paste",({event:t,slice:e})=>this.options.onPaste(t,e)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(t,e){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n=zi(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(t=>{const e="string"==typeof t?`${t}$`:t.key;n=n.filter(t=>!t.key.startsWith(e))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[js,ss.configure({blockSeparator:null===(e=null===(t=this.options.coreExtensionOptions)||void 0===t?void 0:t.clipboardTextSerializer)||void 0===e?void 0:e.blockSeparator}),Fs,$s,qs,Ws,Bs,Vs].filter(t=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[t.name]):[],...this.options.extensions].filter(t=>["extension","node","mark"].includes(null==t?void 0:t.type));this.extensionManager=new es(n,this)}createCommandManager(){this.commandManager=new _i({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var t;let e;try{e=Es(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message)))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>"collaboration"!==t.name),this.createExtensionManager()}}),e=Es(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=hs(e,this.options.autofocus);this.view=new Ho(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...null===(t=this.options.editorProps)||void 0===t?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Ee.create({doc:e,selection:n||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)}):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const r=t.getMeta("focus"),o=t.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Ds(this.state,t)}isActive(t,e){const n="string"==typeof t?t:null,r="string"==typeof t?e:t;return function(t,e,n={}){if(!e)return xs(t,null,n)||As(t,null,n);const r=ws(e,t.schema);return"node"===r?xs(t,e,n):"mark"===r&&As(t,e,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return qi(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return function(t,e){return rs(t,{from:0,to:t.content.size},e)}(this.state.doc,{blockSeparator:e,textSerializers:{...is(this.schema),...n}})}get isEmpty(){return Rs(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const t=this.view.dom;t&&t.editor&&delete t.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}$node(t,e){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new Us(e,this)}get $doc(){return this.$pos(0)}};function Ks(t){return new Wi({find:t.find,handler:({state:e,range:n,match:r})=>{const o=Fi(t.getAttributes,void 0,r);if(!1===o||null===o)return null;const{tr:i}=e,s=r[r.length-1],a=r[0];if(s){const r=a.search(/\S/),l=n.from+a.indexOf(s),c=l+s.length;if(Os(n.from,n.to,e.doc).filter(e=>e.mark.type.excluded.find(n=>n===t.type&&n!==e.mark.type)).filter(t=>t.to>l).length)return null;c<n.to&&i.delete(c,n.to),l>n.from&&i.delete(n.from+r,l);const u=n.from+r+s.length;i.addMark(n.from+r,u,t.type.create(o||{})),i.removeStoredMark(t.type)}}})}function Xs(t){return new Wi({find:t.find,handler:({state:e,range:n,match:r})=>{const o=Fi(t.getAttributes,void 0,r)||{},{tr:i}=e,s=n.from;let a=n.to;const l=t.type.create(o);if(r[1]){let t=s+r[0].lastIndexOf(r[1]);t>a?t=a:a=t+r[1].length;const e=r[0][r[0].length-1];i.insertText(e,s+r[0].length-1),i.replaceWith(t,a,l)}else if(r[0]){const e=t.type.isInline?s:s-1;i.insert(e,t.type.create(o)).delete(i.mapping.map(s),i.mapping.map(a))}i.scrollIntoView()}})}function Js(t){return new Wi({find:t.find,handler:({state:e,range:n,match:r})=>{const o=e.doc.resolve(n.from),i=Fi(t.getAttributes,void 0,r)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,i)}})}function Zs(t){return new Wi({find:t.find,handler:({state:e,range:n,match:r,chain:o})=>{const i=Fi(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),l=a&&Lt(a,t.type,i);if(!l)return null;if(s.wrap(a,l),t.keepMarks&&t.editor){const{selection:n,storedMarks:r}=e,{splittableMarks:o}=t.editor.extensionManager,i=r||n.$to.parentOffset&&n.$from.marks();if(i){const t=i.filter(t=>o.includes(t.type.name));s.ensureMarks(t)}}if(t.keepAttributes){const e="bulletList"===t.type.name||"orderedList"===t.type.name?"listItem":"taskList";o().updateAttributes(e,i).run()}const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&jt(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&s.join(n.from-1)}})}let Qs=class t{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Fi(Ti(this,"addOptions",{name:this.name}))),this.storage=Fi(Ti(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new t(e)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Ki(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(e={}){const n=new t(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Fi(Ti(n,"addOptions",{name:n.name})),n.storage=Fi(Ti(n,"addStorage",{name:n.name,options:n.options})),n}};function ta(t){return new Ji({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:o})=>{const i=Fi(t.getAttributes,void 0,r,o);if(!1===i||null===i)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=n.to;if(a){const r=l.search(/\S/),o=n.from+l.indexOf(a),u=o+a.length;if(Os(n.from,n.to,e.doc).filter(e=>e.mark.type.excluded.find(n=>n===t.type&&n!==e.mark.type)).filter(t=>t.to>o).length)return null;u<n.to&&s.delete(u,n.to),o>n.from&&s.delete(n.from+r,o),c=n.from+r+a.length,s.addMark(n.from+r,c,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}var ea="top",na="bottom",ra="right",oa="left",ia="auto",sa=[ea,na,ra,oa],aa="start",la="end",ca="viewport",ua="popper",da=sa.reduce(function(t,e){return t.concat([e+"-"+aa,e+"-"+la])},[]),pa=[].concat(sa,[ia]).reduce(function(t,e){return t.concat([e,e+"-"+aa,e+"-"+la])},[]),fa=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function ha(t){return t?(t.nodeName||"").toLowerCase():null}function ma(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function ga(t){return t instanceof ma(t).Element||t instanceof Element}function va(t){return t instanceof ma(t).HTMLElement||t instanceof HTMLElement}function ya(t){return"undefined"!=typeof ShadowRoot&&(t instanceof ma(t).ShadowRoot||t instanceof ShadowRoot)}var ba={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach(function(t){var n=e.styles[t]||{},r=e.attributes[t]||{},o=e.elements[t];va(o)&&ha(o)&&(Object.assign(o.style,n),Object.keys(r).forEach(function(t){var e=r[t];!1===e?o.removeAttribute(t):o.setAttribute(t,!0===e?"":e)}))})},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(t){var r=e.elements[t],o=e.attributes[t]||{},i=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce(function(t,e){return t[e]="",t},{});va(r)&&ha(r)&&(Object.assign(r.style,i),Object.keys(o).forEach(function(t){r.removeAttribute(t)}))})}},requires:["computeStyles"]};function xa(t){return t.split("-")[0]}var wa=Math.max,ka=Math.min,Ea=Math.round;function Ca(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Sa(){return!/^((?!chrome|android).)*safari/i.test(Ca())}function Da(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r=t.getBoundingClientRect(),o=1,i=1;e&&va(t)&&(o=t.offsetWidth>0&&Ea(r.width)/t.offsetWidth||1,i=t.offsetHeight>0&&Ea(r.height)/t.offsetHeight||1);var s=(ga(t)?ma(t):window).visualViewport,a=!Sa()&&n,l=(r.left+(a&&s?s.offsetLeft:0))/o,c=(r.top+(a&&s?s.offsetTop:0))/i,u=r.width/o,d=r.height/i;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function Ma(t){var e=Da(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Oa(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&ya(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function _a(t){return ma(t).getComputedStyle(t)}function Aa(t){return["table","td","th"].indexOf(ha(t))>=0}function Ta(t){return((ga(t)?t.ownerDocument:t.document)||window.document).documentElement}function Ra(t){return"html"===ha(t)?t:t.assignedSlot||t.parentNode||(ya(t)?t.host:null)||Ta(t)}function Na(t){return va(t)&&"fixed"!==_a(t).position?t.offsetParent:null}function Pa(t){for(var e=ma(t),n=Na(t);n&&Aa(n)&&"static"===_a(n).position;)n=Na(n);return n&&("html"===ha(n)||"body"===ha(n)&&"static"===_a(n).position)?e:n||function(t){var e=/firefox/i.test(Ca());if(/Trident/i.test(Ca())&&va(t)&&"fixed"===_a(t).position)return null;var n=Ra(t);for(ya(n)&&(n=n.host);va(n)&&["html","body"].indexOf(ha(n))<0;){var r=_a(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||e&&"filter"===r.willChange||e&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(t)||e}function La(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Ia(t,e,n){return wa(t,ka(e,n))}function za(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function Fa(t,e){return e.reduce(function(e,n){return e[n]=t,e},{})}var Ba={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,r=t.name,o=t.options,i=n.elements.arrow,s=n.modifiersData.popperOffsets,a=xa(n.placement),l=La(a),c=[oa,ra].indexOf(a)>=0?"height":"width";if(i&&s){var u=function(t,e){return za("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:Fa(t,sa))}(o.padding,n),d=Ma(i),p="y"===l?ea:oa,f="y"===l?na:ra,h=n.rects.reference[c]+n.rects.reference[l]-s[l]-n.rects.popper[c],m=s[l]-n.rects.reference[l],g=Pa(i),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=h/2-m/2,b=u[p],x=v-d[c]-u[f],w=v/2-d[c]/2+y,k=Ia(b,w,x),E=l;n.modifiersData[r]=((e={})[E]=k,e.centerOffset=k-w,e)}},effect:function(t){var e=t.state,n=t.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=e.elements.popper.querySelector(r)))&&Oa(e.elements.popper,r)&&(e.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ja(t){return t.split("-")[1]}var Ha={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $a(t){var e,n=t.popper,r=t.popperRect,o=t.placement,i=t.variation,s=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,p=s.x,f=void 0===p?0:p,h=s.y,m=void 0===h?0:h,g="function"==typeof u?u({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var v=s.hasOwnProperty("x"),y=s.hasOwnProperty("y"),b=oa,x=ea,w=window;if(c){var k=Pa(n),E="clientHeight",C="clientWidth";if(k===ma(n)&&"static"!==_a(k=Ta(n)).position&&"absolute"===a&&(E="scrollHeight",C="scrollWidth"),o===ea||(o===oa||o===ra)&&i===la)x=na,m-=(d&&k===w&&w.visualViewport?w.visualViewport.height:k[E])-r.height,m*=l?1:-1;if(o===oa||(o===ea||o===na)&&i===la)b=ra,f-=(d&&k===w&&w.visualViewport?w.visualViewport.width:k[C])-r.width,f*=l?1:-1}var S,D=Object.assign({position:a},c&&Ha),M=!0===u?function(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:Ea(n*o)/o||0,y:Ea(r*o)/o||0}}({x:f,y:m},ma(n)):{x:f,y:m};return f=M.x,m=M.y,l?Object.assign({},D,((S={})[x]=y?"0":"",S[b]=v?"0":"",S.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",S)):Object.assign({},D,((e={})[x]=y?m+"px":"",e[b]=v?f+"px":"",e.transform="",e))}var qa={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,s=void 0===i||i,a=n.roundOffsets,l=void 0===a||a,c={placement:xa(e.placement),variation:ja(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,$a(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,$a(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},Va={passive:!0};var Wa={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,i=void 0===o||o,s=r.resize,a=void 0===s||s,l=ma(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&c.forEach(function(t){t.addEventListener("scroll",n.update,Va)}),a&&l.addEventListener("resize",n.update,Va),function(){i&&c.forEach(function(t){t.removeEventListener("scroll",n.update,Va)}),a&&l.removeEventListener("resize",n.update,Va)}},data:{}},Ga={left:"right",right:"left",bottom:"top",top:"bottom"};function Ua(t){return t.replace(/left|right|bottom|top/g,function(t){return Ga[t]})}var Ya={start:"end",end:"start"};function Ka(t){return t.replace(/start|end/g,function(t){return Ya[t]})}function Xa(t){var e=ma(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ja(t){return Da(Ta(t)).left+Xa(t).scrollLeft}function Za(t){var e=_a(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Qa(t){return["html","body","#document"].indexOf(ha(t))>=0?t.ownerDocument.body:va(t)&&Za(t)?t:Qa(Ra(t))}function tl(t,e){var n;void 0===e&&(e=[]);var r=Qa(t),o=r===(null==(n=t.ownerDocument)?void 0:n.body),i=ma(r),s=o?[i].concat(i.visualViewport||[],Za(r)?r:[]):r,a=e.concat(s);return o?a:a.concat(tl(Ra(s)))}function el(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function nl(t,e,n){return e===ca?el(function(t,e){var n=ma(t),r=Ta(t),o=n.visualViewport,i=r.clientWidth,s=r.clientHeight,a=0,l=0;if(o){i=o.width,s=o.height;var c=Sa();(c||!c&&"fixed"===e)&&(a=o.offsetLeft,l=o.offsetTop)}return{width:i,height:s,x:a+Ja(t),y:l}}(t,n)):ga(e)?function(t,e){var n=Da(t,!1,"fixed"===e);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}(e,n):el(function(t){var e,n=Ta(t),r=Xa(t),o=null==(e=t.ownerDocument)?void 0:e.body,i=wa(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),s=wa(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),a=-r.scrollLeft+Ja(t),l=-r.scrollTop;return"rtl"===_a(o||n).direction&&(a+=wa(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:s,x:a,y:l}}(Ta(t)))}function rl(t,e,n,r){var o="clippingParents"===e?function(t){var e=tl(Ra(t)),n=["absolute","fixed"].indexOf(_a(t).position)>=0&&va(t)?Pa(t):t;return ga(n)?e.filter(function(t){return ga(t)&&Oa(t,n)&&"body"!==ha(t)}):[]}(t):[].concat(e),i=[].concat(o,[n]),s=i[0],a=i.reduce(function(e,n){var o=nl(t,n,r);return e.top=wa(o.top,e.top),e.right=ka(o.right,e.right),e.bottom=ka(o.bottom,e.bottom),e.left=wa(o.left,e.left),e},nl(t,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function ol(t){var e,n=t.reference,r=t.element,o=t.placement,i=o?xa(o):null,s=o?ja(o):null,a=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(i){case ea:e={x:a,y:n.y-r.height};break;case na:e={x:a,y:n.y+n.height};break;case ra:e={x:n.x+n.width,y:l};break;case oa:e={x:n.x-r.width,y:l};break;default:e={x:n.x,y:n.y}}var c=i?La(i):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case aa:e[c]=e[c]-(n[u]/2-r[u]/2);break;case la:e[c]=e[c]+(n[u]/2-r[u]/2)}}return e}function il(t,e){void 0===e&&(e={});var n=e,r=n.placement,o=void 0===r?t.placement:r,i=n.strategy,s=void 0===i?t.strategy:i,a=n.boundary,l=void 0===a?"clippingParents":a,c=n.rootBoundary,u=void 0===c?ca:c,d=n.elementContext,p=void 0===d?ua:d,f=n.altBoundary,h=void 0!==f&&f,m=n.padding,g=void 0===m?0:m,v=za("number"!=typeof g?g:Fa(g,sa)),y=p===ua?"reference":ua,b=t.rects.popper,x=t.elements[h?y:p],w=rl(ga(x)?x:x.contextElement||Ta(t.elements.popper),l,u,s),k=Da(t.elements.reference),E=ol({reference:k,element:b,placement:o}),C=el(Object.assign({},b,E)),S=p===ua?C:k,D={top:w.top-S.top+v.top,bottom:S.bottom-w.bottom+v.bottom,left:w.left-S.left+v.left,right:S.right-w.right+v.right},M=t.modifiersData.offset;if(p===ua&&M){var O=M[o];Object.keys(D).forEach(function(t){var e=[ra,na].indexOf(t)>=0?1:-1,n=[ea,na].indexOf(t)>=0?"y":"x";D[t]+=O[n]*e})}return D}function sl(t,e){void 0===e&&(e={});var n=e,r=n.placement,o=n.boundary,i=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?pa:l,u=ja(r),d=u?a?da:da.filter(function(t){return ja(t)===u}):sa,p=d.filter(function(t){return c.indexOf(t)>=0});0===p.length&&(p=d);var f=p.reduce(function(e,n){return e[n]=il(t,{placement:n,boundary:o,rootBoundary:i,padding:s})[xa(n)],e},{});return Object.keys(f).sort(function(t,e){return f[t]-f[e]})}var al={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,s=n.altAxis,a=void 0===s||s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,f=n.flipVariations,h=void 0===f||f,m=n.allowedAutoPlacements,g=e.options.placement,v=xa(g),y=l||(v===g||!h?[Ua(g)]:function(t){if(xa(t)===ia)return[];var e=Ua(t);return[Ka(t),e,Ka(e)]}(g)),b=[g].concat(y).reduce(function(t,n){return t.concat(xa(n)===ia?sl(e,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:h,allowedAutoPlacements:m}):n)},[]),x=e.rects.reference,w=e.rects.popper,k=new Map,E=!0,C=b[0],S=0;S<b.length;S++){var D=b[S],M=xa(D),O=ja(D)===aa,_=[ea,na].indexOf(M)>=0,A=_?"width":"height",T=il(e,{placement:D,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),R=_?O?ra:oa:O?na:ea;x[A]>w[A]&&(R=Ua(R));var N=Ua(R),P=[];if(i&&P.push(T[M]<=0),a&&P.push(T[R]<=0,T[N]<=0),P.every(function(t){return t})){C=D,E=!1;break}k.set(D,P)}if(E)for(var L=function(t){var e=b.find(function(e){var n=k.get(e);if(n)return n.slice(0,t).every(function(t){return t})});if(e)return C=e,"break"},I=h?3:1;I>0;I--){if("break"===L(I))break}e.placement!==C&&(e.modifiersData[r]._skip=!0,e.placement=C,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function ll(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function cl(t){return[ea,ra,na,oa].some(function(e){return t[e]>=0})}var ul={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,r=t.name,o=n.offset,i=void 0===o?[0,0]:o,s=pa.reduce(function(t,n){return t[n]=function(t,e,n){var r=xa(t),o=[oa,ea].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},e,{placement:t})):n,s=i[0],a=i[1];return s=s||0,a=(a||0)*o,[oa,ra].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}(n,e.rects,i),t},{}),a=s[e.placement],l=a.x,c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}};var dl={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,i=void 0===o||o,s=n.altAxis,a=void 0!==s&&s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,f=void 0===p||p,h=n.tetherOffset,m=void 0===h?0:h,g=il(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),v=xa(e.placement),y=ja(e.placement),b=!y,x=La(v),w="x"===x?"y":"x",k=e.modifiersData.popperOffsets,E=e.rects.reference,C=e.rects.popper,S="function"==typeof m?m(Object.assign({},e.rects,{placement:e.placement})):m,D="number"==typeof S?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),M=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,O={x:0,y:0};if(k){if(i){var _,A="y"===x?ea:oa,T="y"===x?na:ra,R="y"===x?"height":"width",N=k[x],P=N+g[A],L=N-g[T],I=f?-C[R]/2:0,z=y===aa?E[R]:C[R],F=y===aa?-C[R]:-E[R],B=e.elements.arrow,j=f&&B?Ma(B):{width:0,height:0},H=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},$=H[A],q=H[T],V=Ia(0,E[R],j[R]),W=b?E[R]/2-I-V-$-D.mainAxis:z-V-$-D.mainAxis,G=b?-E[R]/2+I+V+q+D.mainAxis:F+V+q+D.mainAxis,U=e.elements.arrow&&Pa(e.elements.arrow),Y=U?"y"===x?U.clientTop||0:U.clientLeft||0:0,K=null!=(_=null==M?void 0:M[x])?_:0,X=N+G-K,J=Ia(f?ka(P,N+W-K-Y):P,N,f?wa(L,X):L);k[x]=J,O[x]=J-N}if(a){var Z,Q="x"===x?ea:oa,tt="x"===x?na:ra,et=k[w],nt="y"===w?"height":"width",rt=et+g[Q],ot=et-g[tt],it=-1!==[ea,oa].indexOf(v),st=null!=(Z=null==M?void 0:M[w])?Z:0,at=it?rt:et-E[nt]-C[nt]-st+D.altAxis,lt=it?et+E[nt]+C[nt]-st-D.altAxis:ot,ct=f&&it?function(t,e,n){var r=Ia(t,e,n);return r>n?n:r}(at,et,lt):Ia(f?at:rt,et,f?lt:ot);k[w]=ct,O[w]=ct-et}e.modifiersData[r]=O}},requiresIfExists:["offset"]};function pl(t,e,n){void 0===n&&(n=!1);var r,o,i=va(e),s=va(e)&&function(t){var e=t.getBoundingClientRect(),n=Ea(e.width)/t.offsetWidth||1,r=Ea(e.height)/t.offsetHeight||1;return 1!==n||1!==r}(e),a=Ta(e),l=Da(t,s,n),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&(("body"!==ha(e)||Za(a))&&(c=(r=e)!==ma(r)&&va(r)?{scrollLeft:(o=r).scrollLeft,scrollTop:o.scrollTop}:Xa(r)),va(e)?((u=Da(e,!0)).x+=e.clientLeft,u.y+=e.clientTop):a&&(u.x=Ja(a))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function fl(t){var e=new Map,n=new Set,r=[];function o(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach(function(t){if(!n.has(t)){var r=e.get(t);r&&o(r)}}),r.push(t)}return t.forEach(function(t){e.set(t.name,t)}),t.forEach(function(t){n.has(t.name)||o(t)}),r}var hl={placement:"bottom",modifiers:[],strategy:"absolute"};function ml(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(t){return!(t&&"function"==typeof t.getBoundingClientRect)})}function gl(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,r=void 0===n?[]:n,o=e.defaultOptions,i=void 0===o?hl:o;return function(t,e,n){void 0===n&&(n=i);var o,s,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},hl,i),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],c=!1,u={state:a,setOptions:function(n){var o="function"==typeof n?n(a.options):n;d(),a.options=Object.assign({},i,a.options,o),a.scrollParents={reference:ga(t)?tl(t):t.contextElement?tl(t.contextElement):[],popper:tl(e)};var s=function(t){var e=fl(t);return fa.reduce(function(t,n){return t.concat(e.filter(function(t){return t.phase===n}))},[])}(function(t){var e=t.reduce(function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t},{});return Object.keys(e).map(function(t){return e[t]})}([].concat(r,a.options.modifiers)));return a.orderedModifiers=s.filter(function(t){return t.enabled}),a.orderedModifiers.forEach(function(t){var e=t.name,n=t.options,r=void 0===n?{}:n,o=t.effect;if("function"==typeof o){var i=o({state:a,name:e,instance:u,options:r}),s=function(){};l.push(i||s)}}),u.update()},forceUpdate:function(){if(!c){var t=a.elements,e=t.reference,n=t.popper;if(ml(e,n)){a.rects={reference:pl(e,Pa(n),"fixed"===a.options.strategy),popper:Ma(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach(function(t){return a.modifiersData[t.name]=Object.assign({},t.data)});for(var r=0;r<a.orderedModifiers.length;r++)if(!0!==a.reset){var o=a.orderedModifiers[r],i=o.fn,s=o.options,l=void 0===s?{}:s,d=o.name;"function"==typeof i&&(a=i({state:a,options:l,name:d,instance:u})||a)}else a.reset=!1,r=-1}}},update:(o=function(){return new Promise(function(t){u.forceUpdate(),t(a)})},function(){return s||(s=new Promise(function(t){Promise.resolve().then(function(){s=void 0,t(o())})})),s}),destroy:function(){d(),c=!0}};if(!ml(t,e))return u;function d(){l.forEach(function(t){return t()}),l=[]}return u.setOptions(n).then(function(t){!c&&n.onFirstUpdate&&n.onFirstUpdate(t)}),u}}var vl=gl({defaultModifiers:[Wa,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=ol({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})},data:{}},qa,ba,ul,al,dl,Ba,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,i=e.modifiersData.preventOverflow,s=il(e,{elementContext:"reference"}),a=il(e,{altBoundary:!0}),l=ll(s,r),c=ll(a,o,i),u=cl(l),d=cl(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),yl="tippy-content",bl="tippy-arrow",xl="tippy-svg-arrow",wl={passive:!0,capture:!0},kl=function(){return document.body};function El(t,e,n){if(Array.isArray(t)){var r=t[e];return null==r?Array.isArray(n)?n[e]:n:r}return t}function Cl(t,e){var n={}.toString.call(t);return 0===n.indexOf("[object")&&n.indexOf(e+"]")>-1}function Sl(t,e){return"function"==typeof t?t.apply(void 0,e):t}function Dl(t,e){return 0===e?t:function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)};var n}function Ml(t){return[].concat(t)}function Ol(t,e){-1===t.indexOf(e)&&t.push(e)}function _l(t){return[].slice.call(t)}function Al(t){return Object.keys(t).reduce(function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e},{})}function Tl(){return document.createElement("div")}function Rl(t){return["Element","Fragment"].some(function(e){return Cl(t,e)})}function Nl(t){return Rl(t)?[t]:function(t){return Cl(t,"NodeList")}(t)?_l(t):Array.isArray(t)?t:_l(document.querySelectorAll(t))}function Pl(t,e){t.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function Ll(t,e){t.forEach(function(t){t&&t.setAttribute("data-state",e)})}function Il(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(e){t[r](e,n)})}function zl(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var Fl={isTouch:!1},Bl=0;function jl(){Fl.isTouch||(Fl.isTouch=!0,window.performance&&document.addEventListener("mousemove",Hl))}function Hl(){var t=performance.now();t-Bl<20&&(Fl.isTouch=!1,document.removeEventListener("mousemove",Hl)),Bl=t}function $l(){var t,e=document.activeElement;if((t=e)&&t._tippy&&t._tippy.reference===t){var n=e._tippy;e.blur&&!n.state.isVisible&&e.blur()}}var ql,Vl=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto;function Wl(t){return[t+"() was called on a"+("destroy"===t?"n already-":" ")+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function Gl(t){return t.replace(/[ \t]{2,}/g," ").replace(/^[ \t]*/gm,"").trim()}function Ul(t){return Gl("\n  %ctippy.js\n\n  %c"+Gl(t)+"\n\n  %c This is a development-only message. It will be removed in production.\n  ")}function Yl(t){return[Ul(t),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}function Kl(t,e){var n;t&&!ql.has(e)&&(ql.add(e),(n=console).warn.apply(n,Yl(e)))}function Xl(t,e){var n;t&&!ql.has(e)&&(ql.add(e),(n=console).error.apply(n,Yl(e)))}"production"!==process.env.NODE_ENV&&(ql=new Set);var Jl={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Zl=Object.assign({appendTo:kl,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Jl,{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Ql=Object.keys(Zl);function tc(t){var e=(t.plugins||[]).reduce(function(e,n){var r,o=n.name,i=n.defaultValue;o&&(e[o]=void 0!==t[o]?t[o]:null!=(r=Zl[o])?r:i);return e},{});return Object.assign({},t,e)}function ec(t,e){var n=Object.assign({},e,{content:Sl(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(tc(Object.assign({},Zl,{plugins:e}))):Ql).reduce(function(e,n){var r=(t.getAttribute("data-tippy-"+n)||"").trim();if(!r)return e;if("content"===n)e[n]=r;else try{e[n]=JSON.parse(r)}catch(t){e[n]=r}return e},{})}(t,e.plugins));return n.aria=Object.assign({},Zl.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?e.interactive:n.aria.expanded,content:"auto"===n.aria.content?e.interactive?null:"describedby":n.aria.content},n}function nc(t,e){void 0===t&&(t={}),void 0===e&&(e=[]),Object.keys(t).forEach(function(t){var n,r,o=function(t,e){var n=Object.assign({},t);return e.forEach(function(t){delete n[t]}),n}(Zl,Object.keys(Jl)),i=(n=o,r=t,!{}.hasOwnProperty.call(n,r));i&&(i=0===e.filter(function(e){return e.name===t}).length),Kl(i,["`"+t+"`","is not a valid prop. You may have spelled it incorrectly, or if it's","a plugin, forgot to pass it in an array as props.plugins.","\n\n","All props: https://atomiks.github.io/tippyjs/v6/all-props/\n","Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}function rc(t,e){t.innerHTML=e}function oc(t){var e=Tl();return!0===t?e.className=bl:(e.className=xl,Rl(t)?e.appendChild(t):rc(e,t)),e}function ic(t,e){Rl(e.content)?(rc(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?rc(t,e.content):t.textContent=e.content)}function sc(t){var e=t.firstElementChild,n=_l(e.children);return{box:e,content:n.find(function(t){return t.classList.contains(yl)}),arrow:n.find(function(t){return t.classList.contains(bl)||t.classList.contains(xl)}),backdrop:n.find(function(t){return t.classList.contains("tippy-backdrop")})}}function ac(t){var e=Tl(),n=Tl();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=Tl();function o(n,r){var o=sc(e),i=o.box,s=o.content,a=o.arrow;r.theme?i.setAttribute("data-theme",r.theme):i.removeAttribute("data-theme"),"string"==typeof r.animation?i.setAttribute("data-animation",r.animation):i.removeAttribute("data-animation"),r.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?i.setAttribute("role",r.role):i.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||ic(s,t.props),r.arrow?a?n.arrow!==r.arrow&&(i.removeChild(a),i.appendChild(oc(r.arrow))):i.appendChild(oc(r.arrow)):a&&i.removeChild(a)}return r.className=yl,r.setAttribute("data-state","hidden"),ic(r,t.props),e.appendChild(n),n.appendChild(r),o(t.props,t.props),{popper:e,onUpdate:o}}ac.$$tippy=!0;var lc=1,cc=[],uc=[];function dc(t,e){var n,r,o,i,s,a,l,c,u=ec(t,Object.assign({},Zl,tc(Al(e)))),d=!1,p=!1,f=!1,h=!1,m=[],g=Dl(U,u.interactiveDebounce),v=lc++,y=(c=u.plugins).filter(function(t,e){return c.indexOf(t)===e}),b={id:v,reference:t,popper:Tl(),popperInstance:null,props:u,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:y,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(r),cancelAnimationFrame(o)},setProps:function(e){"production"!==process.env.NODE_ENV&&Kl(b.state.isDestroyed,Wl("setProps"));if(b.state.isDestroyed)return;N("onBeforeUpdate",[b,e]),W();var n=b.props,r=ec(t,Object.assign({},n,Al(e),{ignoreAttributes:!0}));b.props=r,V(),n.interactiveDebounce!==r.interactiveDebounce&&(I(),g=Dl(U,r.interactiveDebounce));n.triggerTarget&&!r.triggerTarget?Ml(n.triggerTarget).forEach(function(t){t.removeAttribute("aria-expanded")}):r.triggerTarget&&t.removeAttribute("aria-expanded");L(),R(),k&&k(n,r);b.popperInstance&&(J(),Q().forEach(function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)}));N("onAfterUpdate",[b,e])},setContent:function(t){b.setProps({content:t})},show:function(){"production"!==process.env.NODE_ENV&&Kl(b.state.isDestroyed,Wl("show"));var t=b.state.isVisible,e=b.state.isDestroyed,n=!b.state.isEnabled,r=Fl.isTouch&&!b.props.touch,o=El(b.props.duration,0,Zl.duration);if(t||e||n||r)return;if(O().hasAttribute("disabled"))return;if(N("onShow",[b],!1),!1===b.props.onShow(b))return;b.state.isVisible=!0,M()&&(w.style.visibility="visible");R(),j(),b.state.isMounted||(w.style.transition="none");if(M()){var i=A();Pl([i.box,i.content],0)}a=function(){var t;if(b.state.isVisible&&!h){if(h=!0,w.offsetHeight,w.style.transition=b.props.moveTransition,M()&&b.props.animation){var e=A(),n=e.box,r=e.content;Pl([n,r],o),Ll([n,r],"visible")}P(),L(),Ol(uc,b),null==(t=b.popperInstance)||t.forceUpdate(),N("onMount",[b]),b.props.animation&&M()&&function(t,e){$(t,e)}(o,function(){b.state.isShown=!0,N("onShown",[b])})}},function(){var t,e=b.props.appendTo,n=O();t=b.props.interactive&&e===kl||"parent"===e?n.parentNode:Sl(e,[n]);t.contains(w)||t.appendChild(w);b.state.isMounted=!0,J(),"production"!==process.env.NODE_ENV&&Kl(b.props.interactive&&e===Zl.appendTo&&n.nextElementSibling!==w,["Interactive tippy element may not be accessible via keyboard","navigation because it is not directly after the reference element","in the DOM source order.","\n\n","Using a wrapper <div> or <span> tag around the reference element","solves this by creating a new parentNode context.","\n\n","Specifying `appendTo: document.body` silences this warning, but it","assumes you are using a focus management solution to handle","keyboard navigation.","\n\n","See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity"].join(" "))}()},hide:function(){"production"!==process.env.NODE_ENV&&Kl(b.state.isDestroyed,Wl("hide"));var t=!b.state.isVisible,e=b.state.isDestroyed,n=!b.state.isEnabled,r=El(b.props.duration,1,Zl.duration);if(t||e||n)return;if(N("onHide",[b],!1),!1===b.props.onHide(b))return;b.state.isVisible=!1,b.state.isShown=!1,h=!1,d=!1,M()&&(w.style.visibility="hidden");if(I(),H(),R(!0),M()){var o=A(),i=o.box,s=o.content;b.props.animation&&(Pl([i,s],r),Ll([i,s],"hidden"))}P(),L(),b.props.animation?M()&&function(t,e){$(t,function(){!b.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&e()})}(r,b.unmount):b.unmount()},hideWithInteractivity:function(t){"production"!==process.env.NODE_ENV&&Kl(b.state.isDestroyed,Wl("hideWithInteractivity"));_().addEventListener("mousemove",g),Ol(cc,g),g(t)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){"production"!==process.env.NODE_ENV&&Kl(b.state.isDestroyed,Wl("unmount"));b.state.isVisible&&b.hide();if(!b.state.isMounted)return;Z(),Q().forEach(function(t){t._tippy.unmount()}),w.parentNode&&w.parentNode.removeChild(w);uc=uc.filter(function(t){return t!==b}),b.state.isMounted=!1,N("onHidden",[b])},destroy:function(){"production"!==process.env.NODE_ENV&&Kl(b.state.isDestroyed,Wl("destroy"));if(b.state.isDestroyed)return;b.clearDelayTimeouts(),b.unmount(),W(),delete t._tippy,b.state.isDestroyed=!0,N("onDestroy",[b])}};if(!u.render)return"production"!==process.env.NODE_ENV&&Xl(!0,"render() function has not been supplied."),b;var x=u.render(b),w=x.popper,k=x.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+b.id,b.popper=w,t._tippy=b,w._tippy=b;var E=y.map(function(t){return t.fn(b)}),C=t.hasAttribute("aria-expanded");return V(),L(),R(),N("onCreate",[b]),u.showOnCreate&&tt(),w.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),w.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&_().addEventListener("mousemove",g)}),b;function S(){var t=b.props.touch;return Array.isArray(t)?t:[t,0]}function D(){return"hold"===S()[0]}function M(){var t;return!(null==(t=b.props.render)||!t.$$tippy)}function O(){return l||t}function _(){var t,e,n=O().parentNode;return n?null!=(e=Ml(n)[0])&&null!=(t=e.ownerDocument)&&t.body?e.ownerDocument:document:document}function A(){return sc(w)}function T(t){return b.state.isMounted&&!b.state.isVisible||Fl.isTouch||i&&"focus"===i.type?0:El(b.props.delay,t?0:1,Zl.delay)}function R(t){void 0===t&&(t=!1),w.style.pointerEvents=b.props.interactive&&!t?"":"none",w.style.zIndex=""+b.props.zIndex}function N(t,e,n){var r;(void 0===n&&(n=!0),E.forEach(function(n){n[t]&&n[t].apply(n,e)}),n)&&(r=b.props)[t].apply(r,e)}function P(){var e=b.props.aria;if(e.content){var n="aria-"+e.content,r=w.id;Ml(b.props.triggerTarget||t).forEach(function(t){var e=t.getAttribute(n);if(b.state.isVisible)t.setAttribute(n,e?e+" "+r:r);else{var o=e&&e.replace(r,"").trim();o?t.setAttribute(n,o):t.removeAttribute(n)}})}}function L(){!C&&b.props.aria.expanded&&Ml(b.props.triggerTarget||t).forEach(function(t){b.props.interactive?t.setAttribute("aria-expanded",b.state.isVisible&&t===O()?"true":"false"):t.removeAttribute("aria-expanded")})}function I(){_().removeEventListener("mousemove",g),cc=cc.filter(function(t){return t!==g})}function z(e){if(!Fl.isTouch||!f&&"mousedown"!==e.type){var n=e.composedPath&&e.composedPath()[0]||e.target;if(!b.props.interactive||!zl(w,n)){if(Ml(b.props.triggerTarget||t).some(function(t){return zl(t,n)})){if(Fl.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else N("onClickOutside",[b,e]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),p=!0,setTimeout(function(){p=!1}),b.state.isMounted||H())}}}function F(){f=!0}function B(){f=!1}function j(){var t=_();t.addEventListener("mousedown",z,!0),t.addEventListener("touchend",z,wl),t.addEventListener("touchstart",B,wl),t.addEventListener("touchmove",F,wl)}function H(){var t=_();t.removeEventListener("mousedown",z,!0),t.removeEventListener("touchend",z,wl),t.removeEventListener("touchstart",B,wl),t.removeEventListener("touchmove",F,wl)}function $(t,e){var n=A().box;function r(t){t.target===n&&(Il(n,"remove",r),e())}if(0===t)return e();Il(n,"remove",s),Il(n,"add",r),s=r}function q(e,n,r){void 0===r&&(r=!1),Ml(b.props.triggerTarget||t).forEach(function(t){t.addEventListener(e,n,r),m.push({node:t,eventType:e,handler:n,options:r})})}function V(){var t;D()&&(q("touchstart",G,{passive:!0}),q("touchend",Y,{passive:!0})),(t=b.props.trigger,t.split(/\s+/).filter(Boolean)).forEach(function(t){if("manual"!==t)switch(q(t,G),t){case"mouseenter":q("mouseleave",Y);break;case"focus":q(Vl?"focusout":"blur",K);break;case"focusin":q("focusout",K)}})}function W(){m.forEach(function(t){var e=t.node,n=t.eventType,r=t.handler,o=t.options;e.removeEventListener(n,r,o)}),m=[]}function G(t){var e,n=!1;if(b.state.isEnabled&&!X(t)&&!p){var r="focus"===(null==(e=i)?void 0:e.type);i=t,l=t.currentTarget,L(),!b.state.isVisible&&Cl(t,"MouseEvent")&&cc.forEach(function(e){return e(t)}),"click"===t.type&&(b.props.trigger.indexOf("mouseenter")<0||d)&&!1!==b.props.hideOnClick&&b.state.isVisible?n=!0:tt(t),"click"===t.type&&(d=!n),n&&!r&&et(t)}}function U(t){var e=t.target,n=O().contains(e)||w.contains(e);if("mousemove"!==t.type||!n){var r=Q().concat(w).map(function(t){var e,n=null==(e=t._tippy.popperInstance)?void 0:e.state;return n?{popperRect:t.getBoundingClientRect(),popperState:n,props:u}:null}).filter(Boolean);(function(t,e){var n=e.clientX,r=e.clientY;return t.every(function(t){var e=t.popperRect,o=t.popperState,i=t.props.interactiveBorder,s=o.placement.split("-")[0],a=o.modifiersData.offset;if(!a)return!0;var l="bottom"===s?a.top.y:0,c="top"===s?a.bottom.y:0,u="right"===s?a.left.x:0,d="left"===s?a.right.x:0,p=e.top-r+l>i,f=r-e.bottom-c>i,h=e.left-n+u>i,m=n-e.right-d>i;return p||f||h||m})})(r,t)&&(I(),et(t))}}function Y(t){X(t)||b.props.trigger.indexOf("click")>=0&&d||(b.props.interactive?b.hideWithInteractivity(t):et(t))}function K(t){b.props.trigger.indexOf("focusin")<0&&t.target!==O()||b.props.interactive&&t.relatedTarget&&w.contains(t.relatedTarget)||et(t)}function X(t){return!!Fl.isTouch&&D()!==t.type.indexOf("touch")>=0}function J(){Z();var e=b.props,n=e.popperOptions,r=e.placement,o=e.offset,i=e.getReferenceClientRect,s=e.moveTransition,l=M()?sc(w).arrow:null,c=i?{getBoundingClientRect:i,contextElement:i.contextElement||O()}:t,u={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(M()){var n=A().box;["placement","reference-hidden","escaped"].forEach(function(t){"placement"===t?n.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?n.setAttribute("data-"+t,""):n.removeAttribute("data-"+t)}),e.attributes.popper={}}}},d=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},u];M()&&l&&d.push({name:"arrow",options:{element:l,padding:3}}),d.push.apply(d,(null==n?void 0:n.modifiers)||[]),b.popperInstance=vl(c,w,Object.assign({},n,{placement:r,onFirstUpdate:a,modifiers:d}))}function Z(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Q(){return _l(w.querySelectorAll("[data-tippy-root]"))}function tt(t){b.clearDelayTimeouts(),t&&N("onTrigger",[b,t]),j();var e=T(!0),r=S(),o=r[0],i=r[1];Fl.isTouch&&"hold"===o&&i&&(e=i),e?n=setTimeout(function(){b.show()},e):b.show()}function et(t){if(b.clearDelayTimeouts(),N("onUntrigger",[b,t]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&d)){var e=T(!1);e?r=setTimeout(function(){b.state.isVisible&&b.hide()},e):o=requestAnimationFrame(function(){b.hide()})}}else H()}}function pc(t,e){void 0===e&&(e={});var n=Zl.plugins.concat(e.plugins||[]);"production"!==process.env.NODE_ENV&&(!function(t){var e=!t,n="[object Object]"===Object.prototype.toString.call(t)&&!t.addEventListener;Xl(e,["tippy() was passed","`"+String(t)+"`","as its targets (first) argument. Valid types are: String, Element,","Element[], or NodeList."].join(" ")),Xl(n,["tippy() was passed a plain object which is not supported as an argument","for virtual positioning. Use props.getReferenceClientRect instead."].join(" "))}(t),nc(e,n)),document.addEventListener("touchstart",jl,wl),window.addEventListener("blur",$l);var r=Object.assign({},e,{plugins:n}),o=Nl(t);if("production"!==process.env.NODE_ENV){var i=Rl(r.content),s=o.length>1;Kl(i&&s,["tippy() was passed an Element as the `content` prop, but more than","one tippy instance was created by this invocation. This means the","content element will only be appended to the last tippy instance.","\n\n","Instead, pass the .innerHTML of the element, or use a function that","returns a cloned version of the element instead.","\n\n","1) content: element.innerHTML\n","2) content: () => element.cloneNode(true)"].join(" "))}var a=o.reduce(function(t,e){var n=e&&dc(e,r);return n&&t.push(n),t},[]);return Rl(t)?a[0]:a}pc.defaultProps=Zl,pc.setDefaultProps=function(t){"production"!==process.env.NODE_ENV&&nc(t,[]),Object.keys(t).forEach(function(e){Zl[e]=t[e]})},pc.currentInput=Fl,Object.assign({},ba,{effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow)}}),pc.setDefaultProps({render:ac});class fc{constructor({editor:t,element:e,view:n,tippyOptions:r={},updateDelay:o=250,shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:t,state:e,from:n,to:r})=>{const{doc:o,selection:i}=e,{empty:s}=i,a=!o.textBetween(n,r).length&&ps(e.selection),l=this.element.contains(document.activeElement);return!(!t.hasFocus()&&!l||s||a||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:t})=>{var e;this.preventHide?this.preventHide=!1:(null==t?void 0:t.relatedTarget)&&(null===(e=this.element.parentNode)||void 0===e?void 0:e.contains(t.relatedTarget))||(null==t?void 0:t.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=t=>{this.blurHandler({event:t})},this.handleDebouncedUpdate=(t,e)=>{const n=!(null==e?void 0:e.selection.eq(t.state.selection)),r=!(null==e?void 0:e.doc.eq(t.state.doc));(n||r)&&(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(t,n,r,e)},this.updateDelay))},this.updateHandler=(t,e,n,r)=>{var o,i,s;const{state:a,composing:l}=t,{selection:c}=a;if(l||!e&&!n)return;this.createTooltip();const{ranges:u}=c,d=Math.min(...u.map(t=>t.$from.pos)),p=Math.max(...u.map(t=>t.$to.pos));(null===(o=this.shouldShow)||void 0===o?void 0:o.call(this,{editor:this.editor,element:this.element,view:t,state:a,oldState:r,from:d,to:p}))?(null===(i=this.tippy)||void 0===i||i.setProps({getReferenceClientRect:(null===(s=this.tippyOptions)||void 0===s?void 0:s.getReferenceClientRect)||(()=>{if(Ns(a.selection)){let e=t.nodeDOM(d);if(e){const t=e.dataset.nodeViewWrapper?e:e.querySelector("[data-node-view-wrapper]");if(t&&(e=t.firstChild),e)return e.getBoundingClientRect()}}return function(t,e,n){const r=t.state.doc.content.size,o=fs(e,0,r),i=fs(n,0,r),s=t.coordsAtPos(o),a=t.coordsAtPos(i,-1),l=Math.min(s.top,a.top),c=Math.max(s.bottom,a.bottom),u=Math.min(s.left,a.left),d=Math.max(s.right,a.right),p={top:l,bottom:c,left:u,right:d,width:d-u,height:c-l,x:u,y:l};return{...p,toJSON:()=>p}}(t,d,p)})}),this.show()):this.hide()},this.editor=t,this.element=e,this.view=n,this.updateDelay=o,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,e=!!t.parentElement;!this.tippy&&e&&(this.tippy=pc(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,e){const{state:n}=t,r=n.selection.from!==n.selection.to;if(this.updateDelay>0&&r)return void this.handleDebouncedUpdate(t,e);const o=!(null==e?void 0:e.selection.eq(t.state.selection)),i=!(null==e?void 0:e.doc.eq(t.state.doc));this.updateHandler(t,o,i,e)}show(){var t;null===(t=this.tippy)||void 0===t||t.show()}hide(){var t;null===(t=this.tippy)||void 0===t||t.hide()}destroy(){var t,e;(null===(t=this.tippy)||void 0===t?void 0:t.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null===(e=this.tippy)||void 0===e||e.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const hc=t=>new Se({key:"string"==typeof t.pluginKey?new Oe(t.pluginKey):t.pluginKey,view:e=>new fc({view:e,...t})});function mc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}ns.create({name:"bubbleMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[hc({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});var gc,vc={exports:{}},yc={};var bc,xc={};
/**
   * @license React
   * use-sync-external-store-shim.development.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */"production"===process.env.NODE_ENV?vc.exports=function(){if(gc)return yc;gc=1;var e=t,n="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},r=e.useState,o=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function a(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!n(t,r)}catch(t){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var n=e(),l=r({inst:{value:n,getSnapshot:e}}),c=l[0].inst,u=l[1];return i(function(){c.value=n,c.getSnapshot=e,a(c)&&u({inst:c})},[t,n,e]),o(function(){return a(c)&&u({inst:c}),t(function(){a(c)&&u({inst:c})})},[t]),s(n),n};return yc.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,yc}():vc.exports=(bc||(bc=1,"production"!==process.env.NODE_ENV&&function(){"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=t,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];!function(t,e,r){var o=n.ReactDebugCurrentFrame.getStackAddendum();""!==o&&(e+="%s",r=r.concat([o]));var i=r.map(function(t){return String(t)});i.unshift("Warning: "+e),Function.prototype.apply.call(console[t],console,i)}("error",t,r)}var o="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},i=e.useState,s=e.useEffect,a=e.useLayoutEffect,l=e.useDebugValue,c=!1,u=!1;function d(t){var e=t.getSnapshot,n=t.value;try{var r=e();return!o(n,r)}catch(t){return!0}}var p="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e,n){return e()}:function(t,n,p){c||void 0!==e.startTransition&&(c=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var f=n();if(!u){var h=n();o(f,h)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),u=!0)}var m=i({inst:{value:f,getSnapshot:n}}),g=m[0].inst,v=m[1];return a(function(){g.value=f,g.getSnapshot=n,d(g)&&v({inst:g})},[t,f,n]),s(function(){return d(g)&&v({inst:g}),t(function(){d(g)&&v({inst:g})})},[t]),l(f),f},f=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:p;xc.useSyncExternalStore=f,"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),xc);var wc=vc.exports;const kc=(...t)=>e=>{t.forEach(t=>{"function"==typeof t?t(e):t&&(t.current=e)})},Ec=({contentComponent:e})=>{const n=wc.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return t.createElement(t.Fragment,null,Object.values(n))};class Cc extends t.Component{constructor(e){var n;super(e),this.editorContentRef=t.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:Boolean(null===(n=e.editor)||void 0===n?void 0:n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const t=this.props.editor;if(t&&!t.isDestroyed&&t.options.element){if(t.contentComponent)return;const n=this.editorContentRef.current;n.append(...t.options.element.childNodes),t.setOptions({element:n}),t.contentComponent=function(){const t=new Set;let n={};return{subscribe:e=>(t.add(e),()=>{t.delete(e)}),getSnapshot:()=>n,getServerSnapshot:()=>n,setRenderer(r,o){n={...n,[r]:e.createPortal(o.reactElement,o.element,r)},t.forEach(t=>t())},removeRenderer(e){const r={...n};delete r[e],n=r,t.forEach(t=>t())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(t=>t.hasContentComponentInitialized?t:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const t=this.props.editor;if(!t)return;if(this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null,!t.options.element.firstChild)return;const e=document.createElement("div");e.append(...t.options.element.childNodes),t.setOptions({element:e})}render(){const{editor:e,innerRef:n,...r}=this.props;return t.createElement(t.Fragment,null,t.createElement("div",{ref:kc(n,this.editorContentRef),...r}),(null==e?void 0:e.contentComponent)&&t.createElement(Ec,{contentComponent:e.contentComponent}))}}const Sc=t.forwardRef((e,n)=>{const r=t.useMemo(()=>Math.floor(4294967295*Math.random()).toString(),[e.editor]);return t.createElement(Cc,{key:r,innerRef:n,...e})}),Dc=t.memo(Sc);var Mc,Oc=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,o,i;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(o=r;0!==o--;)if(!t(e[o],n[o]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(o of e.entries())if(!n.has(o[0]))return!1;for(o of e.entries())if(!t(o[1],n.get(o[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(o of e.entries())if(!n.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if((r=e.length)!=n.length)return!1;for(o=r;0!==o--;)if(e[o]!==n[o])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(i=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(o=r;0!==o--;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;0!==o--;){var s=i[o];if(("_owner"!==s||!e.$$typeof)&&!t(e[s],n[s]))return!1}return!0}return e!=e&&n!=n},_c=mc(Oc),Ac={exports:{}},Tc={};var Rc,Nc={};
/**
   * @license React
   * use-sync-external-store-shim/with-selector.development.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */"production"===process.env.NODE_ENV?Ac.exports=function(){if(Mc)return Tc;Mc=1;var e=t,n=wc,r="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},o=n.useSyncExternalStore,i=e.useRef,s=e.useEffect,a=e.useMemo,l=e.useDebugValue;return Tc.useSyncExternalStoreWithSelector=function(t,e,n,c,u){var d=i(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=a(function(){function t(t){if(!s){if(s=!0,o=t,t=c(t),void 0!==u&&p.hasValue){var e=p.value;if(u(e,t))return i=e}return i=t}if(e=i,r(o,t))return e;var n=c(t);return void 0!==u&&u(e,n)?e:(o=t,i=n)}var o,i,s=!1,a=void 0===n?null:n;return[function(){return t(e())},null===a?void 0:function(){return t(a())}]},[e,n,c,u]);var f=o(t,d[0],d[1]);return s(function(){p.hasValue=!0,p.value=f},[f]),l(f),f},Tc}():Ac.exports=(Rc||(Rc=1,"production"!==process.env.NODE_ENV&&function(){"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=t,n=wc,r="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},o=n.useSyncExternalStore,i=e.useRef,s=e.useEffect,a=e.useMemo,l=e.useDebugValue;Nc.useSyncExternalStoreWithSelector=function(t,e,n,c,u){var d,p=i(null);null===p.current?(d={hasValue:!1,value:null},p.current=d):d=p.current;var f=a(function(){var t,o,i=!1,s=function(e){if(!i){i=!0,t=e;var n=c(e);if(void 0!==u&&d.hasValue){var s=d.value;if(u(s,n))return o=s,s}return o=n,n}var a=o;if(r(t,e))return a;var l=c(e);return void 0!==u&&u(a,l)?a:(t=e,o=l,l)},a=void 0===n?null:n;return[function(){return s(e())},null===a?void 0:function(){return s(a())}]},[e,n,c,u]),h=f[0],m=f[1],g=o(t,h,m);return s(function(){d.hasValue=!0,d.value=g},[g]),l(g),g},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Nc);var Pc=Ac.exports;const Lc="undefined"!=typeof window?t.useLayoutEffect:t.useEffect;class Ic{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(t=>t())},e=this.editor;return e.on("transaction",t),()=>{e.off("transaction",t)}}}}const zc="production"!==process.env.NODE_ENV,Fc="undefined"==typeof window,Bc=Fc||Boolean("undefined"!=typeof window&&window.next);class jc{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){if(void 0===this.options.current.immediatelyRender)return Fc||Bc?(zc&&console.warn("Tiptap Error: SSR has been detected, please set `immediatelyRender` explicitly to `false` to avoid hydration mismatches."),null):this.createEditor();if(this.options.current.immediatelyRender&&Fc&&zc)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const t={...this.options.current,onBeforeCreate:(...t)=>{var e,n;return null===(n=(e=this.options.current).onBeforeCreate)||void 0===n?void 0:n.call(e,...t)},onBlur:(...t)=>{var e,n;return null===(n=(e=this.options.current).onBlur)||void 0===n?void 0:n.call(e,...t)},onCreate:(...t)=>{var e,n;return null===(n=(e=this.options.current).onCreate)||void 0===n?void 0:n.call(e,...t)},onDestroy:(...t)=>{var e,n;return null===(n=(e=this.options.current).onDestroy)||void 0===n?void 0:n.call(e,...t)},onFocus:(...t)=>{var e,n;return null===(n=(e=this.options.current).onFocus)||void 0===n?void 0:n.call(e,...t)},onSelectionUpdate:(...t)=>{var e,n;return null===(n=(e=this.options.current).onSelectionUpdate)||void 0===n?void 0:n.call(e,...t)},onTransaction:(...t)=>{var e,n;return null===(n=(e=this.options.current).onTransaction)||void 0===n?void 0:n.call(e,...t)},onUpdate:(...t)=>{var e,n;return null===(n=(e=this.options.current).onUpdate)||void 0===n?void 0:n.call(e,...t)},onContentError:(...t)=>{var e,n;return null===(n=(e=this.options.current).onContentError)||void 0===n?void 0:n.call(e,...t)},onDrop:(...t)=>{var e,n;return null===(n=(e=this.options.current).onDrop)||void 0===n?void 0:n.call(e,...t)},onPaste:(...t)=>{var e,n;return null===(n=(e=this.options.current).onPaste)||void 0===n?void 0:n.call(e,...t)}};return new Ys(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,e){return Object.keys(t).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&t.extensions&&e.extensions?t.extensions.length===e.extensions.length&&t.extensions.every((t,n)=>{var r;return t===(null===(r=e.extensions)||void 0===r?void 0:r[n])}):t[n]===e[n]))}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===t.length?jc.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps)return void(this.previousDeps=t);const e=this.previousDeps.length===t.length&&this.previousDeps.every((e,n)=>e===t[n]);if(e)return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,e=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{this.isComponentMounted&&this.instanceId===t?e&&e.setOptions(this.options.current):e&&!e.isDestroyed&&(e.destroy(),this.instanceId===t&&this.setEditor(null))},1)}}function Hc(e={},n=[]){const r=t.useRef(e);r.current=e;const[o]=t.useState(()=>new jc(r)),i=wc.useSyncExternalStore(o.subscribe,o.getEditor,o.getServerSnapshot);return t.useDebugValue(i),t.useEffect(o.onRender(n)),function(e){var n;const[r]=t.useState(()=>new Ic(e.editor)),o=Pc.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,e.selector,null!==(n=e.equalityFn)&&void 0!==n?n:_c);Lc(()=>r.watch(e.editor),[e.editor,r]),t.useDebugValue(o)}({editor:i,selector:({transactionNumber:t})=>!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===t?0:t+1}),i}const $c=t.createContext({editor:null});$c.Consumer;const qc=e=>{const[n,r]=t.useState(null),{editor:o}=t.useContext($c);return t.useEffect(()=>{var t;if(!n)return;if((null===(t=e.editor)||void 0===t?void 0:t.isDestroyed)||(null==o?void 0:o.isDestroyed))return;const{pluginKey:r="bubbleMenu",editor:i,tippyOptions:s={},updateDelay:a,shouldShow:l=null}=e,c=i||o;if(!c)return void console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");const u=hc({updateDelay:a,editor:c,element:n,pluginKey:r,shouldShow:l,tippyOptions:s});return c.registerPlugin(u),()=>{c.unregisterPlugin(r)}},[e.editor,o,n]),t.createElement("div",{ref:r,className:e.className,style:{visibility:"hidden"}},e.children)},Vc=t.createContext({onDragStart:void 0});function Wc(t){return!("function"!=typeof t||!t.prototype||!t.prototype.isReactComponent)}function Gc(t){return!("object"!=typeof t||!t.$$typeof||"Symbol(react.forward_ref)"!==t.$$typeof.toString()&&"react.forward_ref"!==t.$$typeof.description)}t.forwardRef((e,n)=>{const{onDragStart:r}=t.useContext(Vc),o=e.as||"div";return t.createElement(o,{...e,ref:n,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...e.style}})});class Uc{constructor(t,{editor:n,props:r={},as:o="div",className:i=""}){this.ref=null,this.id=Math.floor(4294967295*Math.random()).toString(),this.component=t,this.editor=n,this.props=r,this.element=document.createElement(o),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?e.flushSync(()=>{this.render()}):this.render()}render(){var e;const n=this.component,r=this.props,o=this.editor,i=function(){try{if(t.version)return parseInt(t.version.split(".")[0],10)>=19}catch{}return!1}(),s=function(t){if(Wc(t))return!0;if(Gc(t))return!0;if(function(t){return!("object"!=typeof t||!t.$$typeof||"Symbol(react.memo)"!==t.$$typeof.toString()&&"react.memo"!==t.$$typeof.description)}(t)){const e=t.type;if(e)return Wc(e)||Gc(e)}return!1}(n),a={...r};!a.ref||i||s||delete a.ref,a.ref||!i&&!s||(a.ref=t=>{this.ref=t}),this.reactElement=t.createElement(n,{...a}),null===(e=null==o?void 0:o.contentComponent)||void 0===e||e.setRenderer(this.id,this)}updateProps(t={}){this.props={...this.props,...t},this.render()}destroy(){var t;const e=this.editor;null===(t=null==e?void 0:e.contentComponent)||void 0===t||t.removeRenderer(this.id)}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}}!function(t,{insertAt:e}={}){if("undefined"==typeof document)return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===e&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}('html[dir=ltr],[data-sonner-toaster][dir=ltr]{--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}html[dir=rtl],[data-sonner-toaster][dir=rtl]{--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}[data-sonner-toaster][data-x-position=right]{right:max(var(--offset),env(safe-area-inset-right))}[data-sonner-toaster][data-x-position=left]{left:max(var(--offset),env(safe-area-inset-left))}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translate(-50%)}[data-sonner-toaster][data-y-position=top]{top:max(var(--offset),env(safe-area-inset-top))}[data-sonner-toaster][data-y-position=bottom]{bottom:max(var(--offset),env(safe-area-inset-bottom))}[data-sonner-toast]{--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;will-change:transform,opacity,height;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast][data-y-position=top]{top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}[data-sonner-toast] [data-description]{font-weight:400;line-height:1.4;color:inherit}[data-sonner-toast] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast] [data-icon]>*{flex-shrink:0}[data-sonner-toast] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;transition:opacity .4s,box-shadow .2s}[data-sonner-toast] [data-button]:focus-visible{box-shadow:0 0 0 2px #0006}[data-sonner-toast] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast] [data-cancel]{color:var(--color);background:var(--border-color)}[data-sonner-toast] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;opacity:0;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast]:hover [data-close-button]{opacity:1}[data-sonner-toast]:focus [data-close-button]{opacity:1}[data-sonner-toast]:focus-within [data-close-button]{opacity:1}[data-sonner-toast]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]:before{content:"";position:absolute;left:0;right:0;height:100%}[data-sonner-toast][data-y-position=top][data-swiping=true]:before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]:before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]:before{content:"";position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]:after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y: translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y: translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]:before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - 32px)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true] [data-sonner-toast][data-type=success],[data-rich-colors=true] [data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true] [data-sonner-toast][data-type=error],[data-rich-colors=true] [data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}\n'),Array(12).fill(0),t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},t.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},t.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}));var Yc=0,Kc=new class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...r}=t,o="number"==typeof(null==t?void 0:t.id)||(null==(e=t.id)?void 0:e.length)>0?t.id:Yc++,i=this.toasts.find(t=>t.id===o),s=void 0===t.dismissible||t.dismissible;return i?this.toasts=this.toasts.map(e=>e.id===o?(this.publish({...e,...t,id:o,title:n}),{...e,...t,id:o,dismissible:s,title:n}):e):this.addToast({title:n,...r,dismissible:s,id:o}),o},this.dismiss=t=>(t||this.toasts.forEach(t=>{this.subscribers.forEach(e=>e({id:t.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{let n=this.create({...e,promise:t,type:"loading",message:e.loading});return(t instanceof Promise?t:t()).then(t=>{let r="function"==typeof e.success?e.success(t):e.success;this.create({id:n,type:"success",message:r})}).catch(t=>{let r="function"==typeof e.error?e.error(t):e.error;this.create({id:n,type:"error",message:r})}).finally(e.finally),n},this.custom=(t,e)=>{let n=(null==e?void 0:e.id)||Yc++;this.publish({jsx:t(n),id:n,...e})},this.subscribers=[],this.toasts=[]}},Xc=(t,e)=>{let n=(null==e?void 0:e.id)||Yc++;return Kc.addToast({title:t,...e,id:n}),n},Jc=Object.assign(Xc,{success:Kc.success,error:Kc.error,custom:Kc.custom,message:Kc.message,promise:Kc.promise,dismiss:Kc.dismiss,loading:Kc.loading});const Zc=new Oe("upload-image"),Qc=()=>new Se({key:Zc,state:{init:()=>go.empty,apply(t,e){e=e.map(t.mapping,t.doc);const n=t.getMeta(this);if(n&&n.add){const{id:r,pos:o,src:i}=n.add,s=document.createElement("div");s.setAttribute("class","img-placeholder");const a=document.createElement("img");a.setAttribute("class","opacity-40 rounded-lg border border-stone-200"),a.src=i,s.appendChild(a);const l=fo.widget(o+1,s,{id:r});e=e.add(t.doc,[l])}else n&&n.remove&&(e=e.remove(e.find(null,null,t=>t.id==n.remove.id)));return e}},props:{decorations(t){return this.getState(t)}}});function tu(t,e){const n=Zc.getState(t).find(null,null,t=>t.id==e);return n.length?n[0].from:null}function eu(t,e,n,r){if(!t.type.includes("image/"))return void Jc.error("File type not supported.");if(t.size/1024/1024>20)return void Jc.error("File size too big (max 20MB).");const o={},i=e.state.tr;i.selection.empty||i.deleteSelection();const s=new FileReader;s.readAsDataURL(t),s.onload=()=>{i.setMeta(Zc,{add:{id:o,pos:n,src:s.result}}),e.dispatch(i)},r?nu(t,r).then(t=>{const{schema:n}=e.state;let r=tu(e.state,o);if(null==r)return;const i=t,s=n.nodes.image.create({src:i}),a=e.state.tr.replaceWith(r,r,s).setMeta(Zc,{remove:{id:o}});e.dispatch(a)}):ru(t).then(t=>{const{schema:n}=e.state;let r=tu(e.state,o);if(null==r)return;const i="object"==typeof t?s.result:t,a=n.nodes.image.create({src:i}),l=e.state.tr.replaceWith(r,r,a).setMeta(Zc,{remove:{id:o}});e.dispatch(l)})}const nu=(t,e)=>new Promise(n=>{Jc.promise(e(t).then(t=>{if("string"==typeof t){let e=new Image;e.src=t,e.onload=()=>{n(t)}}}),{loading:"Uploading image...",success:"Image uploaded successfully.",error:t=>t.message})}),ru=t=>new Promise(e=>{Jc.promise(fetch("/api/upload",{method:"POST",headers:{"content-type":(null==t?void 0:t.type)||"application/octet-stream","x-vercel-filename":(null==t?void 0:t.name)||"image.png"},body:t}).then(async n=>{if(200!==n.status)throw 401===n.status?(e(t),new Error("`BLOB_READ_WRITE_TOKEN` environment variable not found, reading image locally instead.")):new Error("Error uploading image. Please try again.");{const{url:t}=await n.json();let r=new Image;r.src=t,r.onload=()=>{e(t)}}}),{loading:"Uploading image...",success:"Image uploaded successfully.",error:t=>t.message})}),ou={attributes:{class:"novel-prose-lg novel-prose-stone dark:novel-prose-invert prose-headings:novel-font-title novel-font-default focus:novel-outline-none novel-max-w-full"},handleDOMEvents:{keydown:(t,e)=>{if(["ArrowUp","ArrowDown","Enter"].includes(e.key)){if(document.querySelector("#slash-command"))return!0}}},handlePaste:(t,e)=>{if(e.clipboardData&&e.clipboardData.files&&e.clipboardData.files[0]){e.preventDefault();return eu(e.clipboardData.files[0],t,t.state.selection.from),!0}return!1},handleDrop:(t,e,n,r)=>{if(!r&&e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files[0]){e.preventDefault();const n=e.dataTransfer.files[0],r=t.posAtCoords({left:e.clientX,top:e.clientY});return eu(n,t,(null==r?void 0:r.pos)||-1),!0}return!1}},iu=/^\s*>\s$/,su=Qs.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:t}){return["blockquote",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Zs({find:iu,type:this.type})]}}),au=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,lu=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,cu=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,uu=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,du=Xi.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ks({find:au,type:this.type}),Ks({find:cu,type:this.type})]},addPasteRules(){return[ta({find:lu,type:this.type}),ta({find:uu,type:this.type})]}}),pu="textStyle",fu=/^\s*([-+*])\s$/,hu=Qs.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:t}){return["ul",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(pu)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Zs({find:fu,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Zs({find:fu,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(pu),editor:this.editor})),[t]}}),mu=/(^|[^`])`([^`]+)`(?!`)/,gu=/(^|[^`])`([^`]+)`(?!`)/g,vu=Xi.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:t}){return["code",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ks({find:mu,type:this.type})]},addPasteRules(){return[ta({find:gu,type:this.type})]}}),yu=/^```([a-z]+)?[\s\n]$/,bu=/^~~~([a-z]+)?[\s\n]$/,xu=Qs.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,r=[...(null===(e=t.firstElementChild)||void 0===e?void 0:e.classList)||[]].filter(t=>t.startsWith(n)).map(t=>t.replace(n,""))[0];return r||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:t,HTMLAttributes:e}){return["pre",Li(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=1===e.pos;return!(!t||e.parent.type.name!==this.name)&&(!(!n&&e.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith("\n\n");return!(!i||!s)&&t.chain().command(({tr:t})=>(t.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:o,empty:i}=n;if(!i||o.parent.type!==this.type)return!1;if(!(o.parentOffset===o.parent.nodeSize-2))return!1;const s=o.after();if(void 0===s)return!1;return r.nodeAt(s)?t.commands.command(({tr:t})=>(t.setSelection(se.near(r.resolve(s))),!0)):t.commands.exitCode()}}},addInputRules(){return[Js({find:yu,type:this.type,getAttributes:t=>({language:t[1]})}),Js({find:bu,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Se({key:new Oe("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=null==o?void 0:o.mode;if(!n||!i)return!1;const{tr:s,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,"\n"));return s.replaceSelectionWith(this.type.create({language:i},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(ue.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),wu=Qs.create({name:"doc",topNode:!0,content:"block+"});function ku(t={}){return new Se({view:e=>new Eu(e,t)})}class Eu{constructor(t,e){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=e.width)&&void 0!==n?n:1,this.color=!1===e.color?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(e=>{let n=t=>{this[e](t)};return t.dom.addEventListener(e,n),{name:e,handler:n}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t,e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r=this.editorView.dom,o=r.getBoundingClientRect(),i=o.width/r.offsetWidth,s=o.height/r.offsetHeight;if(n){let n=e.nodeBefore,r=e.nodeAfter;if(n||r){let e=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(e){let o=e.getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let a=this.width/2*s;t={left:o.left,right:o.right,top:i-a,bottom:i+a}}}}if(!t){let e=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*i;t={left:e.left-n,right:e.left+n,top:e.top,bottom:e.bottom}}let a,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)a=-pageXOffset,l=-pageYOffset;else{let t=c.getBoundingClientRect(),e=t.width/c.offsetWidth,n=t.height/c.offsetHeight;a=t.left-c.scrollLeft*e,l=t.top-c.scrollTop*n}this.element.style.left=(t.left-a)/i+"px",this.element.style.top=(t.top-l)/s+"px",this.element.style.width=(t.right-t.left)/i+"px",this.element.style.height=(t.bottom-t.top)/s+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,e,t):r;if(e&&!o){let t=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let e=qt(this.editorView.state.doc,t,this.editorView.dragging.slice);null!=e&&(t=e)}this.setCursor(t),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}const Cu=ns.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[ku(this.options)]}});class Su extends se{constructor(t){super(t,t)}map(t,e){let n=t.resolve(e.map(this.head));return Su.valid(n)?new Su(n):se.near(n)}content(){return h.empty}eq(t){return t instanceof Su&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new Su(t.resolve(e.pos))}getBookmark(){return new Du(this.anchor)}static valid(t){let e=t.parent;if(e.isTextblock||!function(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(0!=n)for(let t=r.child(n-1);;t=t.lastChild){if(0==t.childCount&&!t.inlineContent||t.isAtom||t.type.spec.isolating)return!0;if(t.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(t)||!function(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(let t=r.child(n);;t=t.firstChild){if(0==t.childCount&&!t.inlineContent||t.isAtom||t.type.spec.isolating)return!0;if(t.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(t))return!1;let n=e.type.spec.allowGapCursor;if(null!=n)return n;let r=e.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(t,e,n=!1){t:for(;;){if(!n&&Su.valid(t))return t;let r=t.pos,o=null;for(let n=t.depth;;n--){let i=t.node(n);if(e>0?t.indexAfter(n)<i.childCount:t.index(n)>0){o=i.child(e>0?t.indexAfter(n):t.index(n)-1);break}if(0==n)return null;r+=e;let s=t.doc.resolve(r);if(Su.valid(s))return s}for(;;){let i=e>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!pe.isSelectable(o)){t=t.doc.resolve(r+o.nodeSize*e),n=!1;continue t}break}o=i,r+=e;let s=t.doc.resolve(r);if(Su.valid(s))return s}return null}}}Su.prototype.visible=!1,Su.findFrom=Su.findGapCursorFrom,se.jsonID("gapcursor",Su);class Du{constructor(t){this.pos=t}map(t){return new Du(t.map(this.pos))}resolve(t){let e=t.resolve(this.pos);return Su.valid(e)?new Su(e):se.near(e)}}const Mu=ri({ArrowLeft:Ou("horiz",-1),ArrowRight:Ou("horiz",1),ArrowUp:Ou("vert",-1),ArrowDown:Ou("vert",1)});function Ou(t,e){const n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,r,o){let i=t.selection,s=e>0?i.$to:i.$from,a=i.empty;if(i instanceof ue){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=t.doc.resolve(e>0?s.after():s.before())}let l=Su.findGapCursorFrom(s,e,a);return!!l&&(r&&r(t.tr.setSelection(new Su(l))),!0)}}function _u(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Su.valid(r))return!1;let o=t.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&pe.isSelectable(t.state.doc.nodeAt(o.inside)))&&(t.dispatch(t.state.tr.setSelection(new Su(r))),!0)}function Au(t,e){if("insertCompositionText"!=e.inputType||!(t.state.selection instanceof Su))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let o=l.empty;for(let t=r.length-1;t>=0;t--)o=l.from(r[t].createAndFill(null,o));let i=t.state.tr.replace(n.pos,n.pos,new h(o,0,0));return i.setSelection(ue.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function Tu(t){if(!(t.selection instanceof Su))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",go.create(t.doc,[fo.widget(t.selection.head,e,{key:"gapcursor"})])}const Ru=ns.create({name:"gapCursor",addProseMirrorPlugins:()=>[new Se({props:{decorations:Tu,createSelectionBetween:(t,e,n)=>e.pos==n.pos&&Su.valid(n)?new Su(n):null,handleClick:_u,handleKeyDown:Mu,handleDOMEvents:{beforeinput:Au}}})],extendNodeSchema(t){var e;return{allowGapCursor:null!==(e=Fi(Ti(t,"allowGapCursor",{name:t.name,options:t.options,storage:t.storage})))&&void 0!==e?e:null}}}),Nu=Qs.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:t}){return["br",Li(this.options.HTMLAttributes,t)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:t,storedMarks:o}=n;if(t.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:s}=r.extensionManager,a=o||t.$to.parentOffset&&t.$from.marks();return e().insertContent({type:this.name}).command(({tr:t,dispatch:e})=>{if(e&&a&&i){const e=a.filter(t=>s.includes(t.type.name));t.ensureMarks(e)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Pu=Qs.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Li(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.setNode(this.name,t),toggleHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Js({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var Lu=200,Iu=function(){};Iu.prototype.append=function(t){return t.length?(t=Iu.from(t),!this.length&&t||t.length<Lu&&this.leafAppend(t)||this.length<Lu&&t.leafPrepend(this)||this.appendInner(t)):this},Iu.prototype.prepend=function(t){return t.length?Iu.from(t).append(this):this},Iu.prototype.appendInner=function(t){return new Fu(this,t)},Iu.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?Iu.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},Iu.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},Iu.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},Iu.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(e,n){return r.push(t(e,n))},e,n),r},Iu.from=function(t){return t instanceof Iu?t:t&&t.length?new zu(t):Iu.empty};var zu=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var o=e;o<n;o++)if(!1===t(this.values[o],r+o))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var o=e-1;o>=n;o--)if(!1===t(this.values[o],r+o))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=Lu)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=Lu)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Iu);Iu.empty=new zu([]);var Fu=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(e>o&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0)},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(Iu);class Bu{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(0==this.eventCount)return null;let n,r,o=this.items.length;for(;;o--){if(this.items.get(o-1).selection){--o;break}}e&&(n=this.remapping(o,this.items.length),r=n.maps.length);let i,s,a=t.tr,l=[],c=[];return this.items.forEach((t,e)=>{if(!t.step)return n||(n=this.remapping(o,e+1),r=n.maps.length),r--,void c.push(t);if(n){c.push(new ju(t.map));let e,o=t.step.map(n.slice(r));o&&a.maybeStep(o).doc&&(e=a.mapping.maps[a.mapping.maps.length-1],l.push(new ju(e,void 0,void 0,l.length+c.length))),r--,e&&n.appendMap(e,r)}else a.maybeStep(t.step);return t.selection?(i=n?t.selection.map(n.slice(r)):t.selection,s=new Bu(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:s,transform:a,selection:i}}addTransform(t,e,n,r){let o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null;for(let n=0;n<t.steps.length;n++){let l,c=t.steps[n].invert(t.docs[n]),u=new ju(t.mapping.maps[n],c,e);(l=a&&a.merge(u))&&(u=l,n?o.pop():s=s.slice(0,s.length-1)),o.push(u),e&&(i++,e=void 0),r||(a=u)}let l=i-n.depth;return l>$u&&(s=function(t,e){let n;return t.forEach((t,r)=>{if(t.selection&&0==e--)return n=r,!1}),t.slice(n)}(s,l),i-=l),new Bu(s.append(o),i)}remapping(t,e){let n=new xt;return this.items.forEach((e,r)=>{let o=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:void 0;n.appendMap(e.map,o)},t,e),n}addMaps(t){return 0==this.eventCount?this:new Bu(this.items.append(t.map(t=>new ju(t))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-e),o=t.mapping,i=t.steps.length,s=this.eventCount;this.items.forEach(t=>{t.selection&&s--},r);let a=e;this.items.forEach(e=>{let r=o.getMirror(--a);if(null==r)return;i=Math.min(i,r);let l=o.maps[r];if(e.step){let i=t.steps[r].invert(t.docs[r]),c=e.selection&&e.selection.map(o.slice(a+1,r));c&&s++,n.push(new ju(l,i,c))}else n.push(new ju(l))},r);let l=[];for(let t=e;t<i;t++)l.push(new ju(o.maps[t]));let c=this.items.slice(0,r).append(l).append(n),u=new Bu(c,s);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),n=e.maps.length,r=[],o=0;return this.items.forEach((i,s)=>{if(s>=t)r.push(i),i.selection&&o++;else if(i.step){let t=i.step.map(e.slice(n)),s=t&&t.getMap();if(n--,s&&e.appendMap(s,n),t){let a=i.selection&&i.selection.map(e.slice(n));a&&o++;let l,c=new ju(s.invert(),t,a),u=r.length-1;(l=r.length&&r[u].merge(c))?r[u]=l:r.push(c)}}else i.map&&n--},this.items.length,0),new Bu(Iu.from(r.reverse()),o)}}Bu.empty=new Bu(Iu.empty,0);class ju{constructor(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new ju(e.getMap().invert(),e,this.selection)}}}class Hu{constructor(t,e,n,r,o){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}const $u=20;function qu(t){let e=[];for(let n=t.length-1;n>=0&&0==e.length;n--)t[n].forEach((t,n,r,o)=>e.push(r,o));return e}function Vu(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let o=e.map(t[r],1),i=e.map(t[r+1],-1);o<=i&&n.push(o,i)}return n}let Wu=!1,Gu=null;function Uu(t){let e=t.plugins;if(Gu!=e){Wu=!1,Gu=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Wu=!0;break}}return Wu}const Yu=new Oe("history"),Ku=new Oe("closeHistory");function Xu(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Se({key:Yu,state:{init:()=>new Hu(Bu.empty,Bu.empty,null,0,-1),apply:(e,n,r)=>function(t,e,n,r){let o,i=n.getMeta(Yu);if(i)return i.historyState;n.getMeta(Ku)&&(t=new Hu(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(s&&s.getMeta(Yu))return s.getMeta(Yu).redo?new Hu(t.done.addTransform(n,void 0,r,Uu(e)),t.undone,qu(n.mapping.maps),t.prevTime,t.prevComposition):new Hu(t.done,t.undone.addTransform(n,void 0,r,Uu(e)),null,t.prevTime,t.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new Hu(t.done.rebased(n,o),t.undone.rebased(n,o),Vu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Hu(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Vu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition);{let o=n.getMeta("composition"),i=0==t.prevTime||!s&&t.prevComposition!=o&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((t,r)=>{for(let o=0;o<e.length;o+=2)t<=e[o+1]&&r>=e[o]&&(n=!0)}),n}(n,t.prevRanges)),a=s?Vu(t.prevRanges,n.mapping):qu(n.mapping.maps);return new Hu(t.done.addTransform(n,i?e.selection.getBookmark():void 0,r,Uu(e)),Bu.empty,a,n.time,null==o?t.prevComposition:o)}}(n,r,e,t)},config:t,props:{handleDOMEvents:{beforeinput(t,e){let n=e.inputType,r="historyUndo"==n?Zu:"historyRedo"==n?Qu:null;return!!r&&(e.preventDefault(),r(t.state,t.dispatch))}}}})}function Ju(t,e){return(n,r)=>{let o=Yu.getState(n);if(!o||0==(t?o.undone:o.done).eventCount)return!1;if(r){let i=function(t,e,n){let r=Uu(e),o=Yu.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),a=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),o,r),l=new Hu(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(s).setMeta(Yu,{redo:n,historyState:l})}(o,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const Zu=Ju(!1,!0),Qu=Ju(!0,!0),td=ns.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:t,dispatch:e})=>Zu(t,e),redo:()=>({state:t,dispatch:e})=>Qu(t,e)}),addProseMirrorPlugins(){return[Xu(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),ed=Qs.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:t}){return["hr",Li(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!function(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof pe){const t=r.index();return r.parent.canReplaceWith(t,t+1,e)}let o=r.depth;for(;o>=0;){const t=r.index(o);if(r.node(o).contentMatchAt(t).matchType(e))return!0;o-=1}return!1}(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:r,$to:o}=n,i=t();return 0===r.parentOffset?i.insertContentAt({from:Math.max(r.pos-1,0),to:o.pos},{type:this.name}):Ns(n)?i.insertContentAt(o.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:t,dispatch:e})=>{var n;if(e){const{$to:e}=t.selection,r=e.end();if(e.nodeAfter)e.nodeAfter.isTextblock?t.setSelection(ue.create(t.doc,e.pos+1)):e.nodeAfter.isBlock?t.setSelection(pe.create(t.doc,e.pos)):t.setSelection(ue.create(t.doc,e.pos));else{const o=null===(n=e.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();o&&(t.insert(r,o),t.setSelection(ue.create(t.doc,r+1)))}t.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Xs({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),nd=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,rd=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,od=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,id=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,sd=Xi.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ks({find:nd,type:this.type}),Ks({find:od,type:this.type})]},addPasteRules(){return[ta({find:rd,type:this.type}),ta({find:id,type:this.type})]}}),ad=Qs.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",Li(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ld="textStyle",cd=/^(\d+)\.\s$/,ud=Qs.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return 1===e?["ol",Li(this.options.HTMLAttributes,n),0]:["ol",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(ld)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Zs({find:cd,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Zs({find:cd,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(ld)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[t]}}),dd=Qs.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),pd=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,fd=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,hd=Xi.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}],renderHTML({HTMLAttributes:t}){return["s",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ks({find:pd,type:this.type})]},addPasteRules(){return[ta({find:fd,type:this.type})]}}),md=Qs.create({name:"text",group:"inline"}),gd=ns.create({name:"starterKit",addExtensions(){const t=[];return!1!==this.options.bold&&t.push(du.configure(this.options.bold)),!1!==this.options.blockquote&&t.push(su.configure(this.options.blockquote)),!1!==this.options.bulletList&&t.push(hu.configure(this.options.bulletList)),!1!==this.options.code&&t.push(vu.configure(this.options.code)),!1!==this.options.codeBlock&&t.push(xu.configure(this.options.codeBlock)),!1!==this.options.document&&t.push(wu.configure(this.options.document)),!1!==this.options.dropcursor&&t.push(Cu.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&t.push(Ru.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&t.push(Nu.configure(this.options.hardBreak)),!1!==this.options.heading&&t.push(Pu.configure(this.options.heading)),!1!==this.options.history&&t.push(td.configure(this.options.history)),!1!==this.options.horizontalRule&&t.push(ed.configure(this.options.horizontalRule)),!1!==this.options.italic&&t.push(sd.configure(this.options.italic)),!1!==this.options.listItem&&t.push(ad.configure(this.options.listItem)),!1!==this.options.orderedList&&t.push(ud.configure(this.options.orderedList)),!1!==this.options.paragraph&&t.push(dd.configure(this.options.paragraph)),!1!==this.options.strike&&t.push(hd.configure(this.options.strike)),!1!==this.options.text&&t.push(md.configure(this.options.text)),t}}),vd=(t,e)=>{for(const n in e)t[n]=e[n];return t},yd="numeric",bd="ascii",xd="alpha",wd="asciinumeric",kd="alphanumeric",Ed="domain",Cd="emoji",Sd="scheme",Dd="slashscheme",Md="whitespace";function Od(t,e){return t in e||(e[t]=[]),e[t]}function _d(t,e,n){e[yd]&&(e[wd]=!0,e[kd]=!0),e[bd]&&(e[wd]=!0,e[xd]=!0),e[wd]&&(e[kd]=!0),e[xd]&&(e[kd]=!0),e[kd]&&(e[Ed]=!0),e[Cd]&&(e[Ed]=!0);for(const r in e){const e=Od(r,n);e.indexOf(t)<0&&e.push(t)}}function Ad(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}Ad.groups={},Ad.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let n=0;n<e.jr.length;n++){const r=e.jr[n][0],o=e.jr[n][1];if(o&&r.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let o=0;o<t.length;o++)this.tt(t[o],e,n,r)},tr(t,e,n,r){let o;return r=r||Ad.groups,e&&e.j?o=e:(o=new Ad(e),n&&r&&_d(e,n,r)),this.jr.push([t,o]),o},ts(t,e,n,r){let o=this;const i=t.length;if(!i)return o;for(let e=0;e<i-1;e++)o=o.tt(t[e]);return o.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||Ad.groups;const o=this;if(e&&e.j)return o.j[t]=e,e;const i=e;let s,a=o.go(t);if(a?(s=new Ad,vd(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Ad,i){if(r)if(s.t&&"string"==typeof s.t){const t=vd(function(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}(s.t,r),n);_d(i,t,r)}else n&&_d(i,n,r);s.t=i}return o.j[t]=s,s}};const Td=(t,e,n,r,o)=>t.ta(e,n,r,o),Rd=(t,e,n,r,o)=>t.tr(e,n,r,o),Nd=(t,e,n,r,o)=>t.ts(e,n,r,o),Pd=(t,e,n,r,o)=>t.tt(e,n,r,o),Ld="WORD",Id="UWORD",zd="ASCIINUMERICAL",Fd="ALPHANUMERICAL",Bd="LOCALHOST",jd="TLD",Hd="UTLD",$d="SCHEME",qd="SLASH_SCHEME",Vd="NUM",Wd="WS",Gd="NL",Ud="OPENBRACE",Yd="CLOSEBRACE",Kd="OPENBRACKET",Xd="CLOSEBRACKET",Jd="OPENPAREN",Zd="CLOSEPAREN",Qd="OPENANGLEBRACKET",tp="CLOSEANGLEBRACKET",ep="FULLWIDTHLEFTPAREN",np="FULLWIDTHRIGHTPAREN",rp="LEFTCORNERBRACKET",op="RIGHTCORNERBRACKET",ip="LEFTWHITECORNERBRACKET",sp="RIGHTWHITECORNERBRACKET",ap="FULLWIDTHLESSTHAN",lp="FULLWIDTHGREATERTHAN",cp="AMPERSAND",up="APOSTROPHE",dp="ASTERISK",pp="AT",fp="BACKSLASH",hp="BACKTICK",mp="CARET",gp="COLON",vp="COMMA",yp="DOLLAR",bp="DOT",xp="EQUALS",wp="EXCLAMATION",kp="HYPHEN",Ep="PERCENT",Cp="PIPE",Sp="PLUS",Dp="POUND",Mp="QUERY",Op="QUOTE",_p="FULLWIDTHMIDDLEDOT",Ap="SEMI",Tp="SLASH",Rp="TILDE",Np="UNDERSCORE",Pp="EMOJI",Lp="SYM";var Ip=Object.freeze({__proto__:null,ALPHANUMERICAL:Fd,AMPERSAND:cp,APOSTROPHE:up,ASCIINUMERICAL:zd,ASTERISK:dp,AT:pp,BACKSLASH:fp,BACKTICK:hp,CARET:mp,CLOSEANGLEBRACKET:tp,CLOSEBRACE:Yd,CLOSEBRACKET:Xd,CLOSEPAREN:Zd,COLON:gp,COMMA:vp,DOLLAR:yp,DOT:bp,EMOJI:Pp,EQUALS:xp,EXCLAMATION:wp,FULLWIDTHGREATERTHAN:lp,FULLWIDTHLEFTPAREN:ep,FULLWIDTHLESSTHAN:ap,FULLWIDTHMIDDLEDOT:_p,FULLWIDTHRIGHTPAREN:np,HYPHEN:kp,LEFTCORNERBRACKET:rp,LEFTWHITECORNERBRACKET:ip,LOCALHOST:Bd,NL:Gd,NUM:Vd,OPENANGLEBRACKET:Qd,OPENBRACE:Ud,OPENBRACKET:Kd,OPENPAREN:Jd,PERCENT:Ep,PIPE:Cp,PLUS:Sp,POUND:Dp,QUERY:Mp,QUOTE:Op,RIGHTCORNERBRACKET:op,RIGHTWHITECORNERBRACKET:sp,SCHEME:$d,SEMI:Ap,SLASH:Tp,SLASH_SCHEME:qd,SYM:Lp,TILDE:Rp,TLD:jd,UNDERSCORE:Np,UTLD:Hd,UWORD:Id,WORD:Ld,WS:Wd});const zp=/[a-z]/,Fp=/\p{L}/u,Bp=/\p{Emoji}/u,jp=/\d/,Hp=/\s/;let $p=null,qp=null;function Vp(t,e){const n=function(t){const e=[],n=t.length;let r=0;for(;r<n;){let o,i=t.charCodeAt(r),s=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(s),r+=s.length}return e}(e.replace(/[A-Z]/g,t=>t.toLowerCase())),r=n.length,o=[];let i=0,s=0;for(;s<r;){let a=t,l=null,c=0,u=null,d=-1,p=-1;for(;s<r&&(l=a.go(n[s]));)a=l,a.accepts()?(d=0,p=0,u=a):d>=0&&(d+=n[s].length,p++),c+=n[s].length,i+=n[s].length,s++;i-=d,s-=p,c-=d,o.push({t:u.t,v:e.slice(i-c,i),s:i-c,e:i})}return o}function Wp(t,e,n,r,o){let i;const s=e.length;for(let n=0;n<s-1;n++){const s=e[n];t.j[s]?i=t.j[s]:(i=new Ad(r),i.jr=o.slice(),t.j[s]=i),t=i}return i=new Ad(n),i.jr=o.slice(),t.j[e[s-1]]=i,i}function Gp(t){const e=[],n=[];let r=0;for(;r<t.length;){let o=0;for(;"0123456789".indexOf(t[r+o])>=0;)o++;if(o>0){e.push(n.join(""));for(let e=parseInt(t.substring(r,r+o),10);e>0;e--)n.pop();r+=o}else n.push(t[r]),r++}return e}const Up={defaultProtocol:"http",events:null,format:Kp,formatHref:Kp,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Yp(t,e=null){let n=vd({},Up);t&&(n=vd(n,t instanceof Yp?t.o:t));const r=n.ignoreTags,o=[];for(let t=0;t<r.length;t++)o.push(r[t].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=o}function Kp(t){return t}function Xp(t,e){this.t="token",this.v=t,this.tk=e}function Jp(t,e){class n extends Xp{constructor(e,n){super(e,n),this.t=t}}for(const t in e)n.prototype[t]=e[t];return n.t=t,n}Yp.prototype={o:Up,ignoreTags:[],defaultRender:t=>t,check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=null!=e;let o=this.o[t];return o?("object"==typeof o?(o=n.t in o?o[n.t]:Up[t],"function"==typeof o&&r&&(o=o(e,n))):"function"==typeof o&&r&&(o=o(e,n.t,n)),o):o},getObj(t,e,n){let r=this.o[t];return"function"==typeof r&&null!=e&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}},Xp.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Up.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),o=t.get("tagName",n,e),i=this.toFormattedString(t),s={},a=t.get("className",n,e),l=t.get("target",n,e),c=t.get("rel",n,e),u=t.getObj("attributes",n,e),d=t.getObj("events",n,e);return s.href=r,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),u&&vd(s,u),{tagName:o,attributes:s,content:i,eventListeners:d}}};const Zp=Jp("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Qp=Jp("text"),tf=Jp("nl"),ef=Jp("url",{isLink:!0,toHref(t=Up.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Bd&&t[1].t===gp}}),nf=t=>new Ad(t);function rf(t,e,n){const r=n[0].s,o=n[n.length-1].e;return new t(e.slice(r,o),n)}const of="undefined"!=typeof console&&console&&console.warn||(()=>{}),sf={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function af(t,e=!1){if(sf.initialized&&of(`linkifyjs: already initialized - will not register custom scheme "${t}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');sf.customSchemes.push([t,e])}function lf(){sf.scanner=function(t=[]){const e={};Ad.groups=e;const n=new Ad;null==$p&&($p=Gp("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==qp&&(qp=Gp("121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222")),Pd(n,"'",up),Pd(n,"{",Ud),Pd(n,"}",Yd),Pd(n,"[",Kd),Pd(n,"]",Xd),Pd(n,"(",Jd),Pd(n,")",Zd),Pd(n,"<",Qd),Pd(n,">",tp),Pd(n,"",ep),Pd(n,"",np),Pd(n,"",rp),Pd(n,"",op),Pd(n,"",ip),Pd(n,"",sp),Pd(n,"",ap),Pd(n,"",lp),Pd(n,"&",cp),Pd(n,"*",dp),Pd(n,"@",pp),Pd(n,"`",hp),Pd(n,"^",mp),Pd(n,":",gp),Pd(n,",",vp),Pd(n,"$",yp),Pd(n,".",bp),Pd(n,"=",xp),Pd(n,"!",wp),Pd(n,"-",kp),Pd(n,"%",Ep),Pd(n,"|",Cp),Pd(n,"+",Sp),Pd(n,"#",Dp),Pd(n,"?",Mp),Pd(n,'"',Op),Pd(n,"/",Tp),Pd(n,";",Ap),Pd(n,"~",Rp),Pd(n,"_",Np),Pd(n,"\\",fp),Pd(n,"",_p);const r=Rd(n,jp,Vd,{[yd]:!0});Rd(r,jp,r);const o=Rd(r,zp,zd,{[wd]:!0}),i=Rd(r,Fp,Fd,{[kd]:!0}),s=Rd(n,zp,Ld,{[bd]:!0});Rd(s,jp,o),Rd(s,zp,s),Rd(o,jp,o),Rd(o,zp,o);const a=Rd(n,Fp,Id,{[xd]:!0});Rd(a,zp),Rd(a,jp,i),Rd(a,Fp,a),Rd(i,jp,i),Rd(i,zp),Rd(i,Fp,i);const l=Pd(n,"\n",Gd,{[Md]:!0}),c=Pd(n,"\r",Wd,{[Md]:!0}),u=Rd(n,Hp,Wd,{[Md]:!0});Pd(n,"",u),Pd(c,"\n",l),Pd(c,"",u),Rd(c,Hp,u),Pd(u,"\r"),Pd(u,"\n"),Rd(u,Hp,u),Pd(u,"",u);const d=Rd(n,Bp,Pp,{[Cd]:!0});Pd(d,"#"),Rd(d,Bp,d),Pd(d,"",d);const p=Pd(d,"");Pd(p,"#"),Rd(p,Bp,d);const f=[[zp,s],[jp,o]],h=[[zp,null],[Fp,a],[jp,i]];for(let t=0;t<$p.length;t++)Wp(n,$p[t],jd,Ld,f);for(let t=0;t<qp.length;t++)Wp(n,qp[t],Hd,Id,h);_d(jd,{tld:!0,ascii:!0},e),_d(Hd,{utld:!0,alpha:!0},e),Wp(n,"file",$d,Ld,f),Wp(n,"mailto",$d,Ld,f),Wp(n,"http",qd,Ld,f),Wp(n,"https",qd,Ld,f),Wp(n,"ftp",qd,Ld,f),Wp(n,"ftps",qd,Ld,f),_d($d,{scheme:!0,ascii:!0},e),_d(qd,{slashscheme:!0,ascii:!0},e),t=t.sort((t,e)=>t[0]>e[0]?1:-1);for(let e=0;e<t.length;e++){const r=t[e][0],o=t[e][1]?{[Sd]:!0}:{[Dd]:!0};r.indexOf("-")>=0?o[Ed]=!0:zp.test(r)?jp.test(r)?o[wd]=!0:o[bd]=!0:o[yd]=!0,Nd(n,r,r,o)}return Nd(n,"localhost",Bd,{ascii:!0}),n.jd=new Ad(Lp),{start:n,tokens:vd({groups:e},Ip)}}(sf.customSchemes);for(let t=0;t<sf.tokenQueue.length;t++)sf.tokenQueue[t][1]({scanner:sf.scanner});sf.parser=function({groups:t}){const e=t.domain.concat([cp,dp,pp,fp,hp,mp,yp,xp,kp,Vd,Ep,Cp,Sp,Dp,Tp,Lp,Rp,Np]),n=[up,gp,vp,bp,wp,Ep,Mp,Op,Ap,Qd,tp,Ud,Yd,Xd,Kd,Jd,Zd,ep,np,rp,op,ip,sp,ap,lp],r=[cp,up,dp,fp,hp,mp,yp,xp,kp,Ud,Yd,Ep,Cp,Sp,Dp,Mp,Tp,Lp,Rp,Np],o=nf(),i=Pd(o,Rp);Td(i,r,i),Td(i,t.domain,i);const s=nf(),a=nf(),l=nf();Td(o,t.domain,s),Td(o,t.scheme,a),Td(o,t.slashscheme,l),Td(s,r,i),Td(s,t.domain,s);const c=Pd(s,pp);Pd(i,pp,c),Pd(a,pp,c),Pd(l,pp,c);const u=Pd(i,bp);Td(u,r,i),Td(u,t.domain,i);const d=nf();Td(c,t.domain,d),Td(d,t.domain,d);const p=Pd(d,bp);Td(p,t.domain,d);const f=nf(Zp);Td(p,t.tld,f),Td(p,t.utld,f),Pd(c,Bd,f);const h=Pd(d,kp);Pd(h,kp,h),Td(h,t.domain,d),Td(f,t.domain,d),Pd(f,bp,p),Pd(f,kp,h);const m=Pd(f,gp);Td(m,t.numeric,Zp);const g=Pd(s,kp),v=Pd(s,bp);Pd(g,kp,g),Td(g,t.domain,s),Td(v,r,i),Td(v,t.domain,s);const y=nf(ef);Td(v,t.tld,y),Td(v,t.utld,y),Td(y,t.domain,s),Td(y,r,i),Pd(y,bp,v),Pd(y,kp,g),Pd(y,pp,c);const b=Pd(y,gp),x=nf(ef);Td(b,t.numeric,x);const w=nf(ef),k=nf();Td(w,e,w),Td(w,n,k),Td(k,e,w),Td(k,n,k),Pd(y,Tp,w),Pd(x,Tp,w);const E=Pd(a,gp),C=Pd(l,gp),S=Pd(C,Tp),D=Pd(S,Tp);Td(a,t.domain,s),Pd(a,bp,v),Pd(a,kp,g),Td(l,t.domain,s),Pd(l,bp,v),Pd(l,kp,g),Td(E,t.domain,w),Pd(E,Tp,w),Pd(E,Mp,w),Td(D,t.domain,w),Td(D,e,w),Pd(D,Tp,w);const M=[[Ud,Yd],[Kd,Xd],[Jd,Zd],[Qd,tp],[ep,np],[rp,op],[ip,sp],[ap,lp]];for(let t=0;t<M.length;t++){const[r,o]=M[t],i=Pd(w,r);Pd(k,r,i),Pd(i,o,w);const s=nf(ef);Td(i,e,s);const a=nf();Td(i,n),Td(s,e,s),Td(s,n,a),Td(a,e,s),Td(a,n,a),Pd(s,o,w),Pd(a,o,w)}return Pd(o,Bd,y),Pd(o,Gd,tf),{start:o,tokens:Ip}}(sf.scanner.tokens);for(let t=0;t<sf.pluginQueue.length;t++)sf.pluginQueue[t][1]({scanner:sf.scanner,parser:sf.parser});return sf.initialized=!0,sf}function cf(t){return sf.initialized||lf(),function(t,e,n){let r=n.length,o=0,i=[],s=[];for(;o<r;){let a=t,l=null,c=null,u=0,d=null,p=-1;for(;o<r&&!(l=a.go(n[o].t));)s.push(n[o++]);for(;o<r&&(c=l||a.go(n[o].t));)l=null,a=c,a.accepts()?(p=0,d=a):p>=0&&p++,o++,u++;if(p<0)o-=u,o<r&&(s.push(n[o]),o++);else{s.length>0&&(i.push(rf(Qp,e,s)),s=[]),o-=p,u-=p;const t=d.t,r=n.slice(o-u,o);i.push(rf(t,e,r))}}return s.length>0&&i.push(rf(Qp,e,s)),i}(sf.parser.start,t,Vp(sf.scanner.start,t))}function uf(t,e=null,n=null){if(e&&"object"==typeof e){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Yp(n),o=cf(t),i=[];for(let t=0;t<o.length;t++){const n=o[t];!n.isLink||e&&n.t!==e||!r.check(n)||i.push(n.toFormattedObject(r))}return i}function df(t){return new Se({key:new Oe("autolink"),appendTransaction:(e,n,r)=>{const o=e.some(t=>t.docChanged)&&!n.doc.eq(r.doc),i=e.some(t=>t.getMeta("preventAutolink"));if(!o||i)return;const{tr:s}=r,a=function(t,e){const n=new oe(t);return e.forEach(t=>{t.steps.forEach(t=>{n.step(t)})}),n}(n.doc,[...e]),l=function(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((t,o)=>{const i=[];if(t.ranges.length)t.forEach((t,e)=>{i.push({from:t,to:e})});else{const{from:t,to:e}=n[o];if(void 0===t||void 0===e)return;i.push({from:t,to:e})}i.forEach(({from:t,to:n})=>{const i=e.slice(o).map(t,-1),s=e.slice(o).map(n),a=e.invert().map(i,-1),l=e.invert().map(s);r.push({oldRange:{from:a,to:l},newRange:{from:i,to:s}})})}),Ms(r)}(a);return l.forEach(({newRange:e})=>{const n=function(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(t,e)=>{n(t)&&r.push({node:t,pos:e})}),r}(r.doc,e,t=>t.isTextblock);let o,i;if(n.length>1?(o=n[0],i=r.doc.textBetween(o.pos,o.pos+o.node.nodeSize,void 0," ")):n.length&&r.doc.textBetween(e.from,e.to," "," ").endsWith(" ")&&(o=n[0],i=r.doc.textBetween(o.pos,e.to,void 0," ")),o&&i){const e=i.split(" ").filter(t=>""!==t);if(e.length<=0)return!1;const n=e[e.length-1],l=o.pos+i.lastIndexOf(n);if(!n)return!1;const c=cf(n).map(e=>e.toObject(t.defaultProtocol));if(!(1===(a=c).length?a[0].isLink:3===a.length&&a[1].isLink&&["()","[]"].includes(a[0].value+a[2].value)))return!1;c.filter(t=>t.isLink).map(t=>({...t,from:l+t.start+1,to:l+t.end+1})).filter(t=>!r.schema.marks.code||!r.doc.rangeHasMark(t.from,t.to,r.schema.marks.code)).filter(e=>t.validate(e.value)).filter(e=>t.shouldAutoLink(e.value)).forEach(e=>{Os(e.from,e.to,r.doc).some(e=>e.mark.type===t.type)||s.addMark(e.from,e.to,t.type.create({href:e.href}))})}var a}),s.steps.length?s:void 0}})}cf.scan=Vp;const pf=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function ff(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(t=>{const e="string"==typeof t?t:t.scheme;e&&n.push(e)}),!t||t.replace(pf,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const hf=Xi.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{"string"!=typeof t?af(t.scheme,t.optionalSlashes):af(t)})},onDestroy(){Ad.groups={},sf.scanner=null,sf.parser=null,sf.tokenQueue=[],sf.pluginQueue=[],sf.customSchemes=[],sf.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!ff(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}),addAttributes(){return{href:{default:null,parseHTML:t=>t.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!(!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!ff(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:t=>!!ff(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Li(this.options.HTMLAttributes,t),0]:["a",Li(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return!!this.options.isAllowedUri(n,{defaultValidate:t=>!!ff(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&e().setMark(this.name,t).setMeta("preventAutolink",!0).run()},toggleLink:t=>({chain:e})=>{const{href:n}=t;return!!this.options.isAllowedUri(n,{defaultValidate:t=>!!ff(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[ta({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,o=uf(t).filter(t=>t.isLink&&this.options.isAllowedUri(t.value,{defaultValidate:t=>!!ff(t,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(t=>e.push({text:t.value,data:{href:t.href},index:t.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:null===(e=t.data)||void 0===e?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(df({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:t=>this.options.isAllowedUri(t,{defaultValidate:t=>!!ff(t,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),!0===this.options.openOnClick&&t.push(function(t){return new Se({key:new Oe("handleClickLink"),props:{handleClick:(e,n,r)=>{var o,i;if(0!==r.button)return!1;if(!e.editable)return!1;let s=r.target;const a=[];for(;"DIV"!==s.nodeName;)a.push(s),s=s.parentNode;if(!a.find(t=>"A"===t.nodeName))return!1;const l=Ds(e.state,t.type.name),c=r.target,u=null!==(o=null==c?void 0:c.href)&&void 0!==o?o:l.href,d=null!==(i=null==c?void 0:c.target)&&void 0!==i?i:l.target;return!(!c||!u||(window.open(u,d),0))}}})}({type:this.type})),this.options.linkOnPaste&&t.push(function(t){return new Se({key:new Oe("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{state:o}=e,{selection:i}=o,{empty:s}=i;if(s)return!1;let a="";r.content.forEach(t=>{a+=t.textContent});const l=uf(a,{defaultProtocol:t.defaultProtocol}).find(t=>t.isLink&&t.value===a);return!(!a||!l)&&t.editor.commands.setMark(t.type,{href:l.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),t}}),mf=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,gf=Qs.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",Li(this.options.HTMLAttributes,t)]},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[Xs({find:mf,type:this.type,getAttributes:t=>{const[,,e,n,r]=t;return{src:n,alt:e,title:r}}})]}}),vf=ns.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new Se({key:new Oe("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,o=[];if(!n)return null;const i=t.type.createAndFill(),s=(null==i?void 0:i.sameMarkup(t))&&null===i.content.findDiffStart(t.content);return t.descendants((t,e)=>{const n=r>=e&&r<=e+t.nodeSize,i=!t.isLeaf&&!t.childCount;if((n||!this.options.showOnlyCurrent)&&i){const r=[this.options.emptyNodeClass];s&&r.push(this.options.emptyEditorClass);const i=fo.node(e,e+t.nodeSize,{class:r.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:t,pos:e,hasAnchor:n}):this.options.placeholder});o.push(i)}return this.options.includeChildren}),go.create(t,o)}}})]}}),yf=Xi.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("underline")&&{}}],renderHTML({HTMLAttributes:t}){return["u",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),bf=Xi.create({name:"textStyle",priority:101,addOptions:()=>({HTMLAttributes:{},mergeNestedSpanStyles:!1}),parseHTML(){return[{tag:"span",getAttrs:t=>!!t.hasAttribute("style")&&(this.options.mergeNestedSpanStyles&&(t=>{if(!t.children.length)return;const e=t.querySelectorAll("span");e&&e.forEach(t=>{var e,n;const r=t.getAttribute("style"),o=null===(n=null===(e=t.parentElement)||void 0===e?void 0:e.closest("span"))||void 0===n?void 0:n.getAttribute("style");t.setAttribute("style",`${o};${r}`)})})(t),{})}]},renderHTML({HTMLAttributes:t}){return["span",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(e,n)=>{if(e.isTextblock)return!0;e.marks.filter(t=>t.type===this.type).some(t=>Object.values(t.attrs).some(t=>!!t))||t.removeMark(n,n+e.nodeSize,this.type)}),!0}}}}),xf=ns.create({name:"color",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;return null===(e=t.style.color)||void 0===e?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands:()=>({setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()})}),wf=/^\s*(\[([( |x])?\])\s$/,kf=Qs.create({name:"taskItem",addOptions:()=>({nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}),content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:()=>({checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return""===e||"true"===e},renderHTML:t=>({"data-checked":t.checked})}}),parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Li(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const o=document.createElement("li"),i=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div");return i.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",t=>t.preventDefault()),a.addEventListener("change",e=>{if(!r.isEditable&&!this.options.onReadOnlyChecked)return void(a.checked=!a.checked);const{checked:o}=e.target;r.isEditable&&"function"==typeof n&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:t})=>{const e=n();if("number"!=typeof e)return!1;const r=t.doc.nodeAt(e);return t.setNodeMarkup(e,void 0,{...null==r?void 0:r.attrs,checked:o}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,o)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([t,e])=>{o.setAttribute(t,e)}),o.dataset.checked=t.attrs.checked,a.checked=t.attrs.checked,i.append(a,s),o.append(i,l),Object.entries(e).forEach(([t,e])=>{o.setAttribute(t,e)}),{dom:o,contentDOM:l,update:t=>t.type===this.type&&(o.dataset.checked=t.attrs.checked,a.checked=t.attrs.checked,!0)}}},addInputRules(){return[Zs({find:wf,type:this.type,getAttributes:t=>({checked:"x"===t[t.length-1]})})]}}),Ef=Qs.create({name:"taskList",addOptions:()=>({itemTypeName:"taskItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Li(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),Cf={};function Sf(t,e){"string"!=typeof e&&(e=Sf.defaultChars);const n=function(t){let e=Cf[t];if(e)return e;e=Cf[t]=[];for(let t=0;t<128;t++){const n=String.fromCharCode(t);e.push(n)}for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(t){let e="";for(let r=0,o=t.length;r<o;r+=3){const i=parseInt(t.slice(r+1,r+3),16);if(i<128)e+=n[i];else{if(192==(224&i)&&r+3<o){const n=parseInt(t.slice(r+4,r+6),16);if(128==(192&n)){const t=i<<6&1984|63&n;e+=t<128?"":String.fromCharCode(t),r+=3;continue}}if(224==(240&i)&&r+6<o){const n=parseInt(t.slice(r+4,r+6),16),o=parseInt(t.slice(r+7,r+9),16);if(128==(192&n)&&128==(192&o)){const t=i<<12&61440|n<<6&4032|63&o;e+=t<2048||t>=55296&&t<=57343?"":String.fromCharCode(t),r+=6;continue}}if(240==(248&i)&&r+9<o){const n=parseInt(t.slice(r+4,r+6),16),o=parseInt(t.slice(r+7,r+9),16),s=parseInt(t.slice(r+10,r+12),16);if(128==(192&n)&&128==(192&o)&&128==(192&s)){let t=i<<18&1835008|n<<12&258048|o<<6&4032|63&s;t<65536||t>1114111?e+="":(t-=65536,e+=String.fromCharCode(55296+(t>>10),56320+(1023&t))),r+=9;continue}}e+=""}}return e})}Sf.defaultChars=";/?:@&=+$,#",Sf.componentChars="";const Df={};function Mf(t,e,n){"string"!=typeof e&&(n=e,e=Mf.defaultChars),void 0===n&&(n=!0);const r=function(t){let e=Df[t];if(e)return e;e=Df[t]=[];for(let t=0;t<128;t++){const n=String.fromCharCode(t);/^[0-9a-z]$/i.test(n)?e.push(n):e.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<t.length;n++)e[t.charCodeAt(n)]=t[n];return e}(e);let o="";for(let e=0,i=t.length;e<i;e++){const s=t.charCodeAt(e);if(n&&37===s&&e+2<i&&/^[0-9a-f]{2}$/i.test(t.slice(e+1,e+3)))o+=t.slice(e,e+3),e+=2;else if(s<128)o+=r[s];else if(s>=55296&&s<=57343){if(s>=55296&&s<=56319&&e+1<i){const n=t.charCodeAt(e+1);if(n>=56320&&n<=57343){o+=encodeURIComponent(t[e]+t[e+1]),e++;continue}}o+="%EF%BF%BD"}else o+=encodeURIComponent(t[e])}return o}function Of(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&-1!==t.hostname.indexOf(":")?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function _f(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}Mf.defaultChars=";/?:@&=+$,-_.!~*'()#",Mf.componentChars="-_.!~*'()";const Af=/^([a-z0-9.+-]+:)/i,Tf=/:[0-9]*$/,Rf=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Nf=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Pf=["'"].concat(Nf),Lf=["%","/","?",";","#"].concat(Pf),If=["/","?","#"],zf=/^[+a-z0-9A-Z_-]{0,63}$/,Ff=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Bf={javascript:!0,"javascript:":!0},jf={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Hf(t,e){if(t&&t instanceof _f)return t;const n=new _f;return n.parse(t,e),n}_f.prototype.parse=function(t,e){let n,r,o,i=t;if(i=i.trim(),!e&&1===t.split("#").length){const t=Rf.exec(i);if(t)return this.pathname=t[1],t[2]&&(this.search=t[2]),this}let s=Af.exec(i);if(s&&(s=s[0],n=s.toLowerCase(),this.protocol=s,i=i.substr(s.length)),(e||s||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(o="//"===i.substr(0,2),!o||s&&Bf[s]||(i=i.substr(2),this.slashes=!0)),!Bf[s]&&(o||s&&!jf[s])){let t,e,n=-1;for(let t=0;t<If.length;t++)r=i.indexOf(If[t]),-1!==r&&(-1===n||r<n)&&(n=r);e=-1===n?i.lastIndexOf("@"):i.lastIndexOf("@",n),-1!==e&&(t=i.slice(0,e),i=i.slice(e+1),this.auth=t),n=-1;for(let t=0;t<Lf.length;t++)r=i.indexOf(Lf[t]),-1!==r&&(-1===n||r<n)&&(n=r);-1===n&&(n=i.length),":"===i[n-1]&&n--;const o=i.slice(0,n);i=i.slice(n),this.parseHost(o),this.hostname=this.hostname||"";const s="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!s){const t=this.hostname.split(/\./);for(let e=0,n=t.length;e<n;e++){const n=t[e];if(n&&!n.match(zf)){let r="";for(let t=0,e=n.length;t<e;t++)n.charCodeAt(t)>127?r+="x":r+=n[t];if(!r.match(zf)){const r=t.slice(0,e),o=t.slice(e+1),s=n.match(Ff);s&&(r.push(s[1]),o.unshift(s[2])),o.length&&(i=o.join(".")+i),this.hostname=r.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),s&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=i.indexOf("#");-1!==a&&(this.hash=i.substr(a),i=i.slice(0,a));const l=i.indexOf("?");return-1!==l&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),jf[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this},_f.prototype.parseHost=function(t){let e=Tf.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var $f,qf=Object.freeze({__proto__:null,decode:Sf,encode:Mf,format:Of,parse:Hf}),Vf=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Wf=/[\0-\x1F\x7F-\x9F]/,Gf=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,Uf=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,Yf=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Kf=Object.freeze({__proto__:null,Any:Vf,Cc:Wf,Cf:/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,P:Gf,S:Uf,Z:Yf}),Xf=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),Jf=new Uint16Array("aglq\t\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));const Zf=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Qf=null!==($f=String.fromCodePoint)&&void 0!==$f?$f:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+=String.fromCharCode(t),e};var th;!function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"}(th||(th={}));var eh,nh,rh;function oh(t){return t>=th.ZERO&&t<=th.NINE}function ih(t){return t>=th.UPPER_A&&t<=th.UPPER_F||t>=th.LOWER_A&&t<=th.LOWER_F}function sh(t){return t===th.EQUALS||function(t){return t>=th.UPPER_A&&t<=th.UPPER_Z||t>=th.LOWER_A&&t<=th.LOWER_Z||oh(t)}(t)}!function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"}(eh||(eh={})),function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"}(nh||(nh={})),function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"}(rh||(rh={}));class ah{constructor(t,e,n){this.decodeTree=t,this.emitCodePoint=e,this.errors=n,this.state=nh.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=rh.Strict}startEntity(t){this.decodeMode=t,this.state=nh.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,e){switch(this.state){case nh.EntityStart:return t.charCodeAt(e)===th.NUM?(this.state=nh.NumericStart,this.consumed+=1,this.stateNumericStart(t,e+1)):(this.state=nh.NamedEntity,this.stateNamedEntity(t,e));case nh.NumericStart:return this.stateNumericStart(t,e);case nh.NumericDecimal:return this.stateNumericDecimal(t,e);case nh.NumericHex:return this.stateNumericHex(t,e);case nh.NamedEntity:return this.stateNamedEntity(t,e)}}stateNumericStart(t,e){return e>=t.length?-1:(32|t.charCodeAt(e))===th.LOWER_X?(this.state=nh.NumericHex,this.consumed+=1,this.stateNumericHex(t,e+1)):(this.state=nh.NumericDecimal,this.stateNumericDecimal(t,e))}addToNumericResult(t,e,n,r){if(e!==n){const o=n-e;this.result=this.result*Math.pow(r,o)+parseInt(t.substr(e,o),r),this.consumed+=o}}stateNumericHex(t,e){const n=e;for(;e<t.length;){const r=t.charCodeAt(e);if(!oh(r)&&!ih(r))return this.addToNumericResult(t,n,e,16),this.emitNumericEntity(r,3);e+=1}return this.addToNumericResult(t,n,e,16),-1}stateNumericDecimal(t,e){const n=e;for(;e<t.length;){const r=t.charCodeAt(e);if(!oh(r))return this.addToNumericResult(t,n,e,10),this.emitNumericEntity(r,2);e+=1}return this.addToNumericResult(t,n,e,10),-1}emitNumericEntity(t,e){var n;if(this.consumed<=e)return null===(n=this.errors)||void 0===n||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===th.SEMI)this.consumed+=1;else if(this.decodeMode===rh.Strict)return 0;return this.emitCodePoint(function(t){var e;return t>=55296&&t<=57343||t>1114111?65533:null!==(e=Zf.get(t))&&void 0!==e?e:t}(this.result),this.consumed),this.errors&&(t!==th.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,e){const{decodeTree:n}=this;let r=n[this.treeIndex],o=(r&eh.VALUE_LENGTH)>>14;for(;e<t.length;e++,this.excess++){const i=t.charCodeAt(e);if(this.treeIndex=ch(n,r,this.treeIndex+Math.max(1,o),i),this.treeIndex<0)return 0===this.result||this.decodeMode===rh.Attribute&&(0===o||sh(i))?0:this.emitNotTerminatedNamedEntity();if(r=n[this.treeIndex],o=(r&eh.VALUE_LENGTH)>>14,0!==o){if(i===th.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==rh.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:e,decodeTree:n}=this,r=(n[e]&eh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,r,this.consumed),null===(t=this.errors)||void 0===t||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,e,n){const{decodeTree:r}=this;return this.emitCodePoint(1===e?r[t]&~eh.VALUE_LENGTH:r[t+1],n),3===e&&this.emitCodePoint(r[t+2],n),n}end(){var t;switch(this.state){case nh.NamedEntity:return 0===this.result||this.decodeMode===rh.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case nh.NumericDecimal:return this.emitNumericEntity(0,2);case nh.NumericHex:return this.emitNumericEntity(0,3);case nh.NumericStart:return null===(t=this.errors)||void 0===t||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case nh.EntityStart:return 0}}}function lh(t){let e="";const n=new ah(t,t=>e+=Qf(t));return function(t,r){let o=0,i=0;for(;(i=t.indexOf("&",i))>=0;){e+=t.slice(o,i),n.startEntity(r);const s=n.write(t,i+1);if(s<0){o=i+n.end();break}o=i+s,i=0===s?o+1:o}const s=e+t.slice(o);return e="",s}}function ch(t,e,n,r){const o=(e&eh.BRANCH_LENGTH)>>7,i=e&eh.JUMP_TABLE;if(0===o)return 0!==i&&r===i?n:-1;if(i){const e=r-i;return e<0||e>=o?-1:t[n+e]-1}let s=n,a=s+o-1;for(;s<=a;){const e=s+a>>>1,n=t[e];if(n<r)s=e+1;else{if(!(n>r))return t[e+o];a=e-1}}return-1}const uh=lh(Xf);function dh(t,e=rh.Legacy){return uh(t,e)}function ph(t){return"[object String]"===function(t){return Object.prototype.toString.call(t)}(t)}lh(Jf);const fh=Object.prototype.hasOwnProperty;function hh(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){if(e){if("object"!=typeof e)throw new TypeError(e+"must be object");Object.keys(e).forEach(function(n){t[n]=e[n]})}}),t}function mh(t,e,n){return[].concat(t.slice(0,e),n,t.slice(e+1))}function gh(t){return!(t>=55296&&t<=57343)&&(!(t>=64976&&t<=65007)&&(!!(65535&~t&&65534!=(65535&t))&&(!(t>=0&&t<=8)&&(11!==t&&(!(t>=14&&t<=31)&&(!(t>=127&&t<=159)&&!(t>1114111)))))))}function vh(t){if(t>65535){const e=55296+((t-=65536)>>10),n=56320+(1023&t);return String.fromCharCode(e,n)}return String.fromCharCode(t)}const yh=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,bh=new RegExp(yh.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),xh=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function wh(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(bh,function(t,e,n){return e||function(t,e){if(35===e.charCodeAt(0)&&xh.test(e)){const n="x"===e[1].toLowerCase()?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return gh(n)?vh(n):t}const n=dh(t);return n!==t?n:t}(t,n)})}const kh=/[&<>"]/,Eh=/[&<>"]/g,Ch={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function Sh(t){return Ch[t]}function Dh(t){return kh.test(t)?t.replace(Eh,Sh):t}const Mh=/[.?*+^$[\]\\(){}|-]/g;function Oh(t){switch(t){case 9:case 32:return!0}return!1}function _h(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Ah(t){return Gf.test(t)||Uf.test(t)}function Th(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function Rh(t){return t=t.trim().replace(/\s+/g," "),""==="".toLowerCase()&&(t=t.replace(//g,"")),t.toLowerCase().toUpperCase()}const Nh={mdurl:qf,ucmicro:Kf};var Ph=Object.freeze({__proto__:null,arrayReplaceAt:mh,assign:hh,escapeHtml:Dh,escapeRE:function(t){return t.replace(Mh,"\\$&")},fromCodePoint:vh,has:function(t,e){return fh.call(t,e)},isMdAsciiPunct:Th,isPunctChar:Ah,isSpace:Oh,isString:ph,isValidEntityCode:gh,isWhiteSpace:_h,lib:Nh,normalizeReference:Rh,unescapeAll:wh,unescapeMd:function(t){return t.indexOf("\\")<0?t:t.replace(yh,"$1")}});var Lh=Object.freeze({__proto__:null,parseLinkDestination:function(t,e,n){let r,o=e;const i={ok:!1,pos:0,str:""};if(60===t.charCodeAt(o)){for(o++;o<n;){if(r=t.charCodeAt(o),10===r)return i;if(60===r)return i;if(62===r)return i.pos=o+1,i.str=wh(t.slice(e+1,o)),i.ok=!0,i;92===r&&o+1<n?o+=2:o++}return i}let s=0;for(;o<n&&(r=t.charCodeAt(o),32!==r)&&!(r<32||127===r);)if(92===r&&o+1<n){if(32===t.charCodeAt(o+1))break;o+=2}else{if(40===r&&(s++,s>32))return i;if(41===r){if(0===s)break;s--}o++}return e===o||0!==s||(i.str=wh(t.slice(e,o)),i.pos=o,i.ok=!0),i},parseLinkLabel:function(t,e,n){let r,o,i,s;const a=t.posMax,l=t.pos;for(t.pos=e+1,r=1;t.pos<a;){if(i=t.src.charCodeAt(t.pos),93===i&&(r--,0===r)){o=!0;break}if(s=t.pos,t.md.inline.skipToken(t),91===i)if(s===t.pos-1)r++;else if(n)return t.pos=l,-1}let c=-1;return o&&(c=t.pos),t.pos=l,c},parseLinkTitle:function(t,e,n,r){let o,i=e;const s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(i>=n)return s;let r=t.charCodeAt(i);if(34!==r&&39!==r&&40!==r)return s;e++,i++,40===r&&(r=41),s.marker=r}for(;i<n;){if(o=t.charCodeAt(i),o===s.marker)return s.pos=i+1,s.str+=wh(t.slice(e,i)),s.ok=!0,s;if(40===o&&41===s.marker)return s;92===o&&i+1<n&&i++,i++}return s.can_continue=!0,s.str+=wh(t.slice(e,i)),s}});const Ih={};function zh(){this.rules=hh({},Ih)}function Fh(){this.__rules__=[],this.__cache__=null}function Bh(t,e,n){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}function jh(t,e,n){this.src=t,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=e}Ih.code_inline=function(t,e,n,r,o){const i=t[e];return"<code"+o.renderAttrs(i)+">"+Dh(i.content)+"</code>"},Ih.code_block=function(t,e,n,r,o){const i=t[e];return"<pre"+o.renderAttrs(i)+"><code>"+Dh(t[e].content)+"</code></pre>\n"},Ih.fence=function(t,e,n,r,o){const i=t[e],s=i.info?wh(i.info).trim():"";let a,l="",c="";if(s){const t=s.split(/(\s+)/g);l=t[0],c=t.slice(2).join("")}if(a=n.highlight&&n.highlight(i.content,l,c)||Dh(i.content),0===a.indexOf("<pre"))return a+"\n";if(s){const t=i.attrIndex("class"),e=i.attrs?i.attrs.slice():[];t<0?e.push(["class",n.langPrefix+l]):(e[t]=e[t].slice(),e[t][1]+=" "+n.langPrefix+l);const r={attrs:e};return`<pre><code${o.renderAttrs(r)}>${a}</code></pre>\n`}return`<pre><code${o.renderAttrs(i)}>${a}</code></pre>\n`},Ih.image=function(t,e,n,r,o){const i=t[e];return i.attrs[i.attrIndex("alt")][1]=o.renderInlineAsText(i.children,n,r),o.renderToken(t,e,n)},Ih.hardbreak=function(t,e,n){return n.xhtmlOut?"<br />\n":"<br>\n"},Ih.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},Ih.text=function(t,e){return Dh(t[e].content)},Ih.html_block=function(t,e){return t[e].content},Ih.html_inline=function(t,e){return t[e].content},zh.prototype.renderAttrs=function(t){let e,n,r;if(!t.attrs)return"";for(r="",e=0,n=t.attrs.length;e<n;e++)r+=" "+Dh(t.attrs[e][0])+'="'+Dh(t.attrs[e][1])+'"';return r},zh.prototype.renderToken=function(t,e,n){const r=t[e];let o="";if(r.hidden)return"";r.block&&-1!==r.nesting&&e&&t[e-1].hidden&&(o+="\n"),o+=(-1===r.nesting?"</":"<")+r.tag,o+=this.renderAttrs(r),0===r.nesting&&n.xhtmlOut&&(o+=" /");let i=!1;if(r.block&&(i=!0,1===r.nesting&&e+1<t.length)){const n=t[e+1];("inline"===n.type||n.hidden||-1===n.nesting&&n.tag===r.tag)&&(i=!1)}return o+=i?">\n":">",o},zh.prototype.renderInline=function(t,e,n){let r="";const o=this.rules;for(let i=0,s=t.length;i<s;i++){const s=t[i].type;void 0!==o[s]?r+=o[s](t,i,e,n,this):r+=this.renderToken(t,i,e)}return r},zh.prototype.renderInlineAsText=function(t,e,n){let r="";for(let o=0,i=t.length;o<i;o++)switch(t[o].type){case"text":case"html_inline":case"html_block":r+=t[o].content;break;case"image":r+=this.renderInlineAsText(t[o].children,e,n);break;case"softbreak":case"hardbreak":r+="\n"}return r},zh.prototype.render=function(t,e,n){let r="";const o=this.rules;for(let i=0,s=t.length;i<s;i++){const s=t[i].type;"inline"===s?r+=this.renderInline(t[i].children,e,n):void 0!==o[s]?r+=o[s](t,i,e,n,this):r+=this.renderToken(t,i,e,n)}return r},Fh.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1},Fh.prototype.__compile__=function(){const t=this,e=[""];t.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(t){e.indexOf(t)<0&&e.push(t)})}),t.__cache__={},e.forEach(function(e){t.__cache__[e]=[],t.__rules__.forEach(function(n){n.enabled&&(e&&n.alt.indexOf(e)<0||t.__cache__[e].push(n.fn))})})},Fh.prototype.at=function(t,e,n){const r=this.__find__(t),o=n||{};if(-1===r)throw new Error("Parser rule not found: "+t);this.__rules__[r].fn=e,this.__rules__[r].alt=o.alt||[],this.__cache__=null},Fh.prototype.before=function(t,e,n,r){const o=this.__find__(t),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},Fh.prototype.after=function(t,e,n,r){const o=this.__find__(t),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},Fh.prototype.push=function(t,e,n){const r=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null},Fh.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(t){const r=this.__find__(t);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[r].enabled=!0,n.push(t)},this),this.__cache__=null,n},Fh.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(t,e)},Fh.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(t){const r=this.__find__(t);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[r].enabled=!1,n.push(t)},this),this.__cache__=null,n},Fh.prototype.getRules=function(t){return null===this.__cache__&&this.__compile__(),this.__cache__[t]||[]},Bh.prototype.attrIndex=function(t){if(!this.attrs)return-1;const e=this.attrs;for(let n=0,r=e.length;n<r;n++)if(e[n][0]===t)return n;return-1},Bh.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]},Bh.prototype.attrSet=function(t,e){const n=this.attrIndex(t),r=[t,e];n<0?this.attrPush(r):this.attrs[n]=r},Bh.prototype.attrGet=function(t){const e=this.attrIndex(t);let n=null;return e>=0&&(n=this.attrs[e][1]),n},Bh.prototype.attrJoin=function(t,e){const n=this.attrIndex(t);n<0?this.attrPush([t,e]):this.attrs[n][1]=this.attrs[n][1]+" "+e},jh.prototype.Token=Bh;const Hh=/\r\n?|\n/g,$h=/\0/g;function qh(t){return/^<a[>\s]/i.test(t)}function Vh(t){return/^<\/a\s*>/i.test(t)}const Wh=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,Gh=/\((c|tm|r)\)/i,Uh=/\((c|tm|r)\)/gi,Yh={c:"",r:"",tm:""};function Kh(t,e){return Yh[e.toLowerCase()]}function Xh(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];"text"!==r.type||e||(r.content=r.content.replace(Uh,Kh)),"link_open"===r.type&&"auto"===r.info&&e--,"link_close"===r.type&&"auto"===r.info&&e++}}function Jh(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];"text"!==r.type||e||Wh.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1").replace(/(^|\s)--(?=\s|$)/gm,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1")),"link_open"===r.type&&"auto"===r.info&&e--,"link_close"===r.type&&"auto"===r.info&&e++}}const Zh=/['"]/,Qh=/['"]/g;function tm(t,e,n){return t.slice(0,e)+n+t.slice(e+1)}function em(t,e){let n;const r=[];for(let o=0;o<t.length;o++){const i=t[o],s=t[o].level;for(n=r.length-1;n>=0&&!(r[n].level<=s);n--);if(r.length=n+1,"text"!==i.type)continue;let a=i.content,l=0,c=a.length;t:for(;l<c;){Qh.lastIndex=l;const u=Qh.exec(a);if(!u)break;let d=!0,p=!0;l=u.index+1;const f="'"===u[0];let h=32;if(u.index-1>=0)h=a.charCodeAt(u.index-1);else for(n=o-1;n>=0&&("softbreak"!==t[n].type&&"hardbreak"!==t[n].type);n--)if(t[n].content){h=t[n].content.charCodeAt(t[n].content.length-1);break}let m=32;if(l<c)m=a.charCodeAt(l);else for(n=o+1;n<t.length&&("softbreak"!==t[n].type&&"hardbreak"!==t[n].type);n++)if(t[n].content){m=t[n].content.charCodeAt(0);break}const g=Th(h)||Ah(String.fromCharCode(h)),v=Th(m)||Ah(String.fromCharCode(m)),y=_h(h),b=_h(m);if(b?d=!1:v&&(y||g||(d=!1)),y?p=!1:g&&(b||v||(p=!1)),34===m&&'"'===u[0]&&h>=48&&h<=57&&(p=d=!1),d&&p&&(d=g,p=v),d||p){if(p)for(n=r.length-1;n>=0;n--){let d=r[n];if(r[n].level<s)break;if(d.single===f&&r[n].level===s){let s,p;d=r[n],f?(s=e.md.options.quotes[2],p=e.md.options.quotes[3]):(s=e.md.options.quotes[0],p=e.md.options.quotes[1]),i.content=tm(i.content,u.index,p),t[d.token].content=tm(t[d.token].content,d.pos,s),l+=p.length-1,d.token===o&&(l+=s.length-1),a=i.content,c=a.length,r.length=n;continue t}}d?r.push({token:o,pos:u.index,single:f,level:s}):p&&f&&(i.content=tm(i.content,u.index,""))}else f&&(i.content=tm(i.content,u.index,""))}}}const nm=[["normalize",function(t){let e;e=t.src.replace(Hh,"\n"),e=e.replace($h,""),t.src=e}],["block",function(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}],["inline",function(t){const e=t.tokens;for(let n=0,r=e.length;n<r;n++){const r=e[n];"inline"===r.type&&t.md.inline.parse(r.content,t.md,t.env,r.children)}}],["linkify",function(t){const e=t.tokens;if(t.md.options.linkify)for(let n=0,r=e.length;n<r;n++){if("inline"!==e[n].type||!t.md.linkify.pretest(e[n].content))continue;let r=e[n].children,o=0;for(let i=r.length-1;i>=0;i--){const s=r[i];if("link_close"!==s.type){if("html_inline"===s.type&&(qh(s.content)&&o>0&&o--,Vh(s.content)&&o++),!(o>0)&&"text"===s.type&&t.md.linkify.test(s.content)){const o=s.content;let a=t.md.linkify.match(o);const l=[];let c=s.level,u=0;a.length>0&&0===a[0].index&&i>0&&"text_special"===r[i-1].type&&(a=a.slice(1));for(let e=0;e<a.length;e++){const n=a[e].url,r=t.md.normalizeLink(n);if(!t.md.validateLink(r))continue;let i=a[e].text;i=a[e].schema?"mailto:"!==a[e].schema||/^mailto:/i.test(i)?t.md.normalizeLinkText(i):t.md.normalizeLinkText("mailto:"+i).replace(/^mailto:/,""):t.md.normalizeLinkText("http://"+i).replace(/^http:\/\//,"");const s=a[e].index;if(s>u){const e=new t.Token("text","",0);e.content=o.slice(u,s),e.level=c,l.push(e)}const d=new t.Token("link_open","a",1);d.attrs=[["href",r]],d.level=c++,d.markup="linkify",d.info="auto",l.push(d);const p=new t.Token("text","",0);p.content=i,p.level=c,l.push(p);const f=new t.Token("link_close","a",-1);f.level=--c,f.markup="linkify",f.info="auto",l.push(f),u=a[e].lastIndex}if(u<o.length){const e=new t.Token("text","",0);e.content=o.slice(u),e.level=c,l.push(e)}e[n].children=r=mh(r,i,l)}}else for(i--;r[i].level!==s.level&&"link_open"!==r[i].type;)i--}}}],["replacements",function(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)"inline"===t.tokens[e].type&&(Gh.test(t.tokens[e].content)&&Xh(t.tokens[e].children),Wh.test(t.tokens[e].content)&&Jh(t.tokens[e].children))}],["smartquotes",function(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)"inline"===t.tokens[e].type&&Zh.test(t.tokens[e].content)&&em(t.tokens[e].children,t)}],["text_join",function(t){let e,n;const r=t.tokens,o=r.length;for(let t=0;t<o;t++){if("inline"!==r[t].type)continue;const o=r[t].children,i=o.length;for(e=0;e<i;e++)"text_special"===o[e].type&&(o[e].type="text");for(e=n=0;e<i;e++)"text"===o[e].type&&e+1<i&&"text"===o[e+1].type?o[e+1].content=o[e].content+o[e+1].content:(e!==n&&(o[n]=o[e]),n++);e!==n&&(o.length=n)}}]];function rm(){this.ruler=new Fh;for(let t=0;t<nm.length;t++)this.ruler.push(nm[t][0],nm[t][1])}function om(t,e,n,r){this.src=t,this.md=e,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const o=this.src;for(let t=0,e=0,n=0,r=0,i=o.length,s=!1;e<i;e++){const a=o.charCodeAt(e);if(!s){if(Oh(a)){n++,9===a?r+=4-r%4:r++;continue}s=!0}10!==a&&e!==i-1||(10!==a&&e++,this.bMarks.push(t),this.eMarks.push(e),this.tShift.push(n),this.sCount.push(r),this.bsCount.push(0),s=!1,n=0,r=0,t=e+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}rm.prototype.process=function(t){const e=this.ruler.getRules("");for(let n=0,r=e.length;n<r;n++)e[n](t)},rm.prototype.State=jh,om.prototype.push=function(t,e,n){const r=new Bh(t,e,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r},om.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]},om.prototype.skipEmptyLines=function(t){for(let e=this.lineMax;t<e&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t},om.prototype.skipSpaces=function(t){for(let e=this.src.length;t<e;t++){if(!Oh(this.src.charCodeAt(t)))break}return t},om.prototype.skipSpacesBack=function(t,e){if(t<=e)return t;for(;t>e;)if(!Oh(this.src.charCodeAt(--t)))return t+1;return t},om.prototype.skipChars=function(t,e){for(let n=this.src.length;t<n&&this.src.charCodeAt(t)===e;t++);return t},om.prototype.skipCharsBack=function(t,e,n){if(t<=n)return t;for(;t>n;)if(e!==this.src.charCodeAt(--t))return t+1;return t},om.prototype.getLines=function(t,e,n,r){if(t>=e)return"";const o=new Array(e-t);for(let i=0,s=t;s<e;s++,i++){let t=0;const a=this.bMarks[s];let l,c=a;for(l=s+1<e||r?this.eMarks[s]+1:this.eMarks[s];c<l&&t<n;){const e=this.src.charCodeAt(c);if(Oh(e))9===e?t+=4-(t+this.bsCount[s])%4:t++;else{if(!(c-a<this.tShift[s]))break;t++}c++}o[i]=t>n?new Array(t-n+1).join(" ")+this.src.slice(c,l):this.src.slice(c,l)}return o.join("")},om.prototype.Token=Bh;function im(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];return t.src.slice(n,r)}function sm(t){const e=[],n=t.length;let r=0,o=t.charCodeAt(r),i=!1,s=0,a="";for(;r<n;)124===o&&(i?(a+=t.substring(s,r-1),s=r):(e.push(a+t.substring(s,r)),a="",s=r+1)),i=92===o,r++,o=t.charCodeAt(r);return e.push(a+t.substring(s)),e}function am(t,e){const n=t.eMarks[e];let r=t.bMarks[e]+t.tShift[e];const o=t.src.charCodeAt(r++);if(42!==o&&45!==o&&43!==o)return-1;if(r<n){if(!Oh(t.src.charCodeAt(r)))return-1}return r}function lm(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];let o=n;if(o+1>=r)return-1;let i=t.src.charCodeAt(o++);if(i<48||i>57)return-1;for(;;){if(o>=r)return-1;if(i=t.src.charCodeAt(o++),!(i>=48&&i<=57)){if(41===i||46===i)break;return-1}if(o-n>=10)return-1}return o<r&&(i=t.src.charCodeAt(o),!Oh(i))?-1:o}const cm="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",um="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",dm=new RegExp("^(?:"+cm+"|"+um+"|\x3c!---?>|\x3c!--(?:[^-]|-[^-]|--[^>])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Za-z][^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),pm=new RegExp("^(?:"+cm+"|"+um+")"),fm=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"].join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(pm.source+"\\s*$"),/^$/,!1]];const hm=[["table",function(t,e,n,r){if(e+2>n)return!1;let o=e+1;if(t.sCount[o]<t.blkIndent)return!1;if(t.sCount[o]-t.blkIndent>=4)return!1;let i=t.bMarks[o]+t.tShift[o];if(i>=t.eMarks[o])return!1;const s=t.src.charCodeAt(i++);if(124!==s&&45!==s&&58!==s)return!1;if(i>=t.eMarks[o])return!1;const a=t.src.charCodeAt(i++);if(124!==a&&45!==a&&58!==a&&!Oh(a))return!1;if(45===s&&Oh(a))return!1;for(;i<t.eMarks[o];){const e=t.src.charCodeAt(i);if(124!==e&&45!==e&&58!==e&&!Oh(e))return!1;i++}let l=im(t,e+1),c=l.split("|");const u=[];for(let t=0;t<c.length;t++){const e=c[t].trim();if(!e){if(0===t||t===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(e))return!1;58===e.charCodeAt(e.length-1)?u.push(58===e.charCodeAt(0)?"center":"right"):58===e.charCodeAt(0)?u.push("left"):u.push("")}if(l=im(t,e).trim(),-1===l.indexOf("|"))return!1;if(t.sCount[e]-t.blkIndent>=4)return!1;c=sm(l),c.length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop();const d=c.length;if(0===d||d!==u.length)return!1;if(r)return!0;const p=t.parentType;t.parentType="table";const f=t.md.block.ruler.getRules("blockquote"),h=[e,0];t.push("table_open","table",1).map=h,t.push("thead_open","thead",1).map=[e,e+1],t.push("tr_open","tr",1).map=[e,e+1];for(let e=0;e<c.length;e++){const n=t.push("th_open","th",1);u[e]&&(n.attrs=[["style","text-align:"+u[e]]]);const r=t.push("inline","",0);r.content=c[e].trim(),r.children=[],t.push("th_close","th",-1)}let m;t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let g=0;for(o=e+2;o<n&&!(t.sCount[o]<t.blkIndent);o++){let r=!1;for(let e=0,i=f.length;e<i;e++)if(f[e](t,o,n,!0)){r=!0;break}if(r)break;if(l=im(t,o).trim(),!l)break;if(t.sCount[o]-t.blkIndent>=4)break;if(c=sm(l),c.length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop(),g+=d-c.length,g>65536)break;if(o===e+2){t.push("tbody_open","tbody",1).map=m=[e+2,0]}t.push("tr_open","tr",1).map=[o,o+1];for(let e=0;e<d;e++){const n=t.push("td_open","td",1);u[e]&&(n.attrs=[["style","text-align:"+u[e]]]);const r=t.push("inline","",0);r.content=c[e]?c[e].trim():"",r.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return m&&(t.push("tbody_close","tbody",-1),m[1]=o),t.push("table_close","table",-1),h[1]=o,t.parentType=p,t.line=o,!0},["paragraph","reference"]],["code",function(t,e,n){if(t.sCount[e]-t.blkIndent<4)return!1;let r=e+1,o=r;for(;r<n;)if(t.isEmpty(r))r++;else{if(!(t.sCount[r]-t.blkIndent>=4))break;r++,o=r}t.line=o;const i=t.push("code_block","code",0);return i.content=t.getLines(e,o,4+t.blkIndent,!1)+"\n",i.map=[e,t.line],!0}],["fence",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(o+3>i)return!1;const s=t.src.charCodeAt(o);if(126!==s&&96!==s)return!1;let a=o;o=t.skipChars(o,s);let l=o-a;if(l<3)return!1;const c=t.src.slice(a,o),u=t.src.slice(o,i);if(96===s&&u.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let d=e,p=!1;for(;(d++,!(d>=n))&&(o=a=t.bMarks[d]+t.tShift[d],i=t.eMarks[d],!(o<i&&t.sCount[d]<t.blkIndent));)if(t.src.charCodeAt(o)===s&&!(t.sCount[d]-t.blkIndent>=4||(o=t.skipChars(o,s),o-a<l||(o=t.skipSpaces(o),o<i)))){p=!0;break}l=t.sCount[e],t.line=d+(p?1:0);const f=t.push("fence","code",0);return f.info=u,f.content=t.getLines(e+1,d,l,!0),f.markup=c,f.map=[e,t.line],!0},["paragraph","reference","blockquote","list"]],["blockquote",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];const s=t.lineMax;if(t.sCount[e]-t.blkIndent>=4)return!1;if(62!==t.src.charCodeAt(o))return!1;if(r)return!0;const a=[],l=[],c=[],u=[],d=t.md.block.ruler.getRules("blockquote"),p=t.parentType;t.parentType="blockquote";let f,h=!1;for(f=e;f<n;f++){const e=t.sCount[f]<t.blkIndent;if(o=t.bMarks[f]+t.tShift[f],i=t.eMarks[f],o>=i)break;if(62===t.src.charCodeAt(o++)&&!e){let e,n,r=t.sCount[f]+1;32===t.src.charCodeAt(o)?(o++,r++,n=!1,e=!0):9===t.src.charCodeAt(o)?(e=!0,(t.bsCount[f]+r)%4==3?(o++,r++,n=!1):n=!0):e=!1;let s=r;for(a.push(t.bMarks[f]),t.bMarks[f]=o;o<i;){const e=t.src.charCodeAt(o);if(!Oh(e))break;9===e?s+=4-(s+t.bsCount[f]+(n?1:0))%4:s++,o++}h=o>=i,l.push(t.bsCount[f]),t.bsCount[f]=t.sCount[f]+1+(e?1:0),c.push(t.sCount[f]),t.sCount[f]=s-r,u.push(t.tShift[f]),t.tShift[f]=o-t.bMarks[f];continue}if(h)break;let r=!1;for(let e=0,o=d.length;e<o;e++)if(d[e](t,f,n,!0)){r=!0;break}if(r){t.lineMax=f,0!==t.blkIndent&&(a.push(t.bMarks[f]),l.push(t.bsCount[f]),u.push(t.tShift[f]),c.push(t.sCount[f]),t.sCount[f]-=t.blkIndent);break}a.push(t.bMarks[f]),l.push(t.bsCount[f]),u.push(t.tShift[f]),c.push(t.sCount[f]),t.sCount[f]=-1}const m=t.blkIndent;t.blkIndent=0;const g=t.push("blockquote_open","blockquote",1);g.markup=">";const v=[e,0];g.map=v,t.md.block.tokenize(t,e,f),t.push("blockquote_close","blockquote",-1).markup=">",t.lineMax=s,t.parentType=p,v[1]=t.line;for(let n=0;n<u.length;n++)t.bMarks[n+e]=a[n],t.tShift[n+e]=u[n],t.sCount[n+e]=c[n],t.bsCount[n+e]=l[n];return t.blkIndent=m,!0},["paragraph","reference","blockquote","list"]],["hr",function(t,e,n,r){const o=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let i=t.bMarks[e]+t.tShift[e];const s=t.src.charCodeAt(i++);if(42!==s&&45!==s&&95!==s)return!1;let a=1;for(;i<o;){const e=t.src.charCodeAt(i++);if(e!==s&&!Oh(e))return!1;e===s&&a++}if(a<3)return!1;if(r)return!0;t.line=e+1;const l=t.push("hr","hr",0);return l.map=[e,t.line],l.markup=Array(a+1).join(String.fromCharCode(s)),!0},["paragraph","reference","blockquote","list"]],["list",function(t,e,n,r){let o,i,s,a,l=e,c=!0;if(t.sCount[l]-t.blkIndent>=4)return!1;if(t.listIndent>=0&&t.sCount[l]-t.listIndent>=4&&t.sCount[l]<t.blkIndent)return!1;let u,d,p,f=!1;if(r&&"paragraph"===t.parentType&&t.sCount[l]>=t.blkIndent&&(f=!0),(p=lm(t,l))>=0){if(u=!0,s=t.bMarks[l]+t.tShift[l],d=Number(t.src.slice(s,p-1)),f&&1!==d)return!1}else{if(!((p=am(t,l))>=0))return!1;u=!1}if(f&&t.skipSpaces(p)>=t.eMarks[l])return!1;if(r)return!0;const h=t.src.charCodeAt(p-1),m=t.tokens.length;u?(a=t.push("ordered_list_open","ol",1),1!==d&&(a.attrs=[["start",d]])):a=t.push("bullet_list_open","ul",1);const g=[l,0];a.map=g,a.markup=String.fromCharCode(h);let v=!1;const y=t.md.block.ruler.getRules("list"),b=t.parentType;for(t.parentType="list";l<n;){i=p,o=t.eMarks[l];const e=t.sCount[l]+p-(t.bMarks[l]+t.tShift[l]);let r=e;for(;i<o;){const e=t.src.charCodeAt(i);if(9===e)r+=4-(r+t.bsCount[l])%4;else{if(32!==e)break;r++}i++}const d=i;let f;f=d>=o?1:r-e,f>4&&(f=1);const m=e+f;a=t.push("list_item_open","li",1),a.markup=String.fromCharCode(h);const g=[l,0];a.map=g,u&&(a.info=t.src.slice(s,p-1));const b=t.tight,x=t.tShift[l],w=t.sCount[l],k=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=m,t.tight=!0,t.tShift[l]=d-t.bMarks[l],t.sCount[l]=r,d>=o&&t.isEmpty(l+1)?t.line=Math.min(t.line+2,n):t.md.block.tokenize(t,l,n,!0),t.tight&&!v||(c=!1),v=t.line-l>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=k,t.tShift[l]=x,t.sCount[l]=w,t.tight=b,a=t.push("list_item_close","li",-1),a.markup=String.fromCharCode(h),l=t.line,g[1]=l,l>=n)break;if(t.sCount[l]<t.blkIndent)break;if(t.sCount[l]-t.blkIndent>=4)break;let E=!1;for(let e=0,r=y.length;e<r;e++)if(y[e](t,l,n,!0)){E=!0;break}if(E)break;if(u){if(p=lm(t,l),p<0)break;s=t.bMarks[l]+t.tShift[l]}else if(p=am(t,l),p<0)break;if(h!==t.src.charCodeAt(p-1))break}return a=u?t.push("ordered_list_close","ol",-1):t.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(h),g[1]=l,t.line=l,t.parentType=b,c&&function(t,e){const n=t.level+2;for(let r=e+2,o=t.tokens.length-2;r<o;r++)t.tokens[r].level===n&&"paragraph_open"===t.tokens[r].type&&(t.tokens[r+2].hidden=!0,t.tokens[r].hidden=!0,r+=2)}(t,m),!0},["paragraph","reference","blockquote"]],["reference",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e],s=e+1;if(t.sCount[e]-t.blkIndent>=4)return!1;if(91!==t.src.charCodeAt(o))return!1;function a(e){const n=t.lineMax;if(e>=n||t.isEmpty(e))return null;let r=!1;if(t.sCount[e]-t.blkIndent>3&&(r=!0),t.sCount[e]<0&&(r=!0),!r){const r=t.md.block.ruler.getRules("reference"),o=t.parentType;t.parentType="reference";let i=!1;for(let o=0,s=r.length;o<s;o++)if(r[o](t,e,n,!0)){i=!0;break}if(t.parentType=o,i)return null}const o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];return t.src.slice(o,i+1)}let l=t.src.slice(o,i+1);i=l.length;let c=-1;for(o=1;o<i;o++){const t=l.charCodeAt(o);if(91===t)return!1;if(93===t){c=o;break}if(10===t){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}else if(92===t&&(o++,o<i&&10===l.charCodeAt(o))){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}}if(c<0||58!==l.charCodeAt(c+1))return!1;for(o=c+2;o<i;o++){const t=l.charCodeAt(o);if(10===t){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}else if(!Oh(t))break}const u=t.md.helpers.parseLinkDestination(l,o,i);if(!u.ok)return!1;const d=t.md.normalizeLink(u.str);if(!t.md.validateLink(d))return!1;o=u.pos;const p=o,f=s,h=o;for(;o<i;o++){const t=l.charCodeAt(o);if(10===t){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}else if(!Oh(t))break}let m,g=t.md.helpers.parseLinkTitle(l,o,i);for(;g.can_continue;){const e=a(s);if(null===e)break;l+=e,o=i,i=l.length,s++,g=t.md.helpers.parseLinkTitle(l,o,i,g)}for(o<i&&h!==o&&g.ok?(m=g.str,o=g.pos):(m="",o=p,s=f);o<i;){if(!Oh(l.charCodeAt(o)))break;o++}if(o<i&&10!==l.charCodeAt(o)&&m)for(m="",o=p,s=f;o<i;){if(!Oh(l.charCodeAt(o)))break;o++}if(o<i&&10!==l.charCodeAt(o))return!1;const v=Rh(l.slice(1,c));return!!v&&(r||(void 0===t.env.references&&(t.env.references={}),void 0===t.env.references[v]&&(t.env.references[v]={title:m,href:d}),t.line=s),!0)}],["html_block",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(!t.md.options.html)return!1;if(60!==t.src.charCodeAt(o))return!1;let s=t.src.slice(o,i),a=0;for(;a<fm.length&&!fm[a][0].test(s);a++);if(a===fm.length)return!1;if(r)return fm[a][2];let l=e+1;if(!fm[a][1].test(s))for(;l<n&&!(t.sCount[l]<t.blkIndent);l++)if(o=t.bMarks[l]+t.tShift[l],i=t.eMarks[l],s=t.src.slice(o,i),fm[a][1].test(s)){0!==s.length&&l++;break}t.line=l;const c=t.push("html_block","",0);return c.map=[e,l],c.content=t.getLines(e,l,t.blkIndent,!0),!0},["paragraph","reference","blockquote"]],["heading",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.src.charCodeAt(o);if(35!==s||o>=i)return!1;let a=1;for(s=t.src.charCodeAt(++o);35===s&&o<i&&a<=6;)a++,s=t.src.charCodeAt(++o);if(a>6||o<i&&!Oh(s))return!1;if(r)return!0;i=t.skipSpacesBack(i,o);const l=t.skipCharsBack(i,35,o);l>o&&Oh(t.src.charCodeAt(l-1))&&(i=l),t.line=e+1;const c=t.push("heading_open","h"+String(a),1);c.markup="########".slice(0,a),c.map=[e,t.line];const u=t.push("inline","",0);return u.content=t.src.slice(o,i).trim(),u.map=[e,t.line],u.children=[],t.push("heading_close","h"+String(a),-1).markup="########".slice(0,a),!0},["paragraph","reference","blockquote"]],["lheading",function(t,e,n){const r=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;const o=t.parentType;t.parentType="paragraph";let i,s=0,a=e+1;for(;a<n&&!t.isEmpty(a);a++){if(t.sCount[a]-t.blkIndent>3)continue;if(t.sCount[a]>=t.blkIndent){let e=t.bMarks[a]+t.tShift[a];const n=t.eMarks[a];if(e<n&&(i=t.src.charCodeAt(e),(45===i||61===i)&&(e=t.skipChars(e,i),e=t.skipSpaces(e),e>=n))){s=61===i?1:2;break}}if(t.sCount[a]<0)continue;let e=!1;for(let o=0,i=r.length;o<i;o++)if(r[o](t,a,n,!0)){e=!0;break}if(e)break}if(!s)return!1;const l=t.getLines(e,a,t.blkIndent,!1).trim();t.line=a+1;const c=t.push("heading_open","h"+String(s),1);c.markup=String.fromCharCode(i),c.map=[e,t.line];const u=t.push("inline","",0);return u.content=l,u.map=[e,t.line-1],u.children=[],t.push("heading_close","h"+String(s),-1).markup=String.fromCharCode(i),t.parentType=o,!0}],["paragraph",function(t,e,n){const r=t.md.block.ruler.getRules("paragraph"),o=t.parentType;let i=e+1;for(t.parentType="paragraph";i<n&&!t.isEmpty(i);i++){if(t.sCount[i]-t.blkIndent>3)continue;if(t.sCount[i]<0)continue;let e=!1;for(let o=0,s=r.length;o<s;o++)if(r[o](t,i,n,!0)){e=!0;break}if(e)break}const s=t.getLines(e,i,t.blkIndent,!1).trim();t.line=i,t.push("paragraph_open","p",1).map=[e,t.line];const a=t.push("inline","",0);return a.content=s,a.map=[e,t.line],a.children=[],t.push("paragraph_close","p",-1),t.parentType=o,!0}]];function mm(){this.ruler=new Fh;for(let t=0;t<hm.length;t++)this.ruler.push(hm[t][0],hm[t][1],{alt:(hm[t][2]||[]).slice()})}function gm(t,e,n,r){this.src=t,this.env=n,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}function vm(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}mm.prototype.tokenize=function(t,e,n){const r=this.ruler.getRules(""),o=r.length,i=t.md.options.maxNesting;let s=e,a=!1;for(;s<n&&(t.line=s=t.skipEmptyLines(s),!(s>=n))&&!(t.sCount[s]<t.blkIndent);){if(t.level>=i){t.line=n;break}const e=t.line;let l=!1;for(let i=0;i<o;i++)if(l=r[i](t,s,n,!1),l){if(e>=t.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");t.tight=!a,t.isEmpty(t.line-1)&&(a=!0),s=t.line,s<n&&t.isEmpty(s)&&(a=!0,s++,t.line=s)}},mm.prototype.parse=function(t,e,n,r){if(!t)return;const o=new this.State(t,e,n,r);this.tokenize(o,o.line,o.lineMax)},mm.prototype.State=om,gm.prototype.pushPending=function(){const t=new Bh("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t},gm.prototype.push=function(t,e,n){this.pending&&this.pushPending();const r=new Bh(t,e,n);let o=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(o),r},gm.prototype.scanDelims=function(t,e){const n=this.posMax,r=this.src.charCodeAt(t),o=t>0?this.src.charCodeAt(t-1):32;let i=t;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const s=i-t,a=i<n?this.src.charCodeAt(i):32,l=Th(o)||Ah(String.fromCharCode(o)),c=Th(a)||Ah(String.fromCharCode(a)),u=_h(o),d=_h(a),p=!d&&(!c||u||l),f=!u&&(!l||d||c);return{can_open:p&&(e||!f||l),can_close:f&&(e||!p||c),length:s}},gm.prototype.Token=Bh;const ym=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;const bm=[];for(let t=0;t<256;t++)bm.push(0);function xm(t,e){let n;const r=[],o=e.length;for(let i=0;i<o;i++){const o=e[i];if(126!==o.marker)continue;if(-1===o.end)continue;const s=e[o.end];n=t.tokens[o.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=t.tokens[s.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="","text"===t.tokens[s.token-1].type&&"~"===t.tokens[s.token-1].content&&r.push(s.token-1)}for(;r.length;){const e=r.pop();let o=e+1;for(;o<t.tokens.length&&"s_close"===t.tokens[o].type;)o++;o--,e!==o&&(n=t.tokens[o],t.tokens[o]=t.tokens[e],t.tokens[e]=n)}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){bm[t.charCodeAt(0)]=1});var wm={tokenize:function(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e)return!1;if(126!==r)return!1;const o=t.scanDelims(t.pos,!0);let i=o.length;const s=String.fromCharCode(r);if(i<2)return!1;let a;i%2&&(a=t.push("text","",0),a.content=s,i--);for(let e=0;e<i;e+=2)a=t.push("text","",0),a.content=s+s,t.delimiters.push({marker:r,length:0,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return t.pos+=o.length,!0},postProcess:function(t){const e=t.tokens_meta,n=t.tokens_meta.length;xm(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&xm(t,e[r].delimiters)}};function km(t,e){for(let n=e.length-1;n>=0;n--){const r=e[n];if(95!==r.marker&&42!==r.marker)continue;if(-1===r.end)continue;const o=e[r.end],i=n>0&&e[n-1].end===r.end+1&&e[n-1].marker===r.marker&&e[n-1].token===r.token-1&&e[r.end+1].token===o.token+1,s=String.fromCharCode(r.marker),a=t.tokens[r.token];a.type=i?"strong_open":"em_open",a.tag=i?"strong":"em",a.nesting=1,a.markup=i?s+s:s,a.content="";const l=t.tokens[o.token];l.type=i?"strong_close":"em_close",l.tag=i?"strong":"em",l.nesting=-1,l.markup=i?s+s:s,l.content="",i&&(t.tokens[e[n-1].token].content="",t.tokens[e[r.end+1].token].content="",n--)}}var Em={tokenize:function(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e)return!1;if(95!==r&&42!==r)return!1;const o=t.scanDelims(t.pos,42===r);for(let e=0;e<o.length;e++){t.push("text","",0).content=String.fromCharCode(r),t.delimiters.push({marker:r,length:o.length,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close})}return t.pos+=o.length,!0},postProcess:function(t){const e=t.tokens_meta,n=t.tokens_meta.length;km(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&km(t,e[r].delimiters)}};const Cm=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Sm=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;const Dm=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Mm=/^&([a-z][a-z0-9]{1,31});/i;function Om(t){const e={},n=t.length;if(!n)return;let r=0,o=-2;const i=[];for(let s=0;s<n;s++){const n=t[s];if(i.push(0),t[r].marker===n.marker&&o===n.token-1||(r=s),o=n.token,n.length=n.length||0,!n.close)continue;e.hasOwnProperty(n.marker)||(e[n.marker]=[-1,-1,-1,-1,-1,-1]);const a=e[n.marker][(n.open?3:0)+n.length%3];let l=r-i[r]-1,c=l;for(;l>a;l-=i[l]+1){const e=t[l];if(e.marker===n.marker&&(e.open&&e.end<0)){let r=!1;if((e.close||n.open)&&(e.length+n.length)%3==0&&(e.length%3==0&&n.length%3==0||(r=!0)),!r){const r=l>0&&!t[l-1].open?i[l-1]+1:0;i[s]=s-l+r,i[l]=r,n.open=!1,e.end=s,e.close=!1,c=-1,o=-2;break}}}-1!==c&&(e[n.marker][(n.open?3:0)+(n.length||0)%3]=c)}}const _m=[["text",function(t,e){let n=t.pos;for(;n<t.posMax&&!vm(t.src.charCodeAt(n));)n++;return n!==t.pos&&(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}],["linkify",function(t,e){if(!t.md.options.linkify)return!1;if(t.linkLevel>0)return!1;const n=t.pos;if(n+3>t.posMax)return!1;if(58!==t.src.charCodeAt(n))return!1;if(47!==t.src.charCodeAt(n+1))return!1;if(47!==t.src.charCodeAt(n+2))return!1;const r=t.pending.match(ym);if(!r)return!1;const o=r[1],i=t.md.linkify.matchAtStart(t.src.slice(n-o.length));if(!i)return!1;let s=i.url;if(s.length<=o.length)return!1;s=s.replace(/\*+$/,"");const a=t.md.normalizeLink(s);if(!t.md.validateLink(a))return!1;if(!e){t.pending=t.pending.slice(0,-o.length);const e=t.push("link_open","a",1);e.attrs=[["href",a]],e.markup="linkify",e.info="auto";t.push("text","",0).content=t.md.normalizeLinkText(s);const n=t.push("link_close","a",-1);n.markup="linkify",n.info="auto"}return t.pos+=s.length-o.length,!0}],["newline",function(t,e){let n=t.pos;if(10!==t.src.charCodeAt(n))return!1;const r=t.pending.length-1,o=t.posMax;if(!e)if(r>=0&&32===t.pending.charCodeAt(r))if(r>=1&&32===t.pending.charCodeAt(r-1)){let e=r-1;for(;e>=1&&32===t.pending.charCodeAt(e-1);)e--;t.pending=t.pending.slice(0,e),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(n++;n<o&&Oh(t.src.charCodeAt(n));)n++;return t.pos=n,!0}],["escape",function(t,e){let n=t.pos;const r=t.posMax;if(92!==t.src.charCodeAt(n))return!1;if(n++,n>=r)return!1;let o=t.src.charCodeAt(n);if(10===o){for(e||t.push("hardbreak","br",0),n++;n<r&&(o=t.src.charCodeAt(n),Oh(o));)n++;return t.pos=n,!0}let i=t.src[n];if(o>=55296&&o<=56319&&n+1<r){const e=t.src.charCodeAt(n+1);e>=56320&&e<=57343&&(i+=t.src[n+1],n++)}const s="\\"+i;if(!e){const e=t.push("text_special","",0);o<256&&0!==bm[o]?e.content=i:e.content=s,e.markup=s,e.info="escape"}return t.pos=n+1,!0}],["backticks",function(t,e){let n=t.pos;if(96!==t.src.charCodeAt(n))return!1;const r=n;n++;const o=t.posMax;for(;n<o&&96===t.src.charCodeAt(n);)n++;const i=t.src.slice(r,n),s=i.length;if(t.backticksScanned&&(t.backticks[s]||0)<=r)return e||(t.pending+=i),t.pos+=s,!0;let a,l=n;for(;-1!==(a=t.src.indexOf("`",l));){for(l=a+1;l<o&&96===t.src.charCodeAt(l);)l++;const r=l-a;if(r===s){if(!e){const e=t.push("code_inline","code",0);e.markup=i,e.content=t.src.slice(n,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=l,!0}t.backticks[r]=a}return t.backticksScanned=!0,e||(t.pending+=i),t.pos+=s,!0}],["strikethrough",wm.tokenize],["emphasis",Em.tokenize],["link",function(t,e){let n,r,o,i,s="",a="",l=t.pos,c=!0;if(91!==t.src.charCodeAt(t.pos))return!1;const u=t.pos,d=t.posMax,p=t.pos+1,f=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(f<0)return!1;let h=f+1;if(h<d&&40===t.src.charCodeAt(h)){for(c=!1,h++;h<d&&(n=t.src.charCodeAt(h),Oh(n)||10===n);h++);if(h>=d)return!1;if(l=h,o=t.md.helpers.parseLinkDestination(t.src,h,t.posMax),o.ok){for(s=t.md.normalizeLink(o.str),t.md.validateLink(s)?h=o.pos:s="",l=h;h<d&&(n=t.src.charCodeAt(h),Oh(n)||10===n);h++);if(o=t.md.helpers.parseLinkTitle(t.src,h,t.posMax),h<d&&l!==h&&o.ok)for(a=o.str,h=o.pos;h<d&&(n=t.src.charCodeAt(h),Oh(n)||10===n);h++);}(h>=d||41!==t.src.charCodeAt(h))&&(c=!0),h++}if(c){if(void 0===t.env.references)return!1;if(h<d&&91===t.src.charCodeAt(h)?(l=h+1,h=t.md.helpers.parseLinkLabel(t,h),h>=0?r=t.src.slice(l,h++):h=f+1):h=f+1,r||(r=t.src.slice(p,f)),i=t.env.references[Rh(r)],!i)return t.pos=u,!1;s=i.href,a=i.title}if(!e){t.pos=p,t.posMax=f;const e=[["href",s]];t.push("link_open","a",1).attrs=e,a&&e.push(["title",a]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=h,t.posMax=d,!0}],["image",function(t,e){let n,r,o,i,s,a,l,c,u="";const d=t.pos,p=t.posMax;if(33!==t.src.charCodeAt(t.pos))return!1;if(91!==t.src.charCodeAt(t.pos+1))return!1;const f=t.pos+2,h=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(h<0)return!1;if(i=h+1,i<p&&40===t.src.charCodeAt(i)){for(i++;i<p&&(n=t.src.charCodeAt(i),Oh(n)||10===n);i++);if(i>=p)return!1;for(c=i,a=t.md.helpers.parseLinkDestination(t.src,i,t.posMax),a.ok&&(u=t.md.normalizeLink(a.str),t.md.validateLink(u)?i=a.pos:u=""),c=i;i<p&&(n=t.src.charCodeAt(i),Oh(n)||10===n);i++);if(a=t.md.helpers.parseLinkTitle(t.src,i,t.posMax),i<p&&c!==i&&a.ok)for(l=a.str,i=a.pos;i<p&&(n=t.src.charCodeAt(i),Oh(n)||10===n);i++);else l="";if(i>=p||41!==t.src.charCodeAt(i))return t.pos=d,!1;i++}else{if(void 0===t.env.references)return!1;if(i<p&&91===t.src.charCodeAt(i)?(c=i+1,i=t.md.helpers.parseLinkLabel(t,i),i>=0?o=t.src.slice(c,i++):i=h+1):i=h+1,o||(o=t.src.slice(f,h)),s=t.env.references[Rh(o)],!s)return t.pos=d,!1;u=s.href,l=s.title}if(!e){r=t.src.slice(f,h);const e=[];t.md.inline.parse(r,t.md,t.env,e);const n=t.push("image","img",0),o=[["src",u],["alt",""]];n.attrs=o,n.children=e,n.content=r,l&&o.push(["title",l])}return t.pos=i,t.posMax=p,!0}],["autolink",function(t,e){let n=t.pos;if(60!==t.src.charCodeAt(n))return!1;const r=t.pos,o=t.posMax;for(;;){if(++n>=o)return!1;const e=t.src.charCodeAt(n);if(60===e)return!1;if(62===e)break}const i=t.src.slice(r+1,n);if(Sm.test(i)){const n=t.md.normalizeLink(i);if(!t.md.validateLink(n))return!1;if(!e){const e=t.push("link_open","a",1);e.attrs=[["href",n]],e.markup="autolink",e.info="auto";t.push("text","",0).content=t.md.normalizeLinkText(i);const r=t.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return t.pos+=i.length+2,!0}if(Cm.test(i)){const n=t.md.normalizeLink("mailto:"+i);if(!t.md.validateLink(n))return!1;if(!e){const e=t.push("link_open","a",1);e.attrs=[["href",n]],e.markup="autolink",e.info="auto";t.push("text","",0).content=t.md.normalizeLinkText(i);const r=t.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return t.pos+=i.length+2,!0}return!1}],["html_inline",function(t,e){if(!t.md.options.html)return!1;const n=t.posMax,r=t.pos;if(60!==t.src.charCodeAt(r)||r+2>=n)return!1;const o=t.src.charCodeAt(r+1);if(33!==o&&63!==o&&47!==o&&!function(t){const e=32|t;return e>=97&&e<=122}(o))return!1;const i=t.src.slice(r).match(dm);if(!i)return!1;if(!e){const e=t.push("html_inline","",0);e.content=i[0],s=e.content,/^<a[>\s]/i.test(s)&&t.linkLevel++,function(t){return/^<\/a\s*>/i.test(t)}(e.content)&&t.linkLevel--}var s;return t.pos+=i[0].length,!0}],["entity",function(t,e){const n=t.pos,r=t.posMax;if(38!==t.src.charCodeAt(n))return!1;if(n+1>=r)return!1;if(35===t.src.charCodeAt(n+1)){const r=t.src.slice(n).match(Dm);if(r){if(!e){const e="x"===r[1][0].toLowerCase()?parseInt(r[1].slice(1),16):parseInt(r[1],10),n=t.push("text_special","",0);n.content=gh(e)?vh(e):vh(65533),n.markup=r[0],n.info="entity"}return t.pos+=r[0].length,!0}}else{const r=t.src.slice(n).match(Mm);if(r){const n=dh(r[0]);if(n!==r[0]){if(!e){const e=t.push("text_special","",0);e.content=n,e.markup=r[0],e.info="entity"}return t.pos+=r[0].length,!0}}}return!1}]],Am=[["balance_pairs",function(t){const e=t.tokens_meta,n=t.tokens_meta.length;Om(t.delimiters);for(let t=0;t<n;t++)e[t]&&e[t].delimiters&&Om(e[t].delimiters)}],["strikethrough",wm.postProcess],["emphasis",Em.postProcess],["fragments_join",function(t){let e,n,r=0;const o=t.tokens,i=t.tokens.length;for(e=n=0;e<i;e++)o[e].nesting<0&&r--,o[e].level=r,o[e].nesting>0&&r++,"text"===o[e].type&&e+1<i&&"text"===o[e+1].type?o[e+1].content=o[e].content+o[e+1].content:(e!==n&&(o[n]=o[e]),n++);e!==n&&(o.length=n)}]];function Tm(){this.ruler=new Fh;for(let t=0;t<_m.length;t++)this.ruler.push(_m[t][0],_m[t][1]);this.ruler2=new Fh;for(let t=0;t<Am.length;t++)this.ruler2.push(Am[t][0],Am[t][1])}function Rm(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){e&&Object.keys(e).forEach(function(n){t[n]=e[n]})}),t}function Nm(t){return Object.prototype.toString.call(t)}function Pm(t){return"[object Function]"===Nm(t)}function Lm(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}Tm.prototype.skipToken=function(t){const e=t.pos,n=this.ruler.getRules(""),r=n.length,o=t.md.options.maxNesting,i=t.cache;if(void 0!==i[e])return void(t.pos=i[e]);let s=!1;if(t.level<o){for(let o=0;o<r;o++)if(t.level++,s=n[o](t,!0),t.level--,s){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;s||t.pos++,i[e]=t.pos},Tm.prototype.tokenize=function(t){const e=this.ruler.getRules(""),n=e.length,r=t.posMax,o=t.md.options.maxNesting;for(;t.pos<r;){const i=t.pos;let s=!1;if(t.level<o)for(let r=0;r<n;r++)if(s=e[r](t,!1),s){if(i>=t.pos)throw new Error("inline rule didn't increment state.pos");break}if(s){if(t.pos>=r)break}else t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()},Tm.prototype.parse=function(t,e,n,r){const o=new this.State(t,e,n,r);this.tokenize(o);const i=this.ruler2.getRules(""),s=i.length;for(let t=0;t<s;t++)i[t](o)},Tm.prototype.State=gm;const Im={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};const zm={"http:":{validate:function(t,e,n){const r=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){const r=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?e>=3&&":"===t[e-3]||e>=3&&"/"===t[e-3]?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){const r=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},Fm="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function Bm(t){const e=t.re=function(t){const e={};t=t||{},e.src_Any=Vf.source,e.src_Cc=Wf.source,e.src_Z=Yf.source,e.src_P=Gf.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const n="[><]";return e.src_pseudo_letter="(?:(?![><]|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|[><]|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+n+"|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy='(^|[><]|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}(t.__opts__),n=t.__tlds__.slice();function r(t){return t.replace("%TLDS%",e.src_tlds)}t.onCompile(),t.__tlds_replaced__||n.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),n.push(e.src_xn),e.src_tlds=n.join("|"),e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const o=[];function i(t,e){throw new Error('(LinkifyIt) Invalid schema "'+t+'": '+e)}t.__compiled__={},Object.keys(t.__schemas__).forEach(function(e){const n=t.__schemas__[e];if(null===n)return;const r={validate:null,link:null};if(t.__compiled__[e]=r,"[object Object]"===Nm(n))return!function(t){return"[object RegExp]"===Nm(t)}(n.validate)?Pm(n.validate)?r.validate=n.validate:i(e,n):r.validate=function(t){return function(e,n){const r=e.slice(n);return t.test(r)?r.match(t)[0].length:0}}(n.validate),void(Pm(n.normalize)?r.normalize=n.normalize:n.normalize?i(e,n):r.normalize=function(t,e){e.normalize(t)});!function(t){return"[object String]"===Nm(t)}(n)?i(e,n):o.push(e)}),o.forEach(function(e){t.__compiled__[t.__schemas__[e]]&&(t.__compiled__[e].validate=t.__compiled__[t.__schemas__[e]].validate,t.__compiled__[e].normalize=t.__compiled__[t.__schemas__[e]].normalize)}),t.__compiled__[""]={validate:null,normalize:function(t,e){e.normalize(t)}};const s=Object.keys(t.__compiled__).filter(function(e){return e.length>0&&t.__compiled__[e]}).map(Lm).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),function(t){t.__index__=-1,t.__text_cache__=""}(t)}function jm(t,e){const n=t.__index__,r=t.__last_index__,o=t.__text_cache__.slice(n,r);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=r+e,this.raw=o,this.text=o,this.url=o}function Hm(t,e){const n=new jm(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function $m(t,e){if(!(this instanceof $m))return new $m(t,e);var n;e||(n=t,Object.keys(n||{}).reduce(function(t,e){return t||Im.hasOwnProperty(e)},!1)&&(e=t,t={})),this.__opts__=Rm({},Im,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Rm({},zm,t),this.__compiled__={},this.__tlds__=Fm,this.__tlds_replaced__=!1,this.re={},Bm(this)}$m.prototype.add=function(t,e){return this.__schemas__[t]=e,Bm(this),this},$m.prototype.set=function(t){return this.__opts__=Rm(this.__opts__,t),this},$m.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let e,n,r,o,i,s,a,l,c;if(this.re.schema_test.test(t))for(a=this.re.schema_search,a.lastIndex=0;null!==(e=a.exec(t));)if(o=this.testSchemaAt(t,e[2],a.lastIndex),o){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+o;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=t.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(i=n.index+n[1].length,(this.__index__<0||i<this.__index__)&&(this.__schema__="",this.__index__=i,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=t.indexOf("@"),c>=0&&null!==(r=t.match(this.re.email_fuzzy))&&(i=r.index+r[1].length,s=r.index+r[0].length,(this.__index__<0||i<this.__index__||i===this.__index__&&s>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=i,this.__last_index__=s))),this.__index__>=0},$m.prototype.pretest=function(t){return this.re.pretest.test(t)},$m.prototype.testSchemaAt=function(t,e,n){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,n,this):0},$m.prototype.match=function(t){const e=[];let n=0;this.__index__>=0&&this.__text_cache__===t&&(e.push(Hm(this,n)),n=this.__last_index__);let r=n?t.slice(n):t;for(;this.test(r);)e.push(Hm(this,n)),r=r.slice(this.__last_index__),n+=this.__last_index__;return e.length?e:null},$m.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const e=this.re.schema_at_start.exec(t);if(!e)return null;const n=this.testSchemaAt(t,e[2],e[0].length);return n?(this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+n,Hm(this,0)):null},$m.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(t,e,n){return t!==n[e-1]}).reverse(),Bm(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,Bm(this),this)},$m.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),"mailto:"!==t.schema||/^mailto:/i.test(t.url)||(t.url="mailto:"+t.url)},$m.prototype.onCompile=function(){};const qm=2147483647,Vm=36,Wm=/^xn--/,Gm=/[^\0-\x7F]/,Um=/[\x2E\u3002\uFF0E\uFF61]/g,Ym={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Km=Math.floor,Xm=String.fromCharCode;function Jm(t){throw new RangeError(Ym[t])}function Zm(t,e){const n=t.split("@");let r="";n.length>1&&(r=n[0]+"@",t=n[1]);const o=function(t,e){const n=[];let r=t.length;for(;r--;)n[r]=e(t[r]);return n}((t=t.replace(Um,".")).split("."),e).join(".");return r+o}function Qm(t){const e=[];let n=0;const r=t.length;for(;n<r;){const o=t.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){const r=t.charCodeAt(n++);56320==(64512&r)?e.push(((1023&o)<<10)+(1023&r)+65536):(e.push(o),n--)}else e.push(o)}return e}const tg=function(t){return t>=48&&t<58?t-48+26:t>=65&&t<91?t-65:t>=97&&t<123?t-97:Vm},eg=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},ng=function(t,e,n){let r=0;for(t=n?Km(t/700):t>>1,t+=Km(t/e);t>455;r+=Vm)t=Km(t/35);return Km(r+36*t/(t+38))},rg=function(t){const e=[],n=t.length;let r=0,o=128,i=72,s=t.lastIndexOf("-");s<0&&(s=0);for(let n=0;n<s;++n)t.charCodeAt(n)>=128&&Jm("not-basic"),e.push(t.charCodeAt(n));for(let a=s>0?s+1:0;a<n;){const s=r;for(let e=1,o=Vm;;o+=Vm){a>=n&&Jm("invalid-input");const s=tg(t.charCodeAt(a++));s>=Vm&&Jm("invalid-input"),s>Km((qm-r)/e)&&Jm("overflow"),r+=s*e;const l=o<=i?1:o>=i+26?26:o-i;if(s<l)break;const c=Vm-l;e>Km(qm/c)&&Jm("overflow"),e*=c}const l=e.length+1;i=ng(r-s,l,0==s),Km(r/l)>qm-o&&Jm("overflow"),o+=Km(r/l),r%=l,e.splice(r++,0,o)}return String.fromCodePoint(...e)},og=function(t){const e=[],n=(t=Qm(t)).length;let r=128,o=0,i=72;for(const n of t)n<128&&e.push(Xm(n));const s=e.length;let a=s;for(s&&e.push("-");a<n;){let n=qm;for(const e of t)e>=r&&e<n&&(n=e);const l=a+1;n-r>Km((qm-o)/l)&&Jm("overflow"),o+=(n-r)*l,r=n;for(const n of t)if(n<r&&++o>qm&&Jm("overflow"),n===r){let t=o;for(let n=Vm;;n+=Vm){const r=n<=i?1:n>=i+26?26:n-i;if(t<r)break;const o=t-r,s=Vm-r;e.push(Xm(eg(r+o%s,0))),t=Km(o/s)}e.push(Xm(eg(t,0))),i=ng(o,l,a===s),o=0,++a}++o,++r}return e.join("")},ig=function(t){return Zm(t,function(t){return Gm.test(t)?"xn--"+og(t):t})},sg=function(t){return Zm(t,function(t){return Wm.test(t)?rg(t.slice(4).toLowerCase()):t})};const ag={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},zero:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}}},lg=/^(vbscript|javascript|file|data):/,cg=/^data:image\/(gif|png|jpeg|webp);/;function ug(t){const e=t.trim().toLowerCase();return!lg.test(e)||cg.test(e)}const dg=["http:","https:","mailto:"];function pg(t){const e=Hf(t,!0);if(e.hostname&&(!e.protocol||dg.indexOf(e.protocol)>=0))try{e.hostname=ig(e.hostname)}catch(t){}return Mf(Of(e))}function fg(t){const e=Hf(t,!0);if(e.hostname&&(!e.protocol||dg.indexOf(e.protocol)>=0))try{e.hostname=sg(e.hostname)}catch(t){}return Sf(Of(e),Sf.defaultChars+"%")}function hg(t,e){if(!(this instanceof hg))return new hg(t,e);e||ph(t)||(e=t||{},t="default"),this.inline=new Tm,this.block=new mm,this.core=new rm,this.renderer=new zh,this.linkify=new $m,this.validateLink=ug,this.normalizeLink=pg,this.normalizeLinkText=fg,this.utils=Ph,this.helpers=hh({},Lh),this.options={},this.configure(t),e&&this.set(e)}hg.prototype.set=function(t){return hh(this.options,t),this},hg.prototype.configure=function(t){const e=this;if(ph(t)){const e=t;if(!(t=ag[e]))throw new Error('Wrong `markdown-it` preset "'+e+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enableOnly(t.components[n].rules),t.components[n].rules2&&e[n].ruler2.enableOnly(t.components[n].rules2)}),this},hg.prototype.enable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(e){n=n.concat(this[e].ruler.enable(t,!0))},this),n=n.concat(this.inline.ruler2.enable(t,!0));const r=t.filter(function(t){return n.indexOf(t)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this},hg.prototype.disable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(e){n=n.concat(this[e].ruler.disable(t,!0))},this),n=n.concat(this.inline.ruler2.disable(t,!0));const r=t.filter(function(t){return n.indexOf(t)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this},hg.prototype.use=function(t){const e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this},hg.prototype.parse=function(t,e){if("string"!=typeof t)throw new Error("Input data should be a String");const n=new this.core.State(t,this,e);return this.core.process(n),n.tokens},hg.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)},hg.prototype.parseInline=function(t,e){const n=new this.core.State(t,this,e);return n.inlineMode=!0,this.core.process(n),n.tokens},hg.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};const mg=new J({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",0]},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["div",["hr"]]},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:t=>["h"+t.attrs.level,0]},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:t=>({params:t.getAttribute("data-params")||""})}],toDOM:t=>["pre",t.attrs.params?{"data-params":t.attrs.params}:{},["code",0]]},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs:t=>({order:t.hasAttribute("start")?+t.getAttribute("start"):1,tight:t.hasAttribute("data-tight")})}],toDOM:t=>["ol",{start:1==t.attrs.order?null:t.attrs.order,"data-tight":t.attrs.tight?"true":null},0]},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:t=>({tight:t.hasAttribute("data-tight")})}],toDOM:t=>["ul",{"data-tight":t.attrs.tight?"true":null},0]},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM:()=>["li",0]},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:t=>({src:t.getAttribute("src"),title:t.getAttribute("title"),alt:t.getAttribute("alt")})}],toDOM:t=>["img",t.attrs]},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:t=>"em"==t.type.name}],toDOM:()=>["em"]},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!=t.style.fontWeight&&null},{style:"font-weight=400",clearMark:t=>"strong"==t.type.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],toDOM:()=>["strong"]},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:t=>({href:t.getAttribute("href"),title:t.getAttribute("title")})}],toDOM:t=>["a",t.attrs]},code:{code:!0,parseDOM:[{tag:"code"}],toDOM:()=>["code"]}}});class gg{constructor(t,e){this.schema=t,this.tokenHandlers=e,this.stack=[{type:t.topNodeType,attrs:null,content:[],marks:p.none}]}top(){return this.stack[this.stack.length-1]}push(t){this.stack.length&&this.top().content.push(t)}addText(t){if(!t)return;let e,n=this.top(),r=n.content,o=r[r.length-1],i=this.schema.text(t,n.marks);o&&(e=function(t,e){if(t.isText&&e.isText&&p.sameSet(t.marks,e.marks))return t.withText(t.text+e.text)}(o,i))?r[r.length-1]=e:r.push(i)}openMark(t){let e=this.top();e.marks=t.addToSet(e.marks)}closeMark(t){let e=this.top();e.marks=t.removeFromSet(e.marks)}parseTokens(t){for(let e=0;e<t.length;e++){let n=t[e],r=this.tokenHandlers[n.type];if(!r)throw new Error("Token type `"+n.type+"` not supported by Markdown parser");r(this,n,t,e)}}addNode(t,e,n){let r=this.top(),o=t.createAndFill(e,n,r?r.marks:[]);return o?(this.push(o),o):null}openNode(t,e){this.stack.push({type:t,attrs:e,content:[],marks:p.none})}closeNode(){let t=this.stack.pop();return this.addNode(t.type,t.attrs,t.content)}}function vg(t,e,n,r){return t.getAttrs?t.getAttrs(e,n,r):t.attrs instanceof Function?t.attrs(e):t.attrs}function yg(t,e){return t.noCloseToken||"code_inline"==e||"code_block"==e||"fence"==e}function bg(t){return"\n"==t[t.length-1]?t.slice(0,t.length-1):t}function xg(){}function wg(t,e){for(;++e<t.length;)if("list_item_open"!=t[e].type)return t[e].hidden;return!1}new class{constructor(t,e,n){this.schema=t,this.tokenizer=e,this.tokens=n,this.tokenHandlers=function(t,e){let n=Object.create(null);for(let r in e){let o=e[r];if(o.block){let e=t.nodeType(o.block);yg(o,r)?n[r]=(t,n,r,i)=>{t.openNode(e,vg(o,n,r,i)),t.addText(bg(n.content)),t.closeNode()}:(n[r+"_open"]=(t,n,r,i)=>t.openNode(e,vg(o,n,r,i)),n[r+"_close"]=t=>t.closeNode())}else if(o.node){let e=t.nodeType(o.node);n[r]=(t,n,r,i)=>t.addNode(e,vg(o,n,r,i))}else if(o.mark){let e=t.marks[o.mark];yg(o,r)?n[r]=(t,n,r,i)=>{t.openMark(e.create(vg(o,n,r,i))),t.addText(bg(n.content)),t.closeMark(e)}:(n[r+"_open"]=(t,n,r,i)=>t.openMark(e.create(vg(o,n,r,i))),n[r+"_close"]=t=>t.closeMark(e))}else{if(!o.ignore)throw new RangeError("Unrecognized parsing spec "+JSON.stringify(o));yg(o,r)?n[r]=xg:(n[r+"_open"]=xg,n[r+"_close"]=xg)}}return n.text=(t,e)=>t.addText(e.content),n.inline=(t,e)=>t.parseTokens(e.children),n.softbreak=n.softbreak||(t=>t.addText(" ")),n}(t,n)}parse(t,e={}){let n,r=new gg(this.schema,this.tokenHandlers);r.parseTokens(this.tokenizer.parse(t,e));do{n=r.closeNode()}while(r.stack.length);return n||this.schema.topNodeType.createAndFill()}}(mg,hg("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:(t,e,n)=>({tight:wg(e,n)})},ordered_list:{block:"ordered_list",getAttrs:(t,e,n)=>({order:+t.attrGet("start")||1,tight:wg(e,n)})},heading:{block:"heading",getAttrs:t=>({level:+t.tag.slice(1)})},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:t=>({params:t.info||""}),noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:t=>({src:t.attrGet("src"),title:t.attrGet("title")||null,alt:t.children[0]&&t.children[0].content||null})},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:t=>({href:t.attrGet("href"),title:t.attrGet("title")||null})},code_inline:{mark:"code",noCloseToken:!0}});const kg={open:"",close:"",mixable:!0};const Eg=new class{constructor(t,e,n={}){this.nodes=t,this.marks=e,this.options=n}serialize(t,e={}){e=Object.assign({},this.options,e);let n=new Sg(this.nodes,this.marks,e);return n.renderContent(t),n.out}}({blockquote(t,e){t.wrapBlock("> ",null,e,()=>t.renderContent(e))},code_block(t,e){const n=e.textContent.match(/`{3,}/gm),r=n?n.sort().slice(-1)[0]+"`":"```";t.write(r+(e.attrs.params||"")+"\n"),t.text(e.textContent,!1),t.write("\n"),t.write(r),t.closeBlock(e)},heading(t,e){t.write(t.repeat("#",e.attrs.level)+" "),t.renderInline(e,!1),t.closeBlock(e)},horizontal_rule(t,e){t.write(e.attrs.markup||"---"),t.closeBlock(e)},bullet_list(t,e){t.renderList(e,"  ",()=>(e.attrs.bullet||"*")+" ")},ordered_list(t,e){let n=e.attrs.order||1,r=String(n+e.childCount-1).length,o=t.repeat(" ",r+2);t.renderList(e,o,e=>{let o=String(n+e);return t.repeat(" ",r-o.length)+o+". "})},list_item(t,e){t.renderContent(e)},paragraph(t,e){t.renderInline(e),t.closeBlock(e)},image(t,e){t.write("!["+t.esc(e.attrs.alt||"")+"]("+e.attrs.src.replace(/[\(\)]/g,"\\$&")+(e.attrs.title?' "'+e.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break(t,e,n,r){for(let o=r+1;o<n.childCount;o++)if(n.child(o).type!=e.type)return void t.write("\\\n")},text(t,e){t.text(e.text,!t.inAutolink)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open:(t,e,n,r)=>(t.inAutolink=function(t,e,n){if(t.attrs.title||!/^\w+:/.test(t.attrs.href))return!1;let r=e.child(n);return!(!r.isText||r.text!=t.attrs.href||r.marks[r.marks.length-1]!=t)&&(n==e.childCount-1||!t.isInSet(e.child(n+1).marks))}(e,n,r),t.inAutolink?"<":"["),close(t,e,n,r){let{inAutolink:o}=t;return t.inAutolink=void 0,o?">":"]("+e.attrs.href.replace(/[\(\)"]/g,"\\$&")+(e.attrs.title?` "${e.attrs.title.replace(/"/g,'\\"')}"`:"")+")"},mixable:!0},code:{open:(t,e,n,r)=>Cg(n.child(r),-1),close:(t,e,n,r)=>Cg(n.child(r-1),1),escape:!1}});function Cg(t,e){let n,r=/`+/g,o=0;if(t.isText)for(;n=r.exec(t.text);)o=Math.max(o,n[0].length);let i=o>0&&e>0?" `":"`";for(let t=0;t<o;t++)i+="`";return o>0&&e<0&&(i+=" "),i}let Sg=class{constructor(t,e,n){this.nodes=t,this.marks=e,this.options=n,this.delim="",this.out="",this.closed=null,this.inAutolink=void 0,this.atBlockStart=!1,this.inTightList=!1,void 0===this.options.tightLists&&(this.options.tightLists=!1),void 0===this.options.hardBreakNodeName&&(this.options.hardBreakNodeName="hard_break")}flushClose(t=2){if(this.closed){if(this.atBlank()||(this.out+="\n"),t>1){let e=this.delim,n=/\s+$/.exec(e);n&&(e=e.slice(0,e.length-n[0].length));for(let n=1;n<t;n++)this.out+=e+"\n"}this.closed=null}}getMark(t){let e=this.marks[t];if(!e){if(!1!==this.options.strict)throw new Error(`Mark type \`${t}\` not supported by Markdown renderer`);e=kg}return e}wrapBlock(t,e,n,r){let o=this.delim;this.write(null!=e?e:t),this.delim+=t,r(),this.delim=o,this.closeBlock(n)}atBlank(){return/(^|\n)$/.test(this.out)}ensureNewLine(){this.atBlank()||(this.out+="\n")}write(t){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),t&&(this.out+=t)}closeBlock(t){this.closed=t}text(t,e=!0){let n=t.split("\n");for(let t=0;t<n.length;t++)this.write(),!e&&"["==n[t][0]&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=e?this.esc(n[t],this.atBlockStart):n[t],t!=n.length-1&&(this.out+="\n")}render(t,e,n){if(this.nodes[t.type.name])this.nodes[t.type.name](this,t,e,n);else{if(!1!==this.options.strict)throw new Error("Token type `"+t.type.name+"` not supported by Markdown renderer");t.type.isLeaf||(t.type.inlineContent?this.renderInline(t):this.renderContent(t),t.isBlock&&this.closeBlock(t))}}renderContent(t){t.forEach((e,n,r)=>this.render(e,t,r))}renderInline(t,e=!0){this.atBlockStart=e;let n=[],r="",o=(e,o,i)=>{let s=e?e.marks:[];e&&e.type.name===this.options.hardBreakNodeName&&(s=s.filter(e=>{if(i+1==t.childCount)return!1;let n=t.child(i+1);return e.isInSet(n.marks)&&(!n.isText||/\S/.test(n.text))}));let a=r;if(r="",e&&e.isText&&s.some(t=>{let e=this.getMark(t.type.name);return e&&e.expelEnclosingWhitespace&&!t.isInSet(n)})){let[t,r,o]=/^(\s*)(.*)$/m.exec(e.text);r&&(a+=r,(e=o?e.withText(o):null)||(s=n))}if(e&&e.isText&&s.some(e=>{let n=this.getMark(e.type.name);return n&&n.expelEnclosingWhitespace&&(i==t.childCount-1||!e.isInSet(t.child(i+1).marks))})){let[t,o,i]=/^(.*?)(\s*)$/m.exec(e.text);i&&(r=i,(e=o?e.withText(o):null)||(s=n))}let l=s.length?s[s.length-1]:null,c=l&&!1===this.getMark(l.type.name).escape,u=s.length-(c?1:0);t:for(let t=0;t<u;t++){let e=s[t];if(!this.getMark(e.type.name).mixable)break;for(let r=0;r<n.length;r++){let o=n[r];if(!this.getMark(o.type.name).mixable)break;if(e.eq(o)){t>r?s=s.slice(0,r).concat(e).concat(s.slice(r,t)).concat(s.slice(t+1,u)):r>t&&(s=s.slice(0,t).concat(s.slice(t+1,r)).concat(e).concat(s.slice(r,u)));continue t}}}let d=0;for(;d<Math.min(n.length,u)&&s[d].eq(n[d]);)++d;for(;d<n.length;)this.text(this.markString(n.pop(),!1,t,i),!1);if(a&&this.text(a),e){for(;n.length<u;){let e=s[n.length];n.push(e),this.text(this.markString(e,!0,t,i),!1),this.atBlockStart=!1}c&&e.isText?this.text(this.markString(l,!0,t,i)+e.text+this.markString(l,!1,t,i+1),!1):this.render(e,t,i),this.atBlockStart=!1}(null==e?void 0:e.isText)&&e.nodeSize>0&&(this.atBlockStart=!1)};t.forEach(o),o(null,0,t.childCount),this.atBlockStart=!1}renderList(t,e,n){this.closed&&this.closed.type==t.type?this.flushClose(3):this.inTightList&&this.flushClose(1);let r=void 0!==t.attrs.tight?t.attrs.tight:this.options.tightLists,o=this.inTightList;this.inTightList=r,t.forEach((o,i,s)=>{s&&r&&this.flushClose(1),this.wrapBlock(e,n(s),t,()=>this.render(o,t,s))}),this.inTightList=o}esc(t,e=!1){return t=t.replace(/[`*\\~\[\]_]/g,(e,n)=>"_"==e&&n>0&&n+1<t.length&&t[n-1].match(/\w/)&&t[n+1].match(/\w/)?e:"\\"+e),e&&(t=t.replace(/^(\+[ ]|[\-*>])/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(t=t.replace(this.options.escapeExtraCharacters,"\\$&")),t}quote(t){let e=-1==t.indexOf('"')?'""':-1==t.indexOf("'")?"''":"()";return e[0]+t+e[1]}repeat(t,e){let n="";for(let r=0;r<e;r++)n+=t;return n}markString(t,e,n,r){let o=this.getMark(t.type.name),i=e?o.open:o.close;return"string"==typeof i?i:i(this,t,n,r)}getEnclosingWhitespace(t){return{leading:(t.match(/^(\s+)/)||[void 0])[0],trailing:(t.match(/(\s+)$/)||[void 0])[0]}}};function Dg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Mg,Og;var _g=function(){if(Og)return Mg;Og=1;var t=!0,e=!1,n=!1;function r(t,e,n){var r=t.attrIndex(e),o=[e,n];r<0?t.attrPush(o):t.attrs[r]=o}function o(t,e){for(var n=t[e].level-1,r=e-1;r>=0;r--)if(t[r].level===n)return r;return-1}function i(t,e){return"inline"===t[e].type&&function(t){return"paragraph_open"===t.type}(t[e-1])&&function(t){return"list_item_open"===t.type}(t[e-2])&&function(t){return 0===t.content.indexOf("[ ] ")||0===t.content.indexOf("[x] ")||0===t.content.indexOf("[X] ")}(t[e])}function s(r,o){if(r.children.unshift(function(e,n){var r=new n("html_inline","",0),o=t?' disabled="" ':"";0===e.content.indexOf("[ ] ")?r.content='<input class="task-list-item-checkbox"'+o+'type="checkbox">':0!==e.content.indexOf("[x] ")&&0!==e.content.indexOf("[X] ")||(r.content='<input class="task-list-item-checkbox" checked=""'+o+'type="checkbox">');return r}(r,o)),r.children[1].content=r.children[1].content.slice(3),r.content=r.content.slice(3),e)if(n){r.children.pop();var i="task-item-"+Math.ceil(1e7*Math.random()-1e3);r.children[0].content=r.children[0].content.slice(0,-1)+' id="'+i+'">',r.children.push(function(t,e,n){var r=new n("html_inline","",0);return r.content='<label class="task-list-item-label" for="'+e+'">'+t+"</label>",r.attrs=[{for:e}],r}(r.content,i,o))}else r.children.unshift(function(t){var e=new t("html_inline","",0);return e.content="<label>",e}(o)),r.children.push(function(t){var e=new t("html_inline","",0);return e.content="</label>",e}(o))}return Mg=function(a,l){l&&(t=!l.enabled,e=!!l.label,n=!!l.labelAfter),a.core.ruler.after("inline","github-task-lists",function(e){for(var n=e.tokens,a=2;a<n.length;a++)i(n,a)&&(s(n[a],e.Token),r(n[a-2],"class","task-list-item"+(t?"":" enabled")),r(n[o(n,a-2)],"class","contains-task-list"))})},Mg}(),Ag=Dg(_g),Tg=Object.defineProperty,Rg=(t,e,n)=>(((t,e,n)=>{e in t?Tg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const Ng=ns.create({name:"markdownTightLists",addOptions:()=>({tight:!0,tightClass:"tight",listTypes:["bulletList","orderedList"]}),addGlobalAttributes(){return[{types:this.options.listTypes,attributes:{tight:{default:this.options.tight,parseHTML:t=>"true"===t.getAttribute("data-tight")||!t.querySelector("p"),renderHTML:t=>({class:t.tight?this.options.tightClass:null,"data-tight":t.tight?"true":null})}}}]},addCommands(){var t=this;return{toggleTight:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return n=>{let{editor:r,commands:o}=n;return t.options.listTypes.some(t=>function(t){if(!r.isActive(t))return!1;const n=r.getAttributes(t);return o.updateAttributes(t,{tight:null!=e?e:!(null!=n&&n.tight)})}(t))}}}}}),Pg=hg();function Lg(t,e){Pg.inline.State.prototype.scanDelims.call({src:t,posMax:t.length});return new Pg.inline.State(t,null,null,[]).scanDelims(e,!0)}function Ig(t,e,n,r){let o=t.substring(0,n)+t.substring(n+e.length);return o=o.substring(0,n+r)+e+o.substring(n+r),o}function zg(t,e,n,r){let o={text:t,from:n,to:r};return o=function(t,e,n,r){let o=n,i=t;for(;o<r&&!Lg(i,o).can_open;)i=Ig(i,e,o,1),o++;return{text:i,from:o,to:r}}(o.text,e,o.from,o.to),o=function(t,e,n,r){let o=r,i=t;for(;o>n&&!Lg(i,o).can_close;)i=Ig(i,e,o,-1),o--;return{text:i,from:n,to:o}}(o.text,e,o.from,o.to),o.to-o.from<e.length+1&&(o.text=o.text.substring(0,o.from)+o.text.substring(o.to+e.length)),o.text}class Fg extends Sg{constructor(t,e,n){super(t,e,null!=n?n:{}),Rg(this,"inTable",!1),this.inlines=[]}render(t,e,n){super.render(t,e,n);const r=this.inlines[this.inlines.length-1];if(null!=r&&r.start&&null!=r&&r.end){const{delimiter:t,start:e,end:n}=this.normalizeInline(r);this.out=zg(this.out,t,e,n),this.inlines.pop()}}markString(t,e,n,r){const o=this.marks[t.type.name];if(o.expelEnclosingWhitespace)if(e)this.inlines.push({start:this.out.length,delimiter:o.open});else{const t=this.inlines.pop();this.inlines.push({...t,end:this.out.length})}return super.markString(t,e,n,r)}normalizeInline(t){let{start:e,end:n}=t;for(;this.out.charAt(e).match(/\s/);)e++;return{...t,start:e}}}const Bg=Xi.create({name:"markdownHTMLMark",addStorage:()=>({markdown:{serialize:{open(t,e){var n,r;return this.editor.storage.markdown.options.html?null!==(n=null===(r=jg(e))||void 0===r?void 0:r[0])&&void 0!==n?n:"":(console.warn(`Tiptap Markdown: "${e.type.name}" mark is only available in html mode`),"")},close(t,e){var n,r;return this.editor.storage.markdown.options.html&&null!==(n=null===(r=jg(e))||void 0===r?void 0:r[1])&&void 0!==n?n:""}},parse:{}}})});function jg(t){const e=t.type.schema,n=e.text(" ",[t]),r=qi(l.from(n),e).match(/^(<.*?>) (<\/.*?>)$/);return r?[r[1],r[2]]:null}function Hg(t){const e=`<body>${t}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}const $g=Qs.create({name:"markdownHTMLNode",addStorage:()=>({markdown:{serialize(t,e,n){this.editor.storage.markdown.options.html?t.write(function(t,e){const n=t.type.schema,r=qi(l.from(t),n);if(t.isBlock&&(e instanceof l||e.type.name===n.topNodeType.name))return function(t){const e=Hg(t),n=e.firstElementChild;return n.innerHTML=n.innerHTML.trim()?`\n${n.innerHTML}\n`:"\n",n.outerHTML}(r);return r}(e,n)):(console.warn(`Tiptap Markdown: "${e.type.name}" node is only available in html mode`),t.write(`[${e.type.name}]`)),e.isBlock&&t.closeBlock(e)},parse:{}}})});const qg=Qs.create({name:"blockquote"}).extend({addStorage:()=>({markdown:{serialize:Eg.nodes.blockquote,parse:{}}})}),Vg=Qs.create({name:"bulletList"}).extend({addStorage:()=>({markdown:{serialize(t,e){return t.renderList(e,"  ",()=>(this.editor.storage.markdown.options.bulletListMarker||"-")+" ")},parse:{}}})}),Wg=Qs.create({name:"codeBlock"}).extend({addStorage:()=>({markdown:{serialize(t,e){t.write("```"+(e.attrs.language||"")+"\n"),t.text(e.textContent,!1),t.ensureNewLine(),t.write("```"),t.closeBlock(e)},parse:{setup(t){var e;t.set({langPrefix:null!==(e=this.options.languageClassPrefix)&&void 0!==e?e:"language-"})},updateDOM(t){t.innerHTML=t.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}})}),Gg=Qs.create({name:"hardBreak"}).extend({addStorage:()=>({markdown:{serialize(t,e,n,r){for(let o=r+1;o<n.childCount;o++)if(n.child(o).type!=e.type)return void t.write(t.inTable?$g.storage.markdown.serialize.call(this,t,e,n):"\\\n")},parse:{}}})}),Ug=Qs.create({name:"heading"}).extend({addStorage:()=>({markdown:{serialize:Eg.nodes.heading,parse:{}}})}),Yg=Qs.create({name:"horizontalRule"}).extend({addStorage:()=>({markdown:{serialize:Eg.nodes.horizontal_rule,parse:{}}})}),Kg=Qs.create({name:"image"}).extend({addStorage:()=>({markdown:{serialize:Eg.nodes.image,parse:{}}})}),Xg=Qs.create({name:"listItem"}).extend({addStorage:()=>({markdown:{serialize:Eg.nodes.list_item,parse:{}}})});const Jg=Qs.create({name:"orderedList"}).extend({addStorage:()=>({markdown:{serialize(t,e,n,r){const o=e.attrs.start||1,i=String(o+e.childCount-1).length,s=t.repeat(" ",i+2),a=function(t,e,n){let r=0;for(;n-r>0&&e.child(n-r-1).type.name===t.type.name;r++);return r}(e,n,r),l=a%2?") ":". ";t.renderList(e,s,e=>{const n=String(o+e);return t.repeat(" ",i-n.length)+n+l})},parse:{}}})}),Zg=Qs.create({name:"paragraph"}).extend({addStorage:()=>({markdown:{serialize:Eg.nodes.paragraph,parse:{}}})});function Qg(t){var e,n;return null!==(e=null==t||null===(n=t.content)||void 0===n?void 0:n.content)&&void 0!==e?e:[]}const tv=Qs.create({name:"table"}).extend({addStorage:()=>({markdown:{serialize(t,e,n){!function(t){const e=Qg(t),n=e[0],r=e.slice(1);if(Qg(n).some(t=>"tableHeader"!==t.type.name||ev(t)||t.childCount>1))return!1;if(r.some(t=>Qg(t).some(t=>"tableHeader"===t.type.name||ev(t)||t.childCount>1)))return!1;return!0}(e)?$g.storage.markdown.serialize.call(this,t,e,n):(t.inTable=!0,e.forEach((e,n,r)=>{if(t.write("| "),e.forEach((e,n,r)=>{r&&t.write(" | ");const o=e.firstChild;o.textContent.trim()&&t.renderInline(o)}),t.write(" |"),t.ensureNewLine(),!r){const n=Array.from({length:e.childCount}).map(()=>"---").join(" | ");t.write(`| ${n} |`),t.ensureNewLine()}}),t.closeBlock(e),t.inTable=!1)},parse:{}}})});function ev(t){return t.attrs.colspan>1||t.attrs.rowspan>1}const nv=Qs.create({name:"taskItem"}).extend({addStorage:()=>({markdown:{serialize(t,e){const n=e.attrs.checked?"[x]":"[ ]";t.write(`${n} `),t.renderContent(e)},parse:{updateDOM(t){[...t.querySelectorAll(".task-list-item")].forEach(t=>{const e=t.querySelector("input");t.setAttribute("data-type","taskItem"),e&&(t.setAttribute("data-checked",e.checked),e.remove())})}}}})}),rv=Qs.create({name:"taskList"}).extend({addStorage:()=>({markdown:{serialize:Vg.storage.markdown.serialize,parse:{setup(t){t.use(Ag)},updateDOM(t){[...t.querySelectorAll(".contains-task-list")].forEach(t=>{t.setAttribute("data-type","taskList")})}}}})}),ov=Qs.create({name:"text"}).extend({addStorage:()=>({markdown:{serialize(t,e){var n;t.text(null==(n=e.text)?void 0:n.replace(/</g,"&lt;").replace(/>/g,"&gt;"))},parse:{}}})}),iv=Xi.create({name:"bold"}).extend({addStorage:()=>({markdown:{serialize:Eg.marks.strong,parse:{}}})}),sv=Xi.create({name:"code"}).extend({addStorage:()=>({markdown:{serialize:Eg.marks.code,parse:{}}})}),av=Xi.create({name:"italic"}).extend({addStorage:()=>({markdown:{serialize:Eg.marks.em,parse:{}}})}),lv=Xi.create({name:"link"}).extend({addStorage:()=>({markdown:{serialize:Eg.marks.link,parse:{}}})}),cv=Xi.create({name:"strike"}).extend({addStorage:()=>({markdown:{serialize:{open:"~~",close:"~~",expelEnclosingWhitespace:!0},parse:{}}})}),uv=[qg,Vg,Wg,Gg,Ug,Yg,$g,Kg,Xg,Jg,Zg,tv,nv,rv,ov,iv,sv,Bg,av,lv,cv];function dv(t){var e,n;const r=null===(e=t.storage)||void 0===e?void 0:e.markdown,o=null===(n=uv.find(e=>e.name===t.name))||void 0===n?void 0:n.storage.markdown;return r||o?{...o,...r}:null}class pv{constructor(t){Rg(this,"editor",null),this.editor=t}serialize(t){const e=new Fg(this.nodes,this.marks,{hardBreakNodeName:Gg.name});return e.renderContent(t),e.out}get nodes(){var t;return{...Object.fromEntries(Object.keys(this.editor.schema.nodes).map(t=>[t,this.serializeNode($g)])),...Object.fromEntries(null!==(t=this.editor.extensionManager.extensions.filter(t=>"node"===t.type&&this.serializeNode(t)).map(t=>[t.name,this.serializeNode(t)]))&&void 0!==t?t:[])}}get marks(){var t;return{...Object.fromEntries(Object.keys(this.editor.schema.marks).map(t=>[t,this.serializeMark(Bg)])),...Object.fromEntries(null!==(t=this.editor.extensionManager.extensions.filter(t=>"mark"===t.type&&this.serializeMark(t)).map(t=>[t.name,this.serializeMark(t)]))&&void 0!==t?t:[])}}serializeNode(t){var e;return null===(e=dv(t))||void 0===e||null===(e=e.serialize)||void 0===e?void 0:e.bind({editor:this.editor,options:t.options})}serializeMark(t){var e;const n=null===(e=dv(t))||void 0===e?void 0:e.serialize;return n?{...n,open:"function"==typeof n.open?n.open.bind({editor:this.editor,options:t.options}):n.open,close:"function"==typeof n.close?n.close.bind({editor:this.editor,options:t.options}):n.close}:null}}class fv{constructor(t,e){Rg(this,"editor",null),Rg(this,"md",null);let{html:n,linkify:r,breaks:o}=e;this.editor=t,this.md=this.withPatchedRenderer(hg({html:n,linkify:r,breaks:o}))}parse(t){let{inline:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t){this.editor.extensionManager.extensions.forEach(t=>{var e;return null===(e=dv(t))||void 0===e||null===(e=e.parse)||void 0===e||null===(e=e.setup)||void 0===e?void 0:e.call({editor:this.editor,options:t.options},this.md)});const n=Hg(this.md.render(t));return this.editor.extensionManager.extensions.forEach(t=>{var e;return null===(e=dv(t))||void 0===e||null===(e=e.parse)||void 0===e||null===(e=e.updateDOM)||void 0===e?void 0:e.call({editor:this.editor,options:t.options},n)}),this.normalizeDOM(n,{inline:e,content:t}),n.innerHTML}return t}normalizeDOM(t,e){let{inline:n,content:r}=e;return this.normalizeBlocks(t),t.querySelectorAll("*").forEach(t=>{var e;(null===(e=t.nextSibling)||void 0===e?void 0:e.nodeType)!==Node.TEXT_NODE||t.closest("pre")||(t.nextSibling.textContent=t.nextSibling.textContent.replace(/^\n/,""))}),n&&this.normalizeInline(t,r),t}normalizeBlocks(t){const e=Object.values(this.editor.schema.nodes).filter(t=>t.isBlock).map(t=>{var e;return null===(e=t.spec.parseDOM)||void 0===e?void 0:e.map(t=>t.tag)}).flat().filter(Boolean).join(",");e&&[...t.querySelectorAll(e)].forEach(t=>{t.parentElement.matches("p")&&function(t){const e=t.parentElement,n=e.cloneNode();for(;e.firstChild&&e.firstChild!==t;)n.appendChild(e.firstChild);n.childNodes.length>0&&e.parentElement.insertBefore(n,e),e.parentElement.insertBefore(t,e),0===e.childNodes.length&&e.remove()}(t)})}normalizeInline(t,e){var n;if(null!==(n=t.firstElementChild)&&void 0!==n&&n.matches("p")){var r,o,i,s;const n=t.firstElementChild,{nextElementSibling:a}=n,l=null!==(r=null===(o=e.match(/^\s+/))||void 0===o?void 0:o[0])&&void 0!==r?r:"",c=a?"":null!==(i=null===(s=e.match(/\s+$/))||void 0===s?void 0:s[0])&&void 0!==i?i:"";if(e.match(/^\n\n/))return void(n.innerHTML=`${n.innerHTML}${c}`);!function(t){const e=t.parentNode;for(;t.firstChild;)e.insertBefore(t.firstChild,t);e.removeChild(t)}(n),t.innerHTML=`${l}${t.innerHTML}${c}`}}withPatchedRenderer(t){const e=t=>function(){const e=t(...arguments);return"\n"===e?e:"\n"===e[e.length-1]?e.slice(0,-1):e};return t.renderer.rules.hardbreak=e(t.renderer.rules.hardbreak),t.renderer.rules.softbreak=e(t.renderer.rules.softbreak),t.renderer.rules.fence=e(t.renderer.rules.fence),t.renderer.rules.code_block=e(t.renderer.rules.code_block),t.renderer.renderToken=e(t.renderer.renderToken.bind(t.renderer)),t}}const hv=ns.create({name:"markdownClipboard",addOptions:()=>({transformPastedText:!1,transformCopiedText:!1}),addProseMirrorPlugins(){return[new Se({key:new Oe("markdownClipboard"),props:{clipboardTextParser:(t,e,n)=>{if(n||!this.options.transformPastedText)return null;const r=this.editor.storage.markdown.parser.parse(t,{inline:!0});return Q.fromSchema(this.editor.schema).parseSlice(Hg(r),{preserveWhitespace:!0,context:e})},clipboardTextSerializer:t=>this.options.transformCopiedText?this.editor.storage.markdown.serializer.serialize(t.content):null}})]}}),mv=ns.create({name:"markdown",priority:50,addOptions:()=>({html:!0,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!1,breaks:!1,transformPastedText:!1,transformCopiedText:!1}),addCommands(){const t=Gs.Commands.config.addCommands();return{setContent:(e,n,r)=>o=>t.setContent(o.editor.storage.markdown.parser.parse(e),n,r)(o),insertContentAt:(e,n,r)=>o=>t.insertContentAt(e,o.editor.storage.markdown.parser.parse(n,{inline:!0}),r)(o)}},onBeforeCreate(){this.editor.storage.markdown={options:{...this.options},parser:new fv(this.editor,this.options),serializer:new pv(this.editor),getMarkdown:()=>this.editor.storage.markdown.serializer.serialize(this.editor.state.doc)},this.editor.options.initialContent=this.editor.options.content,this.editor.options.content=this.editor.storage.markdown.parser.parse(this.editor.options.content)},onCreate(){this.editor.options.content=this.editor.options.initialContent,delete this.editor.options.initialContent},addStorage:()=>({}),addExtensions(){return[Ng.configure({tight:this.options.tightLists,tightClass:this.options.tightListClass}),hv.configure({transformPastedText:this.options.transformPastedText,transformCopiedText:this.options.transformCopiedText})]}}),gv=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,vv=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,yv=Xi.create({name:"highlight",addOptions:()=>({multicolor:!1,HTMLAttributes:{}}),addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML:()=>[{tag:"mark"}],renderHTML({HTMLAttributes:t}){return["mark",Li(this.options.HTMLAttributes,t),0]},addCommands(){return{setHighlight:t=>({commands:e})=>e.setMark(this.name,t),toggleHighlight:t=>({commands:e})=>e.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Ks({find:gv,type:this.type})]},addPasteRules(){return[ta({find:vv,type:this.type})]}});function bv(t){var e;const{char:n,allowSpaces:r,allowToIncludeChar:o,allowedPrefixes:i,startOfLine:s,$position:a}=t,l=r&&!o,c=n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&");const u=new RegExp(`\\s${c}$`),d=s?"^":"",p=o?"":c,f=l?new RegExp(`${d}${c}.*?(?=\\s${p}|$)`,"gm"):new RegExp(`${d}(?:^)?${c}[^\\s${p}]*`,"gm"),h=(null===(e=a.nodeBefore)||void 0===e?void 0:e.isText)&&a.nodeBefore.text;if(!h)return null;const m=a.pos-h.length,g=Array.from(h.matchAll(f)).pop();if(!g||void 0===g.input||void 0===g.index)return null;const v=g.input.slice(Math.max(0,g.index-1),g.index),y=new RegExp(`^[${null==i?void 0:i.join("")}\0]?$`).test(v);if(null!==i&&!y)return null;const b=m+g.index;let x=b+g[0].length;return l&&u.test(h.slice(x-1,x+1))&&(g[0]+=" ",x+=1),b<a.pos&&x>=a.pos?{range:{from:b,to:x},query:g[0].slice(n.length),text:g[0]}:null}const xv=new Oe("suggestion");function wv({pluginKey:t=xv,editor:e,char:n="@",allowSpaces:r=!1,allowToIncludeChar:o=!1,allowedPrefixes:i=[" "],startOfLine:s=!1,decorationTag:a="span",decorationClass:l="suggestion",command:c=()=>null,items:u=()=>[],render:d=()=>({}),allow:p=()=>!0,findSuggestionMatch:f=bv}){let h;const m=null==d?void 0:d(),g=new Se({key:t,view(){return{update:async(t,n)=>{var r,o,i,s,a,l,d;const p=null===(r=this.key)||void 0===r?void 0:r.getState(n),f=null===(o=this.key)||void 0===o?void 0:o.getState(t.state),g=p.active&&f.active&&p.range.from!==f.range.from,v=!p.active&&f.active,y=p.active&&!f.active,b=!v&&!y&&p.query!==f.query,x=v||g&&b,w=b||g,k=y||g&&b;if(!x&&!w&&!k)return;const E=k&&!x?p:f,C=t.dom.querySelector(`[data-decoration-id="${E.decorationId}"]`);h={editor:e,range:E.range,query:E.query,text:E.text,items:[],command:t=>c({editor:e,range:E.range,props:t}),decorationNode:C,clientRect:C?()=>{var n;const{decorationId:r}=null===(n=this.key)||void 0===n?void 0:n.getState(e.state),o=t.dom.querySelector(`[data-decoration-id="${r}"]`);return(null==o?void 0:o.getBoundingClientRect())||null}:null},x&&(null===(i=null==m?void 0:m.onBeforeStart)||void 0===i||i.call(m,h)),w&&(null===(s=null==m?void 0:m.onBeforeUpdate)||void 0===s||s.call(m,h)),(w||x)&&(h.items=await u({editor:e,query:E.query})),k&&(null===(a=null==m?void 0:m.onExit)||void 0===a||a.call(m,h)),w&&(null===(l=null==m?void 0:m.onUpdate)||void 0===l||l.call(m,h)),x&&(null===(d=null==m?void 0:m.onStart)||void 0===d||d.call(m,h))},destroy:()=>{var t;h&&(null===(t=null==m?void 0:m.onExit)||void 0===t||t.call(m,h))}}},state:{init:()=>({active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}),apply(t,a,l,c){const{isEditable:u}=e,{composing:d}=e.view,{selection:h}=t,{empty:m,from:g}=h,v={...a};if(v.composing=d,u&&(m||e.view.composing)){!(g<a.range.from||g>a.range.to)||d||a.composing||(v.active=!1);const t=f({char:n,allowSpaces:r,allowToIncludeChar:o,allowedPrefixes:i,startOfLine:s,$position:h.$from}),l=`id_${Math.floor(4294967295*Math.random())}`;t&&p({editor:e,state:c,range:t.range,isActive:a.active})?(v.active=!0,v.decorationId=a.decorationId?a.decorationId:l,v.range=t.range,v.query=t.query,v.text=t.text):v.active=!1}else v.active=!1;return v.active||(v.decorationId=null,v.range={from:0,to:0},v.query=null,v.text=null),v}},props:{handleKeyDown(t,e){var n;const{active:r,range:o}=g.getState(t.state);return r&&(null===(n=null==m?void 0:m.onKeyDown)||void 0===n?void 0:n.call(m,{view:t,event:e,range:o}))||!1},decorations(t){const{active:e,range:n,decorationId:r}=g.getState(t);return e?go.create(t.doc,[fo.inline(n.from,n.to,{nodeName:a,class:l,"data-decoration-id":r})]):null}}});return g}var kv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ev=(e,n)=>{const r=t.forwardRef(({color:r="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:s,children:a,...l},c)=>{return t.createElement("svg",{ref:c,...kv,width:o,height:o,stroke:r,strokeWidth:s?24*Number(i)/Number(o):i,className:`lucide lucide-${u=e,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,...l},[...n.map(([e,n])=>t.createElement(e,n)),...(Array.isArray(a)?a:[a])||[]]);var u});return r.displayName=`${e}`,r},Cv=Ev("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]),Sv=Ev("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),Dv=Ev("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Mv=Ev("ChevronDown",[["polyline",{points:"6 9 12 15 18 9",key:"1do0m2"}]]),Ov=Ev("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),_v=Ev("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]),Av=Ev("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]),Tv=Ev("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]),Rv=Ev("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Nv=Ev("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),Pv=Ev("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]),Lv=Ev("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),Iv=Ev("Strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]),zv=Ev("TextQuote",[["path",{d:"M17 6H3",key:"16j9eg"}],["path",{d:"M21 12H8",key:"scolzb"}],["path",{d:"M21 18H8",key:"1wfozv"}],["path",{d:"M3 12v6",key:"fv4c87"}]]),Fv=Ev("Text",[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]]),Bv=Ev("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),jv=Ev("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);function Hv({dimensions:t}){return React.createElement("svg",{"aria-hidden":"true",className:`${t||"novel-h-4 novel-w-4"} novel-animate-spin novel-fill-stone-600 novel-text-stone-200`,viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),React.createElement("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"}))}const $v=t.createContext({completionApi:"/api/generate"}),qv=ns.create({name:"slash-command",addOptions:()=>({suggestion:{char:"/",command:({editor:t,range:e,props:n})=>{n.command({editor:t,range:e})}}}),addProseMirrorPlugins(){return[wv({editor:this.editor,...this.options.suggestion})]}}),Vv=({items:e,command:n,editor:r,range:o})=>{const[i,s]=t.useState(0),{handleUserImageUpload:a}=t.useContext($v),l=t.useCallback(t=>{const i=e[t];if(i)if("Image"===i.title){r.chain().focus().deleteRange(o).run();const t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=async()=>{var e;if(null==(e=t.files)?void 0:e.length){const e=t.files[0],n=r.view.state.selection.from;eu(e,r.view,n,a)}},t.click()}else n(i)},[n,r,e,o,a]);t.useEffect(()=>{const t=["ArrowUp","ArrowDown","Enter"],n=n=>{if(t.includes(n.key))return n.preventDefault(),"ArrowUp"===n.key?(s((i+e.length-1)%e.length),!0):"ArrowDown"===n.key?(s((i+1)%e.length),!0):"Enter"===n.key&&(l(i),!0)};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[e,i,s,l]),t.useEffect(()=>{s(0)},[e]);const c=t.useRef(null);return t.useLayoutEffect(()=>{const t=null==c?void 0:c.current,e=null==t?void 0:t.children[i];e&&t&&((t,e)=>{const n=t.offsetHeight,r=e?e.offsetHeight:0,o=e.offsetTop,i=o+r;o<t.scrollTop?t.scrollTop-=t.scrollTop-o+5:i>n+t.scrollTop&&(t.scrollTop+=i-n-t.scrollTop+5)})(t,e)},[i]),e.length>0?t.createElement("div",{id:"slash-command",ref:c,className:"novel-z-50 novel-h-auto novel-max-h-[330px] novel-w-72 novel-overflow-y-auto novel-rounded-md novel-border novel-border-stone-200 novel-bg-white novel-px-1 novel-py-2 novel-shadow-md novel-transition-all"},e.map((e,n)=>t.createElement("button",{className:"novel-flex novel-w-full novel-items-center novel-space-x-2 novel-rounded-md novel-px-2 novel-py-1 novel-text-left novel-text-sm novel-text-stone-900 hover:novel-bg-stone-100 "+(n===i?"novel-bg-stone-100 novel-text-stone-900":""),key:n,onClick:()=>l(n)},t.createElement("div",{className:"novel-flex novel-h-10 novel-w-10 novel-items-center novel-justify-center novel-rounded-md novel-border novel-border-stone-200 novel-bg-white"},"Continue writing"===e.title&&isLoading?t.createElement(Hv,null):e.icon),t.createElement("div",null,t.createElement("p",{className:"novel-font-medium"},e.title),t.createElement("p",{className:"novel-text-xs novel-text-stone-500"},e.description))))):null},Wv=qv.configure({suggestion:{items:({query:e})=>[{title:"Text",description:"Just start typing with plain text.",searchTerms:["p","paragraph"],icon:t.createElement(Fv,{size:18}),command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleNode("paragraph","paragraph").run()}},{title:"To-do List",description:"Track tasks with a to-do list.",searchTerms:["todo","task","list","check","checkbox"],icon:t.createElement(Sv,{size:18}),command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleTaskList().run()}},{title:"Heading 1",description:"Big section heading.",searchTerms:["title","big","large"],icon:t.createElement(_v,{size:18}),command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setNode("heading",{level:1}).run()}},{title:"Heading 2",description:"Medium section heading.",searchTerms:["subtitle","medium"],icon:t.createElement(Av,{size:18}),command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setNode("heading",{level:2}).run()}},{title:"Heading 3",description:"Small section heading.",searchTerms:["subtitle","small"],icon:t.createElement(Tv,{size:18}),command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setNode("heading",{level:3}).run()}},{title:"Bullet List",description:"Create a simple bullet list.",searchTerms:["unordered","point"],icon:t.createElement(Lv,{size:18}),command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleBulletList().run()}},{title:"Numbered List",description:"Create a list with numbering.",searchTerms:["ordered"],icon:t.createElement(Pv,{size:18}),command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleOrderedList().run()}},{title:"Quote",description:"Capture a quote.",searchTerms:["blockquote"],icon:t.createElement(zv,{size:18}),command:({editor:t,range:e})=>t.chain().focus().deleteRange(e).toggleNode("paragraph","paragraph").toggleBlockquote().run()},{title:"Code",description:"Capture a code snippet.",searchTerms:["codeblock"],icon:t.createElement(Ov,{size:18}),command:({editor:t,range:e})=>t.chain().focus().deleteRange(e).toggleCodeBlock().run()},{title:"Image",description:"Upload an image from your computer.",searchTerms:["photo","picture","media"],icon:t.createElement(Rv,{size:18})}].filter(t=>{if("string"==typeof e&&e.length>0){const n=e.toLowerCase();return t.title.toLowerCase().includes(n)||t.description.toLowerCase().includes(n)||t.searchTerms&&t.searchTerms.some(t=>t.includes(n))}return!0}),render:()=>{let t=null,e=null;return{onStart:n=>{t=new Uc(Vv,{props:n,editor:n.editor}),e=pc("body",{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"})},onUpdate:n=>{null==t||t.updateProps(n),e&&e[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown:n=>{var r;return"Escape"===n.event.key?(null==e||e[0].hide(),!0):null==(r=null==t?void 0:t.ref)?void 0:r.onKeyDown(n)},onExit:()=>{null==e||e[0].destroy(),null==t||t.destroy()}}}}}),Gv=gf.extend({addAttributes(){var t;return{...null==(t=this.parent)?void 0:t.call(this),width:{default:null},height:{default:null}}}}),Uv=ns.create({name:"CustomKeymap",addCommands:()=>({selectTextWithinNodeBoundaries:()=>({editor:t,commands:e})=>{const{state:n}=t,{tr:r}=n,o=r.selection.$from.start(),i=r.selection.$to.end();return e.setTextSelection({from:o,to:i})}}),addKeyboardShortcuts:()=>({"Mod-a":({editor:t})=>{const{state:e}=t,{tr:n}=e,r=n.selection.from,o=n.selection.to,i=n.selection.$from.start(),s=n.selection.$to.end();return!!(r>i||o<s)&&(t.chain().selectTextWithinNodeBoundaries().run(),!0)}})});function Yv(t){return document.elementsFromPoint(t.x,t.y).find(t=>{var e,n;return(null==(n=null==(e=t.parentElement)?void 0:e.matches)?void 0:n.call(e,".ProseMirror"))||t.matches(["li","p:not(:first-child)","pre","blockquote","h1, h2, h3, h4, h5, h6"].join(", "))})}function Kv(t,e){var n;const r=t.getBoundingClientRect();return null==(n=e.posAtCoords({left:r.left+1,top:r.top+1}))?void 0:n.inside}function Xv(t){let e=null;function n(){e&&e.classList.add("hidden")}return new Se({view:r=>{var o,i;return e=document.createElement("div"),e.draggable=!0,e.dataset.dragHandle="",e.classList.add("drag-handle"),e.addEventListener("dragstart",e=>{!function(e,n){if(n.focus(),!e.dataTransfer)return;const r=Yv({x:e.clientX+50+t.dragHandleWidth,y:e.clientY});if(!(r instanceof Element))return;const o=Kv(r,n);if(null==o||o<0)return;n.dispatch(n.state.tr.setSelection(pe.create(n.state.doc,o)));const i=n.state.selection.content();e.dataTransfer.clearData(),e.dataTransfer.setData("text/plain","Dragged content"),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage(r,0,0),n.dragging={slice:i,move:e.ctrlKey}}(e,r)}),e.addEventListener("click",e=>{!function(e,n){n.focus(),n.dom.classList.remove("dragging");const r=Yv({x:e.clientX+50+t.dragHandleWidth,y:e.clientY});if(!(r instanceof Element))return;const o=Kv(r,n);o&&n.dispatch(n.state.tr.setSelection(pe.create(n.state.doc,o)))}(e,r)}),n(),null==(i=null==(o=null==r?void 0:r.dom)?void 0:o.parentElement)||i.appendChild(e),{destroy:()=>{var t;null==(t=null==e?void 0:e.remove)||t.call(e),e=null}}},props:{handleDOMEvents:{mousemove:(r,o)=>{if(!r.editable)return;const i=Yv({x:o.clientX+50+t.dragHandleWidth,y:o.clientY});if(!(i instanceof Element)||i.matches("ul, ol"))return void n();const s=window.getComputedStyle(i),a=parseInt(s.lineHeight,10),l=parseInt(s.paddingTop,10),c=function(t){const e=t.getBoundingClientRect();return{top:e.top,left:e.left,width:e.width}}(i);c.top+=(a-24)/2,c.top+=l,i.matches("ul:not([data-type=taskList]) li, ol li")&&(c.left-=t.dragHandleWidth),c.width=t.dragHandleWidth,e&&(e.style.left=c.left-c.width+"px",e.style.top=`${c.top}px`,e&&e.classList.remove("hidden"))},keydown:()=>{n()},mousewheel:()=>{n()},dragstart:t=>{t.dom.classList.add("dragging")},drop:t=>{t.dom.classList.remove("dragging")},dragend:t=>{t.dom.classList.remove("dragging")}}}})}const Jv=ns.create({name:"dragAndDrop",addProseMirrorPlugins:()=>[Xv({dragHandleWidth:24})]}),Zv=[gd.configure({bulletList:{HTMLAttributes:{class:"novel-list-disc novel-list-outside novel-leading-3 novel--mt-2"}},orderedList:{HTMLAttributes:{class:"novel-list-decimal novel-list-outside novel-leading-3 novel--mt-2"}},listItem:{HTMLAttributes:{class:"novel-leading-normal novel--mb-2"}},blockquote:{HTMLAttributes:{class:"novel-border-l-4 novel-border-stone-700"}},codeBlock:{HTMLAttributes:{class:"novel-rounded-sm novel-bg-stone-100 novel-p-5 novel-font-mono novel-font-medium novel-text-stone-800"}},code:{HTMLAttributes:{class:"novel-rounded-md novel-bg-stone-200 novel-px-1.5 novel-py-1 novel-font-mono novel-font-medium novel-text-stone-900",spellcheck:"false"}},horizontalRule:!1,dropcursor:{color:"#DBEAFE",width:4},gapcursor:!1}),ed.extend({addInputRules(){return[new Wi({find:/^(?:---|-|___\s|\*\*\*\s)$/,handler:({state:t,range:e})=>{const{tr:n}=t,r=e.from;let o=e.to;n.insert(r-1,this.type.create({})).delete(n.mapping.map(r),n.mapping.map(o))}})]}}).configure({HTMLAttributes:{class:"novel-mt-4 novel-mb-6 novel-border-t novel-border-stone-300"}}),hf.configure({HTMLAttributes:{class:"novel-text-stone-400 novel-underline novel-underline-offset-[3px] hover:novel-text-stone-600 novel-transition-colors novel-cursor-pointer"}}),gf.extend({addProseMirrorPlugins:()=>[Qc()]}).configure({allowBase64:!0,HTMLAttributes:{class:"novel-rounded-lg novel-border novel-border-stone-200"}}),Gv.configure({HTMLAttributes:{class:"novel-rounded-lg novel-border novel-border-stone-200"}}),vf.configure({placeholder:({node:t})=>"heading"===t.type.name?`Heading ${t.attrs.level}`:"Press '/' for commands, or '++' for AI autocomplete...",includeChildren:!0}),Wv,yf,bf,xf,yv.configure({multicolor:!0}),Ef.configure({HTMLAttributes:{class:"novel-not-prose novel-pl-2"}}),kf.configure({HTMLAttributes:{class:"novel-flex novel-items-start novel-my-4"},nested:!0}),mv.configure({html:!1,transformCopiedText:!0,transformPastedText:!0}),Uv,Jv];var Qv,ty={exports:{}},ey={};var ny,ry,oy={};
/**
   * @license React
   * use-sync-external-store-shim.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */var iy=(ry||(ry=1,"production"===process.env.NODE_ENV?ty.exports=function(){if(Qv)return ey;Qv=1;var e=t,n="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},r=e.useState,o=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function a(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!n(t,r)}catch(t){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var n=e(),l=r({inst:{value:n,getSnapshot:e}}),c=l[0].inst,u=l[1];return i(function(){c.value=n,c.getSnapshot=e,a(c)&&u({inst:c})},[t,n,e]),o(function(){return a(c)&&u({inst:c}),t(function(){a(c)&&u({inst:c})})},[t]),s(n),n};return ey.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,ey}():ty.exports=(ny||(ny=1,"production"!==process.env.NODE_ENV&&function(){function e(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!r(t,n)}catch(t){return!0}}"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var n=t,r="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},o=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue,l=!1,c=!1,u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,u){l||void 0===n.startTransition||(l=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var d=u();if(!c){var p=u();r(d,p)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),c=!0)}var f=(p=o({inst:{value:d,getSnapshot:u}}))[0].inst,h=p[1];return s(function(){f.value=d,f.getSnapshot=u,e(f)&&h({inst:f})},[t,d,u]),i(function(){return e(f)&&h({inst:f}),t(function(){e(f)&&h({inst:f})})},[t]),a(d),d};oy.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:u,"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),oy)),ty.exports);const sy=()=>{},ay=sy(),ly=Object,cy=t=>t===ay,uy=t=>"function"==typeof t,dy=(t,e)=>({...t,...e}),py=new WeakMap;let fy=0;const hy=t=>{const e=typeof t,n=t&&t.constructor,r=n==Date;let o,i;if(ly(t)!==t||r||n==RegExp)o=r?t.toJSON():"symbol"==e?t.toString():"string"==e?JSON.stringify(t):""+t;else{if(o=py.get(t),o)return o;if(o=++fy+"~",py.set(t,o),n==Array){for(o="@",i=0;i<t.length;i++)o+=hy(t[i])+",";py.set(t,o)}if(n==ly){o="#";const e=ly.keys(t).sort();for(;!cy(i=e.pop());)cy(t[i])||(o+=i+":"+hy(t[i])+",");py.set(t,o)}}return o},my=new WeakMap,gy={},vy={},yy="undefined",by=typeof window!=yy,xy=typeof document!=yy,wy=(t,e)=>{const n=my.get(t);return[()=>!cy(e)&&t.get(e)||gy,r=>{if(!cy(e)){const o=t.get(e);e in vy||(vy[e]=o),n[5](e,dy(o,r),o||gy)}},n[6],()=>!cy(e)&&e in vy?vy[e]:!cy(e)&&t.get(e)||gy]};let ky=!0;const[Ey,Cy]=by&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[sy,sy],Sy={isOnline:()=>ky,isVisible:()=>{const t=xy&&document.visibilityState;return cy(t)||"hidden"!==t}},Dy={initFocus:t=>(xy&&document.addEventListener("visibilitychange",t),Ey("focus",t),()=>{xy&&document.removeEventListener("visibilitychange",t),Cy("focus",t)}),initReconnect:t=>{const e=()=>{ky=!0,t()},n=()=>{ky=!1};return Ey("online",e),Ey("offline",n),()=>{Cy("online",e),Cy("offline",n)}}},My=!t.useId,Oy=!by||"Deno"in window,_y=t=>by&&typeof window.requestAnimationFrame!=yy?window.requestAnimationFrame(t):setTimeout(t,1),Ay=Oy?t.useEffect:t.useLayoutEffect,Ty="undefined"!=typeof navigator&&navigator.connection,Ry=!Oy&&Ty&&(["slow-2g","2g"].includes(Ty.effectiveType)||Ty.saveData),Ny=t=>{if(uy(t))try{t=t()}catch(e){t=""}const e=t;return[t="string"==typeof t?t:(Array.isArray(t)?t.length:t)?hy(t):"",e]};let Py=0;const Ly=()=>++Py;var Iy=3,zy=0,Fy=2,By=1;async function jy(...t){const[e,n,r,o]=t,i=dy({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{});let s=i.populateCache;const a=i.rollbackOnError;let l=i.optimisticData;const c=!1!==i.revalidate,u=i.throwOnError;if(uy(n)){const t=n,r=[],o=e.keys();for(const n of o)!/^\$(inf|sub)\$/.test(n)&&t(e.get(n)._k)&&r.push(n);return Promise.all(r.map(d))}return d(n);async function d(n){const[o]=Ny(n);if(!o)return;const[i,d]=wy(e,o),[p,f,h,m]=my.get(e),g=p[o],v=()=>c&&(delete h[o],delete m[o],g&&g[0])?g[0](2).then(()=>i().data):i().data;if(t.length<3)return v();let y,b=r;const x=Ly();f[o]=[x,0];const w=!cy(l),k=i(),E=k.data,C=k._c,S=cy(C)?E:C;if(w&&(l=uy(l)?l(S,E):l,d({data:l,_c:S})),uy(b))try{b=b(S)}catch(t){y=t}if(b&&uy(b.then)){if(b=await b.catch(t=>{y=t}),x!==f[o][0]){if(y)throw y;return b}y&&w&&(t=>"function"==typeof a?a(t):!1!==a)(y)&&(s=!0,b=S,d({data:b,_c:ay}))}s&&(y||(uy(s)&&(b=s(b,S)),d({data:b,error:ay,_c:ay}))),f[o][1]=Ly();const D=await v();if(d({_c:ay}),!y)return s?D:b;if(u)throw y}}const Hy=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},[$y,qy]=((t,e)=>{if(!my.has(t)){const n=dy(Dy,e),r={},o=jy.bind(ay,t);let i=sy;const s={},a=(t,e)=>{const n=s[t]||[];return s[t]=n,n.push(e),()=>n.splice(n.indexOf(e),1)},l=(e,n,r)=>{t.set(e,n);const o=s[e];if(o)for(const t of o)t(n,r)},c=()=>{if(!my.has(t)&&(my.set(t,[r,{},{},{},o,l,a]),!Oy)){const e=n.initFocus(setTimeout.bind(ay,Hy.bind(ay,r,0))),o=n.initReconnect(setTimeout.bind(ay,Hy.bind(ay,r,1)));i=()=>{e&&e(),o&&o(),my.delete(t)}}};return c(),[t,o,c,i]}return[t,my.get(t)[4]]})(new Map),Vy=dy({onLoadingSlow:sy,onSuccess:sy,onError:sy,onErrorRetry:(t,e,n,r,o)=>{const i=n.errorRetryCount,s=o.retryCount,a=~~((Math.random()+.5)*(1<<(s<8?s:8)))*n.errorRetryInterval;!cy(i)&&s>i||setTimeout(r,a,o)},onDiscarded:sy,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Ry?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:Ry?5e3:3e3,compare:(t,e)=>hy(t)==hy(e),isPaused:()=>!1,cache:$y,mutate:qy,fallback:{}},Sy),Wy=t.createContext({}),Gy=by&&window.__SWR_DEVTOOLS_USE__,Uy=Gy?window.__SWR_DEVTOOLS_USE__:[],Yy=Uy.concat(t=>(e,n,r)=>t(e,n&&((...t)=>{const[r]=Ny(e),[,,,o]=my.get($y),i=o[r];return cy(i)?n(...t):(delete o[r],i)}),r));Gy&&(window.__SWR_DEVTOOLS_REACT__=t);const Ky=t.use||(t=>{if("pending"===t.status)throw t;if("fulfilled"===t.status)return t.value;throw"rejected"===t.status?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),Xy={dedupe:!0},Jy=(Zy=(e,n,r)=>{const{cache:o,compare:i,suspense:s,fallbackData:a,revalidateOnMount:l,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:d,refreshWhenOffline:p,keepPreviousData:f}=r,[h,m,g,v]=my.get(o),[y,b]=Ny(e),x=t.useRef(!1),w=t.useRef(!1),k=t.useRef(y),E=t.useRef(n),C=t.useRef(r),S=()=>C.current,D=()=>S().isVisible()&&S().isOnline(),[M,O,_,A]=wy(o,y),T=t.useRef({}).current,R=cy(a)?r.fallback[y]:a,N=(t,e)=>{for(const n in T){const r=n;if("data"===r){if(!i(t[r],e[r])){if(!cy(t[r]))return!1;if(!i($,e[r]))return!1}}else if(e[r]!==t[r])return!1}return!0},P=t.useMemo(()=>{const t=!!y&&!!n&&(cy(l)?!S().isPaused()&&!s&&(!!cy(c)||c):l),e=e=>{const n=dy(e);return delete n._k,t?{isValidating:!0,isLoading:!0,...n}:n},r=M(),o=A(),i=e(r),a=r===o?i:e(o);let u=i;return[()=>{const t=e(M());return N(t,u)?(u.data=t.data,u.isLoading=t.isLoading,u.isValidating=t.isValidating,u.error=t.error,u):(u=t,t)},()=>a]},[o,y]),L=iy.useSyncExternalStore(t.useCallback(t=>_(y,(e,n)=>{N(n,e)||t()}),[o,y]),P[0],P[1]),I=!x.current,z=h[y]&&h[y].length>0,F=L.data,B=cy(F)?R:F,j=L.error,H=t.useRef(B),$=f?cy(F)?H.current:F:B,q=!(z&&!cy(j))&&(I&&!cy(l)?l:!S().isPaused()&&(s?!cy(B)&&c:cy(B)||c)),V=!!(y&&n&&I&&q),W=cy(L.isValidating)?V:L.isValidating,G=cy(L.isLoading)?V:L.isLoading,U=t.useCallback(async t=>{const e=E.current;if(!y||!e||w.current||S().isPaused())return!1;let n,o,s=!0;const a=t||{},l=!g[y]||!a.dedupe,c=()=>My?!w.current&&y===k.current&&x.current:y===k.current,u={isValidating:!1,isLoading:!1},d=()=>{O(u)},p=()=>{const t=g[y];t&&t[1]===o&&delete g[y]},f={isValidating:!0};cy(M().data)&&(f.isLoading=!0);try{if(l&&(O(f),r.loadingTimeout&&cy(M().data)&&setTimeout(()=>{s&&c()&&S().onLoadingSlow(y,r)},r.loadingTimeout),g[y]=[e(b),Ly()]),[n,o]=g[y],n=await n,l&&setTimeout(p,r.dedupingInterval),!g[y]||g[y][1]!==o)return l&&c()&&S().onDiscarded(y),!1;u.error=ay;const t=m[y];if(!cy(t)&&(o<=t[0]||o<=t[1]||0===t[1]))return d(),l&&c()&&S().onDiscarded(y),!1;const a=M().data;u.data=i(a,n)?a:n,l&&c()&&S().onSuccess(n,y,r)}catch(t){p();const e=S(),{shouldRetryOnError:n}=e;e.isPaused()||(u.error=t,l&&c()&&(e.onError(t,y,e),(!0===n||uy(n)&&n(t))&&D()&&e.onErrorRetry(t,y,e,t=>{const e=h[y];e&&e[0]&&e[0](Iy,t)},{retryCount:(a.retryCount||0)+1,dedupe:!0})))}return s=!1,d(),!0},[y,o]),Y=t.useCallback((...t)=>jy(o,k.current,...t),[]);if(Ay(()=>{E.current=n,C.current=r,cy(F)||(H.current=F)}),Ay(()=>{if(!y)return;const t=U.bind(ay,Xy);let e=0;const n=((t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const t=r.indexOf(n);t>=0&&(r[t]=r[r.length-1],r.pop())}})(y,h,(n,r={})=>{if(n==zy){const n=Date.now();S().revalidateOnFocus&&n>e&&D()&&(e=n+S().focusThrottleInterval,t())}else if(n==By)S().revalidateOnReconnect&&D()&&t();else{if(n==Fy)return U();if(n==Iy)return U(r)}});return w.current=!1,k.current=y,x.current=!0,O({_k:b}),q&&(cy(B)||Oy?t():_y(t)),()=>{w.current=!0,n()}},[y]),Ay(()=>{let t;function e(){const e=uy(u)?u(M().data):u;e&&-1!==t&&(t=setTimeout(n,e))}function n(){M().error||!d&&!S().isVisible()||!p&&!S().isOnline()?e():U(Xy).then(e)}return e(),()=>{t&&(clearTimeout(t),t=-1)}},[u,d,p,y]),t.useDebugValue($),s&&cy(B)&&y){if(!My&&Oy)throw new Error("Fallback data is required when using suspense in SSR.");E.current=n,C.current=r,w.current=!1;const t=v[y];if(!cy(t)){const e=Y(t);Ky(e)}if(!cy(j))throw j;{const t=U(Xy);cy($)||(t.status="fulfilled",t.value=!0),Ky(t)}}return{mutate:Y,get data(){return T.data=!0,$},get error(){return T.error=!0,j},get isValidating(){return T.isValidating=!0,W},get isLoading(){return T.isLoading=!0,G}}},function(...e){const n=dy(Vy,t.useContext(Wy)),[r,o,i]=(t=>uy(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(null===t[1]?t[2]:t[1])||{}])(e),s=((t,e)=>{const n=dy(t,e);if(e){const{use:r,fallback:o}=t,{use:i,fallback:s}=e;r&&i&&(n.use=r.concat(i)),o&&s&&(n.fallback=dy(o,s))}return n})(n,i);let a=Zy;const{use:l}=s,c=(l||[]).concat(Yy);for(let t=c.length;t--;)a=c[t](a);return a(r,o||s.fetcher||null,s)});var Zy,Qy={code:"0",name:"text",parse:t=>{if("string"!=typeof t)throw new Error('"text" parts expect a string value.');return{type:"text",value:t}}},tb={code:"1",name:"function_call",parse:t=>{if(null==t||"object"!=typeof t||!("function_call"in t)||"object"!=typeof t.function_call||null==t.function_call||!("name"in t.function_call)||!("arguments"in t.function_call)||"string"!=typeof t.function_call.name||"string"!=typeof t.function_call.arguments)throw new Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:t}}},eb={code:"2",name:"data",parse:t=>{if(!Array.isArray(t))throw new Error('"data" parts expect an array value.');return{type:"data",value:t}}},nb={code:"3",name:"error",parse:t=>{if("string"!=typeof t)throw new Error('"error" parts expect a string value.');return{type:"error",value:t}}},rb={code:"4",name:"assistant_message",parse:t=>{if(!(null!=t&&"object"==typeof t&&"id"in t&&"role"in t&&"content"in t&&"string"==typeof t.id&&"string"==typeof t.role&&"assistant"===t.role&&Array.isArray(t.content)&&t.content.every(t=>null!=t&&"object"==typeof t&&"type"in t&&"text"===t.type&&"text"in t&&null!=t.text&&"object"==typeof t.text&&"value"in t.text&&"string"==typeof t.text.value)))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:t}}},ob={code:"5",name:"assistant_control_data",parse:t=>{if(null==t||"object"!=typeof t||!("threadId"in t)||!("messageId"in t)||"string"!=typeof t.threadId||"string"!=typeof t.messageId)throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:t.threadId,messageId:t.messageId}}}},ib={code:"6",name:"data_message",parse:t=>{if(null==t||"object"!=typeof t||!("role"in t)||!("data"in t)||"string"!=typeof t.role||"data"!==t.role)throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:t}}},sb={code:"7",name:"tool_calls",parse:t=>{if(null==t||"object"!=typeof t||!("tool_calls"in t)||"object"!=typeof t.tool_calls||null==t.tool_calls||!Array.isArray(t.tool_calls)||t.tool_calls.some(t=>{null!=t&&"object"==typeof t&&"id"in t&&"string"==typeof t.id&&"type"in t&&"string"==typeof t.type&&"function"in t&&null!=t.function&&"object"==typeof t.function&&"arguments"in t.function&&"string"==typeof t.function.name&&t.function.arguments}))throw new Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:t}}},ab={code:"8",name:"message_annotations",parse:t=>{if(!Array.isArray(t))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:t}}},lb=[Qy,tb,eb,nb,rb,ob,ib,sb,ab],cb={[Qy.code]:Qy,[tb.code]:tb,[eb.code]:eb,[nb.code]:nb,[rb.code]:rb,[ob.code]:ob,[ib.code]:ib,[sb.code]:sb,[ab.code]:ab},ub=lb.map(t=>t.code),db=t=>{const e=t.indexOf(":");if(-1===e)throw new Error("Failed to parse stream string. No separator found.");const n=t.slice(0,e);if(!ub.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,o=t.slice(e+1),i=JSON.parse(o);return cb[r].parse(i)},pb="\n".charCodeAt(0);function fb(t,e){const n=new Uint8Array(e);let r=0;for(const e of t)n.set(e,r),r+=e.length;return t.length=0,n}async function hb({api:t,prompt:e,credentials:n,headers:r,body:o,setCompletion:i,setLoading:s,setError:a,setAbortController:l,onResponse:c,onFinish:u,onError:d,onData:p}){try{s(!0),a(void 0);const d=new AbortController;l(d),i("");const f=await fetch(t,{method:"POST",body:JSON.stringify({prompt:e,...o}),credentials:n,headers:{"Content-Type":"application/json",...r},signal:d.signal}).catch(t=>{throw t});if(c)try{await c(f)}catch(t){throw t}if(!f.ok)throw new Error(await f.text()||"Failed to fetch the chat response.");if(!f.body)throw new Error("The response body is empty.");let h="";const m=f.body.getReader();if("true"===f.headers.get("X-Experimental-Stream-Data"))for await(const{type:t,value:e}of async function*(t,{isAborted:e}={}){const n=new TextDecoder,r=[];let o=0;for(;;){const{value:i}=await t.read();if(i&&(r.push(i),o+=i.length,i[i.length-1]!==pb))continue;if(0===r.length)break;const s=fb(r,o);o=0;const a=n.decode(s,{stream:!0}).split("\n").filter(t=>""!==t).map(db);for(const t of a)yield t;if(null==e?void 0:e()){t.cancel();break}}}(m,{isAborted:()=>null===d}))switch(t){case"text":h+=e,i(h);break;case"data":null==p||p(e)}else{const t=function(){const t=new TextDecoder;return function(e){return e?t.decode(e,{stream:!0}):""}}();for(;;){const{done:e,value:n}=await m.read();if(e)break;if(h+=t(n),i(h),null===d){m.cancel();break}}}return u&&u(e,h),l(null),h}catch(t){if("AbortError"===t.name)return l(null),null;t instanceof Error&&d&&d(t),a(t)}finally{s(!1)}}const mb={type:"doc",content:[{type:"heading",attrs:{level:2},content:[{type:"text",text:"Introducing Lightweight Novel"}]},{type:"paragraph",content:[{type:"text",marks:[{type:"link",attrs:{href:"https://github.com/Ankur-Datta-4/novel-lightweight",target:"_blank",class:"text-stone-400 underline underline-offset-[3px] hover:text-stone-600 transition-colors cursor-pointer"}}],text:"Novel"},{type:"text",text:" is a Notion-style WYSIWYG editor with AI-powered autocompletion. Built with "},{type:"text",marks:[{type:"link",attrs:{href:"https://tiptap.dev/",target:"_blank",class:"text-stone-400 underline underline-offset-[3px] hover:text-stone-600 transition-colors cursor-pointer"}}],text:"Tiptap"},{type:"text",text:" + "},{type:"text",marks:[{type:"link",attrs:{href:"https://sdk.vercel.ai/docs",target:"_blank",class:"text-stone-400 underline underline-offset-[3px] hover:text-stone-600 transition-colors cursor-pointer text-stone-400 underline underline-offset-[3px] hover:text-stone-600 transition-colors cursor-pointer"}}],text:"Vercel AI SDK"},{type:"text",text:"."}]},{type:"heading",attrs:{level:3},content:[{type:"text",text:"Installation"}]},{type:"codeBlock",attrs:{language:null},content:[{type:"text",text:"npm i novel-lightweight"}]},{type:"heading",attrs:{level:3},content:[{type:"text",text:"Usage"}]},{type:"codeBlock",attrs:{language:null},content:[{type:"text",text:'import { Editor } from "novel-lightweight";\n\nexport default function App() {\n  return (\n     <Editor />\n  )\n}'}]},{type:"heading",attrs:{level:3},content:[{type:"text",text:"Features"}]},{type:"orderedList",attrs:{tight:!0,start:1},content:[{type:"listItem",content:[{type:"paragraph",content:[{type:"text",text:"Slash menu & bubble menu"}]}]},{type:"listItem",content:[{type:"paragraph",content:[{type:"text",text:"AI autocomplete (type "},{type:"text",marks:[{type:"code"}],text:"++"},{type:"text",text:" to activate, or select from slash menu)"}]}]},{type:"listItem",content:[{type:"paragraph",content:[{type:"text",text:"Image uploads (drag & drop / copy & paste, or select from slash menu) "}]}]}]},{type:"image",attrs:{src:"https://public.blob.vercel-storage.com/pJrjXbdONOnAeZAZ/banner-2wQk82qTwyVgvlhTW21GIkWgqPGD2C.png",alt:"banner.png",title:"banner.png",width:null,height:null}},{type:"horizontalRule"},{type:"heading",attrs:{level:3},content:[{type:"text",text:"Learn more"}]},{type:"taskList",content:[{type:"taskItem",attrs:{checked:!1},content:[{type:"paragraph",content:[{type:"text",text:"Star us on "},{type:"text",marks:[{type:"link",attrs:{href:"https://github.com/Ankur-Datta-4/novel-lightweight",target:"_blank",class:"text-stone-400 underline underline-offset-[3px] hover:text-stone-600 transition-colors cursor-pointer"}}],text:"GitHub"}]}]},{type:"taskItem",attrs:{checked:!1},content:[{type:"paragraph",content:[{type:"text",text:"Install the "},{type:"text",marks:[{type:"link",attrs:{href:"https://www.npmjs.com/package/novel-lightweight",target:"_blank",class:"text-stone-400 underline underline-offset-[3px] hover:text-stone-600 transition-colors cursor-pointer"}}],text:"NPM package"}]}]}]}]};function gb(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t?.(r),!1===n||!r.defaultPrevented)return e?.(r)}}function vb(t,e){if("function"==typeof t)return t(e);null!=t&&(t.current=e)}function yb(...t){return e=>{let n=!1;const r=t.map(t=>{const r=vb(t,e);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let e=0;e<r.length;e++){const n=r[e];"function"==typeof n?n():vb(t[e],null)}}}}function bb(...t){return r.useCallback(yb(...t),t)}var xb,wb={exports:{}},kb={};var Eb,Cb,Sb={};
/**
   * @license React
   * react-jsx-runtime.development.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */function Db(){return Eb||(Eb=1,"production"!==process.env.NODE_ENV&&function(){var e=t,n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.for("react.offscreen"),m=Symbol.iterator;var g=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function v(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];!function(t,e,n){var r=g.ReactDebugCurrentFrame,o=r.getStackAddendum();""!==o&&(e+="%s",n=n.concat([o]));var i=n.map(function(t){return String(t)});i.unshift("Warning: "+e),Function.prototype.apply.call(console[t],console,i)}("error",t,n)}var y;function b(t){return t.displayName||"Context"}function x(t){if(null==t)return null;if("number"==typeof t.tag&&v("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),"function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case o:return"Fragment";case r:return"Portal";case s:return"Profiler";case i:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case l:return b(t)+".Consumer";case a:return b(t._context)+".Provider";case c:return function(t,e,n){var r=t.displayName;if(r)return r;var o=e.displayName||e.name||"";return""!==o?n+"("+o+")":n}(t,t.render,"ForwardRef");case p:var e=t.displayName||null;return null!==e?e:x(t.type)||"Memo";case f:var n=t,h=n._payload,m=n._init;try{return x(m(h))}catch(t){return null}}return null}y=Symbol.for("react.module.reference");var w,k,E,C,S,D,M,O=Object.assign,_=0;function A(){}A.__reactDisabledLog=!0;var T,R=g.ReactCurrentDispatcher;function N(t,e,n){if(void 0===T)try{throw Error()}catch(t){var r=t.stack.trim().match(/\n( *(at )?)/);T=r&&r[1]||""}return"\n"+T+t}var P,L=!1,I="function"==typeof WeakMap?WeakMap:Map;function z(t,e){if(!t||L)return"";var n,r=P.get(t);if(void 0!==r)return r;L=!0;var o,i=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=R.current,R.current=null,function(){if(0===_){w=console.log,k=console.info,E=console.warn,C=console.error,S=console.group,D=console.groupCollapsed,M=console.groupEnd;var t={configurable:!0,enumerable:!0,value:A,writable:!0};Object.defineProperties(console,{info:t,log:t,warn:t,error:t,group:t,groupCollapsed:t,groupEnd:t})}_++}();try{if(e){var s=function(){throw Error()};if(Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(s,[])}catch(t){n=t}Reflect.construct(t,[],s)}else{try{s.call()}catch(t){n=t}t.call(s.prototype)}}else{try{throw Error()}catch(t){n=t}t()}}catch(e){if(e&&n&&"string"==typeof e.stack){for(var a=e.stack.split("\n"),l=n.stack.split("\n"),c=a.length-1,u=l.length-1;c>=1&&u>=0&&a[c]!==l[u];)u--;for(;c>=1&&u>=0;c--,u--)if(a[c]!==l[u]){if(1!==c||1!==u)do{if(c--,--u<0||a[c]!==l[u]){var d="\n"+a[c].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),"function"==typeof t&&P.set(t,d),d}}while(c>=1&&u>=0);break}}}finally{L=!1,R.current=o,function(){if(0===--_){var t={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:O({},t,{value:w}),info:O({},t,{value:k}),warn:O({},t,{value:E}),error:O({},t,{value:C}),group:O({},t,{value:S}),groupCollapsed:O({},t,{value:D}),groupEnd:O({},t,{value:M})})}_<0&&v("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}(),Error.prepareStackTrace=i}var p=t?t.displayName||t.name:"",f=p?N(p):"";return"function"==typeof t&&P.set(t,f),f}function F(t,e,n){if(null==t)return"";if("function"==typeof t)return z(t,!(!(r=t.prototype)||!r.isReactComponent));var r;if("string"==typeof t)return N(t);switch(t){case u:return N("Suspense");case d:return N("SuspenseList")}if("object"==typeof t)switch(t.$$typeof){case c:return z(t.render,!1);case p:return F(t.type,e,n);case f:var o=t,i=o._payload,s=o._init;try{return F(s(i),e,n)}catch(t){}}return""}P=new I;var B=Object.prototype.hasOwnProperty,j={},H=g.ReactDebugCurrentFrame;function $(t){if(t){var e=t._owner,n=F(t.type,t._source,e?e.type:null);H.setExtraStackFrame(n)}else H.setExtraStackFrame(null)}var q=Array.isArray;function V(t){return q(t)}function W(t){return""+t}function G(t){if(function(t){try{return W(t),!1}catch(t){return!0}}(t))return v("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",function(t){return"function"==typeof Symbol&&Symbol.toStringTag&&t[Symbol.toStringTag]||t.constructor.name||"Object"}(t)),W(t)}var U,Y,K=g.ReactCurrentOwner,X={key:!0,ref:!0,__self:!0,__source:!0};function J(t,e,r,o,i){var s,a={},l=null,c=null;for(s in void 0!==r&&(G(r),l=""+r),function(t){if(B.call(t,"key")){var e=Object.getOwnPropertyDescriptor(t,"key").get;if(e&&e.isReactWarning)return!1}return void 0!==t.key}(e)&&(G(e.key),l=""+e.key),function(t){if(B.call(t,"ref")){var e=Object.getOwnPropertyDescriptor(t,"ref").get;if(e&&e.isReactWarning)return!1}return void 0!==t.ref}(e)&&(c=e.ref,function(t){"string"==typeof t.ref&&K.current}(e)),e)B.call(e,s)&&!X.hasOwnProperty(s)&&(a[s]=e[s]);if(t&&t.defaultProps){var u=t.defaultProps;for(s in u)void 0===a[s]&&(a[s]=u[s])}if(l||c){var d="function"==typeof t?t.displayName||t.name||"Unknown":t;l&&function(t,e){var n=function(){U||(U=!0,v("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",e))};n.isReactWarning=!0,Object.defineProperty(t,"key",{get:n,configurable:!0})}(a,d),c&&function(t,e){var n=function(){Y||(Y=!0,v("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",e))};n.isReactWarning=!0,Object.defineProperty(t,"ref",{get:n,configurable:!0})}(a,d)}return function(t,e,r,o,i,s,a){var l={$$typeof:n,type:t,key:e,ref:r,props:a,_owner:s,_store:{}};return Object.defineProperty(l._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(l,"_self",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(l,"_source",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.freeze&&(Object.freeze(l.props),Object.freeze(l)),l}(t,l,c,i,o,K.current,a)}var Z,Q=g.ReactCurrentOwner,tt=g.ReactDebugCurrentFrame;function et(t){if(t){var e=t._owner,n=F(t.type,t._source,e?e.type:null);tt.setExtraStackFrame(n)}else tt.setExtraStackFrame(null)}function nt(t){return"object"==typeof t&&null!==t&&t.$$typeof===n}function rt(){if(Q.current){var t=x(Q.current.type);if(t)return"\n\nCheck the render method of `"+t+"`."}return""}Z=!1;var ot={};function it(t,e){if(t._store&&!t._store.validated&&null==t.key){t._store.validated=!0;var n=function(t){var e=rt();if(!e){var n="string"==typeof t?t:t.displayName||t.name;n&&(e="\n\nCheck the top-level render call using <"+n+">.")}return e}(e);if(!ot[n]){ot[n]=!0;var r="";t&&t._owner&&t._owner!==Q.current&&(r=" It was passed a child from "+x(t._owner.type)+"."),et(t),v('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',n,r),et(null)}}}function st(t,e){if("object"==typeof t)if(V(t))for(var n=0;n<t.length;n++){var r=t[n];nt(r)&&it(r,e)}else if(nt(t))t._store&&(t._store.validated=!0);else if(t){var o=function(t){if(null===t||"object"!=typeof t)return null;var e=m&&t[m]||t["@@iterator"];return"function"==typeof e?e:null}(t);if("function"==typeof o&&o!==t.entries)for(var i,s=o.call(t);!(i=s.next()).done;)nt(i.value)&&it(i.value,e)}}function at(t){var e,n=t.type;if(null!=n&&"string"!=typeof n){if("function"==typeof n)e=n.propTypes;else{if("object"!=typeof n||n.$$typeof!==c&&n.$$typeof!==p)return;e=n.propTypes}if(e){var r=x(n);!function(t,e,n,r,o){var i=Function.call.bind(B);for(var s in t)if(i(t,s)){var a=void 0;try{if("function"!=typeof t[s]){var l=Error((r||"React class")+": "+n+" type `"+s+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof t[s]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw l.name="Invariant Violation",l}a=t[s](e,s,r,n,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(t){a=t}!a||a instanceof Error||($(o),v("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",r||"React class",n,s,typeof a),$(null)),a instanceof Error&&!(a.message in j)&&(j[a.message]=!0,$(o),v("Failed %s type: %s",n,a.message),$(null))}}(e,t.props,"prop",r,t)}else if(void 0!==n.PropTypes&&!Z){Z=!0,v("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",x(n)||"Unknown")}"function"!=typeof n.getDefaultProps||n.getDefaultProps.isReactClassApproved||v("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function lt(t,e,r,m,g,b){var w=function(t){return"string"==typeof t||"function"==typeof t||t===o||t===s||t===i||t===u||t===d||t===h||"object"==typeof t&&null!==t&&(t.$$typeof===f||t.$$typeof===p||t.$$typeof===a||t.$$typeof===l||t.$$typeof===c||t.$$typeof===y||void 0!==t.getModuleId)}(t);if(!w){var k="";(void 0===t||"object"==typeof t&&null!==t&&0===Object.keys(t).length)&&(k+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var E;k+=rt(),null===t?E="null":V(t)?E="array":void 0!==t&&t.$$typeof===n?(E="<"+(x(t.type)||"Unknown")+" />",k=" Did you accidentally export a JSX literal instead of a component?"):E=typeof t,v("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",E,k)}var C=J(t,e,r,g,b);if(null==C)return C;if(w){var S=e.children;if(void 0!==S)if(m)if(V(S)){for(var D=0;D<S.length;D++)st(S[D],t);Object.freeze&&Object.freeze(S)}else v("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else st(S,t)}return t===o?function(t){for(var e=Object.keys(t.props),n=0;n<e.length;n++){var r=e[n];if("children"!==r&&"key"!==r){et(t),v("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",r),et(null);break}}null!==t.ref&&(et(t),v("Invalid attribute `ref` supplied to `React.Fragment`."),et(null))}(C):at(C),C}var ct=function(t,e,n){return lt(t,e,n,!1)},ut=function(t,e,n){return lt(t,e,n,!0)};Sb.Fragment=o,Sb.jsx=ct,Sb.jsxs=ut}()),Sb}var Mb=(Cb||(Cb=1,"production"===process.env.NODE_ENV?wb.exports=function(){if(xb)return kb;xb=1;var e=t,n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(t,e,r){var a,l={},c=null,u=null;for(a in void 0!==r&&(c=""+r),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)o.call(e,a)&&!s.hasOwnProperty(a)&&(l[a]=e[a]);if(t&&t.defaultProps)for(a in e=t.defaultProps)void 0===l[a]&&(l[a]=e[a]);return{$$typeof:n,type:t,key:c,ref:u,props:l,_owner:i.current}}return kb.Fragment=r,kb.jsx=a,kb.jsxs=a,kb}():wb.exports=Db()),wb.exports);function Ob(t,e=[]){let n=[];const o=()=>{const e=n.map(t=>r.createContext(t));return function(n){const o=n?.[t]||e;return r.useMemo(()=>({[`__scope${t}`]:{...n,[t]:o}}),[n,o])}};return o.scopeName=t,[function(e,o){const i=r.createContext(o),s=n.length;n=[...n,o];const a=e=>{const{scope:n,children:o,...a}=e,l=n?.[t]?.[s]||i,c=r.useMemo(()=>a,Object.values(a));return Mb.jsx(l.Provider,{value:c,children:o})};return a.displayName=e+"Provider",[a,function(n,a){const l=a?.[t]?.[s]||i,c=r.useContext(l);if(c)return c;if(void 0!==o)return o;throw new Error(`\`${n}\` must be used within \`${e}\``)}]},_b(o,...e)]}function _b(...t){const e=t[0];if(1===t.length)return e;const n=()=>{const n=t.map(t=>({useScope:t(),scopeName:t.scopeName}));return function(t){const o=n.reduce((e,{useScope:n,scopeName:r})=>({...e,...n(t)[`__scope${r}`]}),{});return r.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Ab(t){const e=Tb(t),n=r.forwardRef((t,n)=>{const{children:o,...i}=t,s=r.Children.toArray(o),a=s.find(Nb);if(a){const t=a.props.children,o=s.map(e=>e===a?r.Children.count(t)>1?r.Children.only(null):r.isValidElement(t)?t.props.children:null:e);return Mb.jsx(e,{...i,ref:n,children:r.isValidElement(t)?r.cloneElement(t,void 0,o):null})}return Mb.jsx(e,{...i,ref:n,children:o})});return n.displayName=`${t}.Slot`,n}function Tb(t){const e=r.forwardRef((t,e)=>{const{children:n,...o}=t;if(r.isValidElement(n)){const t=function(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;if(n)return t.ref;if(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n)return t.props.ref;return t.props.ref||t.ref}(n),i=function(t,e){const n={...e};for(const r in e){const o=t[r],i=e[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...t)=>{const e=i(...t);return o(...t),e}:o&&(n[r]=o):"style"===r?n[r]={...o,...i}:"className"===r&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...t,...n}}(o,n.props);return n.type!==r.Fragment&&(i.ref=e?yb(e,t):t),r.cloneElement(n,i)}return r.Children.count(n)>1?r.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Rb=Symbol("radix.slottable");function Nb(t){return r.isValidElement(t)&&"function"==typeof t.type&&"__radixId"in t.type&&t.type.__radixId===Rb}var Pb=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((t,e)=>{const n=Ab(`Primitive.${e}`),o=r.forwardRef((t,r)=>{const{asChild:o,...i}=t,s=o?n:e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),Mb.jsx(s,{...i,ref:r})});return o.displayName=`Primitive.${e}`,{...t,[e]:o}},{});function Lb(t){const e=r.useRef(t);return r.useEffect(()=>{e.current=t}),r.useMemo(()=>(...t)=>e.current?.(...t),[])}var Ib,zb="dismissableLayer.update",Fb="dismissableLayer.pointerDownOutside",Bb="dismissableLayer.focusOutside",jb=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Hb=r.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:l,...c}=t,u=r.useContext(jb),[d,p]=r.useState(null),f=d?.ownerDocument??globalThis?.document,[,h]=r.useState({}),m=bb(e,t=>p(t)),g=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(v),b=d?g.indexOf(d):-1,x=u.layersWithOutsidePointerEventsDisabled.size>0,w=b>=y,k=function(t,e=globalThis?.document){const n=Lb(t),o=r.useRef(!1),i=r.useRef(()=>{});return r.useEffect(()=>{const t=t=>{if(t.target&&!o.current){let r=function(){Vb(Fb,n,o,{discrete:!0})};const o={originalEvent:t};"touch"===t.pointerType?(e.removeEventListener("click",i.current),i.current=r,e.addEventListener("click",i.current,{once:!0})):r()}else e.removeEventListener("click",i.current);o.current=!1},r=window.setTimeout(()=>{e.addEventListener("pointerdown",t)},0);return()=>{window.clearTimeout(r),e.removeEventListener("pointerdown",t),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>o.current=!0}}(t=>{const e=t.target,n=[...u.branches].some(t=>t.contains(e));w&&!n&&(i?.(t),a?.(t),t.defaultPrevented||l?.())},f),E=function(t,e=globalThis?.document){const n=Lb(t),o=r.useRef(!1);return r.useEffect(()=>{const t=t=>{if(t.target&&!o.current){Vb(Bb,n,{originalEvent:t},{discrete:!1})}};return e.addEventListener("focusin",t),()=>e.removeEventListener("focusin",t)},[e,n]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}(t=>{const e=t.target;[...u.branches].some(t=>t.contains(e))||(s?.(t),a?.(t),t.defaultPrevented||l?.())},f);return function(t,e=globalThis?.document){const n=Lb(t);r.useEffect(()=>{const t=t=>{"Escape"===t.key&&n(t)};return e.addEventListener("keydown",t,{capture:!0}),()=>e.removeEventListener("keydown",t,{capture:!0})},[n,e])}(t=>{b===u.layers.size-1&&(o?.(t),!t.defaultPrevented&&l&&(t.preventDefault(),l()))},f),r.useEffect(()=>{if(d)return n&&(0===u.layersWithOutsidePointerEventsDisabled.size&&(Ib=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),qb(),()=>{n&&1===u.layersWithOutsidePointerEventsDisabled.size&&(f.body.style.pointerEvents=Ib)}},[d,f,n,u]),r.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),qb())},[d,u]),r.useEffect(()=>{const t=()=>h({});return document.addEventListener(zb,t),()=>document.removeEventListener(zb,t)},[]),Mb.jsx(Pb.div,{...c,ref:m,style:{pointerEvents:x?w?"auto":"none":void 0,...t.style},onFocusCapture:gb(t.onFocusCapture,E.onFocusCapture),onBlurCapture:gb(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:gb(t.onPointerDownCapture,k.onPointerDownCapture)})});Hb.displayName="DismissableLayer";var $b=r.forwardRef((t,e)=>{const n=r.useContext(jb),o=r.useRef(null),i=bb(e,o);return r.useEffect(()=>{const t=o.current;if(t)return n.branches.add(t),()=>{n.branches.delete(t)}},[n.branches]),Mb.jsx(Pb.div,{...t,ref:i})});function qb(){const t=new CustomEvent(zb);document.dispatchEvent(t)}function Vb(t,e,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?function(t,e){t&&o.flushSync(()=>t.dispatchEvent(e))}(i,s):i.dispatchEvent(s)}$b.displayName="DismissableLayerBranch";var Wb=0;function Gb(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ub="focusScope.autoFocusOnMount",Yb="focusScope.autoFocusOnUnmount",Kb={bubbles:!1,cancelable:!0},Xb=r.forwardRef((t,e)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=t,[l,c]=r.useState(null),u=Lb(i),d=Lb(s),p=r.useRef(null),f=bb(e,t=>c(t)),h=r.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;r.useEffect(()=>{if(o){let t=function(t){if(h.paused||!l)return;const e=t.target;l.contains(e)?p.current=e:tx(p.current,{select:!0})},e=function(t){if(h.paused||!l)return;const e=t.relatedTarget;null!==e&&(l.contains(e)||tx(p.current,{select:!0}))},n=function(t){if(document.activeElement===document.body)for(const e of t)e.removedNodes.length>0&&tx(l)};document.addEventListener("focusin",t),document.addEventListener("focusout",e);const r=new MutationObserver(n);return l&&r.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",t),document.removeEventListener("focusout",e),r.disconnect()}}},[o,l,h.paused]),r.useEffect(()=>{if(l){ex.add(h);const e=document.activeElement;if(!l.contains(e)){const n=new CustomEvent(Ub,Kb);l.addEventListener(Ub,u),l.dispatchEvent(n),n.defaultPrevented||(!function(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(tx(r,{select:e}),document.activeElement!==n)return}((t=Jb(l),t.filter(t=>"A"!==t.tagName)),{select:!0}),document.activeElement===e&&tx(l))}return()=>{l.removeEventListener(Ub,u),setTimeout(()=>{const t=new CustomEvent(Yb,Kb);l.addEventListener(Yb,d),l.dispatchEvent(t),t.defaultPrevented||tx(e??document.body,{select:!0}),l.removeEventListener(Yb,d),ex.remove(h)},0)}}var t},[l,u,d,h]);const m=r.useCallback(t=>{if(!n&&!o)return;if(h.paused)return;const e="Tab"===t.key&&!t.altKey&&!t.ctrlKey&&!t.metaKey,r=document.activeElement;if(e&&r){const e=t.currentTarget,[o,i]=function(t){const e=Jb(t),n=Zb(e,t),r=Zb(e.reverse(),t);return[n,r]}(e);o&&i?t.shiftKey||r!==i?t.shiftKey&&r===o&&(t.preventDefault(),n&&tx(i,{select:!0})):(t.preventDefault(),n&&tx(o,{select:!0})):r===e&&t.preventDefault()}},[n,o,h.paused]);return Mb.jsx(Pb.div,{tabIndex:-1,...a,ref:f,onKeyDown:m})});function Jb(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{const e="INPUT"===t.tagName&&"hidden"===t.type;return t.disabled||t.hidden||e?NodeFilter.FILTER_SKIP:t.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Zb(t,e){for(const n of t)if(!Qb(n,{upTo:e}))return n}function Qb(t,{upTo:e}){if("hidden"===getComputedStyle(t).visibility)return!0;for(;t;){if(void 0!==e&&t===e)return!1;if("none"===getComputedStyle(t).display)return!0;t=t.parentElement}return!1}function tx(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&function(t){return t instanceof HTMLInputElement&&"select"in t}(t)&&e&&t.select()}}Xb.displayName="FocusScope";var ex=function(){let t=[];return{add(e){const n=t[0];e!==n&&n?.pause(),t=nx(t,e),t.unshift(e)},remove(e){t=nx(t,e),t[0]?.resume()}}}();function nx(t,e){const n=[...t],r=n.indexOf(e);return-1!==r&&n.splice(r,1),n}var rx=globalThis?.document?r.useLayoutEffect:()=>{},ox=r[" useId ".trim().toString()]||(()=>{}),ix=0;function sx(t){const[e,n]=r.useState(ox());return rx(()=>{n(t=>t??String(ix++))},[t]),t||(e?`radix-${e}`:"")}const ax=["top","right","bottom","left"],lx=Math.min,cx=Math.max,ux=Math.round,dx=Math.floor,px=t=>({x:t,y:t}),fx={left:"right",right:"left",bottom:"top",top:"bottom"},hx={start:"end",end:"start"};function mx(t,e,n){return cx(t,lx(e,n))}function gx(t,e){return"function"==typeof t?t(e):t}function vx(t){return t.split("-")[0]}function yx(t){return t.split("-")[1]}function bx(t){return"x"===t?"y":"x"}function xx(t){return"y"===t?"height":"width"}function wx(t){return["top","bottom"].includes(vx(t))?"y":"x"}function kx(t){return bx(wx(t))}function Ex(t){return t.replace(/start|end/g,t=>hx[t])}function Cx(t){return t.replace(/left|right|bottom|top/g,t=>fx[t])}function Sx(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function Dx(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function Mx(t,e,n){let{reference:r,floating:o}=t;const i=wx(e),s=kx(e),a=xx(s),l=vx(e),c="y"===i,u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,p=r[a]/2-o[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-o.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-o.width,y:d};break;default:f={x:r.x,y:r.y}}switch(yx(e)){case"start":f[s]-=p*(n&&c?-1:1);break;case"end":f[s]+=p*(n&&c?-1:1)}return f}async function Ox(t,e){var n;void 0===e&&(e={});const{x:r,y:o,platform:i,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=gx(e,t),h=Sx(f),m=a[p?"floating"===d?"reference":"floating":d],g=Dx(await i.getClippingRect({element:null==(n=await(null==i.isElement?void 0:i.isElement(m)))||n?m:m.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===d?{x:r,y:o,width:s.floating.width,height:s.floating.height}:s.reference,y=await(null==i.getOffsetParent?void 0:i.getOffsetParent(a.floating)),b=await(null==i.isElement?void 0:i.isElement(y))&&await(null==i.getScale?void 0:i.getScale(y))||{x:1,y:1},x=Dx(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-x.top+h.top)/b.y,bottom:(x.bottom-g.bottom+h.bottom)/b.y,left:(g.left-x.left+h.left)/b.x,right:(x.right-g.right+h.right)/b.x}}function _x(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Ax(t){return ax.some(e=>t[e]>=0)}function Tx(){return"undefined"!=typeof window}function Rx(t){return Lx(t)?(t.nodeName||"").toLowerCase():"#document"}function Nx(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function Px(t){var e;return null==(e=(Lx(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function Lx(t){return!!Tx()&&(t instanceof Node||t instanceof Nx(t).Node)}function Ix(t){return!!Tx()&&(t instanceof Element||t instanceof Nx(t).Element)}function zx(t){return!!Tx()&&(t instanceof HTMLElement||t instanceof Nx(t).HTMLElement)}function Fx(t){return!(!Tx()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof Nx(t).ShadowRoot)}function Bx(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=Wx(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(o)}function jx(t){return["table","td","th"].includes(Rx(t))}function Hx(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch(t){return!1}})}function $x(t){const e=qx(),n=Ix(t)?Wx(t):t;return["transform","translate","scale","rotate","perspective"].some(t=>!!n[t]&&"none"!==n[t])||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some(t=>(n.willChange||"").includes(t))||["paint","layout","strict","content"].some(t=>(n.contain||"").includes(t))}function qx(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Vx(t){return["html","body","#document"].includes(Rx(t))}function Wx(t){return Nx(t).getComputedStyle(t)}function Gx(t){return Ix(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ux(t){if("html"===Rx(t))return t;const e=t.assignedSlot||t.parentNode||Fx(t)&&t.host||Px(t);return Fx(e)?e.host:e}function Yx(t){const e=Ux(t);return Vx(e)?t.ownerDocument?t.ownerDocument.body:t.body:zx(e)&&Bx(e)?e:Yx(e)}function Kx(t,e,n){var r;void 0===e&&(e=[]),void 0===n&&(n=!0);const o=Yx(t),i=o===(null==(r=t.ownerDocument)?void 0:r.body),s=Nx(o);if(i){const t=Xx(s);return e.concat(s,s.visualViewport||[],Bx(o)?o:[],t&&n?Kx(t):[])}return e.concat(o,Kx(o,[],n))}function Xx(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Jx(t){const e=Wx(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=zx(t),i=o?t.offsetWidth:n,s=o?t.offsetHeight:r,a=ux(n)!==i||ux(r)!==s;return a&&(n=i,r=s),{width:n,height:r,$:a}}function Zx(t){return Ix(t)?t:t.contextElement}function Qx(t){const e=Zx(t);if(!zx(e))return px(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:i}=Jx(e);let s=(i?ux(n.width):n.width)/r,a=(i?ux(n.height):n.height)/o;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}const tw=px(0);function ew(t){const e=Nx(t);return qx()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:tw}function nw(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=!1);const o=t.getBoundingClientRect(),i=Zx(t);let s=px(1);e&&(r?Ix(r)&&(s=Qx(r)):s=Qx(t));const a=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==Nx(t))&&e}(i,n,r)?ew(i):px(0);let l=(o.left+a.x)/s.x,c=(o.top+a.y)/s.y,u=o.width/s.x,d=o.height/s.y;if(i){const t=Nx(i),e=r&&Ix(r)?Nx(r):r;let n=t,o=Xx(n);for(;o&&r&&e!==n;){const t=Qx(o),e=o.getBoundingClientRect(),r=Wx(o),i=e.left+(o.clientLeft+parseFloat(r.paddingLeft))*t.x,s=e.top+(o.clientTop+parseFloat(r.paddingTop))*t.y;l*=t.x,c*=t.y,u*=t.x,d*=t.y,l+=i,c+=s,n=Nx(o),o=Xx(n)}}return Dx({width:u,height:d,x:l,y:c})}function rw(t,e){const n=Gx(t).scrollLeft;return e?e.left+n:nw(Px(t)).left+n}function ow(t,e,n){void 0===n&&(n=!1);const r=t.getBoundingClientRect();return{x:r.left+e.scrollLeft-(n?0:rw(t,r)),y:r.top+e.scrollTop}}function iw(t,e,n){let r;if("viewport"===e)r=function(t,e){const n=Nx(t),r=Px(t),o=n.visualViewport;let i=r.clientWidth,s=r.clientHeight,a=0,l=0;if(o){i=o.width,s=o.height;const t=qx();(!t||t&&"fixed"===e)&&(a=o.offsetLeft,l=o.offsetTop)}return{width:i,height:s,x:a,y:l}}(t,n);else if("document"===e)r=function(t){const e=Px(t),n=Gx(t),r=t.ownerDocument.body,o=cx(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=cx(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+rw(t);const a=-n.scrollTop;return"rtl"===Wx(r).direction&&(s+=cx(e.clientWidth,r.clientWidth)-o),{width:o,height:i,x:s,y:a}}(Px(t));else if(Ix(e))r=function(t,e){const n=nw(t,!0,"fixed"===e),r=n.top+t.clientTop,o=n.left+t.clientLeft,i=zx(t)?Qx(t):px(1);return{width:t.clientWidth*i.x,height:t.clientHeight*i.y,x:o*i.x,y:r*i.y}}(e,n);else{const n=ew(t);r={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return Dx(r)}function sw(t,e){const n=Ux(t);return!(n===e||!Ix(n)||Vx(n))&&("fixed"===Wx(n).position||sw(n,e))}function aw(t,e,n){const r=zx(e),o=Px(e),i="fixed"===n,s=nw(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=px(0);function c(){l.x=rw(o)}if(r||!r&&!i)if(("body"!==Rx(e)||Bx(o))&&(a=Gx(e)),r){const t=nw(e,!0,i,e);l.x=t.x+e.clientLeft,l.y=t.y+e.clientTop}else o&&c();i&&!r&&o&&c();const u=!o||r||i?px(0):ow(o,a);return{x:s.left+a.scrollLeft-l.x-u.x,y:s.top+a.scrollTop-l.y-u.y,width:s.width,height:s.height}}function lw(t){return"static"===Wx(t).position}function cw(t,e){if(!zx(t)||"fixed"===Wx(t).position)return null;if(e)return e(t);let n=t.offsetParent;return Px(t)===n&&(n=n.ownerDocument.body),n}function uw(t,e){const n=Nx(t);if(Hx(t))return n;if(!zx(t)){let e=Ux(t);for(;e&&!Vx(e);){if(Ix(e)&&!lw(e))return e;e=Ux(e)}return n}let r=cw(t,e);for(;r&&jx(r)&&lw(r);)r=cw(r,e);return r&&Vx(r)&&lw(r)&&!$x(r)?n:r||function(t){let e=Ux(t);for(;zx(e)&&!Vx(e);){if($x(e))return e;if(Hx(e))return null;e=Ux(e)}return null}(t)||n}const dw={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:r,strategy:o}=t;const i="fixed"===o,s=Px(r),a=!!e&&Hx(e.floating);if(r===s||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=px(1);const u=px(0),d=zx(r);if((d||!d&&!i)&&(("body"!==Rx(r)||Bx(s))&&(l=Gx(r)),zx(r))){const t=nw(r);c=Qx(r),u.x=t.x+r.clientLeft,u.y=t.y+r.clientTop}const p=!s||d||i?px(0):ow(s,l,!0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+p.x,y:n.y*c.y-l.scrollTop*c.y+u.y+p.y}},getDocumentElement:Px,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const i="clippingAncestors"===n?Hx(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let r=Kx(t,[],!1).filter(t=>Ix(t)&&"body"!==Rx(t)),o=null;const i="fixed"===Wx(t).position;let s=i?Ux(t):t;for(;Ix(s)&&!Vx(s);){const e=Wx(s),n=$x(s);n||"fixed"!==e.position||(o=null),(i?!n&&!o:!n&&"static"===e.position&&o&&["absolute","fixed"].includes(o.position)||Bx(s)&&!n&&sw(t,s))?r=r.filter(t=>t!==s):o=e,s=Ux(s)}return e.set(t,r),r}(e,this._c):[].concat(n),s=[...i,r],a=s[0],l=s.reduce((t,n)=>{const r=iw(e,n,o);return t.top=cx(r.top,t.top),t.right=lx(r.right,t.right),t.bottom=lx(r.bottom,t.bottom),t.left=cx(r.left,t.left),t},iw(e,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:uw,getElementRects:async function(t){const e=this.getOffsetParent||uw,n=this.getDimensions,r=await n(t.floating);return{reference:aw(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=Jx(t);return{width:e,height:n}},getScale:Qx,isElement:Ix,isRTL:function(t){return"rtl"===Wx(t).direction}};function pw(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function fw(t,e,n,r){void 0===r&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:a="function"==typeof IntersectionObserver,animationFrame:l=!1}=r,c=Zx(t),u=o||i?[...c?Kx(c):[],...Kx(e)]:[];u.forEach(t=>{o&&t.addEventListener("scroll",n,{passive:!0}),i&&t.addEventListener("resize",n)});const d=c&&a?function(t,e){let n,r=null;const o=Px(t);function i(){var t;clearTimeout(n),null==(t=r)||t.disconnect(),r=null}return function s(a,l){void 0===a&&(a=!1),void 0===l&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:d,width:p,height:f}=c;if(a||e(),!p||!f)return;const h={rootMargin:-dx(d)+"px "+-dx(o.clientWidth-(u+p))+"px "+-dx(o.clientHeight-(d+f))+"px "+-dx(u)+"px",threshold:cx(0,lx(1,l))||1};let m=!0;function g(e){const r=e[0].intersectionRatio;if(r!==l){if(!m)return s();r?s(!1,r):n=setTimeout(()=>{s(!1,1e-7)},1e3)}1!==r||pw(c,t.getBoundingClientRect())||s(),m=!1}try{r=new IntersectionObserver(g,{...h,root:o.ownerDocument})}catch(t){r=new IntersectionObserver(g,h)}r.observe(t)}(!0),i}(c,n):null;let p,f=-1,h=null;s&&(h=new ResizeObserver(t=>{let[r]=t;r&&r.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var t;null==(t=h)||t.observe(e)})),n()}),c&&!l&&h.observe(c),h.observe(e));let m=l?nw(t):null;return l&&function e(){const r=nw(t);m&&!pw(m,r)&&n();m=r,p=requestAnimationFrame(e)}(),n(),()=>{var t;u.forEach(t=>{o&&t.removeEventListener("scroll",n),i&&t.removeEventListener("resize",n)}),null==d||d(),null==(t=h)||t.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const hw=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:o,y:i,placement:s,middlewareData:a}=e,l=await async function(t,e){const{placement:n,platform:r,elements:o}=t,i=await(null==r.isRTL?void 0:r.isRTL(o.floating)),s=vx(n),a=yx(n),l="y"===wx(n),c=["left","top"].includes(s)?-1:1,u=i&&l?-1:1,d=gx(e,t);let{mainAxis:p,crossAxis:f,alignmentAxis:h}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&"number"==typeof h&&(f="end"===a?-1*h:h),l?{x:f*u,y:p*c}:{x:p*c,y:f*u}}(e,t);return s===(null==(n=a.offset)?void 0:n.placement)&&null!=(r=a.arrow)&&r.alignmentOffset?{}:{x:o+l.x,y:i+l.y,data:{...l,placement:s}}}}},mw=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:s=!1,limiter:a={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...l}=gx(t,e),c={x:n,y:r},u=await Ox(e,l),d=wx(vx(o)),p=bx(d);let f=c[p],h=c[d];if(i){const t="y"===p?"bottom":"right";f=mx(f+u["y"===p?"top":"left"],f,f-u[t])}if(s){const t="y"===d?"bottom":"right";h=mx(h+u["y"===d?"top":"left"],h,h-u[t])}const m=a.fn({...e,[p]:f,[d]:h});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[p]:i,[d]:s}}}}}},gw=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:o,middlewareData:i,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:m=!0,...g}=gx(t,e);if(null!=(n=i.arrow)&&n.alignmentOffset)return{};const v=vx(o),y=wx(a),b=vx(a)===a,x=await(null==l.isRTL?void 0:l.isRTL(c.floating)),w=p||(b||!m?[Cx(a)]:function(t){const e=Cx(t);return[Ex(t),e,Ex(e)]}(a)),k="none"!==h;!p&&k&&w.push(...function(t,e,n,r){const o=yx(t);let i=function(t,e,n){const r=["left","right"],o=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?o:r:e?r:o;case"left":case"right":return e?i:s;default:return[]}}(vx(t),"start"===n,r);return o&&(i=i.map(t=>t+"-"+o),e&&(i=i.concat(i.map(Ex)))),i}(a,m,h,x));const E=[a,...w],C=await Ox(e,g),S=[];let D=(null==(r=i.flip)?void 0:r.overflows)||[];if(u&&S.push(C[v]),d){const t=function(t,e,n){void 0===n&&(n=!1);const r=yx(t),o=kx(t),i=xx(o);let s="x"===o?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return e.reference[i]>e.floating[i]&&(s=Cx(s)),[s,Cx(s)]}(o,s,x);S.push(C[t[0]],C[t[1]])}if(D=[...D,{placement:o,overflows:S}],!S.every(t=>t<=0)){var M,O;const t=((null==(M=i.flip)?void 0:M.index)||0)+1,e=E[t];if(e){if(!("alignment"===d&&y!==wx(e))||D.every(t=>t.overflows[0]>0&&wx(t.placement)===y))return{data:{index:t,overflows:D},reset:{placement:e}}}let n=null==(O=D.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:O.placement;if(!n)switch(f){case"bestFit":{var _;const t=null==(_=D.filter(t=>{if(k){const e=wx(t.placement);return e===y||"y"===e}return!0}).map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:_[0];t&&(n=t);break}case"initialPlacement":n=a}if(o!==n)return{reset:{placement:n}}}return{}}}},vw=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:o,rects:i,platform:s,elements:a}=e,{apply:l=()=>{},...c}=gx(t,e),u=await Ox(e,c),d=vx(o),p=yx(o),f="y"===wx(o),{width:h,height:m}=i.floating;let g,v;"top"===d||"bottom"===d?(g=d,v=p===(await(null==s.isRTL?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,g="end"===p?"top":"bottom");const y=m-u.top-u.bottom,b=h-u.left-u.right,x=lx(m-u[g],y),w=lx(h-u[v],b),k=!e.middlewareData.shift;let E=x,C=w;if(null!=(n=e.middlewareData.shift)&&n.enabled.x&&(C=b),null!=(r=e.middlewareData.shift)&&r.enabled.y&&(E=y),k&&!p){const t=cx(u.left,0),e=cx(u.right,0),n=cx(u.top,0),r=cx(u.bottom,0);f?C=h-2*(0!==t||0!==e?t+e:cx(u.left,u.right)):E=m-2*(0!==n||0!==r?n+r:cx(u.top,u.bottom))}await l({...e,availableWidth:C,availableHeight:E});const S=await s.getDimensions(a.floating);return h!==S.width||m!==S.height?{reset:{rects:!0}}:{}}}},yw=function(t){return void 0===t&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...o}=gx(t,e);switch(r){case"referenceHidden":{const t=_x(await Ox(e,{...o,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:t,referenceHidden:Ax(t)}}}case"escaped":{const t=_x(await Ox(e,{...o,altBoundary:!0}),n.floating);return{data:{escapedOffsets:t,escaped:Ax(t)}}}default:return{}}}}},bw=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:o,rects:i,platform:s,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=gx(t,e)||{};if(null==c)return{};const d=Sx(u),p={x:n,y:r},f=kx(o),h=xx(f),m=await s.getDimensions(c),g="y"===f,v=g?"top":"left",y=g?"bottom":"right",b=g?"clientHeight":"clientWidth",x=i.reference[h]+i.reference[f]-p[f]-i.floating[h],w=p[f]-i.reference[f],k=await(null==s.getOffsetParent?void 0:s.getOffsetParent(c));let E=k?k[b]:0;E&&await(null==s.isElement?void 0:s.isElement(k))||(E=a.floating[b]||i.floating[h]);const C=x/2-w/2,S=E/2-m[h]/2-1,D=lx(d[v],S),M=lx(d[y],S),O=D,_=E-m[h]-M,A=E/2-m[h]/2+C,T=mx(O,A,_),R=!l.arrow&&null!=yx(o)&&A!==T&&i.reference[h]/2-(A<O?D:M)-m[h]/2<0,N=R?A<O?A-O:A-_:0;return{[f]:p[f]+N,data:{[f]:T,centerOffset:A-T-N,...R&&{alignmentOffset:N}},reset:R}}}),xw=function(t){return void 0===t&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:o,rects:i,middlewareData:s}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=gx(t,e),u={x:n,y:r},d=wx(o),p=bx(d);let f=u[p],h=u[d];const m=gx(a,e),g="number"==typeof m?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const t="y"===p?"height":"width",e=i.reference[p]-i.floating[t]+g.mainAxis,n=i.reference[p]+i.reference[t]-g.mainAxis;f<e?f=e:f>n&&(f=n)}if(c){var v,y;const t="y"===p?"width":"height",e=["top","left"].includes(vx(o)),n=i.reference[d]-i.floating[t]+(e&&(null==(v=s.offset)?void 0:v[d])||0)+(e?0:g.crossAxis),r=i.reference[d]+i.reference[t]+(e?0:(null==(y=s.offset)?void 0:y[d])||0)-(e?g.crossAxis:0);h<n?h=n:h>r&&(h=r)}return{[p]:f,[d]:h}}}},ww=(t,e,n)=>{const r=new Map,o={platform:dw,...n},i={...o.platform,_c:r};return(async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:s}=n,a=i.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:o}),{x:u,y:d}=Mx(c,r,l),p=r,f={},h=0;for(let n=0;n<a.length;n++){const{name:i,fn:m}=a[n],{x:g,y:v,data:y,reset:b}=await m({x:u,y:d,initialPlacement:r,placement:p,strategy:o,middlewareData:f,rects:c,platform:s,elements:{reference:t,floating:e}});u=null!=g?g:u,d=null!=v?v:d,f={...f,[i]:{...f[i],...y}},b&&h<=50&&(h++,"object"==typeof b&&(b.placement&&(p=b.placement),b.rects&&(c=!0===b.rects?await s.getElementRects({reference:t,floating:e,strategy:o}):b.rects),({x:u,y:d}=Mx(c,p,l))),n=-1)}return{x:u,y:d,placement:p,strategy:o,middlewareData:f}})(t,e,{...o,platform:i})};var kw="undefined"!=typeof document?t.useLayoutEffect:function(){};function Ew(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if("function"==typeof t&&t.toString()===e.toString())return!0;let n,r,o;if(t&&e&&"object"==typeof t){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;0!==r--;)if(!Ew(t[r],e[r]))return!1;return!0}if(o=Object.keys(t),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;0!==r--;)if(!{}.hasOwnProperty.call(e,o[r]))return!1;for(r=n;0!==r--;){const n=o[r];if(("_owner"!==n||!t.$$typeof)&&!Ew(t[n],e[n]))return!1}return!0}return t!=t&&e!=e}function Cw(t){if("undefined"==typeof window)return 1;return(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Sw(t,e){const n=Cw(t);return Math.round(e*n)/n}function Dw(t){const e=r.useRef(t);return kw(()=>{e.current=t}),e}const Mw=t=>({name:"arrow",options:t,fn(e){const{element:n,padding:r}="function"==typeof t?t(e):t;return n&&(o=n,{}.hasOwnProperty.call(o,"current"))?null!=n.current?bw({element:n.current,padding:r}).fn(e):{}:n?bw({element:n,padding:r}).fn(e):{};var o}}),Ow=(t,e)=>({...hw(t),options:[t,e]}),_w=(t,e)=>({...mw(t),options:[t,e]}),Aw=(t,e)=>({...xw(t),options:[t,e]}),Tw=(t,e)=>({...gw(t),options:[t,e]}),Rw=(t,e)=>({...vw(t),options:[t,e]}),Nw=(t,e)=>({...yw(t),options:[t,e]}),Pw=(t,e)=>({...Mw(t),options:[t,e]});var Lw=r.forwardRef((t,e)=>{const{children:n,width:r=10,height:o=5,...i}=t;return Mb.jsx(Pb.svg,{...i,ref:e,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:Mb.jsx("polygon",{points:"0,0 30,0 15,10"})})});Lw.displayName="Arrow";var Iw=Lw;var zw="Popper",[Fw,Bw]=Ob(zw),[jw,Hw]=Fw(zw),$w=t=>{const{__scopePopper:e,children:n}=t,[o,i]=r.useState(null);return Mb.jsx(jw,{scope:e,anchor:o,onAnchorChange:i,children:n})};$w.displayName=zw;var qw="PopperAnchor",Vw=r.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:o,...i}=t,s=Hw(qw,n),a=r.useRef(null),l=bb(e,a);return r.useEffect(()=>{s.onAnchorChange(o?.current||a.current)}),o?null:Mb.jsx(Pb.div,{...i,ref:l})});Vw.displayName=qw;var Ww="PopperContent",[Gw,Uw]=Fw(Ww),Yw=r.forwardRef((t,e)=>{const{__scopePopper:n,side:i="bottom",sideOffset:s=0,align:a="center",alignOffset:l=0,arrowPadding:c=0,avoidCollisions:u=!0,collisionBoundary:d=[],collisionPadding:p=0,sticky:f="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:g,...v}=t,y=Hw(Ww,n),[b,x]=r.useState(null),w=bb(e,t=>x(t)),[k,E]=r.useState(null),C=function(t){const[e,n]=r.useState(void 0);return rx(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const e=new ResizeObserver(e=>{if(!Array.isArray(e))return;if(!e.length)return;const r=e[0];let o,i;if("borderBoxSize"in r){const t=r.borderBoxSize,e=Array.isArray(t)?t[0]:t;o=e.inlineSize,i=e.blockSize}else o=t.offsetWidth,i=t.offsetHeight;n({width:o,height:i})});return e.observe(t,{box:"border-box"}),()=>e.unobserve(t)}n(void 0)},[t]),e}(k),S=C?.width??0,D=C?.height??0,M=i+("center"!==a?"-"+a:""),O="number"==typeof p?p:{top:0,right:0,bottom:0,left:0,...p},_=Array.isArray(d)?d:[d],A=_.length>0,T={padding:O,boundary:_.filter(Zw),altBoundary:A},{refs:R,floatingStyles:N,placement:P,isPositioned:L,middlewareData:I}=function(t){void 0===t&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:s,elements:{reference:a,floating:l}={},transform:c=!0,whileElementsMounted:u,open:d}=t,[p,f]=r.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,m]=r.useState(i);Ew(h,i)||m(i);const[g,v]=r.useState(null),[y,b]=r.useState(null),x=r.useCallback(t=>{t!==C.current&&(C.current=t,v(t))},[]),w=r.useCallback(t=>{t!==S.current&&(S.current=t,b(t))},[]),k=a||g,E=l||y,C=r.useRef(null),S=r.useRef(null),D=r.useRef(p),M=null!=u,O=Dw(u),_=Dw(s),A=Dw(d),T=r.useCallback(()=>{if(!C.current||!S.current)return;const t={placement:e,strategy:n,middleware:h};_.current&&(t.platform=_.current),ww(C.current,S.current,t).then(t=>{const e={...t,isPositioned:!1!==A.current};R.current&&!Ew(D.current,e)&&(D.current=e,o.flushSync(()=>{f(e)}))})},[h,e,n,_,A]);kw(()=>{!1===d&&D.current.isPositioned&&(D.current.isPositioned=!1,f(t=>({...t,isPositioned:!1})))},[d]);const R=r.useRef(!1);kw(()=>(R.current=!0,()=>{R.current=!1}),[]),kw(()=>{if(k&&(C.current=k),E&&(S.current=E),k&&E){if(O.current)return O.current(k,E,T);T()}},[k,E,T,O,M]);const N=r.useMemo(()=>({reference:C,floating:S,setReference:x,setFloating:w}),[x,w]),P=r.useMemo(()=>({reference:k,floating:E}),[k,E]),L=r.useMemo(()=>{const t={position:n,left:0,top:0};if(!P.floating)return t;const e=Sw(P.floating,p.x),r=Sw(P.floating,p.y);return c?{...t,transform:"translate("+e+"px, "+r+"px)",...Cw(P.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:e,top:r}},[n,c,P.floating,p.x,p.y]);return r.useMemo(()=>({...p,update:T,refs:N,elements:P,floatingStyles:L}),[p,T,N,P,L])}({strategy:"fixed",placement:M,whileElementsMounted:(...t)=>fw(...t,{animationFrame:"always"===m}),elements:{reference:y.anchor},middleware:[Ow({mainAxis:s+D,alignmentAxis:l}),u&&_w({mainAxis:!0,crossAxis:!1,limiter:"partial"===f?Aw():void 0,...T}),u&&Tw({...T}),Rw({...T,apply:({elements:t,rects:e,availableWidth:n,availableHeight:r})=>{const{width:o,height:i}=e.reference,s=t.floating.style;s.setProperty("--radix-popper-available-width",`${n}px`),s.setProperty("--radix-popper-available-height",`${r}px`),s.setProperty("--radix-popper-anchor-width",`${o}px`),s.setProperty("--radix-popper-anchor-height",`${i}px`)}}),k&&Pw({element:k,padding:c}),Qw({arrowWidth:S,arrowHeight:D}),h&&Nw({strategy:"referenceHidden",...T})]}),[z,F]=tk(P),B=Lb(g);rx(()=>{L&&B?.()},[L,B]);const j=I.arrow?.x,H=I.arrow?.y,$=0!==I.arrow?.centerOffset,[q,V]=r.useState();return rx(()=>{b&&V(window.getComputedStyle(b).zIndex)},[b]),Mb.jsx("div",{ref:R.setFloating,"data-radix-popper-content-wrapper":"",style:{...N,transform:L?N.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:q,"--radix-popper-transform-origin":[I.transformOrigin?.x,I.transformOrigin?.y].join(" "),...I.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:Mb.jsx(Gw,{scope:n,placedSide:z,onArrowChange:E,arrowX:j,arrowY:H,shouldHideArrow:$,children:Mb.jsx(Pb.div,{"data-side":z,"data-align":F,...v,ref:w,style:{...v.style,animation:L?void 0:"none"}})})})});Yw.displayName=Ww;var Kw="PopperArrow",Xw={top:"bottom",right:"left",bottom:"top",left:"right"},Jw=r.forwardRef(function(t,e){const{__scopePopper:n,...r}=t,o=Uw(Kw,n),i=Xw[o.placedSide];return Mb.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:Mb.jsx(Iw,{...r,ref:e,style:{...r.style,display:"block"}})})});function Zw(t){return null!==t}Jw.displayName=Kw;var Qw=t=>({name:"transformOrigin",options:t,fn(e){const{placement:n,rects:r,middlewareData:o}=e,i=0!==o.arrow?.centerOffset,s=i?0:t.arrowWidth,a=i?0:t.arrowHeight,[l,c]=tk(n),u={start:"0%",center:"50%",end:"100%"}[c],d=(o.arrow?.x??0)+s/2,p=(o.arrow?.y??0)+a/2;let f="",h="";return"bottom"===l?(f=i?u:`${d}px`,h=-a+"px"):"top"===l?(f=i?u:`${d}px`,h=`${r.floating.height+a}px`):"right"===l?(f=-a+"px",h=i?u:`${p}px`):"left"===l&&(f=`${r.floating.width+a}px`,h=i?u:`${p}px`),{data:{x:f,y:h}}}});function tk(t){const[e,n="center"]=t.split("-");return[e,n]}var ek=$w,nk=Vw,rk=Yw,ok=Jw;var ik=t=>{const{present:e,children:n}=t,o=function(t){const[e,n]=r.useState(),o=r.useRef(null),i=r.useRef(t),s=r.useRef("none"),a=t?"mounted":"unmounted",[l,c]=function(t,e){return r.useReducer((t,n)=>e[t][n]??t,t)}(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return r.useEffect(()=>{const t=sk(o.current);s.current="mounted"===l?t:"none"},[l]),rx(()=>{const e=o.current,n=i.current;if(n!==t){const r=s.current,o=sk(e);if(t)c("MOUNT");else if("none"===o||"none"===e?.display)c("UNMOUNT");else{c(n&&r!==o?"ANIMATION_OUT":"UNMOUNT")}i.current=t}},[t,c]),rx(()=>{if(e){let t;const n=e.ownerDocument.defaultView??window,r=r=>{const s=sk(o.current).includes(r.animationName);if(r.target===e&&s&&(c("ANIMATION_END"),!i.current)){const r=e.style.animationFillMode;e.style.animationFillMode="forwards",t=n.setTimeout(()=>{"forwards"===e.style.animationFillMode&&(e.style.animationFillMode=r)})}},a=t=>{t.target===e&&(s.current=sk(o.current))};return e.addEventListener("animationstart",a),e.addEventListener("animationcancel",r),e.addEventListener("animationend",r),()=>{n.clearTimeout(t),e.removeEventListener("animationstart",a),e.removeEventListener("animationcancel",r),e.removeEventListener("animationend",r)}}c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:r.useCallback(t=>{o.current=t?getComputedStyle(t):null,n(t)},[])}}(e),i="function"==typeof n?n({present:o.isPresent}):r.Children.only(n),s=bb(o.ref,function(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;if(n)return t.ref;if(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n)return t.props.ref;return t.props.ref||t.ref}(i));return"function"==typeof n||o.isPresent?r.cloneElement(i,{ref:s}):null};function sk(t){return t?.animationName||"none"}ik.displayName="Presence";var ak=r[" useInsertionEffect ".trim().toString()]||rx;function lk({prop:t,defaultProp:e,onChange:n=()=>{},caller:o}){const[i,s,a]=function({defaultProp:t,onChange:e}){const[n,o]=r.useState(t),i=r.useRef(n),s=r.useRef(e);return ak(()=>{s.current=e},[e]),r.useEffect(()=>{i.current!==n&&(s.current?.(n),i.current=n)},[n,i]),[n,o,s]}({defaultProp:e,onChange:n}),l=void 0!==t,c=l?t:i;{const e=r.useRef(void 0!==t);r.useEffect(()=>{const t=e.current;if(t!==l){const e=t?"controlled":"uncontrolled",n=l?"controlled":"uncontrolled";console.warn(`${o} is changing from ${e} to ${n}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}e.current=l},[l,o])}const u=r.useCallback(e=>{if(l){const n=function(t){return"function"==typeof t}(e)?e(t):e;n!==t&&a.current?.(n)}else s(e)},[l,t,s,a]);return[c,u]}var ck=new WeakMap,uk=new WeakMap,dk={},pk=0,fk=function(t){return t&&(t.host||fk(t.parentNode))},hk=function(t,e,n,r){var o=function(t,e){return e.map(function(e){if(t.contains(e))return e;var n=fk(e);return n&&t.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(t){return Boolean(t)})}(e,Array.isArray(t)?t:[t]);dk[n]||(dk[n]=new WeakMap);var i=dk[n],s=[],a=new Set,l=new Set(o),c=function(t){t&&!a.has(t)&&(a.add(t),c(t.parentNode))};o.forEach(c);var u=function(t){t&&!l.has(t)&&Array.prototype.forEach.call(t.children,function(t){if(a.has(t))u(t);else try{var e=t.getAttribute(r),o=null!==e&&"false"!==e,l=(ck.get(t)||0)+1,c=(i.get(t)||0)+1;ck.set(t,l),i.set(t,c),s.push(t),1===l&&o&&uk.set(t,!0),1===c&&t.setAttribute(n,"true"),o||t.setAttribute(r,"true")}catch(e){console.error("aria-hidden: cannot operate on ",t,e)}})};return u(e),a.clear(),pk++,function(){s.forEach(function(t){var e=ck.get(t)-1,o=i.get(t)-1;ck.set(t,e),i.set(t,o),e||(uk.has(t)||t.removeAttribute(r),uk.delete(t)),o||t.removeAttribute(n)}),--pk||(ck=new WeakMap,ck=new WeakMap,uk=new WeakMap,dk={})}},mk=function(t,e,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),o=function(t){return"undefined"==typeof document?null:(Array.isArray(t)?t[0]:t).ownerDocument.body}(t);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live], script"))),hk(r,o,n,"aria-hidden")):function(){return null}},gk=function(){return gk=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},gk.apply(this,arguments)};function vk(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}"function"==typeof SuppressedError&&SuppressedError;var yk="right-scroll-bar-position",bk="width-before-scroll-bar";function xk(t,e){return"function"==typeof t?t(e):t&&(t.current=e),t}var wk="undefined"!=typeof window?r.useLayoutEffect:r.useEffect,kk=new WeakMap;function Ek(e,n){var r=function(e,n){var r=t.useState(function(){return{value:e,callback:n,facade:{get current(){return r.value},set current(t){var e=r.value;e!==t&&(r.value=t,r.callback(t,e))}}}})[0];return r.callback=n,r.facade}(null,function(t){return e.forEach(function(e){return xk(e,t)})});return wk(function(){var t=kk.get(r);if(t){var n=new Set(t),o=new Set(e),i=r.current;n.forEach(function(t){o.has(t)||xk(t,null)}),o.forEach(function(t){n.has(t)||xk(t,i)})}kk.set(r,e)},[e]),r}function Ck(t){return t}var Sk=function(t){var e=t.sideCar,n=vk(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var o=e.read();if(!o)throw new Error("Sidecar medium not found");return r.createElement(o,gk({},n))};Sk.isSideCarExport=!0;var Dk=function(t){void 0===t&&(t={});var e=function(t,e){void 0===e&&(e=Ck);var n=[],r=!1;return{read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(t){var o=e(t,r);return n.push(o),function(){n=n.filter(function(t){return t!==o})}},assignSyncMedium:function(t){for(r=!0;n.length;){var e=n;n=[],e.forEach(t)}n={push:function(e){return t(e)},filter:function(){return n}}},assignMedium:function(t){r=!0;var e=[];if(n.length){var o=n;n=[],o.forEach(t),e=n}var i=function(){var n=e;e=[],n.forEach(t)},s=function(){return Promise.resolve().then(i)};s(),n={push:function(t){e.push(t),s()},filter:function(t){return e=e.filter(t),n}}}}}(null);return e.options=gk({async:!0,ssr:!1},t),e}(),Mk=function(){},Ok=r.forwardRef(function(t,e){var n=r.useRef(null),o=r.useState({onScrollCapture:Mk,onWheelCapture:Mk,onTouchMoveCapture:Mk}),i=o[0],s=o[1],a=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,p=t.shards,f=t.sideCar,h=t.noRelative,m=t.noIsolation,g=t.inert,v=t.allowPinchZoom,y=t.as,b=void 0===y?"div":y,x=t.gapMode,w=vk(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=f,E=Ek([n,e]),C=gk(gk({},w),i);return r.createElement(r.Fragment,null,d&&r.createElement(k,{sideCar:Dk,removeScrollBar:u,shards:p,noRelative:h,noIsolation:m,inert:g,setCallbacks:s,allowPinchZoom:!!v,lockRef:n,gapMode:x}),a?r.cloneElement(r.Children.only(l),gk(gk({},C),{ref:E})):r.createElement(b,gk({},C,{className:c,ref:E}),l))});Ok.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Ok.classNames={fullWidth:bk,zeroRight:yk};function _k(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=function(){if("undefined"!=typeof __webpack_nonce__)return __webpack_nonce__}();return e&&t.setAttribute("nonce",e),t}var Ak=function(){var t=0,e=null;return{add:function(n){var r;0==t&&(e=_k())&&(!function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}(e,n),r=e,(document.head||document.getElementsByTagName("head")[0]).appendChild(r)),t++},remove:function(){! --t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Tk=function(){var t,e=(t=Ak(),function(e,n){r.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])});return function(t){var n=t.styles,r=t.dynamic;return e(n,r),null}},Rk={left:0,top:0,right:0,gap:0},Nk=function(t){return parseInt(t||"",10)||0},Pk=function(t){if(void 0===t&&(t="margin"),"undefined"==typeof window)return Rk;var e=function(t){var e=window.getComputedStyle(document.body),n=e["padding"===t?"paddingLeft":"marginLeft"],r=e["padding"===t?"paddingTop":"marginTop"],o=e["padding"===t?"paddingRight":"marginRight"];return[Nk(n),Nk(r),Nk(o)]}(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},Lk=Tk(),Ik="data-scroll-locked",zk=function(t,e,n,r){var o=t.left,i=t.top,s=t.right,a=t.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(a,"px ").concat(r,";\n  }\n  body[").concat(Ik,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([e&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(o,"px;\n    padding-top: ").concat(i,"px;\n    padding-right: ").concat(s,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(yk," {\n    right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(bk," {\n    margin-right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(yk," .").concat(yk," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(bk," .").concat(bk," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(Ik,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},Fk=function(){var t=parseInt(document.body.getAttribute(Ik)||"0",10);return isFinite(t)?t:0},Bk=function(t){var e=t.noRelative,n=t.noImportant,o=t.gapMode,i=void 0===o?"margin":o;r.useEffect(function(){return document.body.setAttribute(Ik,(Fk()+1).toString()),function(){var t=Fk()-1;t<=0?document.body.removeAttribute(Ik):document.body.setAttribute(Ik,t.toString())}},[]);var s=r.useMemo(function(){return Pk(i)},[i]);return r.createElement(Lk,{styles:zk(s,!e,i,n?"":"!important")})},jk=!1;if("undefined"!=typeof window)try{var Hk=Object.defineProperty({},"passive",{get:function(){return jk=!0,!0}});window.addEventListener("test",Hk,Hk),window.removeEventListener("test",Hk,Hk)}catch(t){jk=!1}var $k=!!jk&&{passive:!1},qk=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return"hidden"!==n[e]&&!(n.overflowY===n.overflowX&&!function(t){return"TEXTAREA"===t.tagName}(t)&&"visible"===n[e])},Vk=function(t,e){var n=e.ownerDocument,r=e;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),Wk(t,r)){var o=Gk(t,r);if(o[1]>o[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Wk=function(t,e){return"v"===t?function(t){return qk(t,"overflowY")}(e):function(t){return qk(t,"overflowX")}(e)},Gk=function(t,e){return"v"===t?function(t){return[t.scrollTop,t.scrollHeight,t.clientHeight]}(e):function(t){return[t.scrollLeft,t.scrollWidth,t.clientWidth]}(e)},Uk=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Yk=function(t){return[t.deltaX,t.deltaY]},Kk=function(t){return t&&"current"in t?t.current:t},Xk=function(t){return"\n  .block-interactivity-".concat(t," {pointer-events: none;}\n  .allow-interactivity-").concat(t," {pointer-events: all;}\n")},Jk=0,Zk=[];function Qk(t){for(var e=null;null!==t;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}var tE,eE=(tE=function(t){var e=r.useRef([]),n=r.useRef([0,0]),o=r.useRef(),i=r.useState(Jk++)[0],s=r.useState(Tk)[0],a=r.useRef(t);r.useEffect(function(){a.current=t},[t]),r.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var e=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([t.lockRef.current],(t.shards||[]).map(Kk),!0).filter(Boolean);return e.forEach(function(t){return t.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),e.forEach(function(t){return t.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var l=r.useCallback(function(t,e){if("touches"in t&&2===t.touches.length||"wheel"===t.type&&t.ctrlKey)return!a.current.allowPinchZoom;var r,i=Uk(t),s=n.current,l="deltaX"in t?t.deltaX:s[0]-i[0],c="deltaY"in t?t.deltaY:s[1]-i[1],u=t.target,d=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in t&&"h"===d&&"range"===u.type)return!1;var p=Vk(d,u);if(!p)return!0;if(p?r=d:(r="v"===d?"h":"v",p=Vk(d,u)),!p)return!1;if(!o.current&&"changedTouches"in t&&(l||c)&&(o.current=r),!r)return!0;var f=o.current||r;return function(t,e,n,r){var o=function(t,e){return"h"===t&&"rtl"===e?-1:1}(t,window.getComputedStyle(e).direction),i=o*r,s=n.target,a=e.contains(s),l=!1,c=i>0,u=0,d=0;do{if(!s)break;var p=Gk(t,s),f=p[0],h=p[1]-p[2]-o*f;(f||h)&&Wk(t,s)&&(u+=h,d+=f);var m=s.parentNode;s=m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE?m.host:m}while(!a&&s!==document.body||a&&(e.contains(s)||e===s));return(c&&Math.abs(u)<1||!c&&Math.abs(d)<1)&&(l=!0),l}(f,e,t,"h"===f?l:c)},[]),c=r.useCallback(function(t){var n=t;if(Zk.length&&Zk[Zk.length-1]===s){var r="deltaY"in n?Yk(n):Uk(n),o=e.current.filter(function(t){return t.name===n.type&&(t.target===n.target||n.target===t.shadowParent)&&(e=t.delta,o=r,e[0]===o[0]&&e[1]===o[1]);var e,o})[0];if(o&&o.should)n.cancelable&&n.preventDefault();else if(!o){var i=(a.current.shards||[]).map(Kk).filter(Boolean).filter(function(t){return t.contains(n.target)});(i.length>0?l(n,i[0]):!a.current.noIsolation)&&n.cancelable&&n.preventDefault()}}},[]),u=r.useCallback(function(t,n,r,o){var i={name:t,delta:n,target:r,should:o,shadowParent:Qk(r)};e.current.push(i),setTimeout(function(){e.current=e.current.filter(function(t){return t!==i})},1)},[]),d=r.useCallback(function(t){n.current=Uk(t),o.current=void 0},[]),p=r.useCallback(function(e){u(e.type,Yk(e),e.target,l(e,t.lockRef.current))},[]),f=r.useCallback(function(e){u(e.type,Uk(e),e.target,l(e,t.lockRef.current))},[]);r.useEffect(function(){return Zk.push(s),t.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:f}),document.addEventListener("wheel",c,$k),document.addEventListener("touchmove",c,$k),document.addEventListener("touchstart",d,$k),function(){Zk=Zk.filter(function(t){return t!==s}),document.removeEventListener("wheel",c,$k),document.removeEventListener("touchmove",c,$k),document.removeEventListener("touchstart",d,$k)}},[]);var h=t.removeScrollBar,m=t.inert;return r.createElement(r.Fragment,null,m?r.createElement(s,{styles:Xk(i)}):null,h?r.createElement(Bk,{noRelative:t.noRelative,gapMode:t.gapMode}):null)},Dk.useMedium(tE),Sk),nE=r.forwardRef(function(t,e){return r.createElement(Ok,gk({},t,{ref:e,sideCar:eE}))});nE.classNames=Ok.classNames;var rE="Popover",[oE,iE]=Ob(rE,[Bw]),sE=Bw(),[aE,lE]=oE(rE),cE=t=>{const{__scopePopover:e,children:n,open:o,defaultOpen:i,onOpenChange:s,modal:a=!1}=t,l=sE(e),c=r.useRef(null),[u,d]=r.useState(!1),[p,f]=lk({prop:o,defaultProp:i??!1,onChange:s,caller:rE});return Mb.jsx(ek,{...l,children:Mb.jsx(aE,{scope:e,contentId:sx(),triggerRef:c,open:p,onOpenChange:f,onOpenToggle:r.useCallback(()=>f(t=>!t),[f]),hasCustomAnchor:u,onCustomAnchorAdd:r.useCallback(()=>d(!0),[]),onCustomAnchorRemove:r.useCallback(()=>d(!1),[]),modal:a,children:n})})};cE.displayName=rE;var uE="PopoverAnchor";r.forwardRef((t,e)=>{const{__scopePopover:n,...o}=t,i=lE(uE,n),s=sE(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:l}=i;return r.useEffect(()=>(a(),()=>l()),[a,l]),Mb.jsx(nk,{...s,...o,ref:e})}).displayName=uE;var dE="PopoverTrigger",pE=r.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,o=lE(dE,n),i=sE(n),s=bb(e,o.triggerRef),a=Mb.jsx(Pb.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":kE(o.open),...r,ref:s,onClick:gb(t.onClick,o.onOpenToggle)});return o.hasCustomAnchor?a:Mb.jsx(nk,{asChild:!0,...i,children:a})});pE.displayName=dE;var[fE,hE]=oE("PopoverPortal",{forceMount:void 0}),mE="PopoverContent",gE=r.forwardRef((t,e)=>{const n=hE(mE,t.__scopePopover),{forceMount:r=n.forceMount,...o}=t,i=lE(mE,t.__scopePopover);return Mb.jsx(ik,{present:r||i.open,children:i.modal?Mb.jsx(yE,{...o,ref:e}):Mb.jsx(bE,{...o,ref:e})})});gE.displayName=mE;var vE=Ab("PopoverContent.RemoveScroll"),yE=r.forwardRef((t,e)=>{const n=lE(mE,t.__scopePopover),o=r.useRef(null),i=bb(e,o),s=r.useRef(!1);return r.useEffect(()=>{const t=o.current;if(t)return mk(t)},[]),Mb.jsx(nE,{as:vE,allowPinchZoom:!0,children:Mb.jsx(xE,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gb(t.onCloseAutoFocus,t=>{t.preventDefault(),s.current||n.triggerRef.current?.focus()}),onPointerDownOutside:gb(t.onPointerDownOutside,t=>{const e=t.detail.originalEvent,n=0===e.button&&!0===e.ctrlKey,r=2===e.button||n;s.current=r},{checkForDefaultPrevented:!1}),onFocusOutside:gb(t.onFocusOutside,t=>t.preventDefault(),{checkForDefaultPrevented:!1})})})}),bE=r.forwardRef((t,e)=>{const n=lE(mE,t.__scopePopover),o=r.useRef(!1),i=r.useRef(!1);return Mb.jsx(xE,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:e=>{t.onCloseAutoFocus?.(e),e.defaultPrevented||(o.current||n.triggerRef.current?.focus(),e.preventDefault()),o.current=!1,i.current=!1},onInteractOutside:e=>{t.onInteractOutside?.(e),e.defaultPrevented||(o.current=!0,"pointerdown"===e.detail.originalEvent.type&&(i.current=!0));const r=e.target,s=n.triggerRef.current?.contains(r);s&&e.preventDefault(),"focusin"===e.detail.originalEvent.type&&i.current&&e.preventDefault()}})}),xE=r.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...p}=t,f=lE(mE,n),h=sE(n);return r.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Gb()),document.body.insertAdjacentElement("beforeend",t[1]??Gb()),Wb++,()=>{1===Wb&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Wb--}},[]),Mb.jsx(Xb,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:i,onUnmountAutoFocus:s,children:Mb.jsx(Hb,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:Mb.jsx(rk,{"data-state":kE(f.open),role:"dialog",id:f.contentId,...h,...p,ref:e,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),wE="PopoverClose";r.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,o=lE(wE,n);return Mb.jsx(Pb.button,{type:"button",...r,ref:e,onClick:gb(t.onClick,()=>o.onOpenChange(!1))})}).displayName=wE;function kE(t){return t?"open":"closed"}r.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,o=sE(n);return Mb.jsx(ok,{...o,...r,ref:e})}).displayName="PopoverArrow";var EE=cE,CE=pE,SE=gE;const DE=({editor:t,isOpen:e,setIsOpen:n})=>{var r;const o=[{name:"Text",icon:Fv,command:()=>t.chain().focus().toggleNode("paragraph","paragraph").run(),isActive:()=>t.isActive("paragraph")&&!t.isActive("bulletList")&&!t.isActive("orderedList")},{name:"Heading 1",icon:_v,command:()=>t.chain().focus().toggleHeading({level:1}).run(),isActive:()=>t.isActive("heading",{level:1})},{name:"Heading 2",icon:Av,command:()=>t.chain().focus().toggleHeading({level:2}).run(),isActive:()=>t.isActive("heading",{level:2})},{name:"Heading 3",icon:Tv,command:()=>t.chain().focus().toggleHeading({level:3}).run(),isActive:()=>t.isActive("heading",{level:3})},{name:"To-do List",icon:Sv,command:()=>t.chain().focus().toggleTaskList().run(),isActive:()=>t.isActive("taskItem")},{name:"Bullet List",icon:Pv,command:()=>t.chain().focus().toggleBulletList().run(),isActive:()=>t.isActive("bulletList")},{name:"Numbered List",icon:Pv,command:()=>t.chain().focus().toggleOrderedList().run(),isActive:()=>t.isActive("orderedList")},{name:"Quote",icon:zv,command:()=>t.chain().focus().toggleNode("paragraph","paragraph").toggleBlockquote().run(),isActive:()=>t.isActive("blockquote")},{name:"Code",icon:Ov,command:()=>t.chain().focus().toggleCodeBlock().run(),isActive:()=>t.isActive("codeBlock")}],i=null!=(r=o.filter(t=>t.isActive()).pop())?r:{name:"Multiple"};return React.createElement(EE,{open:e},React.createElement("div",{className:"novel-relative novel-h-full"},React.createElement(CE,{className:"novel-flex novel-h-full novel-items-center novel-gap-1 novel-whitespace-nowrap novel-p-2 novel-text-sm novel-font-medium novel-text-stone-600 hover:novel-bg-stone-100 active:novel-bg-stone-200",onClick:()=>n(!e)},React.createElement("span",null,null==i?void 0:i.name),React.createElement(Mv,{className:"h-4 w-4"})),React.createElement(SE,{align:"start",className:"novel-z-[99999] novel-my-1 novel-flex novel-max-h-80 novel-w-48 novel-flex-col novel-overflow-hidden novel-overflow-y-auto novel-rounded novel-border novel-border-stone-200 novel-bg-white novel-p-1 novel-shadow-xl novel-animate-in novel-fade-in novel-slide-in-from-top-1"},o.map((t,e)=>React.createElement("button",{key:e,onClick:()=>{t.command(),n(!1)},className:"novel-flex novel-items-center novel-justify-between novel-rounded-sm novel-px-2 novel-py-1 novel-text-sm novel-text-stone-600 hover:novel-bg-stone-100",type:"button"},React.createElement("div",{className:"flex items-center space-x-2"},React.createElement("div",{className:"novel-flex novel-items-center novel-space-x-2"}," ",React.createElement(t.icon,{className:"novel-h-3 novel-w-3"})),React.createElement("span",null,t.name)),i.name===t.name&&React.createElement(Dv,{className:"novel-h-4 novel-w-4"}))))))},ME=[{name:"Default",color:"var(--novel-black)"},{name:"Purple",color:"#9333EA"},{name:"Red",color:"#E00000"},{name:"Yellow",color:"#EAB308"},{name:"Blue",color:"#2563EB"},{name:"Green",color:"#008A00"},{name:"Orange",color:"#FFA500"},{name:"Pink",color:"#BA4081"},{name:"Gray",color:"#A8A29E"}],OE=[{name:"Default",color:"var(--novel-highlight-default)"},{name:"Purple",color:"var(--novel-highlight-purple)"},{name:"Red",color:"var(--novel-highlight-red)"},{name:"Yellow",color:"var(--novel-highlight-yellow)"},{name:"Blue",color:"var(--novel-highlight-blue)"},{name:"Green",color:"var(--novel-highlight-green)"},{name:"Orange",color:"var(--novel-highlight-orange)"},{name:"Pink",color:"var(--novel-highlight-pink)"},{name:"Gray",color:"var(--novel-highlight-gray)"}],_E=({editor:t,isOpen:e,setIsOpen:n})=>{const r=ME.find(({color:e})=>t.isActive("textStyle",{color:e})),o=OE.find(({color:e})=>t.isActive("highlight",{color:e}));return React.createElement(EE,{open:e},React.createElement("div",{className:"novel-relative novel-h-full"},React.createElement(CE,{className:"novel-flex novel-h-full novel-items-center novel-gap-1 novel-p-2 novel-text-sm novel-font-medium novel-text-stone-600 hover:novel-bg-stone-100 active:novel-bg-stone-200",onClick:()=>n(!e)},React.createElement("span",{className:"novel-rounded-sm novel-px-1",style:{color:null==r?void 0:r.color,backgroundColor:null==o?void 0:o.color}},"A"),React.createElement(Mv,{className:"novel-h-4 novel-w-4"})),React.createElement(SE,{align:"start",className:"novel-z-[99999] novel-my-1 novel-flex novel-max-h-80 novel-w-48 novel-flex-col novel-overflow-hidden novel-overflow-y-auto novel-rounded novel-border novel-border-stone-200 novel-bg-white novel-p-1 novel-shadow-xl novel-animate-in novel-fade-in novel-slide-in-from-top-1"},React.createElement("div",{className:"novel-my-1 novel-px-2 novel-text-sm novel-text-stone-500"},"Color"),ME.map(({name:e,color:r},o)=>React.createElement("button",{key:o,onClick:()=>{t.commands.unsetColor(),"Default"!==e&&t.chain().focus().setColor(r||"").run(),n(!1)},className:"novel-flex novel-items-center novel-justify-between novel-rounded-sm novel-px-2 novel-py-1 novel-text-sm novel-text-stone-600 hover:novel-bg-stone-100",type:"button"},React.createElement("div",{className:"novel-flex novel-items-center novel-space-x-2"},React.createElement("div",{className:"novel-rounded-sm novel-border novel-border-stone-200 novel-px-1 novel-py-px novel-font-medium",style:{color:r}},"A"),React.createElement("span",null,e)),t.isActive("textStyle",{color:r})&&React.createElement(Dv,{className:"novel-h-4 novel-w-4"}))),React.createElement("div",{className:"novel-mb-1 novel-mt-2 novel-px-2 novel-text-sm novel-text-stone-500"},"Background"),OE.map(({name:e,color:r},o)=>React.createElement("button",{key:o,onClick:()=>{t.commands.unsetHighlight(),"Default"!==e&&t.commands.setHighlight({color:r}),n(!1)},className:"novel-flex novel-items-center novel-justify-between novel-rounded-sm novel-px-2 novel-py-1 novel-text-sm novel-text-stone-600 hover:novel-bg-stone-100",type:"button"},React.createElement("div",{className:"novel-flex novel-items-center novel-space-x-2"},React.createElement("div",{className:"novel-rounded-sm novel-border novel-border-stone-200 novel-px-1 novel-py-px novel-font-medium",style:{backgroundColor:r}},"A"),React.createElement("span",null,e)),t.isActive("highlight",{color:r})&&React.createElement(Dv,{className:"novel-h-4 novel-w-4"}))))))};function AE(t){var e,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=AE(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function TE(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=RE(t))&&(r&&(r+=" "),r+=e);return r}function RE(t){if("string"==typeof t)return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=RE(t[r]))&&(n&&(n+=" "),n+=e);return n}function NE(t){var e=function(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},o=function(t,e){if(!e)return t;return t.map(function(t){return[t[0],t[1].map(function(t){return"string"==typeof t?e+t:"object"==typeof t?Object.fromEntries(Object.entries(t).map(function(t){var n=t[0],r=t[1];return[e+n,r]})):t})]})}(Object.entries(t.classGroups),n);return o.forEach(function(t){var n=t[0];IE(t[1],r,n,e)}),r}(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,o=void 0===r?{}:r;return{getClassGroupId:function(t){var n=t.split("-");return""===n[0]&&1!==n.length&&n.shift(),PE(n,e)||function(t){if(LE.test(t)){var e=LE.exec(t)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}(t)},getConflictingClassGroupIds:function(t,e){var r=n[t]||[];return e&&o[t]?[].concat(r,o[t]):r}}}function PE(t,e){if(0===t.length)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),o=r?PE(t.slice(1),r):void 0;if(o)return o;if(0!==e.validators.length){var i=t.join("-");return e.validators.find(function(t){return(0,t.validator)(i)})?.classGroupId}}var LE=/^\[(.+)\]$/;function IE(t,e,n,r){t.forEach(function(t){if("string"!=typeof t){if("function"==typeof t)return t.isThemeGetter?void IE(t(r),e,n,r):void e.validators.push({validator:t,classGroupId:n});Object.entries(t).forEach(function(t){var o=t[0];IE(t[1],zE(e,o),n,r)})}else{(""===t?e:zE(e,t)).classGroupId=n}})}function zE(t,e){var n=t;return e.split("-").forEach(function(t){n.nextPart.has(t)||n.nextPart.set(t,{nextPart:new Map,validators:[]}),n=n.nextPart.get(t)}),n}function FE(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function o(o,i){n.set(o,i),++e>t&&(e=0,r=n,n=new Map)}return{get:function(t){var e=n.get(t);return void 0!==e?e:void 0!==(e=r.get(t))?(o(t,e),e):void 0},set:function(t,e){n.has(t)?n.set(t,e):o(t,e)}}}function BE(t){var e=t.separator||":",n=1===e.length,r=e[0],o=e.length;return function(t){for(var i,s=[],a=0,l=0,c=0;c<t.length;c++){var u=t[c];if(0===a){if(u===r&&(n||t.slice(c,c+o)===e)){s.push(t.slice(l,c)),l=c+o;continue}if("/"===u){i=c;continue}}"["===u?a++:"]"===u&&a--}var d=0===s.length?t:t.substring(l),p=d.startsWith("!");return{modifiers:s,hasImportantModifier:p,baseClassName:p?d.substring(1):d,maybePostfixModifierPosition:i&&i>l?i-l:void 0}}}var jE=/\s+/;function HE(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,o,i,s=function(t){var n=e[0],l=e.slice(1).reduce(function(t,e){return e(t)},n());return r=function(t){return{cache:FE(t.cacheSize),splitModifiers:BE(t),...NE(t)}}(l),o=r.cache.get,i=r.cache.set,s=a,a(t)};function a(t){var e=o(t);if(e)return e;var n=function(t,e){var n=e.splitModifiers,r=e.getClassGroupId,o=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(jE).map(function(t){var e=n(t),o=e.modifiers,i=e.hasImportantModifier,s=e.baseClassName,a=e.maybePostfixModifierPosition,l=r(a?s.substring(0,a):s),c=Boolean(a);if(!l){if(!a)return{isTailwindClass:!1,originalClassName:t};if(!(l=r(s)))return{isTailwindClass:!1,originalClassName:t};c=!1}var u=function(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(t){"["===t[0]?(e.push.apply(e,n.sort().concat([t])),n=[]):n.push(t)}),e.push.apply(e,n.sort()),e}(o).join(":");return{isTailwindClass:!0,modifierId:i?u+"!":u,classGroupId:l,originalClassName:t,hasPostfixModifier:c}}).reverse().filter(function(t){if(!t.isTailwindClass)return!0;var e=t.modifierId,n=t.classGroupId,r=t.hasPostfixModifier,s=e+n;return!i.has(s)&&(i.add(s),o(n,r).forEach(function(t){return i.add(e+t)}),!0)}).reverse().map(function(t){return t.originalClassName}).join(" ")}(t,r);return i(t,n),n}return function(){return s(TE.apply(null,arguments))}}function $E(t){var e=function(e){return e[t]||[]};return e.isThemeGetter=!0,e}var qE=/^\[(?:([a-z-]+):)?(.+)\]$/i,VE=/^\d+\/\d+$/,WE=new Set(["px","full","screen"]),GE=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,UE=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,YE=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function KE(t){return eC(t)||WE.has(t)||VE.test(t)||XE(t)}function XE(t){return lC(t,"length",cC)}function JE(t){return lC(t,"size",uC)}function ZE(t){return lC(t,"position",uC)}function QE(t){return lC(t,"url",dC)}function tC(t){return lC(t,"number",eC)}function eC(t){return!Number.isNaN(Number(t))}function nC(t){return t.endsWith("%")&&eC(t.slice(0,-1))}function rC(t){return pC(t)||lC(t,"number",pC)}function oC(t){return qE.test(t)}function iC(){return!0}function sC(t){return GE.test(t)}function aC(t){return lC(t,"",fC)}function lC(t,e,n){var r=qE.exec(t);return!!r&&(r[1]?r[1]===e:n(r[2]))}function cC(t){return UE.test(t)}function uC(){return!1}function dC(t){return t.startsWith("url(")}function pC(t){return Number.isInteger(Number(t))}function fC(t){return YE.test(t)}function hC(){var t=$E("colors"),e=$E("spacing"),n=$E("blur"),r=$E("brightness"),o=$E("borderColor"),i=$E("borderRadius"),s=$E("borderSpacing"),a=$E("borderWidth"),l=$E("contrast"),c=$E("grayscale"),u=$E("hueRotate"),d=$E("invert"),p=$E("gap"),f=$E("gradientColorStops"),h=$E("gradientColorStopPositions"),m=$E("inset"),g=$E("margin"),v=$E("opacity"),y=$E("padding"),b=$E("saturate"),x=$E("scale"),w=$E("sepia"),k=$E("skew"),E=$E("space"),C=$E("translate"),S=function(){return["auto",oC,e]},D=function(){return[oC,e]},M=function(){return["",KE]},O=function(){return["auto",eC,oC]},_=function(){return["","0",oC]},A=function(){return[eC,tC]},T=function(){return[eC,oC]};return{cacheSize:500,theme:{colors:[iC],spacing:[KE],blur:["none","",sC,oC],brightness:A(),borderColor:[t],borderRadius:["none","","full",sC,oC],borderSpacing:D(),borderWidth:M(),contrast:A(),grayscale:_(),hueRotate:T(),invert:_(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[nC,XE],inset:S(),margin:S(),opacity:A(),padding:D(),saturate:A(),scale:A(),sepia:_(),skew:T(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",oC]}],container:["container"],columns:[{columns:[sC]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[oC])}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",rC]}],basis:[{basis:S()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",oC]}],grow:[{grow:_()}],shrink:[{shrink:_()}],order:[{order:["first","last","none",rC]}],"grid-cols":[{"grid-cols":[iC]}],"col-start-end":[{col:["auto",{span:["full",rC]},oC]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[iC]}],"row-start-end":[{row:["auto",{span:[rC]},oC]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",oC]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",oC]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal"].concat(["start","end","center","between","around","evenly","stretch"])}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",oC,e]}],"min-w":[{"min-w":["min","max","fit",oC,KE]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[sC]},sC,oC]}],h:[{h:[oC,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",oC,KE]}],"max-h":[{"max-h":[oC,e,"min","max","fit"]}],"font-size":[{text:["base",sC,XE]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",tC]}],"font-family":[{font:[iC]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",oC]}],"line-clamp":[{"line-clamp":["none",eC,tC]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",oC,KE]}],"list-image":[{"list-image":["none",oC]}],"list-style-type":[{list:["none","disc","decimal",oC]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(["solid","dashed","dotted","double","none"],["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",KE]}],"underline-offset":[{"underline-offset":["auto",oC,KE]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",oC]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",oC]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[ZE])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",JE]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},QE]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[h]}],"gradient-via-pos":[{via:[h]}],"gradient-to-pos":[{to:[h]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(["solid","dashed","dotted","double","none"],["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:[""].concat(["solid","dashed","dotted","double","none"])}],"outline-offset":[{"outline-offset":[oC,KE]}],"outline-w":[{outline:[KE]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[KE]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",sC,aC]}],"shadow-color":[{shadow:[iC]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",sC,oC]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",oC]}],duration:[{duration:T()}],ease:[{ease:["linear","in","out","in-out",oC]}],delay:[{delay:T()}],animate:[{animate:["none","spin","ping","pulse","bounce",oC]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[rC,oC]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",oC]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",oC]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",oC]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[KE,tC]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var mC=HE(hC);function gC(...t){return mC(function(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=AE(t))&&(r&&(r+=" "),r+=e);return r}(t))}function vC(t){if(function(t){try{return new URL(t),!0}catch(t){return!1}}(t))return t;try{if(t.includes(".")&&!t.includes(" "))return new URL(`https://${t}`).toString()}catch(t){return null}}const yC=({editor:e,isOpen:n,setIsOpen:r})=>{const o=t.useRef(null);return t.useEffect(()=>{var t;o.current&&(null==(t=o.current)||t.focus())}),React.createElement("div",{className:"novel-relative"},React.createElement("button",{type:"button",className:"novel-flex novel-h-full novel-items-center novel-space-x-2 novel-px-3 novel-py-1.5 novel-text-sm novel-font-medium novel-text-stone-600 hover:novel-bg-stone-100 active:novel-bg-stone-200",onClick:()=>{r(!n)}},React.createElement("p",{className:"novel-text-base"},"?"),React.createElement("p",{className:gC("novel-underline novel-decoration-stone-400 novel-underline-offset-4",{"novel-text-blue-500":e.isActive("link")})},"Link")),n&&React.createElement("form",{onSubmit:t=>{t.preventDefault();const n=vC(t.currentTarget[0].value);n&&e.chain().focus().setLink({href:n}).run(),r(!1)},className:"novel-fixed novel-top-full novel-z-[99999] novel-mt-1 novel-flex novel-w-60 novel-overflow-hidden novel-rounded novel-border novel-border-stone-200 novel-bg-white novel-p-1 novel-shadow-xl novel-animate-in novel-fade-in novel-slide-in-from-top-1"},React.createElement("input",{ref:o,type:"text",placeholder:"Paste a link",className:"novel-flex-1 novel-bg-white novel-p-1 novel-text-sm novel-outline-none",defaultValue:e.getAttributes("link").href||""}),e.getAttributes("link").href?React.createElement("button",{type:"button",className:"novel-flex novel-items-center novel-rounded-sm novel-p-1 novel-text-red-600 novel-transition-all hover:novel-bg-red-100 dark:hover:novel-bg-red-800",onClick:()=>{e.chain().focus().unsetLink().run(),r(!1)}},React.createElement(Bv,{className:"novel-h-4 novel-w-4"})):React.createElement("button",{className:"novel-flex novel-items-center novel-rounded-sm novel-p-1 novel-text-stone-600 novel-transition-all hover:novel-bg-stone-100"},React.createElement(Dv,{className:"novel-h-4 novel-w-4"}))))},bC=e=>{const n=[{name:"bold",isActive:()=>e.editor.isActive("bold"),command:()=>e.editor.chain().focus().toggleBold().run(),icon:Cv},{name:"italic",isActive:()=>e.editor.isActive("italic"),command:()=>e.editor.chain().focus().toggleItalic().run(),icon:Nv},{name:"underline",isActive:()=>e.editor.isActive("underline"),command:()=>e.editor.chain().focus().toggleUnderline().run(),icon:jv},{name:"strike",isActive:()=>e.editor.isActive("strike"),command:()=>e.editor.chain().focus().toggleStrike().run(),icon:Iv},{name:"code",isActive:()=>e.editor.isActive("code"),command:()=>e.editor.chain().focus().toggleCode().run(),icon:Ov}],r={...e,shouldShow:({state:t,editor:e})=>{const{selection:n}=t,{empty:r}=n;return!(e.isActive("image")||r||Ns(n))},tippyOptions:{moveTransition:"transform 0.15s ease-out",onHidden:()=>{i(!1),a(!1),c(!1)}}},[o,i]=t.useState(!1),[s,a]=t.useState(!1),[l,c]=t.useState(!1);return React.createElement(qc,{...r,className:"novel-flex novel-w-fit novel-divide-x novel-divide-stone-200 novel-rounded novel-border novel-border-stone-200 novel-bg-white novel-shadow-xl"},React.createElement(DE,{editor:e.editor,isOpen:o,setIsOpen:()=>{i(!o),a(!1),c(!1)}}),React.createElement(yC,{editor:e.editor,isOpen:l,setIsOpen:()=>{c(!l),a(!1),i(!1)}}),React.createElement("div",{className:"novel-flex"},n.map((t,e)=>React.createElement("button",{key:e,onClick:t.command,className:"novel-p-2 novel-text-stone-600 hover:novel-bg-stone-100 active:novel-bg-stone-200",type:"button"},React.createElement(t.icon,{className:gC("novel-h-4 novel-w-4",{"novel-text-blue-500":t.isActive()})})))),React.createElement(_E,{editor:e.editor,isOpen:s,setIsOpen:()=>{a(!s),i(!1),c(!1)}}))},xC=(t,{chars:e,offset:n=0})=>t.state.doc.textBetween(Math.max(0,t.state.selection.from-e),t.state.selection.from-n,"\n");function wC(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function kC(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function EC(t){var e=t;if(void 0===e){if("undefined"==typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function CC(t,e){try{return new RegExp(t,"g").exec(e)}catch(t){return null}}function SC(t){return t.replace(/_/g,".")}function DC(t,e){var n=null,r="-1";return wC(t,function(t){var o=CC("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!(!o||t.brand)&&(n=t,r=o[3]||"-1",t.versionAlias?r=t.versionAlias:t.versionTest&&(r=function(t,e){var n=CC("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}(t.versionTest.toLowerCase(),e)||r),r=SC(r),!0)}),{preset:n,version:r}}function MC(t,e){var n={brand:"",version:"-1"};return wC(t,function(t){var r=OC(e,t);return!!r&&(n.brand=t.id,n.version=t.versionAlias||r.version,"-1"!==n.version)}),n}function OC(t,e){return kC(t,function(t){var n=t.brand;return CC(""+e.test,n.toLowerCase())})}var _C=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],AC=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],TC=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],RC=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],NC=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function PC(t){return!!DC(RC,t).preset}function LC(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map(function(e){return e.split(" ").map(function(e){return e?""+t+e:""}).join(" ")}).join(" ")}function IC(t,e){return function(n){n&&(t[e]=n)}}function zC(t,e,n){return function(r){r&&(t[e][n]=r)}}var FC="undefined",BC=typeof window!==FC,jC=typeof document!==FC&&document,HC=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],$C=1e-7,qC={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return void 0===e&&(e=window.innerWidth),t/100*e},vh:function(t,e){return void 0===e&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return void 0===e&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return void 0===e&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function VC(t,e,n,r){return(t*r+e*n)/(n+r)}function WC(t){return typeof t===FC}function GC(t){return t&&"object"==typeof t}function UC(t){return Array.isArray(t)}function YC(t){return"string"==typeof t}function KC(t){return"number"==typeof t}function XC(t){return"function"==typeof t}function JC(t,e,n,r,o){return ZC(t,e,n)?n:function(t,e,n,r,o){for(var i,s=function(n){var s=e[n].trim();if(s===t.close&&!ZC(t,e,n))return{value:n};var a=n,l=sS(o,function(t){return t.open===s});if(l&&(a=JC(l,e,n,r,o)),-1===a)return i=n,"break";i=n=a},a=n;a<r;++a){var l=s(a);if(a=i,"object"==typeof l)return l.value;if("break"===l)break}return-1}(t,e,n+1,r,o)}function ZC(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function QC(t,e){var n=YC(e)?{separator:e}:e,r=n.separator,o=void 0===r?",":r,i=n.isSeparateFirst,s=n.isSeparateOnlyOpenClose,a=n.isSeparateOpenClose,l=void 0===a?s:a,c=n.openCloseCharacters,u=void 0===c?HC:c,d=u.map(function(t){var e=t.open,n=t.close;return e===n?e:e+"|"+n}).join("|"),p=new RegExp("(\\s*"+o+"\\s*|"+d+"|\\s+)","g"),f=t.split(p).filter(function(t){return t&&"undefined"!==t}),h=f.length,m=[],g=[];function v(){return!!g.length&&(m.push(g.join("")),g=[],!0)}for(var y,b=function(e){var n=f[e].trim(),r=e,a=sS(u,function(t){return t.open===n}),c=sS(u,function(t){return t.close===n});if(a){if(-1!==(r=JC(a,f,e,h,u))&&l)return v()&&i?(y=e,"break"):(m.push(f.slice(e,r+1).join("")),e=r,i?(y=e,"break"):(y=e,"continue"))}else{if(c&&!ZC(c,f,e)){var d=
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}(u);return d.splice(u.indexOf(c),1),{value:QC(t,{separator:o,isSeparateFirst:i,isSeparateOnlyOpenClose:s,isSeparateOpenClose:l,openCloseCharacters:d})}}if(function(t,e){return(""===e||" "==e)&&(""===t||" "==t)||t===e}(n,o)&&!s)return v(),i?(y=e,"break"):(y=e,"continue")}-1===r&&(r=h-1),g.push(f.slice(e,r+1).join("")),y=e=r},x=0;x<h;++x){var w=b(x);if(x=y,"object"==typeof w)return w.value;if("break"===w)break}return g.length&&m.push(g.join("")),m}function tS(t){return QC(t,"")}function eS(t){return QC(t,",")}function nS(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function rS(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2];return{prefix:n,unit:e[3],value:parseFloat(r)}}function oS(){return Date.now?Date.now():(new Date).getTime()}function iS(t,e,n){void 0===n&&(n=-1);for(var r=t.length,o=0;o<r;++o)if(e(t[o],o,t))return o;return n}function sS(t,e,n){var r=iS(t,e);return r>-1?t[r]:n}var aS=function(){var t=oS(),e=BC&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(e){var n=oS();return setTimeout(function(){e(n-t)},1e3/60)}}(),lS=function(){var t=BC&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(t){clearTimeout(t)}}();function cS(t){return Object.keys(t)}function uS(t,e){var n=rS(t),r=n.value,o=n.unit;if(GC(e)){var i=e[o];if(i){if(XC(i))return i(r);if(qC[o])return qC[o](r,i)}}else if("%"===o)return r*e/100;return qC[o]?qC[o](r):r}function dS(t,e,n){return Math.max(e,Math.min(t,n))}function pS(t,e,n,r){return void 0===r&&(r=t[0]/t[1]),[[yS(e[0],$C),yS(e[0]/r,$C)],[yS(e[1]*r,$C),yS(e[1],$C)]].filter(function(t){return t.every(function(t,r){var o=e[r],i=yS(o,$C);return n?t<=o||t<=i:t>=o||t>=i})})[0]||t}function fS(t,e,n,r){if(!r)return t.map(function(t,r){return dS(t,e[r],n[r])});var o=t[0],i=t[1],s=!0===r?o/i:r,a=pS(t,e,!1,s),l=a[0],c=a[1],u=pS(t,n,!0,s),d=u[0],p=u[1];return o<l||i<c?(o=l,i=c):(o>d||i>p)&&(o=d,i=p),[o,i]}function hS(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function mS(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=Math.atan2(r,n);return o>=0?o:o+2*Math.PI}function gS(t){var e=function(t){return[0,1].map(function(e){return hS(t.map(function(t){return t[e]}))})}(t),n=mS(e,t[0]),r=mS(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function vS(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function yS(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function bS(t,e){return t.forEach(function(n,r){t[r]=yS(t[r],e)}),t}function xS(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function wS(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function kS(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function ES(t,e,n,r){t.addEventListener(e,n,r)}function CS(t,e,n,r){t.removeEventListener(e,n,r)}function SS(t){return(null==t?void 0:t.ownerDocument)||jC}function DS(t){return SS(t).documentElement}function MS(t){return SS(t).body}function OS(t){var e;return(null===(e=null==t?void 0:t.ownerDocument)||void 0===e?void 0:e.defaultView)||window}function _S(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function AS(t){return GC(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}function TS(t,e,n,r,o,i){for(var s=0;s<o;++s){var a=n+s*o,l=r+s*o;t[a]+=t[l]*i,e[a]+=e[l]*i}}function RS(t,e,n,r,o){for(var i=0;i<o;++i){var s=n+i*o,a=r+i*o,l=t[s],c=e[s];t[s]=t[a],t[a]=l,e[s]=e[a],e[a]=c}}function NS(t,e,n,r,o){for(var i=0;i<r;++i){var s=n+i*r;t[s]/=o,e[s]/=o}}function PS(t,e,n){for(var r=t.slice(),o=0;o<n;++o)r[o*n+e-1]=0,r[(e-1)*n+o]=0;return r[(e-1)*(n+1)]=1,r}function LS(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=tD(e),o=0;o<e;++o){var i=e*o+o;if(!yS(n[i],$C))for(var s=o+1;s<e;++s)if(n[e*o+s]){RS(n,r,o,s,e);break}if(!yS(n[i],$C))return[];NS(n,r,o,e,n[i]);for(s=0;s<e;++s){var a=s,l=n[s+o*e];yS(l,$C)&&o!==s&&TS(n,r,a,o,e,-l)}}return r}function IS(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],o=0;o<e-1;++o)n[o]=t[e*(e-1)+o]/r;return n[e-1]=0,n}function zS(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function FS(t,e,n){if(void 0===e&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=tD(n),o=Math.min(e,n),i=0;i<o-1;++i){for(var s=0;s<o-1;++s)r[i*n+s]=t[i*e+s];r[(i+1)*n-1]=t[(i+1)*e-1],r[(n-1)*n+i]=t[(e-1)*e+i]}return r[n*n-1]=t[e*e-1],r}function BS(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=tD(t);return e.forEach(function(e){r=jS(r,e,t)}),r}function jS(t,e,n){void 0===n&&(n=Math.sqrt(t.length));var r=[],o=t.length/n,i=e.length/o;if(!o)return e;if(!i)return t;for(var s=0;s<n;++s)for(var a=0;a<i;++a){r[a*n+s]=0;for(var l=0;l<o;++l)r[a*n+s]+=t[l*n+s]*e[a*o+l]}return r}function HS(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),o=0;o<n;++o)r[o]=r[o]+e[o];return r}function $S(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),o=0;o<n;++o)r[o]=r[o]-e[o];return r}function qS(t,e){return void 0===e&&(e=6===t.length),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function VS(t,e){return void 0===e&&(e=9===t.length),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function WS(t,e,n){void 0===n&&(n=e.length);var r=jS(t,e,n),o=r[n-1];return r.map(function(t){return t/o})}function GS(t,e){return jS(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function US(t,e){return jS(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function YS(t,e){return jS(t,QS(e,4))}function KS(t,e){var n=e[0],r=void 0===n?1:n,o=e[1],i=void 0===o?1:o,s=e[2];return jS(t,[r,0,0,0,0,i,0,0,0,0,void 0===s?1:s,0,0,0,0,1],4)}function XS(t,e){return WS(QS(e,3),zS(t,3))}function JS(t,e){var n=e[0],r=void 0===n?0:n,o=e[1],i=void 0===o?0:o,s=e[2];return jS(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,i,void 0===s?0:s,1],4)}function ZS(t,e){return jS(t,e,4)}function QS(t,e){var n=Math.cos(t),r=Math.sin(t),o=tD(e);return o[0]=n,o[1]=r,o[e]=-r,o[e+1]=n,o}function tD(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function eD(t,e){for(var n=tD(e),r=Math.min(t.length,e-1),o=0;o<r;++o)n[(e+1)*o]=t[o];return n}function nD(t,e){for(var n=tD(e),r=Math.min(t.length,e-1),o=0;o<r;++o)n[e*(e-1)+o]=t[o];return n}function rD(t,e,n,r,o,i,s,a){var l=t[0],c=t[1],u=e[0],d=e[1],p=n[0],f=n[1],h=r[0],m=r[1],g=o[0],v=o[1],y=i[0],b=i[1],x=s[0],w=s[1],k=a[0],E=a[1],C=LS([l,0,u,0,p,0,h,0,c,0,d,0,f,0,m,0,1,0,1,0,1,0,1,0,0,l,0,u,0,p,0,h,0,c,0,d,0,f,0,m,0,1,0,1,0,1,0,1,-g*l,-v*l,-y*u,-b*u,-x*p,-w*p,-k*h,-E*h,-g*c,-v*c,-y*d,-b*d,-x*f,-w*f,-k*m,-E*m],8);if(!C.length)return[];var S=jS(C,[g,v,y,b,x,w,k,E],8);return S[8]=1,FS(function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var o=0;o<e;++o)n[o*e+r]=t[e*r+o];return n}(S),3,4)}var oD=function(){return oD=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},oD.apply(this,arguments)};function iD(t,e){return void 0===e&&(e=0),sD(aD(t,e))}function sD(t){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return t.forEach(function(t){var n=t.matrixFunction,r=t.functionValue;n&&(e=n(e,r))}),e}function aD(t,e){return void 0===e&&(e=0),(UC(t)?t:tS(t)).map(function(t){var n=nS(t),r=n.prefix,o=n.value,i=null,s=r,a="";if("translate"===r||"translateX"===r||"translate3d"===r){var l=GC(e)?oD(oD({},e),{"o%":e["%"]}):{"%":e,"o%":e},c=eS(o).map(function(t,n){return l["%"]=0===n&&"x%"in l?e["x%"]:1===n&&"y%"in l?e["y%"]:e["o%"],uS(t,l)}),u=c[0],d=c[1],p=void 0===d?0:d,f=c[2];i=JS,a=[u,p,void 0===f?0:f]}else if("translateY"===r){i=JS,a=[0,p=uS(o,GC(e)?oD({"%":e["y%"]},e):{"%":e}),0]}else if("translateZ"===r){i=JS,a=[0,0,parseFloat(o)]}else if("scale"===r||"scale3d"===r){var h=eS(o).map(function(t){return parseFloat(t)}),m=h[0],g=h[1],v=void 0===g?m:g,y=h[2];i=KS,a=[m,v,void 0===y?1:y]}else if("scaleX"===r){i=KS,a=[m=parseFloat(o),1,1]}else if("scaleY"===r){i=KS,a=[1,v=parseFloat(o),1]}else if("scaleZ"===r){i=KS,a=[1,1,parseFloat(o)]}else if("rotate"===r||"rotateZ"===r||"rotateX"===r||"rotateY"===r){var b=rS(o),x=b.unit,w=b.value;"rotate"===r||"rotateZ"===r?(s="rotateZ",i=YS):"rotateX"===r?i=GS:"rotateY"===r&&(i=US),a="rad"===x?w:w*Math.PI/180}else if("matrix3d"===r)i=ZS,a=eS(o).map(function(t){return parseFloat(t)});else if("matrix"===r){var k=eS(o).map(function(t){return parseFloat(t)});i=ZS,a=[k[0],k[1],0,0,k[2],k[3],0,0,0,0,1,0,k[4],k[5],0,1]}else s="";return{name:r,functionName:s,value:o,matrixFunction:i,functionValue:a}})}var lD=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,o=n.indexOf(t),i=-1===o?n.length:o;n[i]=t,r[i]=e},t}(),cD=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),uD="function"==typeof Map,dD=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var t=this,e=-1;t;)t=t.prev,++e;return e},t}();var pD=function(){function t(t,e,n,r,o,i,s,a){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=o,this.maintained=i,this.changedBeforeAdded=s,this.fixed=a}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=function(t,e){var n=[],r=[];return t.forEach(function(t){var e=t[0],o=t[1],i=new dD;n[e]=i,r[o]=i}),n.forEach(function(t,e){t.connect(n[e-1])}),t.filter(function(t,n){return!e[n]}).map(function(t,e){var o=t[0],i=t[1];if(o===i)return[0,0];var s=n[o],a=r[i-1],l=s.getIndex();return s.disconnect(),a?s.connect(a,a.next):s.connect(void 0,n[0]),[l,s.getIndex()]})}(this.changedBeforeAdded,this.fixed),e=this.changed,n=[];this.cacheOrdered=t.filter(function(t,r){var o=t[0],i=t[1],s=e[r],a=s[0],l=s[1];if(o!==i)return n.push([a,l]),!0}),this.cachePureChanged=n},t}();function fD(t,e,n){var r=uD?Map:n?cD:lD,o=n||function(t){return t},i=[],s=[],a=[],l=t.map(o),c=e.map(o),u=new r,d=new r,p=[],f=[],h={},m=[],g=0,v=0;return l.forEach(function(t,e){u.set(t,e)}),c.forEach(function(t,e){d.set(t,e)}),l.forEach(function(t,e){var n=d.get(t);void 0===n?(++v,s.push(e)):h[n]=v}),c.forEach(function(t,e){var n=u.get(t);void 0===n?(i.push(e),++g):(a.push([n,e]),v=h[e]||0,p.push([n-v,e-g]),f.push(e===n),n!==e&&m.push([n,e]))}),s.reverse(),new pD(t,e,i,s,m,a,p,f)}var hD=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}return t.prototype.update=function(t){var e=[].slice.call(t),n=fD(this.list,e,this.findKeyCallback);return this.list=e,n},t}(),mD=function(t,e){return mD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},mD(t,e)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var gD,vD="function"==typeof Map?void 0:(gD=0,function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++gD)}),yD=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e,vD)||this}return function(t,e){function n(){this.constructor=t}mD(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(hD);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var bD=function(){return bD=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},bD.apply(this,arguments)};var xD=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(GC(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(GC(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var o=iS(r,function(t){return t.listener===e});o>-1&&r.splice(o,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise(function(e){n._addEvent(t,e,{once:!0})})},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var o=!1;return e.eventType=t,e.stop=function(){o=!0},e.currentTarget=this,function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}(r).forEach(function(r){r.listener(e),r.once&&n.off(t,r.listener)}),!o},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[],r[t].push(bD({listener:e},n))},t}(),wD=function(t,e){return wD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},wD(t,e)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var kD=function(){return kD=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},kD.apply(this,arguments)};function ED(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function CD(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function SD(t){return t?YC(t)?document.querySelector(t):XC(t)?t():t instanceof Element?t:"current"in t?t.current:"value"in t?t.value:void 0:null}var DD=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._startRect=null,e._startPos=[],e._prevTime=0,e._timer=0,e._prevScrollPos=[0,0],e._isWait=!1,e._flag=!1,e._currentOptions=null,e._lock=!1,e._unregister=null,e._onScroll=function(){var t=e._currentOptions;!e._lock&&t&&e.emit("scrollDrag",{next:function(n){e.checkScroll({container:t.container,inputEvent:n})}})},e}!function(t,e){function n(){this.constructor=t}wD(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t);var n=e.prototype;return n.dragStart=function(t,e){var n=SD(e.container);if(n){var r=0,o=0,i=0,s=0;if(n===document.body)i=window.innerWidth,s=window.innerHeight;else{var a=n.getBoundingClientRect();r=a.top,o=a.left,i=a.width,s=a.height}this._flag=!0,this._startPos=[t.clientX,t.clientY],this._startRect={top:r,left:o,width:i,height:s},this._prevScrollPos=this._getScrollPosition([0,0],e),this._currentOptions=e,this._registerScrollEvent(e)}else this._flag=!1},n.drag=function(t,e){if(clearTimeout(this._timer),this._flag){var n=t.clientX,r=t.clientY,o=e.threshold,i=void 0===o?0:o,s=this._startRect,a=this._startPos;this._currentOptions=e;var l=[0,0];return s.top>r-i?(a[1]>s.top||r<a[1])&&(l[1]=-1):s.top+s.height<r+i&&(a[1]<s.top+s.height||r>a[1])&&(l[1]=1),s.left>n-i?(a[0]>s.left||n<a[0])&&(l[0]=-1):s.left+s.width<n+i&&(a[0]<s.left+s.width||n>a[0])&&(l[0]=1),!(!l[0]&&!l[1])&&this._continueDrag(kD(kD({},e),{direction:l,inputEvent:t,isDrag:!0}))}},n.checkScroll=function(t){var e=this;if(this._isWait)return!1;var n=t.prevScrollPos,r=void 0===n?this._prevScrollPos:n,o=t.direction,i=t.throttleTime,s=void 0===i?0:i,a=t.inputEvent,l=t.isDrag,c=this._getScrollPosition(o||[0,0],t),u=c[0]-r[0],d=c[1]-r[1],p=o||[u?Math.abs(u)/u:0,d?Math.abs(d)/d:0];return this._prevScrollPos=c,this._lock=!1,!(!u&&!d)&&(this.emit("move",{offsetX:p[0]?u:0,offsetY:p[1]?d:0,inputEvent:a}),s&&l&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){e._continueDrag(t)},s)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(t,e){var n=e.container,r=e.getScrollPosition;return(void 0===r?ED:r)({container:SD(n),direction:t})},n._continueDrag=function(t){var e,n=this,r=t.container,o=t.direction,i=t.throttleTime,s=t.useScroll,a=t.isDrag,l=t.inputEvent;if(!(!this._flag||a&&this._isWait)){var c=oS(),u=Math.max(i+this._prevTime-c,0);if(u>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){n._continueDrag(t)},u),!1;this._prevTime=c;var d=this._getScrollPosition(o,t);this._prevScrollPos=d,a&&(this._isWait=!0),s||(this._lock=!0);var p={container:SD(r),direction:o,inputEvent:l};return null===(e=t.requestScroll)||void 0===e||e.call(t,p),this.emit("scroll",p),this._isWait=!1,s||this.checkScroll(kD(kD({},t),{prevScrollPos:d,direction:o,inputEvent:l}))}},n._registerScrollEvent=function(t){this._unregisterScrollEvent();var e=t.checkScrollEvent;if(e){var n=!0===e?CD:e,r=SD(t.container);!0!==e||r!==document.body&&r!==document.documentElement?this._unregister=n(r,this._onScroll):this._unregister=CD(window,this._onScroll)}},n._unregisterScrollEvent=function(){var t;null===(t=this._unregister)||void 0===t||t.call(this),this._unregister=null},e}(xD);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function MD(t){return yS(t,$C)}function OD(t){return t.length<3?0:Math.abs(function(t){for(var e=0,n=t.length-1;n>=0;--n)e+=t[n];return e}(t.map(function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]})))/2}function _D(t,e){var n=e.width,r=e.height,o=e.left,i=e.top,s=AD(t),a=s.minX,l=s.minY,c=s.maxX,u=s.maxY,d=n/(c-a),p=r/(u-l);return t.map(function(t){return[o+(t[0]-a)*d,i+(t[1]-l)*p]})}function AD(t){var e=t.map(function(t){return t[0]}),n=t.map(function(t){return t[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function TD(t,e,n){var r=t[0],o=t[1],i=AD(e),s=i.minX,a=i.maxX,l=[[s,o],[a,o]],c=RD(l[0],l[1]),u=LD(e),d=[];if(u.forEach(function(e){var n,r=RD(e[0],e[1]),i=e[0];(n=r,c.every(function(t,e){return 0===MD(t-n[e])}))?d.push({pos:t,line:e,type:"line"}):PD(ND(c,r),[l,e]).forEach(function(t){e.some(function(e){return r=t,!MD((n=e)[0]-r[0])&&!MD(n[1]-r[1]);var n,r})?d.push({pos:t,line:e,type:"point"}):0!==MD(i[1]-o)&&d.push({pos:t,line:e,type:"intersection"})})}),sS(d,function(t){return t[0]===r}))return!0;var p=0,f={};return d.forEach(function(t){var e=t.pos,n=t.type,i=t.line;if(!(e[0]>r))if("intersection"===n)++p;else{if("line"===n)return;if("point"===n){var s=sS(i,function(t){return t[1]!==o}),a=f[e[0]],l=s[1]>o?1:-1;a?a!==l&&++p:f[e[0]]=l}}}),p%2==1}function RD(t,e){var n=t[0],r=t[1],o=e[0]-n,i=e[1]-r;Math.abs(o)<$C&&(o=0),Math.abs(i)<$C&&(i=0);var s=0,a=0,l=0;return o?i?(a=1,l=-(s=-i/o)*n-r):(a=1,l=-r):i&&(s=-1,l=n),[s,a,l]}function ND(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],s=e[1],a=e[2],l=0===n&&0===i,c=0===r&&0===s,u=[];if(l&&c)return[];if(l){var d=-o/r;return d!==-a/s?[]:[[-1/0,d],[1/0,d]]}if(c){var p=-o/n;return p!==-a/i?[]:[[p,-1/0],[p,1/0]]}if(0===n)u=[[f=-(s*(h=-o/r)+a)/i,h]];else if(0===i){u=[[f=-(r*(h=-a/s)+o)/n,h]]}else if(0===r){u=[[f=-o/n,h=-(i*f+a)/s]]}else if(0===s){u=[[f=-a/i,h=-(n*f+o)/r]]}else{var f,h;u=[[f=(r*a-s*o)/(s*n-r*i),h=-(n*f+o)/r]]}return u.map(function(t){return[t[0],t[1]]})}function PD(t,e){var n=e.map(function(t){return[0,1].map(function(e){return[Math.min(t[0][e],t[1][e]),Math.max(t[0][e],t[1][e])]})}),r=[];if(2===t.length){var o=t[0],i=o[0],s=o[1];if(MD(i-t[1][0])){if(!MD(s-t[1][1])){var a=Math.max.apply(Math,n.map(function(t){return t[0][0]})),l=Math.min.apply(Math,n.map(function(t){return t[0][1]}));if(MD(a-l)>0)return[];r=[[a,s],[l,s]]}}else{var c=Math.max.apply(Math,n.map(function(t){return t[1][0]})),u=Math.min.apply(Math,n.map(function(t){return t[1][1]}));if(MD(c-u)>0)return[];r=[[i,c],[i,u]]}}return r.length||(r=t.filter(function(t){var e=t[0],r=t[1];return n.every(function(t){return 0<=MD(e-t[0][0])&&0<=MD(t[0][1]-e)&&0<=MD(r-t[1][0])&&0<=MD(t[1][1]-r)})})),r.map(function(t){return[MD(t[0]),MD(t[1])]})}function LD(t){return function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}(t.slice(1),[t[0]]).map(function(e,n){return[t[n],e]})}function ID(t,e){var n=function(t,e){var n=t.slice(),r=e.slice();-1===gS(n)&&n.reverse(),-1===gS(r)&&r.reverse();var o=LD(n),i=LD(r),s=o.map(function(t){return RD(t[0],t[1])}),a=i.map(function(t){return RD(t[0],t[1])}),l=[];s.forEach(function(t,e){var n=o[e],s=[];a.forEach(function(r,o){var a=PD(ND(t,r),[n,i[o]]);s.push.apply(s,a.map(function(t){return{index1:e,index2:o,pos:t,type:"intersection"}}))}),s.sort(function(t,e){return vS(n[0],t.pos)-vS(n[0],e.pos)}),l.push.apply(l,s),TD(n[1],r)&&l.push({index1:e,index2:-1,pos:n[1],type:"inside"})}),i.forEach(function(t,e){if(TD(t[1],n)){var r=!1,o=iS(l,function(t){return t.index2===e?(r=!0,!1):!!r});-1===o&&(r=!1,o=iS(l,function(t){var n=t.index1,o=t.index2;return-1===n&&o+1===e?(r=!0,!1):!!r})),-1===o?l.push({index1:-1,index2:e,pos:t[1],type:"inside"}):l.splice(o,0,{index1:-1,index2:e,pos:t[1],type:"inside"})}});var c={};return l.filter(function(t){var e=t.pos,n=e[0]+"x"+e[1];return!c[n]&&(c[n]=!0,!0)})}(t,e);return n.map(function(t){return t.pos})}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var zD=function(t,e){return zD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},zD(t,e)};var FD=function(){return FD=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},FD.apply(this,arguments)};function BD(t){return 180*(e=[t[0].clientX,t[0].clientY],n=[t[1].clientX,t[1].clientY],r=n[0]-e[0],o=n[1]-e[1],((i=Math.atan2(o,r))>=0?i:i+2*Math.PI)/Math.PI);var e,n,r,o,i}function jD(t){return t?t.touches?function(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(qD(t[r]));return n}(t.touches):[qD(t)]:[]}function HD(t,e,n){var r=n.length,o=VD(t,r),i=o.clientX,s=o.clientY,a=o.originalClientX,l=o.originalClientY,c=VD(e,r),u=c.clientX,d=c.clientY,p=VD(n,r);return{clientX:a,clientY:l,deltaX:i-u,deltaY:s-d,distX:i-p.clientX,distY:s-p.clientY}}function $D(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function qD(t){return{clientX:t.clientX,clientY:t.clientY}}function VD(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(t.length,e),o=0;o<r;++o){var i=t[o];n.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,n.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,n.clientX+=i.clientX,n.clientY+=i.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var WD=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}return t.prototype.getAngle=function(t){return void 0===t&&(t=this.prevClients),BD(t)},t.prototype.getRotation=function(t){return void 0===t&&(t=this.prevClients),BD(t)-BD(this.startClients)},t.prototype.getPosition=function(t,e){void 0===t&&(t=this.prevClients);var n=HD(t||this.prevClients,this.prevClients,this.startClients),r=n.deltaX,o=n.deltaY;return this.movement+=Math.sqrt(r*r+o*o),this.prevClients=t,n},t.prototype.getPositions=function(t){void 0===t&&(t=this.prevClients);for(var e=this.prevClients,n=this.startClients,r=Math.min(this.length,e.length),o=[],i=0;i<r;++i)o[i]=HD([t[i]],[e[i]],[n[i]]);return o},t.prototype.getMovement=function(t){var e=this.movement;if(!t)return e;var n=VD(t,this.length),r=VD(this.prevClients,this.length),o=n.clientX-r.clientX,i=n.clientY-r.clientY;return Math.sqrt(o*o+i*i)+e},t.prototype.getDistance=function(t){return void 0===t&&(t=this.prevClients),$D(t)},t.prototype.getScale=function(t){return void 0===t&&(t=this.prevClients),$D(t)/$D(this.startClients)},t.prototype.move=function(t,e){this.startClients.forEach(function(n){n.clientX-=t,n.clientY-=e}),this.prevClients.forEach(function(n){n.clientX-=t,n.clientY-=e})},t}(),GD=["textarea","input"],UD=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;r.options={},r.flag=!1,r.pinchFlag=!1,r.data={},r.isDrag=!1,r.isPinch=!1,r.clientStores=[],r.targets=[],r.prevTime=0,r.doubleFlag=!1,r._useMouse=!1,r._useTouch=!1,r._useDrag=!1,r._dragFlag=!1,r._isTrusted=!1,r._isMouseEvent=!1,r._isSecondaryButton=!1,r._preventMouseEvent=!1,r._prevInputEvent=null,r._isDragAPI=!1,r._isIdle=!0,r._preventMouseEventId=0,r._window=window,r.onDragStart=function(t,e){if(void 0===e&&(e=!0),r.flag||!1!==t.cancelable){var n=t.type.indexOf("drag")>=-1;if(!r.flag||!n){r._isDragAPI=!0;var o=r.options,i=o.container,s=o.pinchOutside,a=o.preventWheelClick,l=o.preventRightClick,c=o.preventDefault,u=o.checkInput,d=o.dragFocusedInput,p=o.preventClickEventOnDragStart,f=o.preventClickEventOnDrag,h=o.preventClickEventByCondition,m=r._useTouch,g=!r.flag;if(r._isSecondaryButton=3===t.which||2===t.button,a&&(2===t.which||1===t.button)||l&&(3===t.which||2===t.button))return r.stop(),!1;if(g){var v=r._window.document.activeElement,y=t.target;if(y){var b=y.tagName.toLowerCase(),x=GD.indexOf(b)>-1,w=y.isContentEditable;if(x||w){if(u||!d&&v===y)return!1;if(v&&(v===y||w&&v.isContentEditable&&v.contains(y))){if(!d)return!1;y.blur()}}else if((c||"touchstart"===t.type)&&v){var k=v.tagName.toLowerCase();(v.isContentEditable||GD.indexOf(k)>-1)&&v.blur()}(p||f||h)&&ES(r._window,"click",r._onClick,!0)}r.clientStores=[new WD(jD(t))],r._isIdle=!1,r.flag=!0,r.isDrag=!1,r._isTrusted=e,r._dragFlag=!0,r._prevInputEvent=t,r.data={},r.doubleFlag=oS()-r.prevTime<200,r._isMouseEvent=function(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}(t),!r._isMouseEvent&&r._preventMouseEvent&&r._allowMouseEvent(),!1===(r._preventMouseEvent||r.emit("dragStart",FD(FD({data:r.data,datas:r.data,inputEvent:t,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,isTrusted:e,isDouble:r.doubleFlag},r.getCurrentStore().getPosition()),{preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}})))&&r.stop(),r._isMouseEvent&&r.flag&&c&&t.preventDefault()}if(!r.flag)return!1;var E=0;if(g?(r._attchDragEvent(),m&&s&&(E=setTimeout(function(){ES(i,"touchstart",r.onDragStart,{passive:!1})}))):m&&s&&CS(i,"touchstart",r.onDragStart),r.flag&&function(t){return t.touches&&t.touches.length>=2}(t)){if(clearTimeout(E),g&&t.touches.length!==t.changedTouches.length)return;r.pinchFlag||r.onPinchStart(t)}}}},r.onDrag=function(t,e){if(r.flag){var n=r.options.preventDefault;!r._isMouseEvent&&n&&t.preventDefault(),r._prevInputEvent=t;var o=jD(t),i=r.moveClients(o,t,!1);if(r._dragFlag){if(r.pinchFlag||i.deltaX||i.deltaY)if(!1===(r._preventMouseEvent||r.emit("drag",FD(FD({},i),{isScroll:!!e,inputEvent:t}))))return void r.stop();r.pinchFlag&&r.onPinch(t,o)}r.getCurrentStore().getPosition(o,!0)}},r.onDragEnd=function(t){if(r.flag){var e=r.options,n=e.pinchOutside,o=e.container,i=e.preventClickEventOnDrag,s=e.preventClickEventOnDragStart,a=e.preventClickEventByCondition,l=r.isDrag;(i||s||a)&&requestAnimationFrame(function(){r._allowClickEvent()}),a||s||!i||l||r._allowClickEvent(),r._useTouch&&n&&CS(o,"touchstart",r.onDragStart),r.pinchFlag&&r.onPinchEnd(t);var c=(null==t?void 0:t.touches)?jD(t):[];0!==c.length&&r.options.keepDragging?r._addStore(new WD(c)):r.flag=!1;var u=r._getPosition(),d=oS(),p=!l&&r.doubleFlag;r._prevInputEvent=null,r.prevTime=l||p?0:d,r.flag||(r._dettachDragEvent(),r._preventMouseEvent||r.emit("dragEnd",FD({data:r.data,datas:r.data,isDouble:p,isDrag:l,isClick:!l,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,inputEvent:t,isTrusted:r._isTrusted},u)),r.clientStores=[],r._isMouseEvent||(r._preventMouseEvent=!0,clearTimeout(r._preventMouseEventId),r._preventMouseEventId=setTimeout(function(){r._preventMouseEvent=!1},200)),r._isIdle=!0)}},r.onBlur=function(){r.onDragEnd()},r._allowClickEvent=function(){CS(r._window,"click",r._onClick,!0)},r._onClick=function(t){r._allowClickEvent(),r._allowMouseEvent();var e=r.options.preventClickEventByCondition;(null==e?void 0:e(t))||(t.stopPropagation(),t.preventDefault())},r._onContextMenu=function(t){r.options.preventRightClick?r.onDragEnd(t):t.preventDefault()},r._passCallback=function(){};var o=[].concat(e),i=o[0];r._window=_S(i)?i:OS(i),r.options=FD({checkInput:!1,container:i&&!("document"in i)?OS(i):i,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var s=r.options,a=s.container,l=s.events,c=s.checkWindowBlur;if(r._useDrag=l.indexOf("drag")>-1,r._useTouch=l.indexOf("touch")>-1,r._useMouse=l.indexOf("mouse")>-1,r.targets=o,r._useDrag&&o.forEach(function(t){ES(t,"dragstart",r.onDragStart)}),r._useMouse&&(o.forEach(function(t){ES(t,"mousedown",r.onDragStart),ES(t,"mousemove",r._passCallback)}),ES(a,"contextmenu",r._onContextMenu)),c&&ES(OS(),"blur",r.onBlur),r._useTouch){var u={passive:!1};o.forEach(function(t){ES(t,"touchstart",r.onDragStart,u),ES(t,"touchmove",r._passCallback,u)})}return r}return function(t,e){function n(){this.constructor=t}zD(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(t,e){return t+e.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,e,n,r){void 0===r&&(r=!0),this.flag&&(this.clientStores[0].move(t,e),r&&this.onDrag(n,!0))},e.prototype.move=function(t,e){var n=t[0],r=t[1],o=this.getCurrentStore().prevClients;return this.moveClients(o.map(function(t){var e=t.clientX,o=t.clientY;return{clientX:e+n,clientY:o+r,originalClientX:e,originalClientY:o}}),e,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var e=this.data;for(var n in t)e[n]=t[n];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return void 0===t&&(t=this._prevInputEvent),FD(FD({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,e=this.targets,n=this.options.container;this.off(),CS(this._window,"blur",this.onBlur),this._useDrag&&e.forEach(function(e){CS(e,"dragstart",t.onDragStart)}),this._useMouse&&(e.forEach(function(e){CS(e,"mousedown",t.onDragStart)}),CS(n,"contextmenu",this._onContextMenu)),this._useTouch&&(e.forEach(function(e){CS(e,"touchstart",t.onDragStart)}),CS(n,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var e=this,n=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>n)){var r=new WD(jD(t));this.pinchFlag=!0,this._addStore(r),!1===this.emit("pinchStart",FD(FD({data:this.data,datas:this.data,angle:r.getAngle(),touches:this.getCurrentStore().getPositions()},r.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){e._dragFlag=!1}}))&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,e){if(this.flag&&this.pinchFlag&&!(e.length<2)){var n=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",FD(FD({data:this.data,datas:this.data,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.getCurrentStore();this.emit("pinchEnd",FD(FD({data:this.data,datas:this.data,isPinch:e,touches:n.getPositions()},n.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,e,n){var r=this._getPosition(t,n),o=this.isDrag;(r.deltaX||r.deltaY)&&(this.isDrag=!0);var i=!1;return!o&&this.isDrag&&(i=!0),FD(FD({data:this.data,datas:this.data},r),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:e,isTrusted:this._isTrusted,isFirstDrag:i})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,e){var n=this.getCurrentStore().getPosition(t,e),r=this.clientStores.slice(1).reduce(function(t,e){var n=e.getPosition();return t.distX+=n.distX,t.distY+=n.distY,t},n),o=r.distX,i=r.distY;return FD(FD({},n),{distX:o,distY:i})},e.prototype._attchDragEvent=function(){var t=this._window,e=this.options.container,n={passive:!1};this._isDragAPI&&(ES(e,"dragover",this.onDrag,n),ES(t,"dragend",this.onDragEnd)),this._useMouse&&(ES(e,"mousemove",this.onDrag),ES(t,"mouseup",this.onDragEnd)),this._useTouch&&(ES(e,"touchmove",this.onDrag,n),ES(t,"touchend",this.onDragEnd,n),ES(t,"touchcancel",this.onDragEnd,n))},e.prototype._dettachDragEvent=function(){var t=this._window,e=this.options.container;this._isDragAPI&&(CS(e,"dragover",this.onDrag),CS(t,"dragend",this.onDragEnd)),this._useMouse&&(CS(e,"mousemove",this.onDrag),CS(t,"mouseup",this.onDragEnd)),this._useTouch&&(CS(e,"touchstart",this.onDragStart),CS(e,"touchmove",this.onDrag),CS(t,"touchend",this.onDragEnd),CS(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e}(xD);var YD=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function KD(t,e,n,r,o){var i=SS(r),s=i.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),s.setAttribute("data-styled-count","1"),n.nonce&&s.setAttribute("nonce",n.nonce),s.innerHTML=function(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/gm,function(e,n){var r=n.trim();return(r?eS(r):[""]).map(function(e){var n=e.trim();return 0===n.indexOf("@")?n:n.indexOf(":global")>-1?n.replace(/\:global/g,""):n.indexOf(":host")>-1?"".concat(n.replace(/\:host/g,".".concat(t))):n?".".concat(t," ").concat(n):".".concat(t)}).join(", ")+" {"})}(t,e,n),(o||i.head||i.body).appendChild(s),s}function XD(t){var e="rCS"+YD(t).toString(36);return{className:e,inject:function(n,r){void 0===r&&(r={});var o=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(n),i=(o||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(i){var s=parseFloat(i.getAttribute("data-styled-count"))||0;i.setAttribute("data-styled-count","".concat(s+1))}else i=KD(e,t,r,n,o);return{destroy:function(){var t,e=parseFloat(i.getAttribute("data-styled-count"))||0;e<=1?(i.remove?i.remove():null===(t=i.parentNode)||void 0===t||t.removeChild(i),i=null):i.setAttribute("data-styled-count","".concat(e-1))}}}}}var JD=function(){return JD=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},JD.apply(this,arguments)};function ZD(e,n){var r=XD(n),o=r.className;return t.forwardRef(function(n,i){var s=n.className,a=void 0===s?"":s;n.cspNonce;var l=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}(n,["className","cspNonce"]),c=t.useRef();return t.useImperativeHandle(i,function(){return c.current},[]),t.useEffect(function(){var t=r.inject(c.current,{nonce:n.cspNonce});return function(){t.destroy()}},[]),t.createElement(e,JD({ref:c,"data-styled-id":o,className:"".concat(a," ").concat(o)},l))})}var QD=function(t,e){return QD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},QD(t,e)};function tM(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}QD(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var eM=function(){return eM=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},eM.apply(this,arguments)};function nM(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function rM(t,e,n){if(2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}function oM(t,e){return eM({events:[],props:[],name:t},e)}var iM=["n","w","s","e"],sM=["n","w","s","e","nw","ne","sw","se"];var aM,lM,cM,uM=function(){if("undefined"==typeof navigator||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!(!e||!e.length)}()?function(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=e.mobile||!1,o=n[0],i=(e.platform||navigator.platform).toLowerCase(),s={name:o.brand,version:o.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!MC(RC,n).brand||PC(EC())},a={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&wC(TC,function(t){return OC(n,t)});var l=MC(AC,n);if(s.chromium=!!l.brand,s.chromiumVersion=l.version||"-1",!s.chromium){var c=MC(TC,n);s.webkit=!!c.brand,s.webkitVersion=c.version||"-1"}var u=kC(NC,function(t){return new RegExp(""+t.test,"g").exec(i)});a.name=u?u.id:"";var d=MC(_C,n);return s.name=d.brand||s.name,s.version=d.brand&&t?t.uaFullVersion:d.version,s.webkit&&(a.name=r?"ios":"mac"),"ios"===a.name&&s.webview&&(s.version="-1"),a.version=SC(a.version),s.version=SC(s.version),a.majorVersion=parseInt(a.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:a,isMobile:r,isHints:!0}}():function(t){var e=EC(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:PC(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},o={name:"unknown",version:"-1",majorVersion:-1},i=DC(_C,e),s=i.preset,a=i.version,l=DC(NC,e),c=l.preset,u=l.version,d=DC(AC,e);if(r.chromium=!!d.preset,r.chromiumVersion=d.version,!r.chromium){var p=DC(TC,e);r.webkit=!!p.preset,r.webkitVersion=p.version}return c&&(o.name=c.id,o.version=u,o.majorVersion=parseInt(u,10)),s&&(r.name=s.id,r.version=a,r.webview&&"ios"===o.name&&"safari"!==r.name&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:o,isMobile:n,isHints:!1}}(aM),dM=uM.browser.webkit,pM=dM&&(lM="undefined"==typeof window?{userAgent:""}:window.navigator,!!(cM=/applewebkit\/([^\s]+)/g.exec(lM.userAgent.toLowerCase()))&&parseFloat(cM[1])<605),fM=uM.browser.name,hM=parseInt(uM.browser.version,10),mM="chrome"===fM,gM=uM.browser.chromium,vM=parseInt(uM.browser.chromiumVersion,10)||0,yM=mM&&hM>=109||gM&&vM>=109,bM="firefox"===fM,xM=parseInt(uM.browser.webkitVersion,10)>=612||hM>=15,wM="moveable-",kM=sM.map(function(t){var e="",n="",r="center",o="center",i="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(i,";"),o="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",o="top"),t.indexOf("w")>-1&&(n="left: ".concat(i,";"),r="right"),t.indexOf("e")>-1&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(t,'"] {\n        ').concat(n).concat(e,"\n        transform-origin: ").concat(r," ").concat(o,";\n    }")}).join("\n"),EM="\n{\nposition: absolute;\nwidth: 1px;\nheight: 1px;\nleft: 0;\ntop: 0;\nz-index: 3000;\n--moveable-color: #4af;\n--zoom: 1;\n--zoompx: 1px;\n--moveable-line-padding: 0;\n--moveable-control-padding: 0;\nwill-change: transform;\noutline: 1px solid transparent;\n}\n.control-box {\nz-index: 0;\n}\n.line, .control {\nposition: absolute;\nleft: 0;\ntop: 0;\nwill-change: transform;\n}\n.control {\nwidth: 14px;\nheight: 14px;\nborder-radius: 50%;\nborder: 2px solid #fff;\nbox-sizing: border-box;\nbackground: #4af;\nbackground: var(--moveable-color);\nmargin-top: -7px;\nmargin-left: -7px;\nborder: 2px solid #fff;\nz-index: 10;\n}\n.around-control {\nposition: absolute;\nwill-change: transform;\nwidth: calc(var(--moveable-control-padding, 20) * 1px);\nheight: calc(var(--moveable-control-padding, 20) * 1px);\nleft: calc(var(--moveable-control-padding, 20) * -0.5px);\ntop: calc(var(--moveable-control-padding, 20) * -0.5px);\nbox-sizing: border-box;\nbackground: transparent;\nz-index: 8;\ncursor: alias;\ntransform-origin: center center;\n}\n".concat(kM,"\n.padding {\nposition: absolute;\ntop: 0px;\nleft: 0px;\nwidth: 100px;\nheight: 100px;\ntransform-origin: 0 0;\n}\n.line {\nwidth: 1px;\nheight: 1px;\nbackground: #4af;\nbackground: var(--moveable-color);\ntransform-origin: 0px 50%;\n}\n.line.edge {\nz-index: 1;\nbackground: transparent;\n}\n.line.dashed {\nbox-sizing: border-box;\nbackground: transparent;\n}\n.line.dashed.horizontal {\nborder-top: 1px dashed #4af;\nborder-top-color: #4af;\nborder-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\nborder-left: 1px dashed #4af;\nborder-left-color: #4af;\nborder-left-color: var(--moveable-color);\n}\n.line.vertical {\ntransform: translateX(-50%);\n}\n.line.horizontal {\ntransform: translateY(-50%);\n}\n.line.vertical.bold {\nwidth: 2px;\n}\n.line.horizontal.bold {\nheight: 2px;\n}\n\n.control.origin {\nborder-color: #f55;\nbackground: #fff;\nwidth: 12px;\nheight: 12px;\nmargin-top: -6px;\nmargin-left: -6px;\npointer-events: none;\n}\n").concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return'\n.direction[data-rotation="'.concat(t,'"], :global .view-control-rotation').concat(t," {\n").concat(function(t){var e=function(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}(1,t),n=45*Math.round(t/45)%180,r="ns-resize";return 135===n?r="nwse-resize":45===n?r="nesw-resize":90===n&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}(t),"\n}\n")}).join("\n"),'\n\n.line.direction:before {\ncontent: "";\nposition: absolute;\nwidth: 100%;\nheight: calc(var(--moveable-line-padding, 0) * 1px);\nbottom: 0;\nleft: 0;\n}\n.group {\nz-index: -1;\n}\n.area {\nposition: absolute;\n}\n.area-pieces {\nposition: absolute;\ntop: 0;\nleft: 0;\ndisplay: none;\n}\n.area.avoid, .area.pass {\npointer-events: none;\n}\n.area.avoid+.area-pieces {\ndisplay: block;\n}\n.area-piece {\nposition: absolute;\n}\n\n').concat(pM?':global svg *:before {\ncontent:"";\ntransform-origin: inherit;\n}':"","\n"),CM=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],SM=1e-4,DM=1e-7,MM=1e-9,OM=Math.pow(10,10),_M=-OM,AM={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},TM={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},RM={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},NM=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function PM(t,e,n,r,o,i){var s,a;void 0===i&&(i="draggable");var l=null!==(a=null===(s=e.gestos[i])||void 0===s?void 0:s.move(n,t.inputEvent))&&void 0!==a?a:{},c=l.originalDatas||l.datas,u=c[i]||(c[i]={});return eM(eM({},l),{isPinch:!!r,parentEvent:!0,datas:u,originalDatas:t.originalDatas})}var LM=function(){function t(t){var e;void 0===t&&(t="draggable"),this.ableName=t,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=((e={})[t]={},e)}return t.prototype.dragStart=function(t,e){this.isDrag=!1,this.isFlag=!1;var n=e.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),eM(eM({},this.move(t,e.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},t.prototype.move=function(t,e){var n,r,o=!1;if(this.isFlag){var i=this.isDrag;n=this.prevX+t[0],r=this.prevY+t[1],(t[0]||t[1])&&(this.isDrag=!0),!i&&this.isDrag&&(o=!0)}else this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],n=t[0],r=t[1],this.isFlag=!0;return this.prevX=n,this.prevY=r,{type:"drag",clientX:n,clientY:r,inputEvent:e,isFirstDrag:o,isDrag:this.isDrag,distX:n-this.startX,distY:r-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function IM(t,e,n,r){var o=16===t.length?4:3,i=nM(lA(t,n,r,o),4),s=nM(i[0],2),a=s[0],l=s[1],c=nM(i[1],2),u=c[0],d=c[1],p=nM(i[2],2),f=p[0],h=p[1],m=nM(i[3],2),g=m[0],v=m[1],y=nM(aA(t,e,o),2),b=y[0],x=y[1],w=Math.min(a,u,f,g),k=Math.min(l,d,h,v),E=Math.max(a,u,f,g);return a=a-w||0,{left:w,top:k,right:E,bottom:Math.max(l,d,h,v),origin:[b=b-w||0,x=x-k||0],pos1:[a,l=l-k||0],pos2:[u=u-w||0,d=d-k||0],pos3:[f=f-w||0,h=h-k||0],pos4:[g=g-w||0,v=v-k||0],direction:tT(t[0]*t[o+1])}}function zM(t,e){var n=e.clientX,r=e.clientY,o=e.datas,i=t.state,s=i.moveableClientRect,a=i.rootMatrix,l=i.is3d,c=i.pos1,u=nM($S(BA(a,[n-s.left,r-s.top],l?4:3),c),2),d=nM(VM({datas:o,distX:u[0],distY:u[1]}),2);return[d[0],d[1]]}function FM(t,e){var n=e.datas,r=t.state,o=r.allMatrix,i=r.beforeMatrix,s=r.is3d,a=r.left,l=r.top,c=r.origin,u=r.offsetMatrix,d=r.targetMatrix,p=r.transformOrigin,f=s?4:3;n.is3d=s,n.matrix=o,n.targetMatrix=d,n.beforeMatrix=i,n.offsetMatrix=u,n.transformOrigin=p,n.inverseMatrix=LS(o,f),n.inverseBeforeMatrix=LS(i,f),n.absoluteOrigin=zS(HS([a,l],c),f),n.startDragBeforeDist=WS(n.inverseBeforeMatrix,n.absoluteOrigin,f),n.startDragDist=WS(n.inverseMatrix,n.absoluteOrigin,f)}function BM(t,e,n){var r=e.datas,o=e.originalDatas.beforeRenderable,i=r.transformIndex,s=o.nextTransforms,a=s.length,l=o.nextTransformAppendedIndexes,c=-1;-1===i?("translate"===n?c=0:"rotate"===n&&(c=iS(s,function(t){return t.match(/scale\(/g)})),-1===c&&(c=s.length),r.transformIndex=c):c=sS(l,function(t){return t.index===i&&t.functionName===n})?i:i+l.filter(function(t){return t.index<i}).length;var u=function(t,e,n){var r,o=aD(t,{"x%":function(t){return t/100*e.offsetWidth},"y%":function(t){return t/100*e.offsetHeight}}),i=t.slice(0,n<0?void 0:n),s=t.slice(0,n<0?void 0:n+1),a=t[n]||"",l=n<0?[]:t.slice(n),c=n<0?[]:t.slice(n+1),u=o.slice(0,n<0?void 0:n),d=o.slice(0,n<0?void 0:n+1),p=null!==(r=o[n])&&void 0!==r?r:aD([""])[0],f=n<0?[]:o.slice(n),h=n<0?[]:o.slice(n+1),m=p?[p]:[],g=sD(u),v=sD(d),y=sD(f),b=sD(h),x=jS(g,y,4);return{transforms:t,beforeFunctionMatrix:g,beforeFunctionMatrix2:v,targetFunctionMatrix:sD(m),afterFunctionMatrix:y,afterFunctionMatrix2:b,allFunctionMatrix:x,beforeFunctions:u,beforeFunctions2:d,targetFunction:m[0],afterFunctions:f,afterFunctions2:h,beforeFunctionTexts:i,beforeFunctionTexts2:s,targetFunctionText:a,afterFunctionTexts:l,afterFunctionTexts2:c}}(s,t.state,c),d=u.targetFunction,p="rotate"===n?"rotateZ":n;r.beforeFunctionTexts=u.beforeFunctionTexts,r.afterFunctionTexts=u.afterFunctionTexts,r.beforeTransform=u.beforeFunctionMatrix,r.beforeTransform2=u.beforeFunctionMatrix2,r.targetTansform=u.targetFunctionMatrix,r.afterTransform=u.afterFunctionMatrix,r.afterTransform2=u.afterFunctionMatrix2,r.targetAllTransform=u.allFunctionMatrix,d.functionName===p?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):a>c&&(r.isAppendTransform=!0,o.nextTransformAppendedIndexes=rM(rM([],nM(l),!1),[{functionName:n,index:c,isAppend:!0}],!1))}function jM(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function HM(t){var e=t.datas,n=nM(qM({datas:e,distX:t.distX,distY:t.distY}),2),r=$M(e,function(t,e){for(var n=tD(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}([n[0],n[1]],4));return WS(r,zS([0,0,0],4),4)}function $M(t,e,n){var r=t.beforeTransform,o=t.afterTransform,i=t.beforeTransform2,s=t.afterTransform2,a=t.targetAllTransform,l=n?jS(a,e,4):jS(e,a,4),c=jS(LS(n?i:r,4),l,4);return jS(c,LS(n?s:o,4),4)}function qM(t){var e=t.datas,n=t.distX,r=t.distY,o=e.inverseBeforeMatrix,i=e.is3d,s=e.startDragBeforeDist,a=i?4:3;return $S(WS(o,HS(e.absoluteOrigin,[n,r]),a),s)}function VM(t,e){var n=t.datas,r=t.distX,o=t.distY,i=n.inverseBeforeMatrix,s=n.inverseMatrix,a=n.is3d,l=n.startDragBeforeDist,c=n.startDragDist,u=a?4:3;return $S(WS(e?i:s,HS(n.absoluteOrigin,[r,o]),u),e?l:c)}function WM(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function GM(t,e){var n=(e[0]+1)/2,r=(e[1]+1)/2,o=[VC(t[0][0],t[1][0],n,1-n),VC(t[0][1],t[1][1],n,1-n)],i=[VC(t[2][0],t[3][0],n,1-n),VC(t[2][1],t[3][1],n,1-n)];return[VC(o[0],i[0],r,1-r),VC(o[1],i[1],r,1-r)]}function UM(t,e,n,r){return jS(t,K_(e,r,n),r)}function YM(t,e){var n=ZM(e);return{setTransform:function(r,o){void 0===o&&(o=-1),n.startTransforms=UC(r)?r:tS(r),XM(t,e,o)},setTransformIndex:function(n){XM(t,e,n)}}}function KM(t,e,n){XM(t,e,iS(ZM(e).startTransforms,function(t){return 0===t.indexOf("".concat(n,"("))}))}function XM(t,e,n){var r=ZM(e),o=e.datas;if(o.transformIndex=n,-1!==n){var i=r.startTransforms[n];if(i){var s=t.state,a=aD([i],{"x%":function(t){return t/100*s.offsetWidth},"y%":function(t){return t/100*s.offsetHeight}});o.startValue=a[0].functionValue}}}function JM(t,e){ZM(t).nextTransforms=tS(e)}function ZM(t){return t.originalDatas.beforeRenderable}function QM(t){return t.originalDatas.beforeRenderable.nextTransforms}function tO(t){return(QM(t)||[]).join(" ")}function eO(t){return ZM(t).nextStyle}function nO(t,e,n,r,o){JM(o,e);var i=u_.drag(t,PM(o,t.state,n,r)),s=i?i.transform:e;return eM(eM({transform:e,drag:i},MA({transform:s},o)),{afterTransform:s})}function rO(t,e,n,r,o,i){var s=function(t,e,n,r){var o,i=t.transformOrigin,s=t.offsetMatrix,a=t.is3d?4:3;if(YC(n)){var l=e.beforeTransform,c=e.afterTransform;o=FS(r?iD(n):jS(jS(l,iD([n]),4),c,4),4,a)}else o=n;return UM(s,o,i,a)}(t.state,o,e,i),a=function(t,e,n,r){void 0===r&&(r=t.state.allMatrix);var o=t.state,i=o.width,s=o.height,a=o.is3d,l=a?4:3,c=[i/2*(1+e[0])+n[0],s/2*(1+e[1])+n[1]];return aA(r,c,l)}(t,n,r,s);return a}function oO(t,e,n,r,o,i,s){var a=rO(t,e,n,o,i,s),l=t.state,c=l.left,u=l.top,d=t.props.groupable,p=d?c:0,f=d?u:0,h=$S(r,a);return $S(h,[p,f])}function iO(t,e,n,r,o,i){var s=t.props.groupable,a=t.state,l=a.transformOrigin,c=a.offsetMatrix,u=a.is3d,d=a.width,p=a.height,f=a.left,h=a.top,m=i.fixedDirection,g=i.nextTargetMatrix||a.targetMatrix,v=u?4:3,y=function(t,e,n,r,o,i){return void 0===r&&(r=e),void 0===o&&(o=n),void 0===i&&(i=[0,0]),t?t.map(function(t,s){var a=rS(t),l=a.value,c=a.unit,u=s?o:r,d=s?n:e;return"%"===t||isNaN(l)?d*(u?i[s]/u:0):"%"!==c?l:d*l/100}):i}(o,e,n,d,p,l),b=s?f:0,x=s?h:0,w=function(t,e,n,r,o,i){var s=GM(lA(e,n,r,o),i);return[t[0]-s[0],t[1]-s[1]]}(r,UM(c,g,y,v),e,n,v,m);return $S(w,[b,x])}function sO(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}function aO(t){var e=t("scale"),n=t("rotate"),r=t("translate"),o=[];return r&&"0px"!==r&&"none"!==r&&o.push("translate(".concat(r.split(/\s+/).join(","),")")),n&&"1"!==n&&"none"!==n&&o.push("rotate(".concat(n,")")),e&&"1"!==e&&"none"!==e&&o.push("scale(".concat(e.split(/\s+/).join(","),")")),o}function lO(t,e,n){for(var r,o,i,s=t,a=[],l=DS(t)||MS(t),c=!n&&t===e||t===l,u=c,d=!1,p=3,f=!1,h=Q_(e,e,!0).offsetParent,m=1;s&&!u;){u=c;var g=fO(s),v=g("position"),y=Z_(s),b="fixed"===v,x=aO(g),w=qS(Y_(y)),k=void 0,E=!1,C=!1,S=0,D=0,M=0,O=0,_={hasTransform:!1,fixedContainer:null};b&&(f=!0,h=(_=rA(s)).fixedContainer);var A=w.length;d||16!==A&&!x.length||(d=!0,p=4,nA(a),i&&(i=FS(i,3,4))),d&&9===A&&(w=FS(w,3,4));var T=tA(s,t),R=T.tagName,N=T.hasOffset,P=T.isSVG,L=T.origin,I=T.targetOrigin,z=nM(T.offset,2),F=z[0],B=z[1];"svg"===R&&i&&(a.push({type:"target",target:s,matrix:sA(s,p)}),a.push({type:"offset",target:s,matrix:tD(p)}));var j=parseFloat(g("zoom"))||1;if(b)k=_.fixedContainer,E=!0;else{var H=Q_(s,e,!1,!0,g),$=H.offsetZoom;if(k=H.offsetParent,E=H.isEnd,C=H.isStatic,m*=$,(H.isCustomElement||1!==$)&&C)F-=k.offsetLeft,B-=k.offsetTop;else if(bM||yM){if(H.parentSlotElement){for(var q=k,V=0,W=0;q&&sO(q);)V+=q.offsetLeft,W+=q.offsetTop,q=q.offsetParent;F-=V,B-=W}}}if(!dM||xM||!N||P||!C||"relative"!==v&&"static"!==v||(F-=k.offsetLeft,B-=k.offsetTop,c=c||E),b)N&&_.hasTransform&&(M=k.clientLeft,O=k.clientTop);else if(N&&h!==k&&(S=k.clientLeft,D=k.clientTop),N&&k===l){var G=eA(s,!1);F+=G[0],B+=G[1]}if(a.push({type:"target",target:s,matrix:K_(w,p,L)}),x.length&&(a.push({type:"offset",target:s,matrix:tD(p)}),a.push({type:"target",target:s,matrix:K_(iD(x),p,L)})),N){var U=s===t,Y=U?0:s.scrollLeft,K=U?0:s.scrollTop;a.push({type:"offset",target:s,matrix:nD([F-Y+S-M,B-K+D-O],p)})}else a.push({type:"offset",target:s,origin:L});if(1!==j&&a.push({type:"zoom",target:s,matrix:K_(eD([j,j],p),p,[0,0])}),i||(i=w),r||(r=L),o||(o=I),u||b)break;s=k,c=E,n&&s!==l||(u=c)}return i||(i=tD(p)),r||(r=[0,0]),o||(o=[0,0]),{zoom:m,offsetContainer:h,matrixes:a,targetMatrix:i,transformOrigin:r,targetOrigin:o,is3d:d,hasFixed:f}}var cO=null,uO=null,dO=null;function pO(t){t?(window.Map&&(cO=new Map,uO=new Map),dO=[]):(cO=null,dO=null,uO=null)}function fO(t){var e=null==cO?void 0:cO.get(t);if(!e){var n=OS(t).getComputedStyle(t);if(!cO)return function(t){return n[t]};e={style:n,cached:{}},cO.set(t,e)}var r=e.cached,o=e.style;return function(t){return t in r||(r[t]=o[t]),r[t]}}function hO(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var o=r.groupable;o.childDatas=o.childDatas||[];var i=o.childDatas;return t.moveables.map(function(t,r){return i[r]=i[r]||{},i[r][e]=i[r][e]||{},eM(eM({},n),{isRequestChild:!0,datas:i[r][e],originalDatas:i[r]})})}function mO(t,e,n,r,o,i,s){var a=!!n.match(/Start$/g),l=!!n.match(/End$/g),c=o.isPinch,u=o.datas,d=hO(t,e.name,o),p=t.moveables,f=d.map(function(t,o){var i=p[o],d=i.state,f=d.gestos,h=t;if(a)h=new LM(s).dragStart(r,t);else{if(f[s]||(f[s]=u.childGestos[o]),!f[s])return;h=PM(t,d,r,c,0,s)}var m=e[n](i,eM(eM({},h),{parentFlag:!0}));return l&&(f[s]=null),m});return a&&(u.childGestos=p.map(function(t){return t.state.gestos[s]})),f}function gO(t,e,n,r,o,i){void 0===o&&(o=function(t,e){return e});var s=!!n.match(/End$/g),a=hO(t,e.name,r),l=t.moveables,c=a.map(function(t,r){var i,a=l[r];i=o(a,t);var c=e[n](a,eM(eM({},i),{parentFlag:!0}));return s&&(a.state.gestos={}),c});return c}function vO(t,e,n,r){var o=n.fixedDirection,i=n.fixedPosition,s=GM(r.datas.startPositions||CA(e.state),o),a=nM(WS(QS(-t.rotation/180*Math.PI,3),[s[0]-i[0],s[1]-i[1],1],3),2),l=a[0],c=a[1];return r.datas.originalX=l,r.datas.originalY=c,r}function yO(t,e,n,r){var o=t.getState(),i=o.renderPoses,s=o.rotation,a=o.direction,l=mA(t.props,e).zoom,c=I_(s/Math.PI*180),u={},d=t.renderState;d.renderDirectionMap||(d.renderDirectionMap={});var p=d.renderDirectionMap;n.forEach(function(t){var e=t.dir;u[e]=!0});var f=tT(a);return n.map(function(t){var n=t.data,o=t.classNames,a=t.dir,d=TM[a];if(!d||!u[a])return null;p[a]=!0;var h=(yS(c,15)+f*RM[a]+720)%180,m={};return cS(n).forEach(function(t){m["data-".concat(t)]=n[t]}),r.createElement("div",eM({className:G_.apply(void 0,rM(["control","direction",a,e],nM(o),!1)),"data-rotation":h,"data-direction":a},m,{key:"direction-".concat(a),style:hA.apply(void 0,rM([s,l],nM(d.map(function(t){return i[t]})),!1))}))})}function bO(t,e,n,r){var o=mA(t.props,n),i=o.renderDirections,s=void 0===i?e:i,a=o.displayAroundControls;if(!s)return[];var l=!0===s?sM:s;return rM(rM([],nM(a?CO(t,r,n,l):[]),!1),nM(yO(t,n,l.map(function(t){return{data:{},classNames:[],dir:t}}),r)),!1)}function xO(t,e,n,r,o,i){for(var s=[],a=6;a<arguments.length;a++)s[a-6]=arguments[a];var l=mS(n,r),c=e?yS(l/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(i),className:G_.apply(void 0,rM(["line","direction",e?"edge":"",e],nM(s),!1)),"data-rotation":c,"data-line-key":i,"data-direction":e,style:fA(n,r,o,l)})}function wO(t,e,n,r,o){return(!0===n?iM:n).map(function(n,i){var s=nM(TM[n],2),a=s[0],l=s[1];if(null!=l)return xO(t,n,r[a],r[l],o,"".concat(e,"Edge").concat(i),e)}).filter(Boolean)}function kO(t){return function(e,n){var r=mA(e.props,t).edge;return r&&(!0===r||r.length)?rM(rM([],nM(wO(n,t,r,e.getState().renderPoses,e.props.zoom)),!1),nM(function(t,e,n){return bO(t,["nw","ne","sw","se"],e,n)}(e,t,n)),!1):EO(e,t,n)}}function EO(t,e,n){return bO(t,sM,e,n)}function CO(t,e,n,r){var o=t.renderState;o.renderDirectionMap||(o.renderDirectionMap={});var i=t.getState(),s=i.renderPoses,a=i.rotation,l=i.direction,c=o.renderDirectionMap,u=t.props.zoom,d=tT(l),p=a/Math.PI*180;return(r||cS(c)).map(function(t){var r=TM[t];if(!r)return null;var o=(yS(p,15)+d*RM[t]+720)%180,i=["around-control"];return n&&i.push("direction",n),e.createElement("div",{className:G_.apply(void 0,rM([],nM(i),!1)),"data-rotation":o,"data-direction":t,key:"direction-around-".concat(t),style:hA.apply(void 0,rM([a,u],nM(r.map(function(t){return s[t]})),!1))})})}function SO(t,e,n){var r=t||{},o=r.position,i=void 0===o?"client":o,s=r.left,a=void 0===s?-1/0:s,l=r.top,c=void 0===l?-1/0:l,u=r.right,d=void 0===u?1/0:u,p=r.bottom,f={position:i,left:a,top:c,right:d,bottom:void 0===p?1/0:p};return{vertical:MO(f,e,!0),horizontal:MO(f,n,!1)}}function DO(t,e){var n=t.state,r=n.containerClientRect,o=r.clientHeight,i=r.clientWidth,s=r.clientLeft,a=r.clientTop,l=n.snapOffset,c=l.left,u=l.top,d=l.right,p=l.bottom,f=e||t.props.bounds||{},h="css"===(f.position||"client"),m=f.left,g=void 0===m?-1/0:m,v=f.top,y=void 0===v?-1/0:v,b=f.right,x=void 0===b?h?-1/0:1/0:b,w=f.bottom,k=void 0===w?h?-1/0:1/0:w;return h&&(x=i+d-c-x,k=o+p-u-k),{left:g+c-s,right:x+c-s,top:y+u-a,bottom:k+u-a}}function MO(t,e,n){var r=t[n?"left":"top"],o=t[n?"right":"bottom"],i=Math.min.apply(Math,rM([],nM(e),!1)),s=Math.max.apply(Math,rM([],nM(e),!1)),a=[];return r+1>i&&a.push({direction:"start",isBound:!0,offset:i-r,pos:r}),o-1<s&&a.push({direction:"end",isBound:!0,offset:s-o,pos:o}),a.length||a.push({isBound:!1,offset:0,pos:0}),a.sort(function(t,e){return eT(e.offset)-eT(t.offset)})}function OO(t,e,n){return(n?t.map(function(t){return XS(t,n)}):t).some(function(t){return t[0]<e.left&&eT(t[0]-e.left)>.1||t[0]>e.right&&eT(t[0]-e.right)>.1||t[1]<e.top&&eT(t[1]-e.top)>.1||t[1]>e.bottom&&eT(t[1]-e.bottom)>.1})}function _O(t,e,n,r,o){if(!t.props.bounds)return[];var i=o*Math.PI/180,s=DO(t),a=s.left,l=s.top,c=s.right,u=s.bottom,d=a-r[0],p=c-r[0],f=l-r[1],h=u-r[1],m={left:d,top:f,right:p,bottom:h};if(!OO(n,m,0))return[];var g=[];return[[d,0],[p,0],[f,1],[h,1]].forEach(function(t){var r=nM(t,2),o=r[0],s=r[1];n.forEach(function(t){var n=mS([0,0],t);g.push.apply(g,rM([],nM(function(t,e,n){var r=dA(t),o=Math.sqrt(r*r-e*e)||0;return[o,-o].sort(function(e,r){return eT(e-t[n?0:1])-eT(r-t[n?0:1])}).map(function(t){return mS([0,0],n?[t,e]:[e,t])})}(t,o,s).map(function(t){return i+t-n}).filter(function(t){return!OO(e,m,t)}).map(function(t){return yS(180*t/Math.PI,DM)})),!1))})}),g}var AO=["left","right","center"],TO=["top","bottom","middle"],RO={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},NO={start:"left",end:"right",center:"center"},PO={start:"top",end:"bottom",center:"middle"};function LO(t,e){var n=t.props,r=n.snappable,o=n.bounds,i=n.innerBounds,s=n.verticalGuidelines,a=n.horizontalGuidelines,l=n.snapGridWidth,c=n.snapGridHeight,u=t.state,d=u.guidelines,p=u.enableSnap;return!(!r||!p||e&&!0!==r&&r.indexOf(e)<0)&&!!(l||c||o||i||d&&d.length||s&&s.length||a&&a.length)}function IO(t){return!1===t?{}:!0!==t&&t?t:{left:!0,right:!0,top:!0,bottom:!0}}function zO(t,e){var n=function(t,e){var n=IO(t),r={};for(var o in n)o in e&&n[o]&&(r[o]=e[o]);return r}(t,e),r=TO.filter(function(t){return t in n}),o=AO.filter(function(t){return t in n});return{horizontalNames:r,verticalNames:o,horizontal:r.map(function(t){return n[t]}),vertical:o.map(function(t){return n[t]})}}function FO(t,e,n,r,o,i){void 0===r&&(r=[]),void 0===o&&(o=[]);var s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var o=t[r];if(!WC(o))return o}return t[n]}(i,t.props.snapThreshold,5);return BO(t.state.guidelines,e,n,r,o,s)}function BO(t,e,n,r,o,i){return{vertical:qO(t,"vertical",e,i,r),horizontal:qO(t,"horizontal",n,i,o)}}function jO(t){var e="";return-1===t||"top"===t||"left"===t?e="start":0===t||"center"===t||"middle"===t?e="center":1!==t&&"right"!==t&&"bottom"!==t||(e="end"),e}function HO(t,e,n){var r=zO(t.props.snapDirections,e),o=FO(t,r.vertical,r.horizontal,r.verticalNames.map(function(t){return jO(t)}),r.horizontalNames.map(function(t){return jO(t)}),n),i=jO(r.horizontalNames[o.horizontal.index]),s=jO(r.verticalNames[o.vertical.index]);return{vertical:eM(eM({},o.vertical),{direction:s}),horizontal:eM(eM({},o.horizontal),{direction:i})}}function $O(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],o=r.offset,i=r.dist,s=r.guideline;return{isSnap:e,offset:o,dist:i,pos:n.pos,guideline:s}}function qO(t,e,n,r,o){var i,s;if(void 0===o&&(o=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var a="vertical"===e?0:1,l=n.map(function(n,i){var s=o[i]||"",l=t.map(function(t){var e=t.pos,r=n-e[a];return{offset:r,dist:eT(r),guideline:t,direction:s}}).filter(function(t){var n=t.guideline,o=t.dist;return!(n.type!==e||o>r)}).sort(function(t,e){return t.dist-e.dist});return{pos:n,index:i,guidelineInfos:l,direction:s}}).filter(function(t){return t.guidelineInfos.length>0}).sort(function(t,e){return t.guidelineInfos[0].dist-e.guidelineInfos[0].dist}),c=l.length>0;return{isSnap:c,index:c?l[0].index:-1,direction:null!==(s=null===(i=l[0])||void 0===i?void 0:i.direction)&&void 0!==s?s:"",posInfos:l}}function VO(t,e,n,r){void 0===r&&(r=1);var o=[];n[0]&&n[1]?o=[n,[-n[0],n[1]],[n[0],-n[1]]]:n[0]||n[1]?t.props.keepRatio?o.push([-1,-1],[-1,1],[1,-1],[1,1],n):(o.push.apply(o,rM([],nM(function(t,e){return WM(e).map(function(e){return t[e]})}([[-1,-1],[1,-1],[-1,-1],[1,1]],n)),!1)),o.length>1&&o.push([(o[0][0]+o[1][0])/2,(o[0][1]+o[1][1])/2])):[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(t,e,n){var r=n[e+1]||n[0];o.push(t),o.push([(t[0]+r[0])/2,(t[1]+r[1])/2])});var i=o.map(function(t){return GM(e,t)}),s=FO(t,i.map(function(t){return t[0]}),i.map(function(t){return t[1]}),o.map(function(t){return jO(t[0])}),o.map(function(t){return jO(t[1])}),r),a=jO(o.map(function(t){return t[0]})[s.vertical.index]),l=jO(o.map(function(t){return t[1]})[s.horizontal.index]);return{vertical:eM(eM({},s.vertical),{direction:a}),horizontal:eM(eM({},s.horizontal),{direction:l})}}function WO(t,e){var n=eT(t.offset),r=eT(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<DM?1:r<DM?-1:n-r}function GO(t,e){return t.slice().sort(function(t,n){var r=t.sign[e],o=n.sign[e],i=t.offset[e],s=n.offset[e];return r?o?WO({isBound:t.isBound,isSnap:t.isSnap,offset:i},{isBound:n.isBound,isSnap:n.isSnap,offset:s}):-1:1})[0]}function UO(t,e){var n=hS([e[0][0],e[1][0]]),r=hS([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function YO(t,e){var n,r,o=nM(e,2),i=o[0],s=o[1],a=s[0]-i[0],l=s[1]-i[1];if(eT(a)<DM&&(a=0),eT(l)<DM&&(l=0),a)if(l){n=l/a*(t[0]-i[0])+i[1],r=t[1]}else n=i[1],r=t[1];else n=i[0],r=t[0];return n-r}function KO(t,e,n,r){return void 0===r&&(r=DM),t.every(function(t){var o=YO(t,e);return o<=0===n||eT(o)<=r})}function XO(t,e,n,r,o){return void 0===o&&(o=0),r&&e-o<=t||!r&&t<=n+o?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function JO(t,e,n,r,o,i){var s,a,l=nM(e,2),c=l[0],u=l[1],d=t[0],p=n[0],f=n[1],h=$A(f[1]-p[1]),m=u,g=c,v=-c/u;return $A(f[0]-p[0])?h||i&&!m?{isBound:!1,offset:0}:g?XO((p[1]-d[1])/v+d[0],p[0],f[0],r,o):{isBound:a=eT(s=p[1]-d[1])<=(o||0),offset:a?s:0}:i&&!g?{isBound:!1,offset:0}:m?XO(v*(p[0]-d[0])+d[1],p[1],f[1],r,o):{isBound:a=eT(s=p[0]-d[0])<=(o||0),offset:a?s:0}}function ZO(t,e,n){return e.map(function(e){var r=function(t,e){var n=e.line,r=e.centerSign,o=e.verticalSign,i=e.horizontalSign,s=e.lineConstants,a=t.props.innerBounds;if(!a)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=a.left,c=a.top,u=a.width,d=a.height,p=[[l,c],[l,c+d]],f=[[l,c],[l+u,c]],h=[[l+u,c],[l+u,c+d]],m=[[l,c+d],[l+u,c+d]];if(KO([[l,c],[l+u,c],[l,c+d],[l+u,c+d]],n,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=JO(n,s,f,o),v=JO(n,s,m,o),y=JO(n,s,p,i),b=JO(n,s,h,i),x=g.isBound&&v.isBound,w=g.isBound||v.isBound,k=y.isBound&&b.isBound,E=y.isBound||b.isBound,C=FA(g.offset,v.offset),S=FA(y.offset,b.offset),D=[0,0],M=!1,O=!1;return eT(S)<eT(C)?(D=[C,0],M=w,O=x):(D=[0,S],M=E,O=k),{isAllBound:O,isVerticalBound:w,isHorizontalBound:E,isBound:M,offset:D}}(t,e),o=r.isBound,i=r.offset,s=r.isVerticalBound,a=r.isHorizontalBound,l=e.multiple,c=VM({datas:n,distX:i[0],distY:i[1]}).map(function(t,e){return t*(l[e]?2/l[e]:0)});return{sign:l,isBound:o,isVerticalBound:s,isHorizontalBound:a,isSnap:!1,offset:c}})}function QO(t,e,n){var r,o=ZO(t,t_(t,e,[0,0],!1).map(function(t){return eM(eM({},t),{multiple:t.multiple.map(function(t){return 2*eT(t)})})}),n),i=GO(o,0),s=GO(o,1),a=0,l=0,c=i.isVerticalBound||s.isVerticalBound,u=i.isHorizontalBound||s.isHorizontalBound;return(c||u)&&(r=nM(function(t){var e=t.datas,n=t.distX,r=t.distY;e.beforeMatrix;var o=e.matrix,i=e.is3d;e.startDragBeforeDist;var s=e.startDragDist,a=e.absoluteOrigin,l=i?4:3;return $S(WS(o,HS(s,[n,r]),l),a)}({datas:n,distX:-i.offset[0],distY:-s.offset[1]}),2),a=r[0],l=r[1]),{vertical:{isBound:c,offset:a},horizontal:{isBound:u,offset:l}}}function t_(t,e,n,r){var o=t.state,i=lA(o.allMatrix,100,100,o.is3d?4:3),s=GM(i,[0,0]);return function(t,e){var n=[],r=t[0],o=t[1];return r&&o?n.push([[0,2*o],t,[-r,o]],[[2*r,0],t,[r,-o]]):r?(n.push([[2*r,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):o?(n.push([[0,2*o],[1,o],[-1,o]]),e&&n.push([[-1,0],[-1,o],[-1,-o]],[[1,0],[1,o],[1,-o]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}(n,r).map(function(t){var n=nM(t,3),r=n[0],o=n[1],a=n[2],l=[GM(i,o),GM(i,a)],c=function(t){var e=nM(t,2),n=e[0],r=e[1],o=r[0]-n[0],i=r[1]-n[1];Math.abs(o)<$C&&(o=0),Math.abs(i)<$C&&(i=0);var s=0,a=0,l=0;return o?i?(a=1,l=(s=-i/o)*n[0]-n[1]):(a=1,l=-n[1]):(s=-1,l=n[0]),[s,a,l].map(function(t){return yS(t,$C)})}(l),u=UO(s,l),d=u.vertical,p=u.horizontal;return{multiple:r,centerSign:YO(s,l)<=0,verticalSign:d,horizontalSign:p,lineConstants:c,line:[GM(e,o),GM(e,a)]}})}function e_(t,e,n,r){var o=r?t.map(function(t){return XS(t,r)}):t;return[[o[0],o[1]],[o[1],o[3]],[o[3],o[2]],[o[2],o[0]]].some(function(t){var r=YO(n,t)<=0;return!KO(e,t,r)})}function n_(t,e,n,r,o){var i=t.props.innerBounds,s=o*Math.PI/180;if(!i)return[];var a=i.left,l=i.top,c=i.width,u=i.height,d=a-r[0],p=a+c-r[0],f=l-r[1],h=l+u-r[1],m=[[d,f],[p,f],[d,h],[p,h]],g=GM(n,[0,0]);if(!e_(n,m,g,0))return[];var v=[],y=m.map(function(t){return[dA(t),mS([0,0],t)]});return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(function(t){var n=mS([0,0],function(t){var e=nM(t,2),n=e[0],r=e[1],o=r[0]-n[0],i=r[1]-n[1];if(!o)return[n[0],0];if(!i)return[0,n[1]];var s=i/o,a=-s*n[0]+n[1];return[-a/(s+1/s),a/(s*s+1)]}(t)),r=function(t){var e=nM(t,2),n=e[0],r=e[1],o=r[0]-n[0],i=r[1]-n[1];if(!o)return eT(n[0]);if(!i)return eT(n[1]);var s=i/o;return eT((-s*n[0]+n[1])/Math.sqrt(Math.pow(s,2)+1))}(t);v.push.apply(v,rM([],nM(y.filter(function(t){var e=nM(t,1)[0];return e&&r<=e}).map(function(t){var e=nM(t,2),o=e[0],i=e[1],a=Math.acos(o?r/o:0);return[s+(i+a)-n,s+(i-a)-n]}).reduce(function(t,e){return t.push.apply(t,rM([],nM(e),!1)),t},[]).filter(function(t){return!e_(e,m,g,t)}).map(function(t){return yS(180*t/Math.PI,DM)})),!1))}),v}function r_(t,e,n,r,o){var i=function(t,e,n,r){var o=e[0]-t[0],i=e[1]-t[1];if(eT(o)<$C&&(o=0),eT(i)<$C&&(i=0),!o)return r?[0,0]:[0,n];if(!i)return r?[n,0]:[0,0];var s=i/o,a=t[1]-s*t[0];return r?[n,s*(e[0]+n)+a-e[1]]:[(e[1]+n-a)/s-e[0],n]}(t,e,n,r);if(!i)return{isOutside:!1,offset:[0,0]};var s=vS(t,e),a=vS(i,t),l=vS(i,e),c=a>s||l>s,u=nM(VM({datas:o,distX:i[0],distY:i[1]}),2);return{offset:[u[0],u[1]],isOutside:c}}function o_(t,e){return t.isBound?t.offset:e.isSnap?$O(e).offset:0}function i_(t,e,n,r,o,i){if(!LO(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=EA(i.absolutePoses,[e,n]),a=cA(s),l=a.left,c=a.right,u=a.top,d=a.bottom,p={horizontal:s.map(function(t){return t[1]}),vertical:s.map(function(t){return t[0]})},f=s_(t,o,zO(IO(t.props.snapDirections),{left:l,right:c,top:u,bottom:d,center:(l+c)/2,middle:(u+d)/2}),p),h=f.vertical,m=f.horizontal,g=QO(t,s,i),v=g.vertical,y=g.horizontal,b=h.isSnap,x=m.isSnap,w=h.isBound||v.isBound,k=m.isBound||y.isBound,E=nM(function(t,e,n,r,o){var i=nM(e,2),s=i[0],a=i[1],l=nM(n,2),c=l[0],u=l[1],d=nM(r,2),p=d[0],f=d[1],h=nM(o,2),m=h[0],g=h[1],v=-m,y=-g;if(t&&s&&a){v=0,y=0;var b=[];if(c&&u?b.push([0,g],[m,0]):c?b.push([m,0]):u?b.push([0,g]):p&&f?b.push([0,g],[m,0]):p?b.push([m,0]):f&&b.push([0,g]),b.length){b.sort(function(t,e){return dA($S([s,a],t))-dA($S([s,a],e))});var x=b[0];if(x[0]&&eT(s)>$C)v=-x[0],y=a*eT(s+v)/eT(s)-a;else if(x[1]&&eT(a)>$C){var w=a;y=-x[1],v=s*eT(a+y)/eT(w)-s}if(t&&u&&c)if(eT(v)>$C&&eT(v)<eT(m))v*=k=eT(m)/eT(v),y*=k;else if(eT(y)>$C&&eT(y)<eT(g)){var k;v*=k=eT(g)/eT(y),y*=k}else v=FA(-m,v),y=FA(-g,y)}}else v=s||c?-m:0,y=a||u?-g:0;return[v,y]}(r,[e,n],[w,k],[b,x],[FA(h.offset,v.offset),FA(m.offset,y.offset)]),2);return[{isBound:w,isSnap:b,offset:E[0]},{isBound:k,isSnap:x,offset:E[1]}]}function s_(t,e,n,r){void 0===r&&(r=n);var o=SO(DO(t),r.vertical,r.horizontal),i=o.horizontal,s=o.vertical,a=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:FO(t,n.vertical,n.horizontal),l=a.horizontal,c=a.vertical,u=o_(i[0],l),d=o_(s[0],c),p=eT(u),f=eT(d);return{horizontal:{isBound:i[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:u,dist:p,bounds:i,snap:l},vertical:{isBound:s[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:f,bounds:s,snap:c}}}function a_(t,e,n,r,o){var i=SO(e,n,r),s=i.horizontal,a=i.vertical,l=BO(t,n,r,[],[],o),c=l.horizontal,u=l.vertical,d=o_(s[0],c),p=o_(a[0],u),f=eT(d),h=eT(p);return{horizontal:{isBound:s[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:f,bounds:s,snap:c},vertical:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:p,dist:h,bounds:a,snap:u}}}function l_(t,e,n,r,o,i){return n.map(function(n){var s=nM(n,2),a=s[0],l=s[1],c=GM(e,a),u=GM(e,l),d=r?function(t,e,n,r){var o=function(t,e,n){var r=DO(t),o=r.left,i=r.top,s=r.right,a=r.bottom,l=nM(n,2),c=l[0],u=l[1],d=nM($S(n,e),2),p=d[0],f=d[1];eT(p)<DM&&(p=0),eT(f)<DM&&(f=0);var h=f>0,m=p>0,g={isBound:!1,offset:0,pos:0},v={isBound:!1,offset:0,pos:0};if(0===p&&0===f)return{vertical:g,horizontal:v};if(0===p)h?a<u&&(v.pos=a,v.offset=u-a):i>u&&(v.pos=i,v.offset=u-i);else if(0===f)m?s<c&&(g.pos=s,g.offset=c-s):o>c&&(g.pos=o,g.offset=c-o);else{var y=f/p,b=n[1]-y*c,x=0,w=0,k=!1;m&&s<=c?(x=y*s+b,w=s,k=!0):!m&&c<=o&&(x=y*o+b,w=o,k=!0),k&&(x<i||x>a)&&(k=!1),k||(h&&a<=u?(w=((x=a)-b)/y,k=!0):!h&&u<=i&&(w=((x=i)-b)/y,k=!0)),k&&(g.isBound=!0,g.pos=w,g.offset=c-w,v.isBound=!0,v.pos=x,v.offset=u-x)}return{vertical:g,horizontal:v}}(t,e,n),i=o.horizontal,s=o.vertical,a=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:function(t,e,n){var r=nM(n,2),o=r[0],i=r[1],s=nM(e,2),a=s[0],l=s[1],c=nM($S(n,e),2),u=c[0],d=c[1],p=d>0,f=u>0;u=$A(u),d=$A(d);var h={isSnap:!1,offset:0,pos:0},m={isSnap:!1,offset:0,pos:0};if(0===u&&0===d)return{vertical:h,horizontal:m};var g=FO(t,u?[o]:[],d?[i]:[]),v=g.vertical,y=g.horizontal;v.posInfos.filter(function(t){var e=t.pos;return f?e>=a:e<=a}),y.posInfos.filter(function(t){var e=t.pos;return p?e>=l:e<=l}),v.isSnap=v.posInfos.length>0,y.isSnap=y.posInfos.length>0;var b=$O(v),x=b.isSnap,w=b.guideline,k=$O(y),E=k.isSnap,C=k.guideline,S=E?C.pos[1]:0,D=x?w.pos[0]:0;if(0===u)E&&(m.isSnap=!0,m.pos=C.pos[1],m.offset=i-m.pos);else if(0===d)x&&(h.isSnap=!0,h.pos=D,h.offset=o-D);else{var M=d/u,O=n[1]-M*o,_=0,A=0,T=!1;x?(_=M*(A=D)+O,T=!0):E&&(A=((_=S)-O)/M,T=!0),T&&(h.isSnap=!0,h.pos=A,h.offset=o-A,m.isSnap=!0,m.pos=_,m.offset=i-_)}return{vertical:h,horizontal:m}}(t,e,n),l=a.horizontal,c=a.vertical,u=c_(i,l),d=c_(s,c),p=eT(u),f=eT(d);return{horizontal:{isBound:i.isBound,isSnap:l.isSnap,offset:u,dist:p},vertical:{isBound:s.isBound,isSnap:c.isSnap,offset:d,dist:f}}}(t,c,u,o):s_(t,o,{vertical:[u[0]],horizontal:[u[1]]}),p=d.horizontal,f=p.offset,h=p.isBound,m=p.isSnap,g=d.vertical,v=g.offset,y=g.isBound,b=g.isSnap,x=$S(l,a);if(!v&&!f)return{isBound:y||h,isSnap:b||m,sign:x,offset:[0,0]};var w=function(t,e,n,r){var o=mS(t,e)/Math.PI*180,i=n.vertical,s=i.isBound,a=i.isSnap,l=i.dist,c=n.horizontal,u=c.isBound,d=c.isSnap,p=o%180,f=p<3||p>177,h=p>87&&p<93;return c.dist<l&&(s||a&&!h&&(!r||!f))?"vertical":!u&&(!d||f||r&&h)?"":"horizontal"}(c,u,d,r);if(!w)return{sign:x,isBound:!1,isSnap:!1,offset:[0,0]};var k="vertical"===w,E=[0,0];return E=(E=r||1!==eT(l[0])||1!==eT(l[1])||a[0]===l[0]||a[1]===l[1]?r_(c,u,-(k?v:f),k,i).offset:VM({datas:i,distX:-v,distY:-f})).map(function(t,e){return t*(x[e]?2/x[e]:0)}),{sign:x,isBound:k?y:h,isSnap:k?b:m,offset:E}})}function c_(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}var u_={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var n=t.props,r=n.hideThrottleDragRotateLine,o=n.throttleDragRotate,i=n.zoom,s=t.getState(),a=s.dragInfo,l=s.beforeOrigin;if(r||!o||!a)return[];var c=a.dist;if(!c[0]&&!c[1])return[];var u=dA(c),d=mS(c,[0,0]);return[e.createElement("div",{className:G_("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) rotate(").concat(d,"rad) scaleY(").concat(i,")")}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,o=e.parentGesto,i=t.state,s=i.gestos,a=i.style;if(s.draggable)return!1;s.draggable=o||t.targetGesto,n.datas={},n.left=parseFloat(a.left||"")||0,n.top=parseFloat(a.top||"")||0,n.bottom=parseFloat(a.bottom||"")||0,n.right=parseFloat(a.right||"")||0,n.startValue=[0,0],FM(t,e),KM(t,e,"translate"),function(t,e){e.absolutePoses=CA(t.state)}(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var l=_A(t,e,eM({set:function(t){n.startValue=t}},YM(t,e)));return!1!==(r||RA(t,"onDragStart",l))?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.draggable=null,n.isPinch=!1),!!n.isDrag&&l},drag:function(t,e){if(e){BM(t,e,"translate");var n=e.datas,r=e.parentEvent,o=e.parentFlag,i=e.isPinch,s=e.deltaOffset,a=e.useSnap,l=e.isRequest,c=e.distX,u=e.distY,d=n.isDrag,p=n.prevDist,f=n.prevBeforeDist,h=n.startValue;if(d){s&&(c+=s[0],u+=s[1]);var m=t.props,g=m.parentMoveable,v=r?0:m.throttleDrag||0,y=r?0:m.throttleDragRotate||0,b=0,x=!1,w=!1,k=!1,E=!1;if(!r&&y>0&&(c||u)){var C=m.startDragRotate||0,S=yS(C+180*mS([0,0],[c,u])/Math.PI,y)-C,D=u*Math.abs(Math.cos((S-90)/180*Math.PI)),M=dA([c*Math.abs(Math.cos(S/180*Math.PI)),D]);b=S*Math.PI/180,c=M*Math.cos(b),u=M*Math.sin(b)}if(!i&&!r&&!o){var O=nM(i_(t,c,u,y,!a&&l||s,n),2),_=O[0],A=O[1];x=_.isSnap,w=_.isBound,k=A.isSnap,E=A.isBound,c+=_.offset,u+=A.offset}var T=HS(qM({datas:n,distX:c,distY:u}),h),R=HS(HM({datas:n,distX:c,distY:u}),h);bS(R,DM),bS(T,DM),y||(x||w||(R[0]=yS(R[0],v),T[0]=yS(T[0],v)),k||E||(R[1]=yS(R[1],v),T[1]=yS(T[1],v)));var N=$S(T,h),P=$S(R,h),L=$S(P,p),I=$S(N,f);n.prevDist=P,n.prevBeforeDist=N,n.passDelta=L,n.passDist=P;var z=n.left+N[0],F=n.top+N[1],B=n.right-N[0],j=n.bottom-N[1],H=jM(n,"translate(".concat(R[0],"px, ").concat(R[1],"px)"),"translate(".concat(P[0],"px, ").concat(P[1],"px)"));if(JM(e,H),t.state.dragInfo.dist=r?[0,0]:P,r||g||!L.every(function(t){return!t})||!I.some(function(t){return!t})){var $=t.state,q=$.width,V=$.height,W=_A(t,e,eM({transform:H,dist:P,delta:L,translate:R,beforeDist:N,beforeDelta:I,beforeTranslate:T,left:z,top:F,right:B,bottom:j,width:q,height:V,isPinch:i},MA({transform:H},e)));return!r&&RA(t,"onDrag",W),W}}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return!(!r[0]&&!r[1])&&(n.deltaOffset=[0,0],this.drag(t,eM(eM({},e),{deltaOffset:r})))},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.dragInfo=null,r.isDrag){r.isDrag=!1;var o=AA(t,e,{});return!n&&RA(t,"onDragEnd",o),o}},dragGroupStart:function(t,e){var n=e.datas,r=e.clientX,o=e.clientY,i=this.dragStart(t,e);if(!i)return!1;var s=mO(t,this,"dragStart",[r||0,o||0],e,0,"draggable"),a=RA(t,"onDragGroupStart",eM(eM({},i),{targets:t.props.targets,events:s}));return n.isDrag=!1!==a,!!n.isDrag&&i},dragGroup:function(t,e){if(e.datas.isDrag){var n=this.drag(t,e),r=mO(t,this,"drag",e.datas.passDelta,e,0,"draggable");if(n){var o=eM({targets:t.props.targets,events:r},n);return RA(t,"onDragGroup",o),o}}},dragGroupEnd:function(t,e){var n=e.isDrag;if(e.datas.isDrag){this.dragEnd(t,e);var r=mO(t,this,"dragEnd",[0,0],e,0,"draggable");return RA(t,"onDragGroupEnd",AA(t,e,{targets:t.props.targets,events:r})),n}},request:function(t){var e={},n=t.getRect(),r=0,o=0,i=!1;return{isControl:!1,requestStart:function(t){return i=t.useSnap,{datas:e,useSnap:i}},request:function(t){return"x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?o=t.y-n.top:"deltaY"in t&&(o+=t.deltaY),{datas:e,distX:r,distY:o,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function d_(t,e){return{fixedPosition:GM(t,e),fixedDirection:e,fixedOffset:[0,0]}}function p_(t,e){var n=t.allMatrix,r=t.is3d,o=t.width,i=t.height,s=r?4:3,a=function(t,e,n){return[e?t[0]/(e/2)-1:0,n?t[1]/(n/2)-1:0]}(e,o,i);return{fixedPosition:aA(n,e,s),fixedDirection:a,fixedOffset:[o?0:e[0],i?0:e[1]]}}var f_=VA("resizable"),h_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:kO("resizable"),dragControlCondition:f_,viewClassName:qA("resizable"),dragControlStart:function(t,e){var n,r=e.inputEvent,o=e.isPinch,i=e.isGroup,s=e.parentDirection,a=e.parentGesto,l=e.datas,c=e.parentFixedDirection,u=e.parentEvent,d=wA(s,o,r,l),p=t.state,f=p.target,h=p.width,m=p.height,g=p.gestos;if(!d||!f)return!1;if(g.resizable)return!1;g.resizable=a||t.controlGesto,!o&&FM(t,e),l.datas={},l.direction=d,l.startOffsetWidth=h,l.startOffsetHeight=m,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=p.inlineCSSWidth||p.cssWidth,l.startHeight=p.inlineCSSHeight||p.cssHeight,l.maxSize=[1/0,1/0],i||(l.minSize=[p.minOffsetWidth,p.minOffsetHeight],l.maxSize=[p.maxOffsetWidth,p.maxOffsetHeight]);var v=t.props.transformOrigin||"% %";function y(t){l.ratio=t&&isFinite(t)?t:0}function b(t){var e=d_(l.startPositions,t);l.fixedDirection=e.fixedDirection,l.fixedPosition=e.fixedPosition,l.fixedOffset=e.fixedOffset}function x(e){var n=p_(t.state,e);l.fixedDirection=n.fixedDirection,l.fixedPosition=n.fixedPosition,l.fixedOffset=n.fixedOffset}function w(t){l.minSize=[uS("".concat(t[0]),0)||0,uS("".concat(t[1]),0)||0]}function k(t){var e=[t[0]||1/0,t[1]||1/0];KC(e[0])&&!isFinite(e[0])||(e[0]=uS("".concat(e[0]),0)||1/0),KC(e[1])&&!isFinite(e[1])||(e[1]=uS("".concat(e[1]),0)||1/0),l.maxSize=e}l.transformOrigin=YC(v)?v.split(" "):v,l.startOffsetMatrix=p.offsetMatrix,l.startTransformOrigin=p.transformOrigin,l.isWidth=null!==(n=null==e?void 0:e.parentIsWidth)&&void 0!==n?n:!d[0]&&!d[1]||d[0]||!d[1],l.startPositions=CA(t.state),y(h/m),b(c||[-d[0],-d[1]]),l.setFixedDirection=b,l.setFixedPosition=x,l.setMin=w,l.setMax=k;var E=_A(t,e,{direction:d,startRatio:l.ratio,set:function(t){var e=nM(t,2),n=e[0],r=e[1];l.startWidth=n,l.startHeight=r},setMin:w,setMax:k,setRatio:y,setFixedDirection:b,setFixedPosition:x,setOrigin:function(t){l.transformOrigin=t},dragStart:u_.dragStart(t,(new LM).dragStart([0,0],e))}),C=u||RA(t,"onResizeStart",E);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,!1!==C&&(l.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:d}),!!l.isResize&&E},dragControl:function(t,e){var n,r=e.datas,o=e.parentFlag,i=e.isPinch,s=e.parentKeepRatio,a=e.dragClient,l=e.parentDist,c=e.useSnap,u=e.isRequest,d=e.isGroup,p=e.parentEvent,f=e.resolveMatrix,h=r.isResize,m=r.transformOrigin,g=r.startWidth,v=r.startHeight,y=r.prevWidth,b=r.prevHeight,x=r.minSize,w=r.maxSize,k=r.ratio,E=r.startOffsetWidth,C=r.startOffsetHeight,S=r.isWidth;if(h){if(f){var D=t.state.is3d,M=r.startOffsetMatrix,O=r.startTransformOrigin,_=D?4:3,A=iD(QM(e)),T=Math.sqrt(A.length);_!==T&&(A=FS(A,T,_));var R=UM(M,A,O,_),N=lA(R,E,C,_);r.startPositions=N,r.nextTargetMatrix=A,r.nextAllMatrix=R}var P=mA(t.props,"resizable"),L=P.resizeFormat,I=P.throttleResize,z=void 0===I?o?0:1:I,F=P.parentMoveable,B=P.keepRatioFinally,j=r.direction,H=j,$=0,q=0;j[0]||j[1]||(H=[1,1]);var V=k&&(null!=s?s:P.keepRatio)||!1,W=nM(ot(),2),G=W[0],U=W[1];p||(r.setFixedDirection(r.fixedDirection),RA(t,"onBeforeResize",_A(t,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(t){var e;return r.setFixedDirection(t),e=nM(ot(),2),G=e[0],U=e[1],[G,U]},setFixedPosition:function(t){var e;return r.setFixedPosition(t),e=nM(ot(),2),G=e[0],U=e[1],[G,U]},boundingWidth:G,boundingHeight:U,setSize:function(t){var e;e=nM(t,2),G=e[0],U=e[1]}},!0)));var Y=a;a||(Y=!o&&i?function(t,e){return GM(CA(t.state),e)}(t,[0,0]):r.fixedPosition);var K=[0,0];if(i||(K=function(t,e,n,r,o,i,s){if(!LO(t,"resizable"))return[0,0];var a=s.fixedDirection,l=s.nextAllMatrix,c=t.state,u=c.allMatrix,d=c.is3d;return L_(t,function(t,r){return R_(l||u,e+t,n+r,a,o,d)},e,n,r,o,i,s)}(t,G,U,j,Y,!c&&u,r)),l&&(!l[0]&&(K[0]=0),!l[1]&&(K[1]=0)),V){H[0]&&H[1]&&K[0]&&K[1]&&(eT(K[0])>eT(K[1])?K[1]=0:K[0]=0);var X=!K[0]&&!K[1];X&&it(),H[0]&&!H[1]||K[0]&&!K[1]||X&&S?(G+=K[0],U=G/k):(!H[0]&&H[1]||!K[0]&&K[1]||X&&!S)&&(U+=K[1],G=U*k)}else G+=K[0],U+=K[1],G=Math.max(0,G),U=Math.max(0,U);n=nM(fS([G,U],x,w,!!V&&k),2),G=n[0],U=n[1],it(),V&&(d||B)&&(S?U=G/k:G=U*k);var J=[($=G-E)-y,(q=U-C)-b];r.prevWidth=$,r.prevHeight=q;var Z=iO(t,G,U,Y,m,r);if(F||!J.every(function(t){return!t})||!Z.every(function(t){return!t})){var Q=u_.drag(t,PM(e,t.state,Z,!!i,0,"draggable")),tt=Q.transform,et=g+$,nt=v+q,rt=_A(t,e,eM({width:et,height:nt,offsetWidth:Math.round(G),offsetHeight:Math.round(U),startRatio:k,boundingWidth:G,boundingHeight:U,direction:j,dist:[$,q],delta:J,isPinch:!!i,drag:Q},OA({style:{width:"".concat(et,"px"),height:"".concat(nt,"px")},transform:tt},Q,e)));return!p&&RA(t,"onResize",rt),rt}}function ot(){var t=r.fixedDirection,n=KA(H,V,r,e);$=n.distWidth,q=n.distHeight;var o=H[0]-t[0]||V?Math.max(E+$,DM):E,i=H[1]-t[1]||V?Math.max(C+q,DM):C;return V&&E&&C&&(S?i=o/k:o=i*k),[o,i]}function it(){var t;L&&(t=nM(L([G,U]),2),G=t[0],U=t[1]),G=yS(G,z),U=yS(U,z)}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,o=n.startOffsetWidth,i=n.startOffsetHeight,s=n.prevWidth,a=n.prevHeight;if(r&&!1!==t.props.checkResizableError){var l=t.state,c=l.width-(o+s),u=l.height-(i+a),d=eT(c)>3,p=eT(u)>3;return d&&(n.startWidth+=c,n.startOffsetWidth+=c,n.prevWidth+=c),p&&(n.startHeight+=u,n.startOffsetHeight+=u,n.prevHeight+=u),d||p?this.dragControl(t,e):void 0}},dragControlEnd:function(t,e){var n=e.datas,r=e.parentEvent;if(n.isResize){n.isResize=!1;var o=AA(t,e,{});return!r&&RA(t,"onResizeEnd",o),o}},dragGroupControlCondition:f_,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,eM(eM({},e),{isGroup:!0}));if(!r)return!1;var o=hO(t,"resizable",e),i=n.startOffsetWidth,s=n.startOffsetHeight;function a(){var t=n.minSize;o.forEach(function(e){var n=e.datas,r=n.minSize,o=n.startOffsetWidth,a=n.startOffsetHeight,l=i*(o?r[0]/o:0),c=s*(a?r[1]/a:0);t[0]=Math.max(t[0],l),t[1]=Math.max(t[1],c)})}function l(){var t=n.maxSize;o.forEach(function(e){var n=e.datas,r=n.maxSize,o=n.startOffsetWidth,a=n.startOffsetHeight,l=i*(o?r[0]/o:0),c=s*(a?r[1]/a:0);t[0]=Math.min(t[0],l),t[1]=Math.min(t[1],c)})}var c=gO(t,this,"dragControlStart",e,function(e,r){return vO(t,e,n,r)});a(),l();var u=function(e){r.setFixedDirection(e),c.forEach(function(r,i){r.setFixedDirection(e),vO(t,r.moveable,n,o[i])})};n.setFixedDirection=u;var d=eM(eM({},r),{targets:t.props.targets,events:c.map(function(t){return eM(eM({},t),{setMin:function(e){t.setMin(e),a()},setMax:function(e){t.setMax(e),l()}})}),setFixedDirection:u,setMin:function(t){r.setMin(t),a()},setMax:function(t){r.setMax(t),l()}}),p=RA(t,"onResizeGroupStart",d);return n.isResize=!1!==p,!!n.isResize&&r},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=mA(t.props,"resizable");TA(t,"onBeforeResize",function(n){RA(t,"onBeforeResizeGroup",_A(t,e,eM(eM({},n),{targets:r.targets}),!0))});var o=this.dragControl(t,eM(eM({},e),{isGroup:!0}));if(o){var i=o.boundingWidth,s=o.boundingHeight,a=o.dist,l=r.keepRatio,c=[i/(i-a[0]),s/(s-a[1])],u=n.fixedPosition,d=gO(t,this,"dragControl",e,function(e,n){var r=nM(WS(QS(t.rotation/180*Math.PI,3),[n.datas.originalX*c[0],n.datas.originalY*c[1],1],3),2),o=r[0],i=r[1];return eM(eM({},n),{parentDist:null,parentScale:c,dragClient:HS(u,[o,i]),parentKeepRatio:l})}),p=eM({targets:r.targets,events:d},o);return RA(t,"onResizeGroup",p),p}}},dragGroupControlEnd:function(t,e){var n=e.isDrag;if(e.datas.isResize){this.dragControlEnd(t,e);var r=gO(t,this,"dragControlEnd",e);return RA(t,"onResizeGroupEnd",AA(t,e,{targets:t.props.targets,events:r})),n}},request:function(t){var e={},n=0,r=0,o=!1,i=t.getRect();return{isControl:!0,requestStart:function(t){var n;return o=t.useSnap,{datas:e,parentDirection:t.direction||[1,1],parentIsWidth:null===(n=null==t?void 0:t.horizontal)||void 0===n||n,useSnap:o}},request:function(t){return"offsetWidth"in t?n=t.offsetWidth-i.offsetWidth:"deltaWidth"in t&&(n+=t.deltaWidth),"offsetHeight"in t?r=t.offsetHeight-i.offsetHeight:"deltaHeight"in t&&(r+=t.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:t.keepRatio,useSnap:o}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:o}}}},unset:function(t){t.state.gestos.resizable=null}};function m_(t,e,n,r,o){var i=t.props.groupable,s=t.state,a=s.is3d?4:3,l=e.origin,c=aA(t.state.rootMatrix,$S([l[0],l[1]],i?[0,0]:[s.left,s.top]),a),u=HS([o.left,o.top],c);e.startAbsoluteOrigin=u,e.prevDeg=mS(u,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=vS(u,[n,r])}function g_(t,e,n){var r=n.defaultDeg,o=n.prevDeg,i=o%360,s=Math.floor(o/360);i<0&&(i+=360),i>t&&i>270&&t<90?++s:i<t&&i<90&&t>270&&--s;var a=e*(360*s+t-r);return n.prevDeg=r+a,a}function v_(t,e,n,r){return g_(mS(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function y_(t,e,n,r,o,i){var s=t.props.throttleRotate,a=void 0===s?0:s,l=n.prevSnapDeg,c=0,u=!1;if(i){var d=function(t,e,n,r){var o,i=t.props,s=null!==(o=i[q_])&&void 0!==o?o:5,a=i[V_];if(LO(t,"rotatable")){var l=e.pos1,c=e.pos2,u=e.pos3,d=e.pos4,p=e.origin,f=n*Math.PI/180,h=[l,c,u,d].map(function(t){return $S(t,p)}),m=h.map(function(t){return XS(t,f)}),g=rM(rM([],nM(_O(t,h,m,p,n)),!1),nM(n_(t,h,m,p,n)),!1);g.sort(function(t,e){return eT(t-n)-eT(e-n)});var v=g.length>0;if(v)return{isSnap:v,dist:v?g[0]:n}}if((null==a?void 0:a.length)&&s){var y=a.slice().sort(function(t,e){return F_(t,r)-F_(e,r)})[0];if(F_(y,r)<=s)return{isSnap:!0,dist:n+z_(r,y)-r}}return{isSnap:!1,dist:n}}(t,e,r,o+r);u=d.isSnap,c=o+d.dist}u||(c=yS(o+r,a));var p=c-o;return n.prevSnapDeg=p,[p-l,p,c]}function b_(t,e,n){var r=nM(e,4),o=r[0],i=r[1],s=r[2],a=r[3];if("none"===t)return[];if(UC(t))return t.map(function(t){return b_(t,[o,i,s,a],n)[0]});var l=nM((t||"top").split("-"),2),c=l[0],u=l[1],d=[o,i];"left"===c?d=[s,o]:"right"===c?d=[i,a]:"bottom"===c&&(d=[a,s]);var p=[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2],f=vA(d,n);if(u){var h="top"===u||"left"===u,m="bottom"===c||"left"===c;p=d[h&&!m||!h&&m?0:1]}return[[p,f]]}function x_(t,e){if(e.isRequest)return"rotatable"===e.requestAble;var n=e.inputEvent.target;if(xS(n,G_("rotation-control"))||t.props.rotateAroundControls&&xS(n,G_("around-control"))||xS(n,G_("control"))&&xS(n,G_("rotatable")))return!0;var r=t.props.rotationTarget;return!!r&&GA(r,!0).some(function(t){return!!t&&(n===t||n.contains(t))})}var w_={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[".rotation {\nposition: absolute;\nheight: 40px;\nwidth: 1px;\ntransform-origin: 50% 100%;\nheight: calc(40px * var(--zoom));\ntop: auto;\nleft: 0;\nbottom: 100%;\nwill-change: transform;\n}\n.rotation .rotation-line {\ndisplay: block;\nwidth: 100%;\nheight: 100%;\ntransform-origin: 50% 50%;\n}\n.rotation .rotation-control {\nborder-color: #4af;\nborder-color: var(--moveable-color);\nbackground:#fff;\ncursor: alias;\n}\n:global .view-rotation-dragging, .rotatable.direction.control {\ncursor: alias;\n}\n.rotatable.direction.control.move {\ncursor: move;\n}\n"],viewClassName:function(t){return t.isDragging("rotatable")?G_("view-rotation-dragging"):""},render:function(t,e){var n=mA(t.props,"rotatable"),r=n.rotatable,o=n.rotationPosition,i=n.zoom,s=n.renderDirections,a=n.rotateAroundControls,l=n.resolveAblesWithRotatable,c=t.getState(),u=c.renderPoses,d=c.direction;if(!r)return null;var p=b_(o,u,d),f=[];if(p.forEach(function(t,n){var r=nM(t,2),o=r[0],s=r[1];f.push(e.createElement("div",{key:"rotation".concat(n),className:G_("rotation"),style:{transform:"translate(-50%) translate(".concat(o[0],"px, ").concat(o[1],"px) rotate(").concat(s,"rad)")}},e.createElement("div",{className:G_("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),e.createElement("div",{className:G_("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))}),s){var h=cS(l||{}),m={};h.forEach(function(t){l[t].forEach(function(e){m[e]=t})});var g=[];UC(s)&&(g=s.map(function(t){var e=m[t];return{data:e?{resolve:e}:{},classNames:e?["move"]:[],dir:t}})),f.push.apply(f,rM([],nM(yO(t,"rotatable",g,e)),!1))}return a&&f.push.apply(f,rM([],nM(CO(t,e)),!1)),f},dragControlCondition:x_,dragControlStart:function(t,e){var n,r,o=e.datas,i=e.clientX,s=e.clientY,a=e.parentRotate,l=e.parentFlag,c=e.isPinch,u=e.isRequest,d=t.state,p=d.target,f=d.left,h=d.top,m=d.direction,g=d.beforeDirection,v=d.targetTransform,y=d.moveableClientRect,b=d.offsetMatrix,x=d.targetMatrix,w=d.allMatrix,k=d.width,E=d.height;if(!u&&!p)return!1;var C=t.getRect();o.rect=C,o.transform=v,o.left=f,o.top=h;var S=function(e){var n=p_(t.state,e);o.fixedDirection=n.fixedDirection,o.fixedOffset=n.fixedOffset,o.fixedPosition=n.fixedPosition,z&&z.setFixedPosition(e)},D=function(e){var n=function(t,e){var n=t.allMatrix,r=t.is3d,o=t.width,i=t.height,s=r?4:3;return{fixedPosition:aA(n,[o/2*(1+e[0]),i/2*(1+e[1])],s),fixedDirection:e,fixedOffset:[0,0]}}(t.state,e);o.fixedDirection=n.fixedDirection,o.fixedOffset=n.fixedOffset,o.fixedPosition=n.fixedPosition,z&&z.setFixedDirection(e)},M=i,O=s;if(u||c||l){var _=a||0;o.beforeInfo={origin:C.beforeOrigin,prevDeg:_,defaultDeg:_,prevSnapDeg:0,startDist:0},o.afterInfo=eM(eM({},o.beforeInfo),{origin:C.origin}),o.absoluteInfo=eM(eM({},o.beforeInfo),{origin:C.origin,startValue:_})}else{var A=null===(r=e.inputEvent)||void 0===r?void 0:r.target;if(A){var T=A.getAttribute("data-direction")||"",R=AM[T];if(R){o.isControl=!0,o.isAroundControl=xS(A,G_("around-control")),o.controlDirection=R;var N=A.getAttribute("data-resolve");N&&(o.resolveAble=N);var P=function(t,e,n){var r=16===t.length?4:3,o=e.map(function(e){return aA(t,e,r)}),i=n.left,s=n.top;return o.map(function(t){return[t[0]+i,t[1]+s]})}(d.rootMatrix,d.renderPoses,y);n=nM(GM(P,R),2),M=n[0],O=n[1]}}o.beforeInfo={origin:C.beforeOrigin},o.afterInfo={origin:C.origin},o.absoluteInfo={origin:C.origin,startValue:C.rotation};var L=S;S=function(e){var n=d.is3d?4:3,r=nM(HS(IS(x,n),e),2),i=r[0],s=r[1],a=WS(b,zS([i,s],n)),l=WS(w,zS([e[0],e[1]],n));L(e);var c=d.posDelta;o.beforeInfo.origin=$S(a,c),o.afterInfo.origin=$S(l,c),o.absoluteInfo.origin=$S(l,c),m_(t,o.beforeInfo,M,O,y),m_(t,o.afterInfo,M,O,y),m_(t,o.absoluteInfo,M,O,y)},D=function(t){var e=GM([[0,0],[k,0],[0,E],[k,E]],t);S(e)}}o.startClientX=M,o.startClientY=O,o.direction=m,o.beforeDirection=g,o.startValue=0,o.datas={},KM(t,e,"rotate");var I=!1,z=!1;o.isControl&&o.resolveAble&&("resizable"===o.resolveAble&&(z=h_.dragControlStart(t,eM(eM({},new LM("resizable").dragStart([0,0],e)),{parentPosition:o.controlPosition,parentFixedPosition:o.fixedPosition}))));z||(I=u_.dragStart(t,(new LM).dragStart([0,0],e))),S(function(t){var e=t.props,n=e.groupable,r=e.svgOrigin,o=t.getState(),i=o.offsetWidth,s=o.offsetHeight,a=o.svg,l=o.transformOrigin;if(!n&&a&&r)return JA(r,i,s);return l}(t));var F=_A(t,e,eM(eM({set:function(t){o.startValue=t*Math.PI/180},setFixedDirection:D,setFixedPosition:S},YM(t,e)),{dragStart:I,resizeStart:z})),B=RA(t,"onRotateStart",F);return o.isRotate=!1!==B,d.snapRenderInfo={request:e.isRequest},!!o.isRotate&&F},dragControl:function(t,e){var n,r,o,i=e.datas,s=e.clientDistX,a=e.clientDistY,l=e.parentRotate,c=e.parentFlag,u=e.isPinch,d=e.groupDelta,p=e.resolveMatrix,f=i.beforeDirection,h=i.beforeInfo,m=i.afterInfo,g=i.absoluteInfo,v=i.isRotate,y=i.startValue,b=i.rect,x=i.startClientX,w=i.startClientY;if(v){BM(t,e,"rotate");var k,E,C,S,D,M,O,_,A,T=function(t){return IM(t.datas.beforeTransform,[50,50],100,100).direction}(e),R=f*T,N=t.props.parentMoveable,P=180/Math.PI*y,L=g.startValue,I=!1,z=x+s,F=w+a;if(!c&&"parentDist"in e){var B=e.parentDist;E=B,D=B,_=B}else u||c?(E=g_(l,f,h),D=g_(l,R,m),_=g_(l,R,g)):(E=v_(z,F,f,h),D=v_(z,F,R,m),_=v_(z,F,R,g),I=!0);if(RA(t,"onBeforeRotate",_A(t,e,{beforeRotation:C=P+E,rotation:M=P+D,absoluteRotation:A=L+_,setRotation:function(t){E=D=t-P,_=D}},!0)),k=(n=nM(y_(t,b,h,E,P,I),3))[0],E=n[1],C=n[2],S=(r=nM(y_(t,b,m,D,P,I),3))[0],D=r[1],M=r[2],O=(o=nM(y_(t,b,g,_,L,I),3))[0],_=o[1],A=o[2],O||S||k||N||p){var j=jM(i,"rotate(".concat(M,"deg)"),"rotate(".concat(D,"deg)"));p&&(i.fixedPosition=rO(t,i.targetAllTransform,i.fixedDirection,i.fixedOffset,i));var H=function(t,e,n){var r=n.fixedDirection,o=n.fixedPosition,i=n.fixedOffset;return oO(t,"rotate(".concat(e,"deg)"),r,o,i,n)}(t,D,i),$=$S(HS(d||[0,0],H),i.prevInverseDist||[0,0]);i.prevInverseDist=H,i.requestValue=null;var q=nO(t,j,$,u,e),V=q,W=vS([z,F],g.startAbsoluteOrigin)-g.startDist,G=void 0;if("resizable"===i.resolveAble){var U=h_.dragControl(t,eM(eM({},PM(e,t.state,[e.deltaX,e.deltaY],!!u,0,"resizable")),{resolveMatrix:!0,parentDistance:W}));U&&(G=U,V=OA(V,U,e))}var Y=_A(t,e,eM(eM({delta:S,dist:D,rotate:M,rotation:M,beforeDist:E,beforeDelta:k,beforeRotate:C,beforeRotation:C,absoluteDist:_,absoluteDelta:O,absoluteRotate:A,absoluteRotation:A,isPinch:!!u,resize:G},q),V));return RA(t,"onRotate",Y),Y}}},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate){n.isRotate=!1;var r=AA(t,e,{});return RA(t,"onRotateEnd",r),r}},dragGroupControlCondition:x_,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,o=r.left,i=r.top,s=r.beforeOrigin,a=this.dragControlStart(t,e);if(!a)return!1;a.set(n.beforeDirection*t.rotation);var l=gO(t,this,"dragControlStart",e,function(t,e){var n=t.state,r=n.left,a=n.top,l=n.beforeOrigin,c=HS($S([r,a],[o,i]),$S(l,s));return e.datas.startGroupClient=c,e.datas.groupClient=c,eM(eM({},e),{parentRotate:0})}),c=RA(t,"onRotateGroupStart",eM(eM({},a),{targets:t.props.targets,events:l}));return n.isRotate=!1!==c,!!n.isRotate&&a},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){TA(t,"onBeforeRotate",function(n){RA(t,"onBeforeRotateGroup",_A(t,e,eM(eM({},n),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var o=n.beforeDirection,i=r.beforeDist,s=i/180*Math.PI,a=gO(t,this,"dragControl",e,function(t,e){var n=e.datas.startGroupClient,r=nM(e.datas.groupClient,2),a=r[0],l=r[1],c=nM(XS(n,s*o),2),u=c[0],d=c[1],p=[u-a,d-l];return e.datas.groupClient=[u,d],eM(eM({},e),{parentRotate:i,groupDelta:p})});t.rotation=o*r.beforeRotation;var l=eM({targets:t.props.targets,events:a,set:function(e){t.rotation=e},setGroupRotation:function(e){t.rotation=e}},r);return RA(t,"onRotateGroup",l),l}}},dragGroupControlEnd:function(t,e){var n=e.isDrag;if(e.datas.isRotate){this.dragControlEnd(t,e);var r=gO(t,this,"dragControlEnd",e);return RA(t,"onRotateGroupEnd",AA(t,e,{targets:t.props.targets,events:r})),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaRotate"in t?n+=t.deltaRotate:"rotate"in t&&(n=t.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function k_(t,e){return function(t,e){var n,r=t.direction,o=t.classNames,i=t.size,s=t.pos,a=t.zoom,l=t.key,c="horizontal"===r,u=c?"Y":"X";return e.createElement("div",{key:l,className:o.join(" "),style:(n={},n[c?"width":"height"]="".concat(i),n.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(u,"(-50%) scale").concat(u,"(").concat(a,")"),n)})}(eM(eM({},t),{classNames:rM([G_("line","guideline",t.direction)],nM(t.classNames),!1).filter(function(t){return t}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(t){return"".concat(yS(t,.1),"px")})}),e)}function E_(t,e,n,r,o,i,s,a){var l=t.props.zoom;return n.map(function(t,n){var c=t.type,u=t.pos,d=[0,0];return d[s]=r,d[s?0:1]=-o+u,k_({key:"".concat(e,"TargetGuideline").concat(n),classNames:[G_("target","bold",c)],posValue:d,sizeValue:i,zoom:l,direction:e},a)})}function C_(t,e,n,r,o,i){var s=t.props,a=s.zoom,l=s.isDisplayInnerSnapDigit,c="horizontal"===e?NO:PO,u=o[c.start],d=o[c.end];return n.filter(function(t){var e=t.hide,n=t.elementRect;if(e)return!1;if(l&&n){var r=n.rect;if(r[c.start]<=u&&d<=r[c.end])return!1}return!0}).map(function(t,n){var o=t.pos,s=t.size,l=t.element,c=t.className,u=[-r[0]+o[0],-r[1]+o[1]];return k_({key:"".concat(e,"-default-guideline-").concat(n),classNames:l?[G_("bold"),c]:[G_("normal"),c],direction:e,posValue:u,sizeValue:s,zoom:a},i)})}function S_(t,e,n,r,o,i,s,a){var l,c=t.props,u=c.snapDigit,d=void 0===u?0:u,p=c.isDisplaySnapDigit,f=void 0===p||p,h=c.snapDistFormat,m=void 0===h?function(t,e){return t}:h,g=c.zoom,v="horizontal"===e?"X":"Y",y="vertical"===e?"height":"width",b=Math.abs(o),x=f?parseFloat(b.toFixed(d)):0;return a.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:G_("guideline-group",e),style:(l={left:"".concat(i[0],"px"),top:"".concat(i[1],"px")},l[y]="".concat(b,"px"),l)},k_({direction:e,classNames:[G_(n),s],size:"100%",posValue:[0,0],sizeValue:b,zoom:g},a),a.createElement("div",{className:G_("size-value","gap"),style:{transform:"translate".concat(v,"(-50%) scale(").concat(g,")")}},x>0?m(x,e):""))}function D_(t,e,n,r,o){var i=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(a){var l=e.filter(function(t){return t.type===a}),c="vertical"===a?1:0,u=c?0:1,d=function(t,e,n,r){var o="vertical"===t?0:1,i="vertical"===t?1:0,s=o?NO:PO,a=n[s.start],l=n[s.end];return IA(e,function(t){return t.pos[o]}).map(function(e){var n=[],c=[];return e.forEach(function(e){var u,d,p=e.element,f=e.elementRect.rect;if(f[s.end]<a)n.push(e);else if(l<f[s.start])c.push(e);else if(f[s.start]<=a&&l<=f[s.end]&&r){var h=e.pos,m={element:p,rect:eM(eM({},f),(u={},u[s.end]=f[s.start],u))},g={element:p,rect:eM(eM({},f),(d={},d[s.start]=f[s.end],d))},v=[0,0],y=[0,0];v[o]=h[o],v[i]=h[i],y[o]=h[o],y[i]=h[i]+e.size,n.push({type:t,pos:v,size:0,elementRect:m,direction:"",elementDirection:"end"}),c.push({type:t,pos:y,size:0,elementRect:g,direction:"",elementDirection:"start"})}}),n.sort(function(t,e){return e.pos[i]-t.pos[i]}),c.sort(function(t,e){return t.pos[i]-e.pos[i]}),{total:e,start:n,end:c,inner:[]}})}(a,l,r,i),p=c?PO:NO,f=c?NO:PO,h=r[p.start],m=r[p.end];d.forEach(function(e){var i=e.total,l=e.start,d=e.end,g=e.inner,v=n[u]+i[0].pos[u]-r[f.start],y=r;l.forEach(function(e){var r=e.elementRect.rect,i=y[p.start]-r[p.end];if(i>0){var l=[0,0];l[c]=n[c]+y[p.start]-h-i,l[u]=v,s.push(S_(t,a,"dashed",s.length,i,l,e.className,o))}y=r}),y=r,d.forEach(function(e){var r=e.elementRect.rect,i=r[p.start]-y[p.end];if(i>0){var l=[0,0];l[c]=n[c]+y[p.end]-h,l[u]=v,s.push(S_(t,a,"dashed",s.length,i,l,e.className,o))}y=r}),g.forEach(function(e){var r=e.elementRect.rect,i=h-r[p.start],l=r[p.end]-m,d=[0,0],f=[0,0];d[c]=n[c]-i,d[u]=v,f[c]=n[c]+m-h,f[u]=v,s.push(S_(t,a,"dashed",s.length,i,d,e.className,o)),s.push(S_(t,a,"dashed",s.length,l,f,e.className,o))})})}),s}function M_(t){var e=t.state,n=e.containerClientRect,r=e.hasFixed,o=n.overflow,i=n.scrollHeight,s=n.scrollWidth,a=n.clientHeight,l=n.clientWidth,c=n.clientLeft,u=n.clientTop,d=t.props,p=d.snapGap,f=void 0===p||p,h=d.verticalGuidelines,m=d.horizontalGuidelines,g=d.snapThreshold,v=void 0===g?5:g,y=d.snapGridWidth,b=void 0===y?0:y,x=d.snapGridHeight,w=void 0===x?0:x,k=d.maxSnapElementGuidelineDistance,E=void 0===k?1/0:k,C=d.isDisplayGridGuidelines,S=cA(CA(t.state)),D=S.top,M=S.left,O=S.bottom,_=S.right,A={top:D,left:M,bottom:O,right:_,center:(M+_)/2,middle:(D+O)/2},T=function(t){var e=t.state,n=t.props.elementGuidelines,r=void 0===n?[]:n;if(!r.length)return e.elementRects=[],[];var o=(e.elementRects||[]).filter(function(t){return!t.refresh}),i=r.map(function(t){return GC(t)&&"element"in t?eM(eM({},t),{element:WA(t.element,!0)}):{element:WA(t,!0)}}).filter(function(t){return t.element}),s=function(t,e){return fD(t,e,vD)}(o.map(function(t){return t.element}),i.map(function(t){return t.element})),a=s.maintained,l=s.added,c=[];a.forEach(function(t){var e=nM(t,2),n=e[0],r=e[1];c[r]=o[n]}),function(t,e){if(!e.length)return[];var n=t.props.groupable,r=t.state,o=r.containerClientRect,i=r.rootMatrix,s=r.is3d,a=r.offsetDelta,l=s?4:3,c=nM(function(t,e,n){var r=aA(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}(i,o,l),2),u=c[0],d=c[1],p=n?0:a[0],f=n?0:a[1];return e.map(function(t){var e=t.element.getBoundingClientRect(),n=e.left-u-p,r=e.top-d-f,o=r+e.height,s=n+e.width,a=nM(BA(i,[n,r],l),2),c=a[0],h=a[1],m=nM(BA(i,[s,o],l),2),g=m[0],v=m[1];return eM(eM({},t),{rect:{left:c,right:g,top:h,bottom:v,center:(c+g)/2,middle:(h+v)/2}})})}(t,l.map(function(t){return i[t]})).map(function(t,e){c[l[e]]=t}),e.elementRects=c;var u=IO(t.props.elementSnapDirections),d=[];return c.forEach(function(t){var e=t.element,n=t.top,r=void 0===n?u.top:n,o=t.left,i=void 0===o?u.left:o,s=t.right,a=void 0===s?u.right:s,l=t.bottom,c=void 0===l?u.bottom:l,p=t.center,f=void 0===p?u.center:p,h=t.middle,m=void 0===h?u.middle:h,g=t.className,v=t.rect,y=zO({top:r,right:a,left:i,bottom:c,center:f,middle:m},v),b=y.horizontal,x=y.vertical,w=y.horizontalNames,k=y.verticalNames,E=v.top,C=v.left,S=v.right-C,D=v.bottom-E,M=[S,D];x.forEach(function(n,r){d.push({type:"vertical",element:e,pos:[yS(n,.1),E],size:D,sizes:M,className:g,elementRect:t,elementDirection:RO[k[r]]||k[r],direction:""})}),b.forEach(function(n,r){d.push({type:"horizontal",element:e,pos:[C,yS(n,.1)],size:S,sizes:M,className:g,elementRect:t,elementDirection:RO[w[r]]||w[r],direction:""})})}),d}(t),R=rM([],nM(T),!1);f&&R.push.apply(R,rM([],nM(function(t,e,n){var r=t.props,o=r.maxSnapElementGuidelineDistance,i=void 0===o?1/0:o,s=r.maxSnapElementGapDistance,a=void 0===s?1/0:s,l=t.state.elementRects,c=[];return[["vertical",NO,PO],["horizontal",PO,NO]].forEach(function(t){var r=nM(t,3),o=r[0],s=r[1],u=r[2],d=e[s.start],p=e[s.end],f=e[s.center],h=e[u.start],m=e[u.end];function g(t){var e=t.rect;return e[s.end]<d+n?d-e[s.end]:p-n<e[s.start]?e[s.start]-p:-1}var v=l.filter(function(t){var e=t.rect;return!(e[u.start]>m||e[u.end]<h)&&g(t)>0}).sort(function(t,e){return g(t)-g(e)}),y=[];v.forEach(function(t){v.forEach(function(e){if(t!==e){var n=t.rect,r=e.rect,o=n[u.start],i=n[u.end],s=r[u.start];o>r[u.end]||s>i||y.push([t,e])}})}),y.forEach(function(t){var r=nM(t,2),l=r[0],u=r[1],h=l.rect,m=u.rect,g=h[s.start],v=h[s.end],y=m[s.start],b=m[s.end],x=0,w=0,k=!1,E=!1,C=!1;if(v<=d&&p<=y){if(E=!0,eT((w=v+(x=(y-v-(p-d))/2)+(p-d)/2)-f)>n)return}else if(v<y&&b<d+n){if(k=!0,eT((w=b+(x=y-v))-d)>n)return}else{if(!(v<y&&p-n<g))return;if(C=!0,eT((w=g-(x=y-v))-p)>n)return}x&&O_(e,m,o,i)&&(x>a||c.push({type:o,pos:"vertical"===o?[w,0]:[0,w],element:u.element,size:0,className:u.className,isStart:k,isCenter:E,isEnd:C,gap:x,hide:!0,gapRects:[l,u],direction:"",elementDirection:""}))})}),c}(t,A,v)),!1));var N=eM({},e.snapOffset||{left:0,top:0,bottom:0,right:0});if(R.push.apply(R,rM([],nM(function(t,e,n,r,o,i,s,a){void 0===o&&(o=0);void 0===i&&(i=0);var l=[],c=s.left,u=s.top;if(e)for(var d=0;d<=r;d+=e)l.push({type:"horizontal",pos:[c,yS(d-i+u,.1)],className:G_("grid-guideline"),size:n,hide:!a,direction:""});if(t)for(d=0;d<=n;d+=t)l.push({type:"vertical",pos:[yS(d-o+c,.1),u],className:G_("grid-guideline"),size:r,hide:!a,direction:""});return l}(b,w,o?s:l,o?i:a,c,u,N,C)),!1)),r){var P=n.left,L=n.top;N.left+=P,N.top+=L,N.right+=P,N.bottom+=L}return R.push.apply(R,rM([],nM(A_(m||!1,h||!1,o?s:l,o?i:a,c,u,N)),!1)),R=R.filter(function(t){var e=t.element,n=t.elementRect,r=t.type;if(!e||!n)return!0;var o=n.rect;return O_(A,o,r,E)}),R}function O_(t,e,n,r){return"horizontal"===n?eT(t.right-e.left)<=r||eT(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:"vertical"!==n||(eT(t.bottom-e.top)<=r||eT(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom)}function __(t,e){return t?t.map(function(t){var n=GC(t)?t:{pos:t},r=n.pos;return KC(r)?n:eM(eM({},n),{pos:uS(r,e)})}):[]}function A_(t,e,n,r,o,i,s){void 0===o&&(o=0),void 0===i&&(i=0),void 0===s&&(s={left:0,top:0,right:0,bottom:0});var a=[],l=s.left,c=s.top,u=s.bottom,d=n+s.right-l,p=r+u-c;return __(t,p).forEach(function(t){a.push({type:"horizontal",pos:[l,yS(t.pos-i+c,.1)],size:d,className:t.className,direction:""})}),__(e,d).forEach(function(t){a.push({type:"vertical",pos:[yS(t.pos-o+l,.1),c],size:p,className:t.className,direction:""})}),a}function T_(t){var e=t.state,n=e.container,r=t.props.snapContainer||n;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var o=e.containerClientRect,i={left:0,top:0,bottom:0,right:0};if(n!==r){var s=WA(r,!0);if(s){var a=xA(s),l=UA(e,[a.left-o.left,a.top-o.top]),c=UA(e,[a.right-o.right,a.bottom-o.bottom]);i.left=yS(l[0],1e-5),i.top=yS(l[1],1e-5),i.right=yS(c[0],1e-5),i.bottom=yS(c[1],1e-5)}}return e.snapContainer=r,e.snapOffset=i,e.guidelines=M_(t),e.enableSnap=!0,!0}function R_(t,e,n,r,o,i){var s=lA(t,e,n,i?4:3);return EA(s,$S(o,GM(s,r)))}function N_(t){return t?t/eT(t):0}function P_(t,e,n,r,o,i){var s=function(t,e,n){var r=[];if(n)1!==eT(e[0])||1!==eT(e[1])?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var o=t[0]?t:[1,1];[1,-1].forEach(function(t){[1,-1].forEach(function(n){var i=[t*o[0],n*o[1]];e[0]===i[0]&&e[1]===i[1]||r.push([e,i])})})}else t[0]?(1===eT(e[0])?[1]:[1,-1]).forEach(function(n){r.push([[e[0],-1],[n*t[0],-1]],[[e[0],0],[n*t[0],0]],[[e[0],1],[n*t[0],1]])}):t[1]&&(1===eT(e[1])?[1]:[1,-1]).forEach(function(n){r.push([[-1,e[1]],[-1,n*t[1]]],[[0,e[1]],[0,n*t[1]]],[[1,e[1]],[1,n*t[1]]])});return r}(n,i.fixedDirection,r),a=t_(t,e,n,r),l=rM(rM([],nM(l_(t,e,s,r,o,i)),!1),nM(ZO(t,a,i)),!1),c=GO(l,0),u=GO(l,1);return{width:{isBound:c.isBound,offset:c.offset[0]},height:{isBound:u.isBound,offset:u.offset[1]}}}function L_(t,e,n,r,o,i,s,a){for(var l=CA(t.state),c=t.props.keepRatio,u=0,d=0,p=0;p<2;++p){var f=P_(t,e(u,d),o,c,s,a),h=f.width,m=f.height,g=h.isBound,v=m.isBound,y=h.offset,b=m.offset;if(1===p&&(g||(y=0),v||(b=0)),0===p&&s&&!g&&!v)return[0,0];if(c){var x=eT(y)*(n?1/n:1),w=eT(b)*(r?1/r:1);(g&&v?x<w:v||!g&&x<w)?y=n*b/r:b=r*y/n}u+=y,d+=b}if(!c&&o[0]&&o[1]){var k=function(t,e,n,r,o){var i=[-n[0],-n[1]],s=t.state,a=s.width,l=s.height,c=t.props.bounds,u=1/0,d=1/0;if(c){var p=[[n[0],-n[1]],[-n[0],n[1]]],f=c.left,h=void 0===f?-1/0:f,m=c.top,g=void 0===m?-1/0:m,v=c.right,y=void 0===v?1/0:v,b=c.bottom,x=void 0===b?1/0:b;p.forEach(function(t){var n=t[0]!==i[0],s=t[1]!==i[1],c=GM(e,t),p=360*mS(r,c)/Math.PI;if(s){var f=c.slice();(eT(p-360)<2||eT(p-180)<2)&&(f[1]=r[1]);var m=r_(r,f,(r[1]<c[1]?x:g)-c[1],!1,o),v=nM(m.offset,2)[1],b=m.isOutside;isNaN(v)||(d=l+(b?1:-1)*eT(v))}if(n){f=c.slice(),(eT(p-90)<2||eT(p-270)<2)&&(f[0]=r[0]);var w=r_(r,f,(r[0]<c[0]?y:h)-c[0],!0,o),k=nM(w.offset,1)[0],E=w.isOutside;isNaN(k)||(u=a+(E?1:-1)*eT(k))}})}return{maxWidth:u,maxHeight:d}}(t,l,o,i,a),E=k.maxWidth,C=k.maxHeight,S=nM(function(t,e,n,r,o,i,s,a,l){var c=GM(e,s),u=s_(t,a,{vertical:[c[0]],horizontal:[c[1]]}),d=u.horizontal.offset,p=u.vertical.offset;if(yS(p,SM)||yS(d,SM)){var f=nM(VM({datas:l,distX:-p,distY:-d}),2),h=f[0],m=f[1];return[Math.min(o||1/0,n+s[0]*h)-n,Math.min(i||1/0,r+s[1]*m)-r]}return[0,0]}(t,e(u,d).map(function(t){return t.map(function(t){return yS(t,SM)})}),n+u,r+d,E,C,o,s,a),2);u+=y=S[0],d+=b=S[1]}return[u,d]}function I_(t){return t<0&&(t=t%360+360),t%=360}function z_(t,e){e=I_(e);var n=Math.floor(t/360),r=360*n+360-e,o=360*n+e;return eT(t-r)<eT(t-o)?r:o}function F_(t,e){t=I_(t),e=I_(e);var n=I_(t-e);return Math.min(n,360-n)}function B_(t,e,n,r,o){if(!LO(t,"scalable"))return[0,0];var i=o.startOffsetWidth,s=o.startOffsetHeight,a=o.fixedPosition,l=o.fixedDirection,c=o.is3d,u=L_(t,function(t,n){return R_(function(t,e){var n=t.transformOrigin,r=t.offsetMatrix,o=t.is3d,i=t.targetMatrix,s=o?4:3;return UM(r,jS(t.targetAllTransform||i,eD(e,s),s),n,s)}(o,HS(e,[t/i,n/s])),i,s,l,a,c)},i,s,n,a,r,o);return[u[0]/i,u[1]/s]}function j_(t){var e=[];return t.forEach(function(t){t.guidelineInfos.forEach(function(n){var r=n.guideline;sS(e,function(t){return t.guideline===r})||(r.direction="",e.push({guideline:r,posInfo:t}))})}),e.map(function(t){var e=t.guideline,n=t.posInfo;return eM(eM({},e),{direction:n.direction})})}function H_(t,e,n,r,o,i){var s=SO(DO(t,i),e,n),a=s.vertical,l=s.horizontal,c={left:!1,top:!1,right:!1,bottom:!1};a.forEach(function(t){t.isBound&&("start"===t.direction&&(c.left=!0),"end"===t.direction&&(c.right=!0),r.push({type:"bounds",pos:t.pos}))}),l.forEach(function(t){t.isBound&&("start"===t.direction&&(c.top=!0),"end"===t.direction&&(c.bottom=!0),o.push({type:"bounds",pos:t.pos}))});var u=function(t){var e=t.props.innerBounds,n={left:!1,top:!1,right:!1,bottom:!1};if(!e)return{boundMap:n,vertical:[],horizontal:[]};var r=t.getRect(),o=[r.pos1,r.pos2,r.pos3,r.pos4],i=GM(o,[0,0]),s=e.left,a=e.top,l=e.width,c=e.height,u=[[s,a],[s,a+c]],d=[[s,a],[s+l,a]],p=[[s+l,a],[s+l,a+c]],f=[[s,a+c],[s+l,a+c]],h=t_(t,o,[0,0],!1),m=[],g=[];return h.forEach(function(t){var e=t.line,r=t.lineConstants,o=UO(i,e),h=o.horizontal,v=o.vertical,y=JO(e,r,d,v,1,!0),b=JO(e,r,f,v,1,!0),x=JO(e,r,u,h,1,!0),w=JO(e,r,p,h,1,!0);y.isBound&&!n.top&&(m.push(a),n.top=!0),b.isBound&&!n.bottom&&(m.push(a+c),n.bottom=!0),x.isBound&&!n.left&&(g.push(s),n.left=!0),w.isBound&&!n.right&&(g.push(s+l),n.right=!0)}),{boundMap:n,horizontal:m,vertical:g}}(t),d=u.boundMap,p=u.vertical,f=u.horizontal;return p.forEach(function(t){iS(r,function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t})>=0||r.push({type:"bounds",pos:t})}),f.forEach(function(t){iS(o,function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t})>=0||o.push({type:"bounds",pos:t})}),{boundMap:c,innerBoundMap:d}}var $_=VA("",["resizable","scalable"]),q_="snapRotationThreshold",V_="snapRotationDegrees",W_={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold",q_,V_,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[":host {\n--bounds-color: #d66;\n}\n.guideline {\npointer-events: none;\nz-index: 2;\n}\n.guideline.bounds {\nbackground: #d66;\nbackground: var(--bounds-color);\n}\n.guideline-group {\nposition: absolute;\ntop: 0;\nleft: 0;\n}\n.guideline-group .size-value {\nposition: absolute;\ncolor: #f55;\nfont-size: 12px;\nfont-size: calc(12px * var(--zoom));\nfont-weight: bold;\n}\n.guideline-group.horizontal .size-value {\ntransform-origin: 50% 100%;\ntransform: translateX(-50%);\nleft: 50%;\nbottom: 5px;\nbottom: calc(2px + 3px * var(--zoom));\n}\n.guideline-group.vertical .size-value {\ntransform-origin: 0% 50%;\ntop: 50%;\ntransform: translateY(-50%);\nleft: 5px;\nleft: calc(2px + 3px * var(--zoom));\n}\n.guideline.gap {\nbackground: #f55;\n}\n.size-value.gap {\ncolor: #f55;\n}\n"],render:function(t,e){var n=t.state,r=n.top,o=n.left,i=n.pos1,s=n.pos2,a=n.pos3,l=n.pos4,c=n.snapRenderInfo,u=t.props.snapRenderThreshold,d=void 0===u?1:u;if(!c||!c.render||!LO(t,""))return QA(t,"boundMap",{left:!1,top:!1,right:!1,bottom:!1},function(t){return JSON.stringify(t)}),QA(t,"innerBoundMap",{left:!1,top:!1,right:!1,bottom:!1},function(t){return JSON.stringify(t)}),[];n.guidelines=M_(t);var p=Math.min(i[0],s[0],a[0],l[0]),f=Math.min(i[1],s[1],a[1],l[1]),h=c.externalPoses||[],m=CA(t.state),g=[],v=[],y=[],b=[],x=[],w=cA(m),k=w.width,E=w.height,C=w.top,S=w.left,D=w.bottom,M=w.right,O={left:S,right:M,top:C,bottom:D,center:(S+M)/2,middle:(C+D)/2},_=h.length>0,A=_?cA(h):{};if(!c.request){if(c.direction&&x.push(VO(t,m,c.direction,d)),c.snap){var T=cA(m);c.center&&(T.middle=(T.top+T.bottom)/2,T.center=(T.left+T.right)/2),x.push(HO(t,T,d))}_&&(c.center&&(A.middle=(A.top+A.bottom)/2,A.center=(A.left+A.right)/2),x.push(HO(t,A,d))),x.forEach(function(t){var e=t.vertical.posInfos,n=t.horizontal.posInfos;g.push.apply(g,rM([],nM(e.filter(function(t){return t.guidelineInfos.some(function(t){return!t.guideline.hide})}).map(function(t){return{type:"snap",pos:t.pos}})),!1)),v.push.apply(v,rM([],nM(n.filter(function(t){return t.guidelineInfos.some(function(t){return!t.guideline.hide})}).map(function(t){return{type:"snap",pos:t.pos}})),!1)),y.push.apply(y,rM([],nM(j_(e)),!1)),b.push.apply(b,rM([],nM(j_(n)),!1))})}var R=H_(t,[S,M],[C,D],g,v),N=R.boundMap,P=R.innerBoundMap;_&&H_(t,[A.left,A.right],[A.top,A.bottom],g,v,c.externalBounds);var L=rM(rM([],nM(y),!1),nM(b),!1),I=L.filter(function(t){return t.element&&!t.gapRects}),z=L.filter(function(t){return t.gapRects}).sort(function(t,e){return t.gap-e.gap});RA(t,"onSnap",{guidelines:L.filter(function(t){return!t.element}),elements:I,gaps:z},!0);var F=QA(t,"boundMap",N,function(t){return JSON.stringify(t)},{left:!1,top:!1,right:!1,bottom:!1}),B=QA(t,"innerBoundMap",P,function(t){return JSON.stringify(t)},{left:!1,top:!1,right:!1,bottom:!1});return N!==F&&P!==B||RA(t,"onBound",{bounds:N,innerBounds:P},!0),rM(rM(rM(rM(rM(rM([],nM(D_(t,I,[p,f],O,e)),!1),nM(function(t,e,n,r,o){var i=[];return["horizontal","vertical"].forEach(function(s){var a=e.filter(function(t){return t.type===s}).slice(0,1),l="vertical"===s?0:1,c=l?0:1,u=l?PO:NO,d=l?NO:PO,p=r[u.start],f=r[u.end],h=r[d.start],m=r[d.end];a.forEach(function(e){var r=e.gap,s=e.gapRects,a=Math.max.apply(Math,rM([h],nM(s.map(function(t){return t.rect[d.start]})),!1)),g=Math.min.apply(Math,rM([m],nM(s.map(function(t){return t.rect[d.end]})),!1)),v=(a+g)/2;a!==g&&v!==(h+m)/2&&s.forEach(function(e){var s=e.rect,a=e.className,d=[n[0],n[1]];if(s[u.end]<p)d[l]+=s[u.end]-p;else{if(!(f<s[u.start]))return;d[l]+=s[u.start]-p-r}d[c]+=v-h,i.push(S_(t,l?"vertical":"horizontal","gap",i.length,r,d,a,o))})})}),i}(t,z,[p,f],O,e)),!1),nM(C_(t,"horizontal",b,[o,r],O,e)),!1),nM(C_(t,"vertical",y,[o,r],O,e)),!1),nM(E_(t,"horizontal",v,p,r,k,0,e)),!1),nM(E_(t,"vertical",g,f,o,E,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},T_(t)},drag:function(t){var e=t.state;T_(t)||(e.guidelines=M_(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){return!(!$_(t,e)&&!x_(t,e))||(!e.isRequest&&e.inputEvent?xS(e.inputEvent.target,G_("snap-control")):void 0)},dragControlStart:function(t){t.state.snapRenderInfo=null,T_(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,T_(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function G_(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return LC.apply(void 0,rM([wM],nM(t),!1))}function U_(t){t()}function Y_(t){return t&&"none"!==t?GC(t)?t:iD(t):[1,0,0,1,0,0]}function K_(t,e,n){return BS(e,nD(n,e),t,nD(n.map(function(t){return-t}),e))}function X_(t){var e=function(t){return J_(t.transformOrigin)}(NA(t,":before"));return e.map(function(e,n){var r=rS(e),o=r.value,i=r.unit;return o*function(t,e,n){return"%"===e?iA(t.ownerSVGElement)[n?"width":"height"]/100:1}(t,i,0===n)})}function J_(t){return t?t.split(" "):["0","0"]}function Z_(t){var e=fO(t)("transform");if(e&&"none"!==e)return e;if("transform"in t){var n=t.transform.baseVal;if(!n)return"";var r=n.length;if(!r)return"";for(var o=[],i=function(t){var e=n[t].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(t){return e[t]}).join(", "),")"))},s=0;s<r;++s)i(s);return o.join(" ")}return""}function Q_(t,e,n,r,o){var i,s,a,l,c=DS(t)||MS(t),u=!1;if(!t||n)a=t;else{var d=null===(i=null==t?void 0:t.assignedSlot)||void 0===i?void 0:i.parentElement,p=t.parentElement;d?(u=!0,l=p,a=d):a=p}for(var f=!1,h=t===e||a===e,m="relative",g=1,v=parseFloat(null==o?void 0:o("zoom"))||1,y=null==o?void 0:o("position");a&&a!==c;){e===a&&(h=!0);var b=fO(a),x=a.tagName.toLowerCase(),w=Z_(a),k=b("willChange"),E=parseFloat(b("zoom"))||1;if(m=b("position"),r&&1!==E){g=E;break}if(!n&&r&&1!==v&&y&&"absolute"!==y||"svg"===x||"static"!==m||w&&"none"!==w||"transform"===k)break;var C=null===(s=null==t?void 0:t.assignedSlot)||void 0===s?void 0:s.parentNode,S=a.parentNode;C&&(u=!0,l=S);var D=S;if(D&&11===D.nodeType){f=!0,m=fO(a=D.host)("position");break}a=D,m="relative"}return{offsetZoom:g,hasSlot:u,parentSlotElement:l,isCustomElement:f,isStatic:"static"===m,isEnd:h||!a||a===c,offsetParent:a||c}}function tA(t,e){var n,r,o,i=t.tagName.toLowerCase(),s=t.offsetLeft,a=t.offsetTop,l=fO(t),c=WC(s),u=!c;return u||"svg"===i?o=(r=J_(l("transformOrigin")).map(function(t){return parseFloat(t)})).slice():(o=(r=pM?X_(t):J_(l("transformOrigin")).map(function(t){return parseFloat(t)})).slice(),u=!0,n=nM(function(t,e,n){if(!t.getBBox||!n&&"g"===t.tagName.toLowerCase())return[0,0,0,0];var r=fO(t),o="fill-box"===r("transform-box"),i=t.getBBox(),s=iA(t.ownerSVGElement),a=i.x-s.x,l=i.y-s.y,c=o?e[0]:e[0]-a,u=o?e[1]:e[1]-l;return[a,l,c,u]}(t,r,t===e&&"g"===e.tagName.toLowerCase()),4),s=n[0],a=n[1],r[0]=n[2],r[1]=n[3]),{tagName:i,isSVG:c,hasOffset:u,offset:[s||0,a||0],origin:r,targetOrigin:o}}function eA(t,e){var n=fO(t),r=fO(MS(t)),o=r("position");if(!(e||o&&"static"!==o))return[0,0];var i=parseInt(r("marginLeft"),10),s=parseInt(r("marginTop"),10);return"absolute"===n("position")&&("auto"===n("top")&&"auto"===n("bottom")||(s=0),"auto"===n("left")&&"auto"===n("right")||(i=0)),[i,s]}function nA(t){t.forEach(function(t){var e=t.matrix;e&&(t.matrix=FS(e,3,4))})}function rA(t){for(var e=t.parentElement,n=!1,r=MS(t);e;){var o=NA(e).transform;if(o&&"none"!==o){n=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:n}}function oA(t,e){return void 0===e&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(VS(t,!e).join(","),")")}function iA(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,o=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:o.x,y:o.y,width:o.width||e,height:o.height||n,clientWidth:e,clientHeight:n}}function sA(t,e){var n,r=iA(t),o=r.width,i=r.height,s=r.clientWidth,a=r.clientHeight,l=s/o,c=a/i,u=t.preserveAspectRatio.baseVal,d=u.align,p=u.meetOrSlice,f=[0,0],h=[l,c],m=[0,0];if(1!==d){var g=(d-2)%3,v=Math.floor((d-2)/3);f[0]=o*g/2,f[1]=i*v/2;var y=2===p?Math.max(c,l):Math.min(l,c);h[0]=y,h[1]=y,m[0]=(s-o)/2*g,m[1]=(a-i)/2*v}var b=eD(h,e);return n=nM(m,2),b[e*(e-1)]=n[0],b[e*(e-1)+1]=n[1],K_(b,e,f)}function aA(t,e,n){return WS(t,zS(e,n),n)}function lA(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map(function(e){return aA(t,e,r)})}function cA(t){var e=t.map(function(t){return t[0]}),n=t.map(function(t){return t[1]}),r=Math.min.apply(Math,rM([],nM(e),!1)),o=Math.min.apply(Math,rM([],nM(n),!1)),i=Math.max.apply(Math,rM([],nM(e),!1)),s=Math.max.apply(Math,rM([],nM(n),!1));return{left:r,top:o,right:i,bottom:s,width:i-r,height:s-o}}function uA(t,e,n,r){return cA(lA(t,e,n,r))}function dA(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function pA(t,e){return dA([e[0]-t[0],e[1]-t[1]])}function fA(t,e,n,r){void 0===n&&(n=1),void 0===r&&(r=mS(t,e));var o=pA(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(o,"px")}}function hA(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=n.length,i=n.reduce(function(t,e){return t+e[0]},0)/o,s=n.reduce(function(t,e){return t+e[1]},0)/o;return{transform:"translateZ(0px) translate(".concat(i,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function mA(t,e){var n=t[e];return GC(n)?eM(eM({},t),n):t}function gA(t){var e=t&&!WC(t.offsetWidth),n=0,r=0,o=0,i=0,s=0,a=0,l=0,c=0,u=0,d=0,p=0,f=0,h=1/0,m=1/0,g=1/0,v=1/0,y=0,b=0,x=!1;if(t)if(e||"svg"===t.tagName.toLowerCase()){var w=fO(t),k=t.style,E="border-box"===w("boxSizing"),C=parseFloat(w("borderLeftWidth"))||0,S=parseFloat(w("borderRightWidth"))||0,D=parseFloat(w("borderTopWidth"))||0,M=parseFloat(w("borderBottomWidth"))||0,O=(parseFloat(w("paddingLeft"))||0)+(parseFloat(w("paddingRight"))||0),_=(parseFloat(w("paddingTop"))||0)+(parseFloat(w("paddingBottom"))||0),A=O+(C+S),T=_+(D+M),R=w("position"),N=0,P=0;if("clientLeft"in t){var L=null;if("absolute"===R)L=Q_(t,MS(t)).offsetParent;else L=t.parentElement;if(L){var I=fO(L);N=parseFloat(I("width")),P=parseFloat(I("height"))}}u=Math.max(O,uS(w("minWidth"),N)||0),d=Math.max(_,uS(w("minHeight"),P)||0),h=uS(w("maxWidth"),N),m=uS(w("maxHeight"),P),isNaN(h)&&(h=1/0),isNaN(m)&&(m=1/0),y=uS(k.width,0)||0,b=uS(k.height,0)||0,s=parseFloat(w("width"))||0,a=parseFloat(w("height"))||0,n=l=eT(s-y)<1?dS(u,y||s,h):s,r=c=eT(a-b)<1?dS(d,b||a,m):a,o=l,i=c,E?(g=h,v=m,p=u,f=d,l=n-A,c=r-T):(g=h+A,v=m+T,p=u+A,f=d+T,n=l+A,r=c+T),o=l+O,i=c+_}else{var z=t.getBBox();x=!0,s=n=z.width,a=r=z.height,l=n,c=r,o=n,i=r}return{svg:x,offsetWidth:n,offsetHeight:r,clientWidth:o,clientHeight:i,contentWidth:l,contentHeight:c,inlineCSSWidth:y,inlineCSSHeight:b,cssWidth:s,cssHeight:a,minWidth:u,minHeight:d,maxWidth:h,maxHeight:m,minOffsetWidth:p,minOffsetHeight:f,maxOffsetWidth:g,maxOffsetHeight:v}}function vA(t,e){return mS(e>0?t[0]:t[1],e>0?t[1]:t[0])}function yA(t,e){var n=t===MS(t)||t===DS(t),r={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow="visible"!==fO(t)("overflow"),eM(eM({},e),r)}function bA(t,e,n,r){var o=t.left,i=t.right,s=t.top,a=t.bottom,l=e.top,c=e.left,u={left:c+o,top:l+s,right:c+i,bottom:l+a,width:i-o,height:a-s};return n&&r?yA(n,u):u}function xA(t,e){var n=0,r=0,o=0,i=0;if(t){var s=t.getBoundingClientRect();n=s.left,r=s.top,o=s.width,i=s.height}var a={left:n,top:r,width:o,height:i,right:n+o,bottom:r+i};return t&&e?yA(t,a):a}function wA(t,e,n,r){var o;if(t)o=t;else if(e)o=[0,0];else{o=kA(n.target,r)}return o}function kA(t,e){if(t){var n=t.getAttribute("data-rotation")||"",r=t.getAttribute("data-direction");if(e.deg=n,r){var o=[0,0];return r.indexOf("w")>-1&&(o[0]=-1),r.indexOf("e")>-1&&(o[0]=1),r.indexOf("n")>-1&&(o[1]=-1),r.indexOf("s")>-1&&(o[1]=1),o}}}function EA(t,e){return[HS(e,t[0]),HS(e,t[1]),HS(e,t[2]),HS(e,t[3])]}function CA(t){var e=t.left,n=t.top;return EA([t.pos1,t.pos2,t.pos3,t.pos4],[e,n])}function SA(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(e){e.unset&&e.unset(t)})}function DA(t,e){var n=e?"controlGesto":"targetGesto",r=t[n];!1===(null==r?void 0:r.isIdle())&&SA(t,e),null==r||r.unset(),t[n]=null}function MA(t,e){if(e){var n=ZM(e);n.nextStyle=eM(eM({},n.nextStyle),t)}return{style:t,cssText:cS(t).map(function(e){return"".concat((n=e,r="-",n.replace(/([a-z])([A-Z])/g,function(t,e,n){return""+e+r+n.toLowerCase()})),": ").concat(t[e],";");var n,r}).join("")}}function OA(t,e,n){var r=e.afterTransform||e.transform;return eM(eM({},MA(eM(eM(eM({},t.style),e.style),{transform:r}),n)),{afterTransform:r,transform:t.transform})}function _A(t,e,n,r){var o=e.datas;o.datas||(o.datas={});var i=eM(eM({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:o.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:!1!==e.isTrusted,stopAble:function(){o.isEventStart=!1},stopDrag:function(){var t;null===(t=e.stop)||void 0===t||t.call(e)}});return o.isStartEvent?r||(o.lastEvent=i):o.isStartEvent=!0,i}function AA(t,e,n){var r=e.datas,o="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),eM(eM({isDrag:o},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function TA(t,e,n){t._emitter.on(e,n)}function RA(t,e,n,r,o){return t.triggerEvent(e,n,r,o)}function NA(t,e){return OS(t).getComputedStyle(t,e)}function PA(t,e,n){var r={},o={};return t.filter(function(t){var i=t.name;if(r[i]||!e.some(function(e){return t[e]}))return!1;if(!n&&t.ableGroup){if(o[t.ableGroup])return!1;o[t.ableGroup]=!0}return r[i]=!0,!0})}function LA(t,e){return t===e||null==t&&null==e}function IA(t,e){var n=[],r=[];return t.forEach(function(o,i){var s=e(o,i,t),a=r.indexOf(s),l=n[a]||[];-1===a&&(r.push(s),n.push(l)),l.push(o)}),n}function zA(t){return t.reduce(function(t,e){return t.concat(e)},[])}function FA(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(t,e){return eT(e)-eT(t)}),t[0]}function BA(t,e,n){return WS(LS(t,n),zS(e,n),n)}function jA(t,e,n,r){if(!n[0]&&!n[1])return e;var o=aA(t,[N_(n[0]),0],r),i=aA(t,[0,N_(n[1])],r);return HS(e,aA(t,[n[0]/dA(o),n[1]/dA(i)],r))}function HA(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function $A(t){return eT(t)<=DM?0:t}function qA(t){return function(e){if(!e.isDragging(t))return"";var n=function(t,e){var n,r=t.targetGesto,o=t.controlGesto;return(null==r?void 0:r.isFlag())&&(n=r.getEventData()[e]),!n&&(null==o?void 0:o.isFlag())&&(n=o.getEventData()[e]),n||{}}(e,t),r=n.deg;return r?G_("view-control-rotation".concat(r)):""}}function VA(t,e){return void 0===e&&(e=[t]),function(n,r){if(r.isRequest)return!!e.some(function(t){return r.requestAble===t})&&r.parentDirection;var o=r.inputEvent.target;return xS(o,G_("direction"))&&(!t||xS(o,G_(t)))}}function WA(t,e){return t?AS(t)?t:YC(t)?e?document.querySelector(t):t:XC(t)?t():_S(t)?t:"current"in t?t.current:t:null}function GA(t,e){return t?((n=t)&&GC(n)&&!AS(n)&&(UC(n)||"length"in n)?[].slice.call(t):[t]).reduce(function(t,n){return YC(n)&&e?rM(rM([],nM(t),!1),nM([].slice.call(document.querySelectorAll(n))),!1):(UC(n)?t.push(GA(n,e)):t.push(WA(n,e)),t)},[]):[];var n}function UA(t,e){var n=t.rootMatrix,r=t.is3d,o=LS(n,r?4:3);return r||(o=FS(o,3,4)),o[12]=0,o[13]=0,o[14]=0,function(t,e){var n=WS(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}(o,e)}function YA(t,e,n,r,o){var i=nM(t,2),s=i[0],a=i[1],l=0,c=0;if(o&&s&&a){var u=mS([0,0],e),d=mS([0,0],r),p=dA(e),f=Math.cos(u-d)*p;if(r[0])if(r[1]){var h=r[0]*s,m=r[1]*a,g=Math.atan2(h+e[0],m+e[1]),v=Math.atan2(h,m);g<0&&(g+=2*Math.PI),v<0&&(v+=2*Math.PI);var y=0;(y=eT(g-v)<Math.PI/2||eT(g-v)>Math.PI/2*3?g-v:g-(v+=Math.PI))>2*Math.PI?y-=2*Math.PI:y>Math.PI?y=2*Math.PI-y:y<-Math.PI&&(y=-2*Math.PI-y);var b=dA([h+e[0],m+e[1]])*Math.cos(y);l=b*Math.sin(v)-h,c=b*Math.cos(v)-m,r[0]<0&&(l*=-1),r[1]<0&&(c*=-1)}else c=(l=f)/n;else l=(c=f)*n}else l=r[0]*e[0],c=r[1]*e[1];return[l,c]}function KA(t,e,n,r){var o,i=n.ratio,s=n.startOffsetWidth,a=n.startOffsetHeight,l=0,c=0,u=r.distX,d=r.distY,p=r.pinchScale,f=r.parentDistance,h=r.parentDist,m=r.parentScale,g=n.fixedDirection,v=[0,1].map(function(e){return eT(t[e]-g[e])}),y=[0,1].map(function(t){var e=v[t];return 0!==e&&(e=2/e),e});if(h)l=h[0],c=h[1],e&&(l?c||(c=l/i):l=c*i);else if(KC(p))l=(p-1)*s,c=(p-1)*a;else if(m)l=(m[0]-1)*s,c=(m[1]-1)*a;else if(f){var b=s*v[0],x=a*v[1],w=dA([b,x]);l=f/w*b*y[0],c=f/w*x*y[1]}else{var k=VM({datas:n,distX:u,distY:d});k=y.map(function(t,e){return k[e]*t}),l=(o=nM(YA([s,a],k,i,t,e),2))[0],c=o[1]}return{distWidth:l,distHeight:c}}function XA(t,e){if(e){if("left"===t)return{x:"0%",y:"50%"};if("top"===t)return{x:"50%",y:"50%"};if("center"===t)return{x:"50%",y:"50%"};if("right"===t)return{x:"100%",y:"50%"};if("bottom"===t)return{x:"50%",y:"100%"};var n=nM(t.split(" "),2),r=n[0],o=n[1],i=XA(r||""),s=XA(o||""),a=eM(eM({},i),s),l={x:"50%",y:"50%"};return a.x&&(l.x=a.x),a.y&&(l.y=a.y),a.value&&(a.x&&!a.y&&(l.y=a.value),!a.x&&a.y&&(l.x=a.value)),l}return"left"===t?{x:"0%"}:"right"===t?{x:"100%"}:"top"===t?{y:"0%"}:"bottom"===t?{y:"100%"}:t?"center"===t?{value:"50%"}:{value:t}:{}}function JA(t,e,n){var r=XA(t,!0),o=r.x,i=r.y;return[uS(o,e)||0,uS(i,n)||0]}function ZA(t,e){return t.length===e.length&&t.every(function(t,n){var r=e[n],o=UC(t),i=UC(r);return o&&i?ZA(t,r):!o&&!i&&t===r})}function QA(t,e,n,r,o){var i=t._store,s=i[e];if(!(e in i)){if(null==o)return i[e]=n,n;i[e]=o,s=o}return s===n||r(s)===r(n)?s:(i[e]=n,n)}function tT(t){return t>=0?1:-1}function eT(t){return Math.abs(t)}function nT(t,e){return function(t){for(var e=[],n=0;n<t;++n)e.push(n);return e}(t).map(function(t){return e(t)})}function rT(t){return KC(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var oT=oM("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,o=e.angle,i=e.originalDatas,s=t.props,a=s.pinchable,l=s.ables;if(!a)return!1;var c="onPinch".concat(r?"Group":"","Start"),u="drag".concat(r?"Group":"","ControlStart"),d=(!0===a?t.controlAbles:l.filter(function(t){return a.indexOf(t.name)>-1})).filter(function(t){return t.canPinch&&t[u]}),p=_A(t,e,{});r&&(p.targets=r);var f=RA(t,c,p);n.isPinch=!1!==f,n.ables=d;var h=n.isPinch;return!!h&&(d.forEach(function(n){if(i[n.name]=i[n.name]||{},n[u]){var r=eM(eM({},e),{datas:i[n.name],parentRotate:o,isPinch:!0});n[u](t,r)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},h)},pinch:function(t,e){var n=e.datas,r=e.scale,o=e.distance,i=e.originalDatas,s=e.inputEvent,a=e.targets,l=e.angle;if(n.isPinch){var c=o*(1-1/r),u=_A(t,e,{});a&&(u.targets=a);var d="onPinch".concat(a?"Group":"");RA(t,d,u);var p=n.ables,f="drag".concat(a?"Group":"","Control");return p.forEach(function(n){n[f]&&n[f](t,eM(eM({},e),{datas:i[n.name],inputEvent:s,resolveMatrix:!0,pinchScale:r,parentDistance:c,parentRotate:l,isPinch:!0}))}),u}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,o=e.inputEvent,i=e.targets,s=e.originalDatas;if(n.isPinch){var a="onPinch".concat(i?"Group":"","End"),l=AA(t,e,{isDrag:r});i&&(l.targets=i),RA(t,a,l);var c=n.ables,u="drag".concat(i?"Group":"","ControlEnd");return c.forEach(function(n){n[u]&&n[u](t,eM(eM({},e),{isDrag:r,datas:s[n.name],inputEvent:o,isPinch:!0}))}),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,eM(eM({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,eM(eM({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,eM(eM({},e),{targets:t.props.targets}))}}),iT=VA("scalable"),sT={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:kO("scalable"),dragControlCondition:iT,viewClassName:qA("scalable"),dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,o=e.inputEvent,i=wA(e.parentDirection,r,o,n),s=t.state,a=s.width,l=s.height,c=s.targetTransform,u=s.target,d=s.pos1,p=s.pos2,f=s.pos4;if(!i||!u)return!1;r||FM(t,e),n.datas={},n.transform=c,n.prevDist=[1,1],n.direction=i,n.startOffsetWidth=a,n.startOffsetHeight=l,n.startValue=[1,1];var h=!i[0]&&!i[1]||i[0]||!i[1];function m(t){n.ratio=t&&isFinite(t)?t:0}function g(t){var e=d_(n.startPositions,t);n.fixedDirection=e.fixedDirection,n.fixedPosition=e.fixedPosition,n.fixedOffset=e.fixedOffset}KM(t,e,"scale"),n.isWidth=h,n.startPositions=CA(t.state),n.setFixedDirection=g,m(vS(d,p)/vS(p,f)),g([-i[0],-i[1]]);var v=function(t){n.minScaleSize=t},y=function(t){n.maxScaleSize=t};v([-1/0,-1/0]),y([1/0,1/0]);var b=_A(t,e,eM(eM({direction:i,set:function(t){n.startValue=t},setRatio:m,setFixedDirection:g,setMinScaleSize:v,setMaxScaleSize:y},YM(t,e)),{dragStart:u_.dragStart(t,(new LM).dragStart([0,0],e))})),x=RA(t,"onScaleStart",b);return n.startFixedDirection=n.fixedDirection,!1!==x&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:i}),!!n.isScale&&b},dragControl:function(t,e){BM(t,e,"scale");var n=e.datas,r=e.parentKeepRatio,o=e.parentFlag,i=e.isPinch,s=e.dragClient,a=e.isRequest,l=e.useSnap,c=e.resolveMatrix,u=n.prevDist,d=n.direction,p=n.startOffsetWidth,f=n.startOffsetHeight,h=n.isScale,m=n.startValue,g=n.isWidth,v=n.ratio;if(!h)return!1;var y=t.props,b=y.throttleScale,x=y.parentMoveable,w=d;d[0]||d[1]||(w=[1,1]);var k=v&&(null!=r?r:y.keepRatio)||!1,E=t.state,C=[m[0],m[1]];function S(){var t=KA(w,k,n,e),r=t.distWidth,o=t.distHeight,i=p?(p+r)/p:1,s=f?(f+o)/f:1;m[0]||(C[0]=r/p),m[1]||(C[1]=o/f);var a=(w[0]||k?i:1)*C[0],l=(w[1]||k?s:1)*C[1];return 0===a&&(a=tT(u[0])*MM),0===l&&(l=tT(u[1])*MM),[a,l]}var D=S();if(!i&&t.props.groupable){var M=(E.snapRenderInfo||{}).direction;UC(M)&&(M[0]||M[1])&&(E.snapRenderInfo={direction:d,request:e.isRequest})}RA(t,"onBeforeScale",_A(t,e,{scale:D,setFixedDirection:function(t){return n.setFixedDirection(t),D=S()},startFixedDirection:n.startFixedDirection,setScale:function(t){D=t}},!0));var O,_,A=[D[0]/C[0],D[1]/C[1]],T=s,R=[0,0],N=!s&&!o&&i;if(N||c?T=rO(t,n.targetAllTransform,[0,0],[0,0],n):s||(T=n.fixedPosition),i||(R=B_(t,A,d,!l&&a,n)),k){w[0]&&w[1]&&R[0]&&R[1]&&(Math.abs(R[0]*p)>Math.abs(R[1]*f)?R[1]=0:R[0]=0);var P=!R[0]&&!R[1];if(P&&(g?A[0]=yS(A[0]*C[0],b)/C[0]:A[1]=yS(A[1]*C[1],b)/C[1]),w[0]&&!w[1]||R[0]&&!R[1]||P&&g){A[0]+=R[0];var L=p*A[0]*C[0]/v;A[1]=L/f/C[1]}else if(!w[0]&&w[1]||!R[0]&&R[1]||P&&!g){A[1]+=R[1];var I=f*A[1]*C[1]*v;A[0]=I/p/C[0]}}else A[0]+=R[0],A[1]+=R[1],R[0]||(A[0]=yS(A[0]*C[0],b)/C[0]),R[1]||(A[1]=yS(A[1]*C[1],b)/C[1]);0===A[0]&&(A[0]=tT(u[0])*MM),0===A[1]&&(A[1]=tT(u[1])*MM),O=A,_=[C[0],C[1]],D=[O[0]*_[0],O[1]*_[1]];var z=[p,f],F=[p*D[0],f*D[1]];F=fS(F,n.minScaleSize,n.maxScaleSize,!!k&&v),D=nT(2,function(t){return z[t]?F[t]/z[t]:F[t]}),A=nT(2,function(t){return D[t]/C[t]});var B=nT(2,function(t){return u[t]?A[t]/u[t]:A[t]}),j="scale(".concat(A.join(", "),")"),H="scale(".concat(D.join(", "),")"),$=jM(n,H,j),q=!m[0]||!m[1],V=function(t,e,n,r,o,i,s){return oO(t,e,n,r,o,i,s)}(t,q?H:j,n.fixedDirection,T,n.fixedOffset,n,q),W=N?V:$S(V,n.prevInverseDist||[0,0]);if(n.prevDist=A,n.prevInverseDist=V,D[0]===u[0]&&D[1]===u[1]&&W.every(function(t){return!t})&&!x&&!N)return!1;var G=_A(t,e,eM({offsetWidth:p,offsetHeight:f,direction:d,scale:D,dist:A,delta:B,isPinch:!!i},nO(t,$,W,i,e)));return RA(t,"onScale",G),G},dragControlEnd:function(t,e){var n=e.datas;if(!n.isScale)return!1;n.isScale=!1;var r=AA(t,e,{});return RA(t,"onScaleEnd",r),r},dragGroupControlCondition:iT,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var o=hO(t,"resizable",e);n.moveableScale=t.scale;var i=gO(t,this,"dragControlStart",e,function(e,r){return vO(t,e,n,r)}),s=function(e){r.setFixedDirection(e),i.forEach(function(r,i){r.setFixedDirection(e),vO(t,r.moveable,n,o[i])})};n.setFixedDirection=s;var a=eM(eM({},r),{targets:t.props.targets,events:i,setFixedDirection:s}),l=RA(t,"onScaleGroupStart",a);return n.isScale=!1!==l,!!n.isScale&&a},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){TA(t,"onBeforeScale",function(n){RA(t,"onBeforeScaleGroup",_A(t,e,eM(eM({},n),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var o=r.dist,i=n.moveableScale;t.scale=[o[0]*i[0],o[1]*i[1]];var s=t.props.keepRatio,a=n.fixedPosition,l=gO(t,this,"dragControl",e,function(e,n){var r=nM(WS(QS(t.rotation/180*Math.PI,3),[n.datas.originalX*o[0],n.datas.originalY*o[1],1],3),2),i=r[0],l=r[1];return eM(eM({},n),{parentDist:null,parentScale:o,parentKeepRatio:s,dragClient:HS(a,[i,l])})}),c=eM({targets:t.props.targets,events:l},r);return RA(t,"onScaleGroup",c),c}}},dragGroupControlEnd:function(t,e){var n=e.isDrag;if(e.datas.isScale){this.dragControlEnd(t,e);var r=gO(t,this,"dragControlEnd",e);return RA(t,"onScaleGroupEnd",AA(t,e,{targets:t.props.targets,events:r})),n}},request:function(){var t={},e=0,n=0,r=!1;return{isControl:!0,requestStart:function(e){return r=e.useSnap,{datas:t,parentDirection:e.direction||[1,1],useSnap:r}},request:function(o){return e+=o.deltaWidth,n+=o.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:o.keepRatio,useSnap:r}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:r}}}}};function aT(t,e){return t.map(function(t,n){return VC(t,e[n],1,2)})}function lT(t,e,n){var r=mS(t,e),o=mS(t,n)-r;return o>=0?o:o+2*Math.PI}var cT={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:qA("warpable"),render:function(t,e){var n=t.props,r=n.resizable,o=n.scalable,i=n.warpable,s=n.zoom;if(r||o||!i)return[];var a=t.state,l=a.pos1,c=a.pos2,u=a.pos3,d=a.pos4,p=aT(l,c),f=aT(c,l),h=aT(l,u),m=aT(u,l),g=aT(u,d),v=aT(d,u),y=aT(c,d),b=aT(d,c);return rM([e.createElement("div",{className:G_("line"),key:"middeLine1",style:fA(p,g,s)}),e.createElement("div",{className:G_("line"),key:"middeLine2",style:fA(f,v,s)}),e.createElement("div",{className:G_("line"),key:"middeLine3",style:fA(h,y,s)}),e.createElement("div",{className:G_("line"),key:"middeLine4",style:fA(m,b,s)})],nM(EO(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var n=e.inputEvent.target;return xS(n,G_("direction"))&&xS(n,G_("warpable"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,o=t.props.target,i=kA(r.target,n);if(!i||!o)return!1;var s=t.state,a=s.transformOrigin,l=s.is3d,c=s.targetTransform,u=s.targetMatrix,d=s.width,p=s.height,f=s.left,h=s.top;return n.datas={},n.targetTransform=c,n.warpTargetMatrix=l?u:FS(u,3,4),n.targetInverseMatrix=PS(LS(n.warpTargetMatrix,4),3,4),n.direction=i,n.left=f,n.top=h,n.poses=[[0,0],[d,0],[0,p],[d,p]].map(function(t){return $S(t,a)}),n.nextPoses=n.poses.map(function(t){var e=nM(t,2),r=e[0],o=e[1];return WS(n.warpTargetMatrix,[r,o,0,1],4)}),n.startValue=tD(4),n.prevMatrix=tD(4),n.absolutePoses=CA(s),n.posIndexes=WM(i),FM(t,e),KM(t,e,"matrix3d"),s.snapRenderInfo={request:e.isRequest,direction:i},!1!==RA(t,"onWarpStart",_A(t,e,eM({set:function(t){n.startValue=t}},YM(t,e))))&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,o=e.distX,i=e.distY,s=n.targetInverseMatrix,a=n.prevMatrix,l=n.isWarp,c=n.startValue,u=n.poses,d=n.posIndexes,p=n.absolutePoses;if(!l)return!1;if(BM(t,e,"matrix3d"),LO(t,"warpable")){var f=d.map(function(t){return p[t]});f.length>1&&f.push([(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]);var h=s_(t,r,{horizontal:f.map(function(t){return t[1]+i}),vertical:f.map(function(t){return t[0]+o})}),m=h.horizontal,g=h.vertical;i-=m.offset,o-=g.offset}var v=VM({datas:n,distX:o,distY:i},!0),y=n.nextPoses.slice();if(d.forEach(function(t){y[t]=HS(y[t],v)}),!CM.every(function(t){return e=t.map(function(t){return u[t]}),n=t.map(function(t){return y[t]}),r=lT(e[0],e[1],e[2]),o=lT(n[0],n[1],n[2]),i=Math.PI,!(r>=i&&o<=i||r<=i&&o>=i);var e,n,r,o,i}))return!1;var b=rD(u[0],u[2],u[1],u[3],y[0],y[2],y[1],y[3]);if(!b.length)return!1;var x=$M(n,jS(s,b,4),!0),w=jS(LS(a,4),x,4);n.prevMatrix=x;var k=jS(c,x,4),E=jM(n,"matrix3d(".concat(k.join(", "),")"),"matrix3d(".concat(x.join(", "),")"));return JM(e,E),RA(t,"onWarp",_A(t,e,eM({delta:w,matrix:k,dist:x,multiply:jS,transform:E},MA({transform:E},e)))),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isWarp&&(n.isWarp=!1,RA(t,"onWarpEnd",AA(t,e,{})),r)}},uT=G_("area-pieces"),dT=G_("area-piece"),pT=G_("avoid"),fT=G_("view-dragging");function hT(t){var e=t.areaElement;if(e){var n=t.state,r=n.width,o=n.height;kS(e,pT),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(o,"px")}}function mT(t){return t.createElement("div",{key:"area_pieces",className:uT},t.createElement("div",{className:dT}),t.createElement("div",{className:dT}),t.createElement("div",{className:dT}),t.createElement("div",{className:dT}))}var gT={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var n=t.props,r=n.target,o=n.dragArea,i=n.groupable,s=n.passDragArea,a=t.getState(),l=a.width,c=a.height,u=a.renderPoses,d=s?G_("area","pass"):G_("area");if(i)return[e.createElement("div",{key:"area",ref:IC(t,"areaElement"),className:d}),mT(e)];if(!r||!o)return[];var p=rD([0,0],[l,0],[0,c],[l,c],u[0],u[1],u[2],u[3]),f=p.length?oA(p,!0):"none";return[e.createElement("div",{key:"area",ref:IC(t,"areaElement"),className:d,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(c,"px"),transformOrigin:"0 0",transform:f}}),mT(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,o=e.clientY;if(!e.inputEvent)return!1;n.isDragArea=!1;var i=t.areaElement,s=t.state,a=s.moveableClientRect,l=s.renderPoses,c=s.rootMatrix,u=s.is3d,d=a.left,p=a.top,f=cA(l),h=f.left,m=f.top,g=f.width,v=f.height,y=nM(BA(c,[r-d,o-p],u?4:3),2),b=y[0],x=y[1],w=[{left:h,top:m,width:g,height:(x-=m)-10},{left:h,top:m,width:(b-=h)-10,height:v},{left:h,top:m+x+10,width:g,height:v-x-10},{left:h+b+10,top:m,width:g-b-10,height:v}],k=[].slice.call(i.nextElementSibling.children);w.forEach(function(t,e){k[e].style.cssText="left: ".concat(t.left,"px;top: ").concat(t.top,"px; width: ").concat(t.width,"px; height: ").concat(t.height,"px;")}),wS(i,pT),s.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,hT(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||hT(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){hT(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&aS(function(){e.disableNativeEvent=!1})}},vT=oM("origin",{props:["origin","svgOrigin"],render:function(t,e){var n,r=t.props,o=r.zoom,i=r.svgOrigin,s=r.groupable,a=t.getState(),l=a.beforeOrigin,c=a.rotation,u=a.svg,d=a.allMatrix,p=a.is3d,f=a.left,h=a.top,m=a.offsetWidth,g=a.offsetHeight;if(!s&&u&&i){var v=nM(JA(i,m,g),2);n=hA(c,o,$S(aA(d,[v[0],v[1]],p?4:3),[f,h]))}else n=hA(c,o,l);return[e.createElement("div",{className:G_("control","origin"),style:n,key:"beforeOrigin"})]}});function yT(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var bT={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var n=t.props,r=n.scrollContainer,o=void 0===r?t.getContainer():r,i=n.scrollOptions,s=new DD,a=WA(o,!0);e.datas.dragScroll=s,t.state.dragScroll=s;var l=e.isControl?"controlGesto":"targetGesto",c=e.targets;s.on("scroll",function(n){var r=n.container,o=n.direction,i=_A(t,e,{scrollContainer:r,direction:o}),s=c?"onScrollGroup":"onScroll";c&&(i.targets=c),RA(t,s,i)}).on("move",function(e){var n=e.offsetX,r=e.offsetY,o=e.inputEvent;t[l].scrollBy(n,r,o.inputEvent,!1)}).on("scrollDrag",function(e){(0,e.next)(t[l].getCurrentEvent())}),s.dragStart(e,eM({container:a},i))},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,o=r.scrollContainer,i=void 0===o?t.getContainer():o,s=r.scrollThreshold,a=void 0===s?0:s,l=r.scrollThrottleTime,c=void 0===l?0:l,u=r.getScrollPosition,d=void 0===u?yT:u,p=r.scrollOptions;return n.drag(e,eM({container:i,threshold:a,throttleTime:c,getScrollPosition:function(t){return d({scrollContainer:t.container,direction:t.direction})}},p)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,eM(eM({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,eM(eM({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,eM(eM({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,eM(eM({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,eM(eM({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,eM(eM({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,eM(eM({},e),{targets:t.props.targets}))},unset:function(t){var e,n=t.state;null===(e=n.dragScroll)||void 0===e||e.dragEnd(),n.dragScroll=null}},xT={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","requestStyles"],events:["changeTargets"]},wT=oM("padding",{props:["padding"],render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=rT(n.padding||{}),o=r.left,i=r.top,s=r.right,a=r.bottom,l=t.getState(),c=l.renderPoses,u=[l.pos1,l.pos2,l.pos3,l.pos4],d=[];return o>0&&d.push([0,2]),i>0&&d.push([0,1]),s>0&&d.push([1,3]),a>0&&d.push([2,3]),d.map(function(t,n){var r=nM(t,2),o=r[0],i=r[1],s=rD([0,0],[100,0],[0,100],[100,100],u[o],u[i],c[o],c[i]);if(s.length)return e.createElement("div",{key:"padding".concat(n),className:G_("padding"),style:{transform:oA(s,!0)}})})}}),kT=["nw","ne","se","sw"];function ET(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var CT=[1,2,5,6],ST=[0,3,4,7],DT=[1,-1,-1,1],MT=[1,1,-1,-1];function OT(t,e,n,r,o,i,s,a){void 0===o&&(o=0),void 0===i&&(i=0),void 0===s&&(s=n),void 0===a&&(a=r);var l=[],c=!1,u=t.filter(function(t){return!t.virtual}),d=u.map(function(t){var u=t.horizontal,d=t.vertical,p=t.pos;if(d&&!c&&(c=!0,l.push("/")),c){var f=Math.max(0,1===d?p[1]-i:a-p[1]);return l.push(HA(f,r,e)),f}f=Math.max(0,1===u?p[0]-o:s-p[0]);return l.push(HA(f,n,e)),f});return{radiusPoses:u,styles:l,raws:d}}function _T(t){for(var e=[0,0],n=[0,0],r=t.length,o=0;o<r;++o){var i=t[o];i.sub&&(i.horizontal&&(0===e[1]&&(e[0]=o),e[1]=o-e[0]+1,n[0]=o+1),i.vertical&&(0===n[1]&&(n[0]=o),n[1]=o-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function AT(t,e,n,r,o,i,s){var a,l,c,u;void 0===i&&(i=[0,0]),void 0===s&&(s=!1);var d=t.indexOf("/"),p=(d>-1?t.slice(0,d):t).length,f=t.slice(0,p),h=t.slice(p+1),m=f.length,g=h.length,v=g>0,y=nM(f,4),b=y[0],x=void 0===b?"0px":b,w=y[1],k=void 0===w?x:w,E=y[2],C=void 0===E?x:E,S=y[3],D=void 0===S?k:S,M=nM(h,4),O=M[0],_=void 0===O?x:O,A=M[1],T=void 0===A?v?_:k:A,R=M[2],N=void 0===R?v?_:C:R,P=M[3],L=void 0===P?v?T:D:P,I=[x,k,C,D].map(function(t){return uS(t,e)}),z=[_,T,N,L].map(function(t){return uS(t,n)}),F=I.slice(),B=z.slice();a=nM(ET([F[0],F[1]],e),2),F[0]=a[0],F[1]=a[1],l=nM(ET([F[3],F[2]],e),2),F[3]=l[0],F[2]=l[1],c=nM(ET([B[0],B[3]],n),2),B[0]=c[0],B[3]=c[1],u=nM(ET([B[1],B[2]],n),2),B[1]=u[0],B[2]=u[1];var j=s?F:F.slice(0,Math.max(i[0],m)),H=s?B:B.slice(0,Math.max(i[1],g));return rM(rM([],nM(j.map(function(t,e){var i=kT[e];return{virtual:e>=m,horizontal:DT[e],vertical:0,pos:[r+t,o+(-1===MT[e]?n:0)],sub:!0,raw:I[e],direction:i}})),!1),nM(H.map(function(t,n){var i=kT[n];return{virtual:n>=g,horizontal:0,vertical:MT[n],pos:[r+(-1===DT[n]?e:0),o+t],sub:!0,raw:z[n],direction:i}})),!1)}var TT=[[0,-1,"n"],[1,0,"e"]],RT=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function NT(t,e,n){var r=t.props.clipRelative,o=t.state,i=o.width,s=o.height,a=e,l=a.type,c=a.poses,u="rect"===l,d="circle"===l;if("polygon"===l)return n.map(function(t){return"".concat(HA(t[0],i,r)," ").concat(HA(t[1],s,r))});if(u||"inset"===l){var p=n[1][1],f=n[3][0],h=n[7][0],m=n[5][1];if(u)return[p,f,m,h].map(function(t){return"".concat(t,"px")});var g=[p,i-f,s-m,h].map(function(t,e){return HA(t,e%2?i:s,r)});if(n.length>8){var v=nM($S(n[4],n[0]),2),y=v[0],b=v[1];g.push.apply(g,rM(["round"],nM(OT(c.slice(8).map(function(t,e){return eM(eM({},t),{pos:n[e]})}),r,y,b,h,p,f,m).styles),!1))}return g}if(d||"ellipse"===l){var x=n[0],w=HA(eT(n[1][1]-x[1]),d?Math.sqrt((i*i+s*s)/2):s,r);return(g=d?[w]:[HA(eT(n[2][0]-x[0]),i,r),w]).push("at",HA(x[0],i,r),HA(x[1],s,r)),g}}function PT(t,e,n,r){var o=[r,(r+e)/2,e],i=[t,(t+n)/2,n];return RT.map(function(t){var e=nM(t,3),n=e[0],r=e[1],s=e[2],a=o[n+1],l=i[r+1];return{vertical:eT(r),horizontal:eT(n),direction:s,pos:[a,l]}})}function LT(t){var e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach(function(t){var r=t.pos;e[0]=Math.min(e[0],r[0]),e[1]=Math.max(e[1],r[0]),n[0]=Math.min(n[0],r[1]),n[1]=Math.max(n[1],r[1])}),[eT(e[1]-e[0]),eT(n[1]-n[0])]}function IT(t,e,n,r,o){var i,s,a,l,c,u,d,p,f;if(t){var h=o;if(!h){var m=fO(t),g=m("clipPath");h="none"!==g?g:m("clip")}if(h&&"none"!==h&&"auto"!==h||(h=r)){var v=nS(h),y=v.prefix,b=void 0===y?h:y,x=v.value,w=void 0===x?"":x,k="circle"===b,E=" ";if("polygon"===b){E=",";var C=(A=eS(w||"0% 0%, 100% 0%, 100% 100%, 0% 100%")).map(function(t){var r=nM(t.split(" "),2),o=r[0],i=r[1];return{vertical:1,horizontal:1,pos:[uS(o,e),uS(i,n)]}}),S=AD(C.map(function(t){return t.pos}));return{type:b,clipText:h,poses:C,splitter:E,left:S.minX,right:S.maxX,top:S.minY,bottom:S.maxY}}if(k||"ellipse"===b){var D="",M="",O=0,_=0,A=tS(w);if(k){var T;T=void 0===(s=(i=nM(A,4))[0])?"50%":s,D=void 0===(a=i[2])?"50%":a,M=void 0===(l=i[3])?"50%":l,O=uS(T,Math.sqrt((e*e+n*n)/2)),_=O}else{var R,N;R=void 0===(u=(c=nM(A,5))[0])?"50%":u,N=void 0===(d=c[1])?"50%":d,D=void 0===(p=c[3])?"50%":p,M=void 0===(f=c[4])?"50%":f,O=uS(R,e),_=uS(N,n)}var P=[uS(D,e),uS(M,n)];C=rM([{vertical:1,horizontal:1,pos:P,direction:"nesw"}],nM(TT.slice(0,k?1:2).map(function(t){return{vertical:eT(t[1]),horizontal:t[0],direction:t[2],sub:!0,pos:[P[0]+t[0]*O,P[1]+t[1]*_]}})),!1);return{type:b,clipText:h,radiusX:O,radiusY:_,left:P[0]-O,top:P[1]-_,right:P[0]+O,bottom:P[1]+_,poses:C,splitter:E}}if("inset"===b){var L=(A=tS(w||"0 0 0 0")).indexOf("round"),I=(L>-1?A.slice(0,L):A).length,z=A.slice(I+1),F=nM(A.slice(0,I),4),B=F[0],j=F[1],H=void 0===j?B:j,$=F[2],q=void 0===$?B:$,V=F[3],W=void 0===V?H:V,G=nM([B,q].map(function(t){return uS(t,n)}),2),U=G[0],Y=G[1],K=nM([W,H].map(function(t){return uS(t,e)}),2),X=K[0],J=K[1],Z=e-J,Q=n-Y,tt=AT(z,Z-X,Q-U,X,U);return{type:"inset",clipText:h,poses:C=rM(rM([],nM(PT(U,Z,Q,X)),!1),nM(tt),!1),top:U,left:X,right:Z,bottom:Q,radius:z,splitter:E}}if("rect"===b){E=",";var et=nM((A=eS(w||"0px, ".concat(e,"px, ").concat(n,"px, 0px"))).map(function(t){return rS(t).value}),4),nt=et[0];return{type:"rect",clipText:h,poses:C=PT(nt,J=et[1],Y=et[2],X=et[3]),top:nt,right:J,bottom:Y,left:X,values:A,splitter:E}}}}}function zT(t,e){var n=nM(zM(t,e),2),r=n[0],o=n[1],i=e.datas,s=i.clipPath,a=i.clipIndex,l=s,c=l.type,u=l.poses,d=l.splitter,p=u.map(function(t){return t.pos});if("polygon"===c)p.splice(a,0,[r,o]);else{if("inset"!==c)return;var f=CT.indexOf(a),h=ST.indexOf(a),m=u.length;if(function(t,e,n,r,o,i,s,a,l,c,u){void 0===c&&(c=0),void 0===u&&(u=0);var d=_T(t.slice(n)),p=d.horizontalRange,f=d.verticalRange;if(r>-1)for(var h=1===DT[r]?i-c:a-i,m=p[1];m<=r;++m){var g=1===MT[m]?u:l,v=0;if(r===m?v=i:0===m?v=c+h:-1===DT[m]&&(v=a-(e[n][0]-c)),t.splice(n+m,0,{horizontal:DT[m],vertical:0,pos:[v,g]}),e.splice(n+m,0,[v,g]),0===m)break}else if(o>-1){var y=1===MT[o]?s-u:l-s;if(0===p[1]&&0===f[1]){var b=[c+y,u];t.push({horizontal:DT[0],vertical:0,pos:b}),e.push(b)}var x=f[0];for(m=f[1];m<=o&&(v=1===DT[m]?c:a,g=0,o===m?g=s:0===m?g=u+y:1===MT[m]?g=e[n+x][1]:-1===MT[m]&&(g=l-(e[n+x][1]-u)),t.push({horizontal:0,vertical:MT[m],pos:[v,g]}),e.push([v,g]),0!==m);++m);}}(u,p,8,f,h,r,o,p[4][0],p[4][1],p[0][0],p[0][1]),m===u.length)return}var g=NT(t,s,p),v="".concat(c,"(").concat(g.join(d),")");RA(t,"onClip",_A(t,e,eM({clipEventType:"added",clipType:c,poses:p,clipStyles:g,clipStyle:v,distX:0,distY:0},MA({clipPath:v},e))))}function FT(t,e){var n=e.datas,r=n.clipPath,o=n.clipIndex,i=r,s=i.type,a=i.poses,l=i.splitter,c=a.map(function(t){return t.pos}),u=c.length;if("polygon"===s)a.splice(o,1),c.splice(o,1);else{if("inset"!==s)return;if(o<8)return;if(function(t,e,n,r,o){void 0===o&&(o=e.length);var i=_T(t.slice(r)),s=i.horizontalRange,a=i.verticalRange,l=n-r,c=0;if(0===l)c=o;else if(l>0&&l<s[1])c=s[1]-l;else{if(!(l>=a[0]))return;c=a[0]+a[1]-l}t.splice(n,c),e.splice(n,c)}(a,c,o,8,u),u===a.length)return}var d=NT(t,r,c),p="".concat(s,"(").concat(d.join(l),")");RA(t,"onClip",_A(t,e,eM({clipEventType:"removed",clipType:s,poses:c,clipStyles:d,clipStyle:p,distX:0,distY:0},MA({clipPath:p},e))))}var BT={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[".control.clip-control {\nbackground: #6d6;\ncursor: pointer;\n}\n.control.clip-control.clip-radius {\nbackground: #d66;\n}\n.line.clip-line {\nbackground: #6e6;\ncursor: move;\nz-index: 1;\n}\n.clip-area {\nposition: absolute;\ntop: 0;\nleft: 0;\n}\n.clip-ellipse {\nposition: absolute;\ncursor: move;\nborder: 1px solid #6d6;\nborder: var(--zoompx) solid #6d6;\nborder-radius: 50%;\ntransform-origin: 0px 0px;\n}",":host {\n--bounds-color: #d66;\n}",".guideline {\npointer-events: none;\nz-index: 2;\n}",".line.guideline.bounds {\nbackground: #d66;\nbackground: var(--bounds-color);\n}"],render:function(t,e){var n=t.props,r=n.customClipPath,o=n.defaultClipPath,i=n.clipArea,s=n.zoom,a=n.groupable,l=t.getState(),c=l.target,u=l.width,d=l.height,p=l.allMatrix,f=l.is3d,h=l.left,m=l.top,g=l.pos1,v=l.pos2,y=l.pos3,b=l.pos4,x=l.clipPathState,w=l.snapBoundInfos,k=l.rotation;if(!c||a)return[];var E=IT(c,u,d,o||"inset",x||r);if(!E)return[];var C=f?4:3,S=E.type,D=E.poses.map(function(t){var e=aA(p,t.pos,C);return[e[0]-h,e[1]-m]}),M=[],O=[],_="rect"===S,A="inset"===S,T="polygon"===S;if(_||A||T){var R=A?D.slice(0,8):D;O=R.map(function(t,n){var r=0===n?R[R.length-1]:R[n-1],o=mS(r,t),i=pA(r,t);return e.createElement("div",{key:"clipLine".concat(n),className:G_("line","clip-line","snap-control"),"data-clip-index":n,style:{width:"".concat(i,"px"),transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(o,"rad) scaleY(").concat(s,")")}})})}if(M=D.map(function(t,n){return e.createElement("div",{key:"clipControl".concat(n),className:G_("control","clip-control","snap-control"),"data-clip-index":n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(k,"rad) scale(").concat(s,")")}})}),A&&M.push.apply(M,rM([],nM(D.slice(8).map(function(t,n){return e.createElement("div",{key:"clipRadiusControl".concat(n),className:G_("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(k,"rad) scale(").concat(s,")")}})})),!1)),"circle"===S||"ellipse"===S){var N=E.left,P=E.top,L=E.radiusX,I=E.radiusY,z=nM($S(aA(p,[N,P],C),aA(p,[0,0],C)),2),F=z[0],B=z[1],j="none";if(!i){for(var H=Math.max(10,L/5,I/5),$=[],q=0;q<=H;++q){var V=2*Math.PI/H*q;$.push([L+(L-s)*Math.cos(V),I+(I-s)*Math.sin(V)])}$.push([L,-2]),$.push([-2,-2]),$.push([-2,2*I+2]),$.push([2*L+2,2*I+2]),$.push([2*L+2,-2]),$.push([L,-2]),j="polygon(".concat($.map(function(t){return"".concat(t[0],"px ").concat(t[1],"px")}).join(", "),")")}M.push(e.createElement("div",{key:"clipEllipse",className:G_("clip-ellipse","snap-control"),style:{width:"".concat(2*L,"px"),height:"".concat(2*I,"px"),clipPath:j,transform:"translate(".concat(-h+F,"px, ").concat(-m+B,"px) ").concat(oA(p))}}))}if(i){var W=cA(rM([g,v,y,b],nM(D),!1)),G=W.width,U=W.height,Y=W.left,K=W.top;if(T||_||A){$=A?D.slice(0,8):D;M.push(e.createElement("div",{key:"clipArea",className:G_("clip-area","snap-control"),style:{width:"".concat(G,"px"),height:"".concat(U,"px"),transform:"translate(".concat(Y,"px, ").concat(K,"px)"),clipPath:"polygon(".concat($.map(function(t){return"".concat(t[0]-Y,"px ").concat(t[1]-K,"px")}).join(", "),")")}}))}}return w&&["vertical","horizontal"].forEach(function(t){var n=w[t],r="horizontal"===t;n.isSnap&&O.push.apply(O,rM([],nM(n.snap.posInfos.map(function(n,o){var i=n.pos,a=$S(aA(p,r?[0,i]:[i,0],C),[h,m]),l=$S(aA(p,r?[u,i]:[i,d],C),[h,m]);return xO(e,"",a,l,s,"clip".concat(t,"snap").concat(o),"guideline")})),!1)),n.isBound&&O.push.apply(O,rM([],nM(n.bounds.map(function(n,o){var i=n.pos,a=$S(aA(p,r?[0,i]:[i,0],C),[h,m]),l=$S(aA(p,r?[u,i]:[i,d],C),[h,m]);return xO(e,"",a,l,s,"clip".concat(t,"bounds").concat(o),"guideline","bounds","bold")})),!1))}),rM(rM([],nM(M),!1),nM(O),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props.dragWithClip;return!(void 0===n||n)&&this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,eM(eM({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,o=r.defaultClipPath,i=r.customClipPath,s=n.target,a=n.width,l=n.height,c=e.inputEvent?e.inputEvent.target:null,u=c&&c.getAttribute("class")||"",d=e.datas,p=IT(s,a,l,o||"inset",i);if(!p)return!1;var f=p.clipText;return!1===RA(t,"onClipStart",_A(t,e,{clipType:p.type,clipStyle:f,poses:p.poses.map(function(t){return t.pos})}))?(d.isClipStart=!1,!1):(d.isControl=u&&u.indexOf("clip-control")>-1,d.isLine=u.indexOf("clip-line")>-1,d.isArea=u.indexOf("clip-area")>-1||u.indexOf("clip-ellipse")>-1,d.clipIndex=c?parseInt(c.getAttribute("data-clip-index"),10):-1,d.clipPath=p,d.isClipStart=!0,n.clipPathState=f,FM(t,e),!0)},dragControl:function(t,e){var n,r,o,i=e.datas,s=e.originalDatas,a=e.isDragTarget;if(!i.isClipStart)return!1;var l=i,c=l.isControl,u=l.isLine,d=l.isArea,p=l.clipIndex,f=l.clipPath;if(!f)return!1;var h=mA(t.props,"clippable"),m=h.keepRatio,g=0,v=0,y=s.draggable,b=VM(e);a&&y?(n=nM(y.prevBeforeDist,2),g=n[0],v=n[1]):(r=nM(b,2),g=r[0],v=r[1]);var x=[g,v],w=t.state,k=w.width,E=w.height,C=!d&&!c&&!u,S=f.type,D=f.poses,M=f.splitter,O=D.map(function(t){return t.pos});C&&(g=-g,v=-v);var _=!c||"nesw"===D[p].direction,A="inset"===S||"rect"===S,T=D.map(function(){return[0,0]});if(c&&!_){var R=D[p],N=R.horizontal,P=R.vertical,L=[g*eT(N),v*eT(P)];T=function(t,e,n,r,o){var i=t[e],s=i.direction,a=i.sub,l=t.map(function(){return[0,0]}),c=s?s.split(""):[];if(r&&e<8){var u=c.filter(function(t){return"w"===t||"e"===t}),d=c.filter(function(t){return"n"===t||"s"===t}),p=u[0],f=d[0];l[e]=n;var h=nM(LT(t),2),m=h[0],g=h[1],v=m&&g?m/g:0;if(v&&o){var y=t[(e+4)%8].pos,b=[0,0];s.indexOf("w")>-1?b[0]=-1:s.indexOf("e")>-1&&(b[0]=1),s.indexOf("n")>-1?b[1]=-1:s.indexOf("s")>-1&&(b[1]=1);var x=YA([m,g],n,v,b,!0),w=m+x[0],k=g+x[1],E=y[1],C=y[1],S=y[0],D=y[0];-1===b[0]?S=D-w:1===b[0]?D=S+w:(S-=w/2,D+=w/2),-1===b[1]?E=C-k:C=1===b[1]?E+k:(E=C-k/2)+k;var M=PT(E,D,C,S);t.forEach(function(t,e){l[e][0]=M[e].pos[0]-t.pos[0],l[e][1]=M[e].pos[1]-t.pos[1]})}else t.forEach(function(t,e){var r=t.direction;r&&(r.indexOf(p)>-1&&(l[e][0]=n[0]),r.indexOf(f)>-1&&(l[e][1]=n[1]))}),p&&(l[1][0]=n[0]/2,l[5][0]=n[0]/2),f&&(l[3][1]=n[1]/2,l[7][1]=n[1]/2)}else s&&!a?c.forEach(function(e){var r="n"===e||"s"===e;t.forEach(function(t,o){var i=t.direction,s=t.horizontal,a=t.vertical;i&&-1!==i.indexOf(e)&&(l[o]=[r||!s?0:n[0],r&&a?n[1]:0])})}):l[e]=n;return l}(D,p,L,A,m)}else _&&(T=O.map(function(){return[g,v]}));var I=O.map(function(t,e){return HS(t,T[e])}),z=rM([],nM(I),!1);w.snapBoundInfos=null;var F="circle"===f.type,B="ellipse"===f.type;if(F||B){var j=eT((nt=cA(I)).bottom-nt.top),H=eT(B?nt.right-nt.left:j),$=I[0][1]+j,q=I[0][0]-H,V=I[0][0]+H;F&&(z.push([V,nt.bottom]),T.push([1,0])),z.push([nt.left,$]),T.push([0,1]),z.push([q,nt.bottom]),T.push([1,0])}var W=A_((h.clipHorizontalGuidelines||[]).map(function(t){return uS("".concat(t),E)}),(h.clipVerticalGuidelines||[]).map(function(t){return uS("".concat(t),k)}),k,E),G=[],U=[];if(F||B)G=[z[4][0],z[2][0]],U=[z[1][1],z[3][1]];else if(A){var Y=[z[0],z[2],z[4],z[6]],K=[T[0],T[2],T[4],T[6]];G=Y.filter(function(t,e){return K[e][0]}).map(function(t){return t[0]}),U=Y.filter(function(t,e){return K[e][1]}).map(function(t){return t[1]})}else G=z.filter(function(t,e){return T[e][0]}).map(function(t){return t[0]}),U=z.filter(function(t,e){return T[e][1]}).map(function(t){return t[1]});var X=[0,0],J=a_(W,h.clipTargetBounds&&{left:0,top:0,right:k,bottom:E},G,U,5),Z=J.horizontal,Q=J.vertical,tt=Z.offset,et=Q.offset;if(Z.isBound&&(X[1]+=tt),Q.isBound&&(X[0]+=et),(B||F)&&0===T[0][0]&&0===T[0][1]){var nt,rt=(nt=cA(I)).bottom-nt.top,ot=B?nt.right-nt.left:rt;ot-=Q.isBound?eT(et):0===Q.snapIndex?-et:et,rt-=Z.isBound?eT(tt):0===Z.snapIndex?-tt:tt,F&&(ot=rt=WO(Q,Z)>0?rt:ot);var it=z[0];z[1][1]=it[1]-rt,z[2][0]=it[0]+ot,z[3][1]=it[1]+rt,z[4][0]=it[0]-ot}else if(A&&m&&c){var st=nM(LT(D),2),at=st[0],lt=st[1],ct=at&&lt?at/lt:0,ut=D[p].direction||"",dt=z[1][1];$=z[5][1],q=z[7][0],V=z[3][0];eT(tt)<=eT(et)?tt=tT(tt)*eT(et)/ct:et=tT(et)*eT(tt)*ct,ut.indexOf("w")>-1?q-=et:ut.indexOf("e")>-1?V-=et:(q+=et/2,V-=et/2),ut.indexOf("n")>-1?dt-=tt:ut.indexOf("s")>-1?$-=tt:(dt+=tt/2,$-=tt/2);var pt=PT(dt,V,$,q);z.forEach(function(t,e){var n;n=nM(pt[e].pos,2),t[0]=n[0],t[1]=n[1]})}else z.forEach(function(t,e){var n=T[e];n[0]&&(t[0]-=et),n[1]&&(t[1]-=tt)});var ft=NT(t,f,I),ht="".concat(S,"(").concat(ft.join(M),")");if(w.clipPathState=ht,F||B)G=[z[4][0],z[2][0]],U=[z[1][1],z[3][1]];else if(A){G=(Y=[z[0],z[2],z[4],z[6]]).map(function(t){return t[0]}),U=Y.map(function(t){return t[1]})}else G=z.map(function(t){return t[0]}),U=z.map(function(t){return t[1]});if(w.snapBoundInfos=a_(W,h.clipTargetBounds&&{left:0,top:0,right:k,bottom:E},G,U,1),y){var mt=w.is3d,gt=w.allMatrix,vt=mt?4:3,yt=X;a&&(yt=[x[0]+X[0]-b[0],x[1]+X[1]-b[1]]),y.deltaOffset=jS(gt,[yt[0],yt[1],0,0],vt)}return RA(t,"onClip",_A(t,e,eM({clipEventType:"changed",clipType:S,poses:I,clipStyle:ht,clipStyles:ft,distX:g,distY:v},MA(((o={})["rect"===S?"clip":"clipPath"]=ht,o),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,o=e.isDouble,i=r.isLine,s=r.isClipStart,a=r.isControl;return!!s&&(RA(t,"onClipEnd",AA(t,e,{})),o&&(a?FT(t,e):i&&zT(t,e)),o||n)},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},jT={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[":host[data-able-origindraggable] .control.origin {\npointer-events: auto;\n}"],dragControlCondition:function(t,e){return e.isRequest?"originDraggable"===e.requestAble:xS(e.inputEvent.target,G_("origin"))},dragControlStart:function(t,e){var n=e.datas;FM(t,e);var r=_A(t,e,{dragStart:u_.dragStart(t,(new LM).dragStart([0,0],e))}),o=RA(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,!1===o?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,o=e.isRequest;if(!n.isDragOrigin)return!1;var i=nM(VM(e),2),s=i[0],a=i[1],l=t.state,c=l.width,u=l.height,d=l.offsetMatrix,p=l.targetMatrix,f=l.is3d,h=t.props.originRelative,m=void 0===h||h,g=f?4:3,v=[s,a];if(o){var y=e.distOrigin;(y[0]||y[1])&&(v=y)}var b=HS(n.startOrigin,v),x=HS(n.startTargetOrigin,v),w=$S(v,n.prevOrigin),k=UM(d,p,b,g),E=t.getRect(),C=cA(lA(k,c,u,g)),S=[E.left-C.left,E.top-C.top];n.prevOrigin=v;var D=[HA(x[0],c,m),HA(x[1],u,m)].join(" "),M=u_.drag(t,PM(e,t.state,S,!!r)),O=_A(t,e,eM(eM({width:c,height:u,origin:b,dist:v,delta:w,transformOrigin:D,drag:M},MA({transformOrigin:D,transform:M.transform},e)),{afterTransform:M.transform}));return RA(t,"onDragOrigin",O),O},dragControlEnd:function(t,e){return!!e.datas.isDragOrigin&&(RA(t,"onDragOriginEnd",AA(t,e,{})),!0)},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){return!!this.dragControlStart(t,e)},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return!!n&&(t.transformOrigin=n.transformOrigin,!0)},request:function(t){var e={},n=t.getRect(),r=0,o=0,i=n.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaOrigin"in t?(s[0]+=t.deltaOrigin[0],s[1]+=t.deltaOrigin[1]):"origin"in t?(s[0]=t.origin[0]-i[0],s[1]=t.origin[1]-i[1]):("x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?o=t.y-n.top:"deltaY"in t&&(o+=t.deltaY)),{datas:e,distX:r,distY:o,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function HT(t,e,n,r,o){void 0===r&&(r=[0,0]);return AT(t&&"0px"!==t?tS(t):[],e,n,0,0,r,o)}function $T(t,e,n,r,o){var i=t.state,s=i.width,a=i.height,l=OT(o,t.props.roundRelative,s,a),c=l.raws,u=l.styles,d=function(t,e){void 0===e&&(e=t.map(function(t){return t.raw}));var n=t.map(function(t,n){return t.horizontal?e[n]:null}).filter(function(t){return null!=t}),r=t.map(function(t,n){return t.vertical?e[n]:null}).filter(function(t){return null!=t});return{horizontals:n,verticals:r}}(l.radiusPoses,c),p=d.horizontals,f=d.verticals,h=u.join(" ");i.borderRadiusState=h;var m=_A(t,e,eM({horizontals:p,verticals:f,borderRadius:h,width:s,height:a,delta:r,dist:n},MA({borderRadius:h},e)));return RA(t,"onRound",m),m}function qT(t){var e,n,r=t.getState().style,o=r.borderRadius||"";if(!o&&t.props.groupable){var i=t.moveables[0],s=t.getTargets()[0];s&&((null==i?void 0:i.props.target)===s?(o=null!==(n=null===(e=t.moveables[0])||void 0===e?void 0:e.state.style.borderRadius)&&void 0!==n?n:"",r.borderRadius=o):(o=NA(s).borderRadius,r.borderRadius=o))}return o}var VT={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[".control.border-radius {\nbackground: #d66;\ncursor: pointer;\nz-index: 3;\n}",".control.border-radius.vertical {\nbackground: #d6d;\nz-index: 2;\n}",".control.border-radius.virtual {\nopacity: 0.5;\nz-index: 1;\n}",":host.round-line-clickable .line.direction {\ncursor: pointer;\n}"],className:function(t){var e=t.props.roundClickable;return!0===e||"line"===e?G_("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var n=t.getState(),r=n.target,o=n.width,i=n.height,s=n.allMatrix,a=n.is3d,l=n.left,c=n.top,u=n.borderRadiusState,d=t.props,p=d.minRoundControls,f=void 0===p?[0,0]:p,h=d.maxRoundControls,m=void 0===h?[4,4]:h,g=d.zoom,v=d.roundPadding,y=void 0===v?0:v,b=d.isDisplayShadowRoundControls,x=d.groupable;if(!r)return null;var w=u||qT(t),k=a?4:3,E=HT(w,o,i,f,!0);if(!E)return null;var C=0,S=0,D=x?[0,0]:[l,c];return E.map(function(t,n){var r=t.horizontal,o=t.vertical,i=t.direction||"",a=rM([],nM(t.pos),!1);S+=Math.abs(r),C+=Math.abs(o),r&&i.indexOf("n")>-1&&(a[1]-=y),o&&i.indexOf("w")>-1&&(a[0]-=y),r&&i.indexOf("s")>-1&&(a[1]+=y),o&&i.indexOf("e")>-1&&(a[0]+=y);var l=$S(aA(s,a,k),D),c=b&&"horizontal"!==b,u=t.vertical?C<=m[1]&&(c||!t.virtual):S<=m[0]&&(b||!t.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(n),className:G_("control","border-radius",t.vertical?"vertical":"",t.virtual?"virtual":""),"data-radius-index":n,style:{display:u?"block":"none",transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) scale(").concat(g,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,o=n.target,i=o.getAttribute("class")||"",s=i.indexOf("border-radius")>-1,a=i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1,l=s?parseInt(o.getAttribute("data-radius-index"),10):-1,c=-1;if(a){var u=o.getAttribute("data-line-key")||"";u&&(c=parseInt(u.replace(/render-line-/g,""),10),isNaN(c)&&(c=-1))}if(!s&&!a)return!1;var d=_A(t,e,{});if(!1===RA(t,"onRoundStart",d))return!1;r.lineIndex=c,r.controlIndex=l,r.isControl=s,r.isLine=a,FM(t,e);var p=t.props,f=p.roundRelative,h=p.minRoundControls,m=void 0===h?[0,0]:h,g=t.state,v=g.width,y=g.height;r.isRound=!0,r.prevDist=[0,0];var b=HT(qT(t)||"",v,y,m,!0)||[];return r.controlPoses=b,g.borderRadiusState=OT(b,f,v,y).styles.join(" "),d},dragControl:function(t,e){var n=e.datas,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;var o=n.controlIndex,i=nM(VM(e),2),s=i[0],a=i[1],l=[s,a],c=$S(l,n.prevDist),u=t.props.maxRoundControls,d=void 0===u?[4,4]:u,p=t.state,f=p.width,h=p.height,m=r[o],g=m.vertical,v=m.horizontal,y=r.map(function(t){var e=t.horizontal,n=t.vertical,r=[e*v*l[0],n*g*l[1]];if(e){if(1===d[0])return r;if(d[0]<4&&e!==v)return r}else{if(0===d[1])return r[1]=n*v*l[0]/f*h,r;if(g){if(1===d[1])return r;if(d[1]<4&&n!==g)return r}}return[0,0]});y[o]=l;var b=r.map(function(t,e){return eM(eM({},t),{pos:HS(t.pos,y[e])})});return o<4?b.slice(0,o+1).forEach(function(t){t.virtual=!1}):b.slice(4,o+1).forEach(function(t){t.virtual=!1}),n.prevDist=[s,a],$T(t,e,l,c,b)},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,o=e.isDouble;if(!r.isRound)return!1;var i=r.isControl,s=r.controlIndex,a=r.isLine,l=r.lineIndex,c=r.controlPoses,u=c.filter(function(t){return t.virtual}).length,d=t.props.roundClickable,p=void 0===d||d;if(o&&p){if(!i||!0!==p&&"control"!==p){if(a&&(!0===p||"line"===p)){var f=nM(zM(t,e),2);!function(t,e,n,r){var o=t.filter(function(t){var e=t.virtual;return t.horizontal&&!e}).length,i=t.filter(function(t){var e=t.virtual;return t.vertical&&!e}).length,s=-1;if(0===e&&(0===o?s=0:1===o&&(s=1)),2===e&&(o<=2?s=2:o<=3&&(s=3)),3===e&&(0===i?s=4:i<4&&(s=7)),1===e&&(i<=1?s=5:i<=2&&(s=6)),-1!==s&&t[s].virtual){var a=t[s];!function(t,e){e<4?t.slice(0,e+1).forEach(function(t){t.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(t){t.virtual=!1}))}(t,s),s<4?a.pos[0]=n:a.pos[1]=r}}(c,l,f[0],f[1])}}else!function(t,e){e<4?t.slice(e,4).forEach(function(t){t.virtual=!0}):t.slice(e).forEach(function(t){t.virtual=!0})}(c,s);u!==c.filter(function(t){return t.virtual}).length&&$T(t,e,[0,0],[0,0],c)}var h=AA(t,e,{});return RA(t,"onRoundEnd",h),n.borderRadiusState="",h},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);if(!n)return!1;var r=t.moveables,o=t.props.targets,i=hO(t,"roundable",e),s=eM({targets:t.props.targets,events:i.map(function(t,e){return eM(eM({},t),{target:o[e],moveable:r[e],currentTarget:r[e]})})},n);return RA(t,"onRoundGroupStart",s),n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);if(!n)return!1;var r=t.moveables,o=t.props.targets,i=hO(t,"roundable",e),s=eM({targets:t.props.targets,events:i.map(function(t,e){return eM(eM(eM({},t),{target:o[e],moveable:r[e],currentTarget:r[e]}),MA({borderRadius:n.borderRadius},t))})},n);return RA(t,"onRoundGroup",s),s},dragGroupControlEnd:function(t,e){var n=t.moveables,r=t.props.targets,o=hO(t,"roundable",e);TA(t,"onRound",function(e){var i=eM({targets:t.props.targets,events:o.map(function(t,o){return eM(eM(eM({},t),{target:r[o],moveable:n[o],currentTarget:n[o]}),MA({borderRadius:e.borderRadius},t))})},e);RA(t,"onRoundGroup",i)});var i=this.dragControlEnd(t,e);if(!i)return!1;var s=eM({targets:t.props.targets,events:o.map(function(t,e){var o;return eM(eM({},t),{target:r[e],moveable:n[e],currentTarget:n[e],lastEvent:null===(o=t.datas)||void 0===o?void 0:o.lastEvent})})},i);return RA(t,"onRoundGroupEnd",s),s},unset:function(t){t.state.borderRadiusState=""}};var WT={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var n=t.state,r=n.is3d,o=n.targetMatrix,i=n.inlineTransform,s=r?"matrix3d(".concat(o.join(","),")"):"matrix(".concat(VS(o,!0),")"),a=i&&"none"!==i?i:s;e.datas.startTransforms=function(t,e){var n=tD(e?4:3);return t==="matrix".concat(e?"3d":"","(").concat(n.join(","),")")||"matrix(1,0,0,1,0,0)"===t}(a,r)?[]:tS(a)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return _A(t,e,{setTransform:function(t){e.datas.startTransforms=UC(t)?t:tS(t)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return _A(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),RA(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),RA(t,"onBeforeRender",_A(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),RA(t,"onBeforeRenderEnd",_A(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=hO(t,"beforeRenderable",e),o=t.moveables,i=r.map(function(t,e){var r=o[e];return n.setTransform(r,t),n.resetStyle(t),n.fillDragStartParams(r,t)});RA(t,"onBeforeRenderGroupStart",_A(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:i}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=hO(t,"beforeRenderable",e),o=t.moveables,i=r.map(function(t,e){var r=o[e];return n.resetStyle(t),n.fillDragParams(r,t)});RA(t,"onBeforeRenderGroup",_A(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:i}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),RA(t,"onBeforeRenderGroupEnd",_A(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},GT={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){RA(t,"onRenderStart",_A(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){RA(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){RA(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){RA(t,"onRenderGroupStart",_A(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=hO(t,"beforeRenderable",e),o=t.moveables,i=r.map(function(t,e){var r=o[e];return n.fillDragParams(r,t)});RA(t,"onRenderGroup",_A(t,e,eM(eM({isPinch:!!e.isPinch,targets:t.props.targets,transform:tO(e),transformObject:{}},MA(eO(e))),{events:i})))},dragGroupEnd:function(t,e){var n=this,r=hO(t,"beforeRenderable",e),o=t.moveables,i=r.map(function(t,e){var r=o[e];return n.fillDragEndParams(r,t)});RA(t,"onRenderGroupEnd",_A(t,e,eM({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:i,transformObject:{},transform:tO(e)},MA(eO(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var n={};return aD(QM(e)||[]).forEach(function(t){n[t.name]=t.functionValue}),_A(t,e,eM({isPinch:!!e.isPinch,transformObject:n,transform:tO(e)},MA(eO(e))))},fillDragEndParams:function(t,e){var n={};return aD(QM(e)||[]).forEach(function(t){n[t.name]=t.functionValue}),_A(t,e,eM({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:n,transform:tO(e)},MA(eO(e))))}};function UT(t,e,n,r,o,i,s){i.clientDistX=i.distX,i.clientDistY=i.distY;var a="Start"===o,l="End"===o,c="After"===o,u=t.state.target,d=i.isRequest,p=r.indexOf("Control")>-1;if(!u||a&&p&&!d&&t.areaElement===i.inputEvent.target)return!1;var f=rM([],nM(e),!1);if(d){var h=i.requestAble;f.some(function(t){return t.name===h})||f.push.apply(f,rM([],nM(t.props.ables.filter(function(t){return t.name===h})),!1))}if(!f.length||f.every(function(t){return t.dragRelation}))return!1;var m,g=i.inputEvent;l&&g&&(m=document.elementFromPoint(i.clientX,i.clientY)||g.target);var v=!1,y=function(){var t;v=!0,null===(t=i.stop)||void 0===t||t.call(i)},b=a&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());b&&t.updateRect(o,!0,!1);var x=i.datas,w=p?"controlGesto":"targetGesto",k=t[w],E=function(e,n,r){if(!(n in e)||k!==t[w])return!1;var o=e.name,s=x[o]||(x[o]={});if(a&&(s.isEventStart=!r||!e[r]||e[r](t,i)),!s.isEventStart)return!1;var l=e[n](t,eM(eM({},i),{stop:y,datas:s,originalDatas:x,inputTarget:m}));return t._emitter.off(),a&&!1===l&&(s.isEventStart=!1),l};b&&f.forEach(function(e){e.unset&&e.unset(t)}),E(WT,"drag".concat(r).concat(o));var C=0,S=0;n.forEach(function(e){if(v)return!1;var n="".concat(e).concat(r).concat(o),s="".concat(e).concat(r,"Condition");""!==o||d||function(t,e){var n,r=t.is3d?4:3;n=nM(BA(t.rootMatrix,[e.distX,e.distY],r),2),e.distX=n[0],e.distY=n[1]}(t.state,i);var l=f.filter(function(t){return t[n]});l=l.filter(function(t,e){return t.name&&l.indexOf(t)===e});var c=l.filter(function(t){return E(t,n,s)}).length;v&&++C,c&&++S,!v&&a&&l.length&&!c&&(C+=l.filter(function(t){var e=t.name;return!!x[e].isEventStart&&"strong"!==t.dragRelation}).length?1:0)}),c&&!S||E(GT,"drag".concat(r).concat(o));var D=k!==t[w]||C===n.length;if((l||v||D)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(t){t.state.gestos={}}),f.forEach(function(e){e.unset&&e.unset(t)})),a&&!D&&!d&&S&&t.props.preventDefault&&(null==i||i.preventDefault()),t.isUnmounted||D)return!1;(!a&&S&&!s||l)&&(t.props.flushSync||U_)(function(){t.updateRect(l?o:"",!0,!1),t.forceUpdate()});return a||l||c||!S||s||UT(t,e,n,r,o+"After",i),!0}function YT(t){return function(e){var n,r=e.inputEvent.target,o=t.areaElement,i=t._dragTarget;return!(!i||(null===(n=t.controlGesto)||void 0===n?void 0:n.isFlag()))&&(r===i||i.contains(r)||r===o||!t.isMoveableElement(r)&&!t.controlBox.contains(r)||xS(r,"moveable-area")||xS(r,"moveable-padding")||xS(r,"moveable-edgeDraggable"))}}function KT(t,e,n){var r=t.controlBox,o=[],i=t.props,s=i.dragArea,a=t.state.target,l=i.dragTarget;return o.push(r),s&&!l||o.push(e),!s&&l&&a&&e!==a&&i.dragTargetSelf&&o.push(a),XT(t,o,"targetAbles",n,{dragStart:YT(t),pinchStart:YT(t)})}function XT(t,e,n,r,o){void 0===o&&(o={});var i="targetAbles"===n,s=t.props,a=s.pinchOutside,l=s.pinchThreshold,c=s.preventClickEventOnDrag,u=s.preventClickDefault,d=s.checkInput,p=s.dragFocusedInput,f=s.preventDefault,h={preventDefault:void 0===f||f,preventRightClick:!0,preventWheelClick:!0,container:WA(s.dragContainer,!0)||OS(t.getControlBoxElement()),pinchThreshold:l,pinchOutside:a,preventClickEventOnDrag:!!i&&c,preventClickEventOnDragStart:!!i&&u,preventClickEventByCondition:i?null:function(e){return t.controlBox.contains(e.target)},checkInput:!!i&&d,dragFocusedInput:p},m=new UD(e,h),g="Control"===r;return["drag","pinch"].forEach(function(e){["Start","","End"].forEach(function(i){m.on("".concat(e).concat(i),function(s){var a,l=s.eventType,c="drag"===e&&s.isPinch;if(!o[l]||o[l](s)){if(!c){var u="drag"===e?[e]:["drag",e],d=rM([],nM(t[n]),!1);UT(t,d,u,r,i,s)?(t.props.stopPropagation||"Start"===i&&g)&&(null===(a=null==s?void 0:s.inputEvent)||void 0===a||a.stopPropagation()):s.stop()}}else s.stop()})})}),m}var JT=function(){function t(t,e,n){var r=this;this.target=t,this.moveable=e,this.eventName=n,this.ables=[],this._onEvent=function(t){var e=r.eventName,n=r.moveable;n.state.disableNativeEvent||r.ables.forEach(function(r){r[e](n,{inputEvent:t})})},t.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(t){this.ables=t},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t}();function ZT(t,e,n,r){var o;void 0===n&&(n=e);var i=lO(t,e),s=i.matrixes,a=i.is3d,l=i.targetMatrix,c=i.transformOrigin,u=i.targetOrigin,d=i.offsetContainer,p=i.hasFixed,f=i.zoom,h=function(t,e){if(dO){var n=sS(dO,function(n){return n[0][0]==t&&n[0][1]==e});if(n)return n[1]}var r=lO(t,e,!0);return dO&&dO.push([[t,e],r]),r}(d,n),m=h.matrixes,g=h.is3d,v=h.offsetContainer,y=h.zoom,b=r,x="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,w=l,k=tD(4),E=tD(4),C=tD(4),S=tD(4),D=s.length,M=m.map(function(t){return eM(eM({},t),{matrix:t.matrix?rM([],nM(t.matrix),!1):void 0})}).reverse();s.reverse(),!a&&b&&(w=FS(w,3,4),nA(s)),!g&&b&&nA(M),M.forEach(function(t){E=jS(E,t.matrix,4)});var O=n||MS(t),_=(null===(o=M[0])||void 0===o?void 0:o.target)||Q_(O,O,!0).offsetParent,A=M.slice(1).reduce(function(t,e){return jS(t,e.matrix,4)},tD(4));s.forEach(function(t,e){if(D-2===e&&(C=k.slice()),D-1===e&&(S=k.slice()),!t.matrix){var n=function(t,e,n,r,o){var i,s=t.target,a=t.origin,l=e.matrix,c=gA(s),u=c.offsetWidth,d=c.offsetHeight,p=n.getBoundingClientRect(),f=[0,0];n===MS(n)&&(f=eA(s,!0));for(var h=s.getBoundingClientRect(),m=h.left-p.left+n.scrollLeft-(n.clientLeft||0)+f[0],g=h.top-p.top+n.scrollTop-(n.clientTop||0)+f[1],v=h.width,y=h.height,b=BS(r,o,l),x=uA(b,u,d,r),w=x.left,k=x.top,E=x.width,C=x.height,S=aA(b,a,r),D=$S(S,[w,k]),M=[m+D[0]*v/E,g+D[1]*y/C],O=[0,0],_=0;++_<10;){var A=LS(o,r);i=nM($S(aA(A,M,r),aA(A,S,r)),2),O[0]=i[0],O[1]=i[1];var T=uA(BS(r,o,nD(O,r),l),u,d,r),R=T.left-m,N=T.top-g;if(eT(R)<2&&eT(N)<2)break;M[0]-=R,M[1]-=N}return O.map(function(t){return Math.round(t)})}(t,s[e+1],_,4,jS(A,k,4));t.matrix=nD(n,4)}k=jS(k,t.matrix,4)});var T=!x&&a;w||(w=tD(T?4:3));var R=oA(x&&16===w.length?FS(w,4,3):w,T),N=E;return E=PS(E,4,4),{hasZoom:1!==f||1!==y,hasFixed:p,matrixes:s,rootMatrix:E,originalRootMatrix:N,beforeMatrix:C,offsetMatrix:S,allMatrix:k,targetMatrix:w,targetTransform:R,inlineTransform:t.style.transform,transformOrigin:c,targetOrigin:u,is3d:b,offsetContainer:d,offsetRootContainer:v}}function QT(t,e,n,r,o,i){void 0===i&&(i=[]);var s=1,a=[0,0],l={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},c={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},u={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},d={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},p=[0,0],f={},h=function(t,e,n,r){void 0===n&&(n=e);var o=0,i=0,s=0,a={},l=gA(t);if(t&&(o=l.offsetWidth,i=l.offsetHeight),t){var c=ZT(t,e,n,r),u=IM(c.allMatrix,c.transformOrigin,o,i);a=eM(eM({},c),u);var d=IM(c.allMatrix,[50,50],100,100);s=vA([d.pos1,d.pos2],d.direction)}return eM(eM(eM({hasZoom:!1,width:o,height:i,rotation:s},l),{originalRootMatrix:tD(4),rootMatrix:tD(4),beforeMatrix:tD(4),offsetMatrix:tD(4),allMatrix:tD(4),targetMatrix:tD(4),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),a)}(e,n,o,!0);if(e){var m=fO(e);i.forEach(function(t){f[t]=m(t)});var g=h.is3d?4:3,v=IM(h.offsetMatrix,HS(h.transformOrigin,IS(h.targetMatrix,g)),h.width,h.height);s=v.direction,a=HS(v.origin,[v.left-h.left,v.top-h.top]),d=xA(h.offsetRootContainer);var y=Q_(r,r,!0).offsetParent||h.offsetRootContainer;if(h.hasZoom){var b=IM(jS(h.originalRootMatrix,h.allMatrix),h.transformOrigin,h.width,h.height),x=IM(h.originalRootMatrix,J_(fO(y)("transformOrigin")).map(function(t){return parseFloat(t)}),y.offsetWidth,y.offsetHeight);if(l=bA(b,d),u=bA(x,d,y,!0),t){var w=b.left,k=b.top;c=bA({left:w,top:k,bottom:k,right:k},d)}}else{l=xA(e),u=function(t){var e=null==uO?void 0:uO.get(t);if(e)return e;var n=xA(t,!0);return uO&&uO.set(t,n),n}(y),t&&(c=xA(t));var E=u.left,C=u.top,S=u.clientLeft,D=u.clientTop,M=[l.left-E,l.top-C];p=$S(BA(h.rootMatrix,M,4),[S+h.left,D+h.top])}}return eM({targetClientRect:l,containerClientRect:u,moveableClientRect:c,rootContainerClientRect:d,beforeDirection:s,beforeOrigin:a,originalBeforeOrigin:a,target:e,style:f,offsetDelta:p},h)}function tR(t){var e=t.pos1,n=t.pos2,r=t.pos3,o=t.pos4;if(!(e&&n&&r&&o))return null;var i=AD([e,n,r,o]),s=[i.minX,i.minY],a=$S(t.origin,s);return e=$S(e,s),n=$S(n,s),r=$S(r,s),o=$S(o,s),eM(eM({},t),{left:t.left,top:t.top,posDelta:s,pos1:e,pos2:n,pos3:r,pos4:o,origin:a,beforeOrigin:a,isPersisted:!0})}var eR=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=eM({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},QT(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new xD,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var e=t.props.parentMoveable;e?e.checkUpdateRect():(lS(t._observerId),t._observerId=aS(function(){t.isDragging()||t.updateRect()}))}},t._onPreventClick=function(t){t.stopPropagation(),t.preventDefault()},t}return tM(n,e),n.prototype.render=function(){var t=this.props,e=this.getState(),n=t.parentPosition,o=t.className,i=t.target,s=t.zoom,a=t.cspNonce,l=t.translateZ,c=t.cssStyled,u=t.groupable,d=t.linePadding,p=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var f=nM(n||[0,0],2),h=f[0],m=f[1],g=e.left,v=e.top,y=e.target,b=e.direction,x=e.hasFixed,w=e.offsetDelta,k=t.targets,E=this.isDragging(),C={};this.getEnabledAbles().forEach(function(t){C["data-able-".concat(t.name.toLowerCase())]=!0});var S=this._getAbleClassName(),D=k&&k.length&&(y||u)||i||!this._hasFirstTarget&&this.state.isPersisted,M=this.controlBox||this.props.firstRenderState||this.props.persistData,O=[g-h,v-m];!u&&t.useAccuratePosition&&(O[0]+=w[0],O[1]+=w[1]);var _={position:x?"fixed":"absolute",display:D?"block":"none",visibility:M?"visible":"hidden",transform:"translate3d(".concat(O[0],"px, ").concat(O[1],"px, ").concat(l,")"),"--zoom":s,"--zoompx":"".concat(s,"px")};return d&&(_["--moveable-line-padding"]=d),p&&(_["--moveable-control-padding"]=p),r.createElement(c,eM({cspNonce:a,ref:IC(this,"controlBox"),className:"".concat(G_("control-box",-1===b?"reverse":"",E?"dragging":"")," ").concat(S," ").concat(o)},C,{onClick:this._onPreventClick,style:_}),this.renderAbles(),this._renderLines())},n.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,e=t.parentMoveable,n=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),n||e||this.state.isPersisted||(this.updateRect("",!1,!1),this.forceUpdate())},n.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},n.prototype.componentWillUnmount=function(){var t,e;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),null===(t=this._reiszeObserver)||void 0===t||t.disconnect(),null===(e=this._mutationObserver)||void 0===e||e.disconnect(),this._viewContainer&&this._changeAbleViewClassNames([]),DA(this,!1),DA(this,!0);var n=this.events;for(var r in n){var o=n[r];o&&o.destroy()}},n.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},n.prototype.getAble=function(t){return sS(this.props.ables||[],function(e){return e.name===t})},n.prototype.getContainer=function(){var t=this.props,e=t.parentMoveable,n=t.wrapperMoveable;return t.container||n&&n.getContainer()||e&&e.getContainer()||this.controlBox.parentElement},n.prototype.getControlBoxElement=function(){return this.controlBox},n.prototype.getDragElement=function(){return this._dragTarget},n.prototype.isMoveableElement=function(t){var e;return t&&((null===(e=t.getAttribute)||void 0===e?void 0:e.call(t,"class"))||"").indexOf(wM)>-1},n.prototype.dragStart=function(t){var e=this.targetGesto,n=this.controlGesto;return e&&YT(this)({inputEvent:t})?e.isFlag()||e.triggerDragStart(t):n&&this.isMoveableElement(t.target)&&(n.isFlag()||n.triggerDragStart(t)),this},n.prototype.hitTest=function(t){var e,n=this.state,r=n.target,o=n.pos1,i=n.pos2,s=n.pos3,a=n.pos4,l=n.targetClientRect;if(!r)return 0;if(AS(t)){var c=t.getBoundingClientRect();e={left:c.left,top:c.top,width:c.width,height:c.height}}else e=eM({width:0,height:0},t);var u=e.left,d=e.top,p=e.width,f=e.height,h=_D([o,i,a,s],l),m=OD(ID(h,[[u,d],[u+p,d],[u+p,d+f],[u,d+f]])),g=OD(h);return m&&g?Math.min(100,m/g*100):0},n.prototype.isInside=function(t,e){var n=this.state,r=n.target,o=n.pos1,i=n.pos2,s=n.pos3,a=n.pos4,l=n.targetClientRect;return!!r&&TD([t,e],_D([o,i,a,s],l))},n.prototype.updateRect=function(t,e,n){void 0===n&&(n=!0);var r=this.props,o=!r.parentPosition&&!r.wrapperMoveable;o&&pO(!0);var i=r.parentMoveable,s=this.state.target||r.target,a=this.getContainer(),l=i?i._rootContainer:this._rootContainer,c=QT(this.controlBox,s,a,a,l||a,this._getRequestStyles());if(!s&&this._hasFirstTarget&&r.persistData){var u=tR(r.persistData);for(var d in u)c[d]=u[d]}o&&pO(),this.updateState(c,!i&&n)},n.prototype.isDragging=function(t){var e,n,r=this.targetGesto,o=this.controlGesto;return(null==r?void 0:r.isFlag())?!t||!!(null===(e=r.getEventData()[t])||void 0===e?void 0:e.isEventStart):!!(null==o?void 0:o.isFlag())&&(!t||!!(null===(n=o.getEventData()[t])||void 0===n?void 0:n.isEventStart))},n.prototype.updateTarget=function(t){this.updateRect(t,!0)},n.prototype.getRect=function(){var t=this.state,e=CA(this.state),n=nM(e,4),r=n[0],o=n[1],i=n[2],s=n[3],a=cA(e),l=t.width,c=t.height,u=a.width,d=a.height,p=a.left,f=a.top,h=[t.left,t.top],m=HS(h,t.origin);return{width:u,height:d,left:p,top:f,pos1:r,pos2:o,pos3:i,pos4:s,offsetWidth:l,offsetHeight:c,beforeOrigin:HS(h,t.beforeOrigin),origin:m,transformOrigin:t.transformOrigin,rotation:this.getRotation()}},n.prototype.getManager=function(){return this},n.prototype.stopDrag=function(t){var e;t&&"target"!==t||(!1===(null==(e=this.targetGesto)?void 0:e.isIdle())&&SA(this,!1),null==e||e.stop());t&&"control"!==t||(!1===(null==(e=this.controlGesto)?void 0:e.isIdle())&&SA(this,!0),null==e||e.stop())},n.prototype.getRotation=function(){var t=this.state;return function(t,e,n){var r=mS(t,e)/Math.PI*180;return(r=n>=0?r:180-r)>=0?r:360+r}(t.pos1,t.pos2,t.direction)},n.prototype.request=function(t,e,n){void 0===e&&(e={});var r=this,o=r.props,i=o.parentMoveable||o.wrapperMoveable||r,s=i.props.ables,a=o.groupable,l=sS(s,function(e){return e.name===t});if(this.isDragging()||!l||!l.request)return{request:function(){return this},requestEnd:function(){return this}};var c=l.request(r),u=n||e.isInstant,d=c.isControl?"controlAbles":"targetAbles",p="".concat(a?"Group":"").concat(c.isControl?"Control":""),f=rM([],nM(i[d]),!1),h={request:function(e){return UT(r,f,["drag"],p,"",eM(eM({},c.request(e)),{requestAble:t,isRequest:!0}),u),h},requestEnd:function(){return UT(r,f,["drag"],p,"End",eM(eM({},c.requestEnd()),{requestAble:t,isRequest:!0}),u),h}};return UT(r,f,["drag"],p,"Start",eM(eM({},c.requestStart(e)),{requestAble:t,isRequest:!0}),u),u?h.request(e).requestEnd():h},n.prototype.getMoveables=function(){return[this]},n.prototype.destroy=function(){this.componentWillUnmount()},n.prototype.updateRenderPoses=function(){var t=this.getState(),e=this.props,n=e.padding,r=t.originalBeforeOrigin,o=t.transformOrigin,i=t.allMatrix,s=t.is3d,a=t.pos1,l=t.pos2,c=t.pos3,u=t.pos4,d=t.left,p=t.top,f=t.isPersisted;if(n){var h=rT(n),m=h.left,g=h.top,v=h.bottom,y=h.right,b=s?4:3,x=BS(b,nD((f?o:this.controlBox&&e.groupable?r:HS(r,[d,p])).map(function(t){return-t}),b),i,nD(o,b));t.renderPoses=[jA(x,a,[-m,-g],b),jA(x,l,[y,-g],b),jA(x,c,[-m,v],b),jA(x,u,[y,v],b)]}else t.renderPoses=[a,l,c,u]},n.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,e=t.target,n=t.container,r=t.parentMoveable,o=this.state,i=o.target,s=o.container;if(i||e){this.updateAbles();var a=!LA(i,e);if(a||!LA(s,n)){var l=n||this.controlBox;l&&this.unsetAbles(),this.updateState({target:e,container:n}),!r&&l&&this.updateRect("End",!1,!1),this._isPropTargetChanged=a}}},n.prototype.waitToChangeTarget=function(){return new Promise(function(){})},n.prototype.triggerEvent=function(t,e){var n=this.props;if(this._emitter.trigger(t,e),n.parentMoveable&&e.isRequest&&!e.isRequestChild)return n.parentMoveable.triggerEvent(t,e,!0);var r=n[t];return r&&r(e)},n.prototype.useCSS=function(t,e){var n=this.props.customStyledMap,r=t+e;return n[r]||(n[r]=ZD(t,e)),n[r]},n.prototype.getState=function(){var t,e=this.props;(e.target||(null===(t=e.targets)||void 0===t?void 0:t.length))&&(this._hasFirstTarget=!0);var n=this.controlBox,r=e.persistData,o=e.firstRenderState;if(o&&!n)return o;if(!this._hasFirstTarget&&r){var i=tR(r);if(i)return this.updateState(i,!1),this.state}return this.state.isPersisted=!1,this.state},n.prototype.updateSelectors=function(){},n.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(e){e.unset&&e.unset(t)})},n.prototype.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var n=this.props.triggerAblesSimultaneously,r=this.getEnabledAbles(t),o="drag".concat(e,"Start"),i="pinch".concat(e,"Start"),s="drag".concat(e,"ControlStart"),a=PA(r,[o,i],n),l=PA(r,[s],n);this.enabledAbles=r,this.targetAbles=a,this.controlAbles=l},n.prototype.updateState=function(t,e){if(e){if(this.isUnmounted)return;this.setState(t)}else{var n=this.state;for(var r in t)n[r]=t[r]}},n.prototype.getEnabledAbles=function(t){void 0===t&&(t=this.props.ables);var e=this.props;return t.filter(function(t){return t&&(t.always&&!1!==e[t.name]||e[t.name])})},n.prototype.renderAbles=function(){var e,n,r,o,i=this,s=this.props.triggerAblesSimultaneously,a={createElement:t.createElement};return this.renderState={},(e=zA(PA(this.getEnabledAbles(),["render"],s).map(function(t){return(0,t.render)(i,a)||[]})).filter(function(t){return t}),n=function(t){return t.key},r=[],o={},e.forEach(function(t,i){var s=n(t,i,e),a=o[s];a||(a=[],o[s]=a,r.push(a)),a.push(t)}),r).map(function(t){return t[0]})},n.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},n.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(t,e){var n,r,o=null!==(r=null===(n=e.requestStyle)||void 0===n?void 0:n.call(e))&&void 0!==r?r:[];return rM(rM([],nM(t),!1),nM(o),!1)},rM([],nM(this.props.requestStyles||[]),!1));return t},n.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},n.prototype._updateEvents=function(){var t=this.controlBox,e=this.targetAbles.length,n=this.controlAbles.length,r=this._dragTarget;(!e&&this.targetGesto||this._isTargetChanged(!0))&&(DA(this,!1),this.updateState({gestos:{}})),n||DA(this,!0),r&&e&&!this.targetGesto&&(this.targetGesto=KT(this,r,"")),!this.controlGesto&&n&&(this.controlGesto=XT(this,t,"controlAbles","Control"))},n.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=WA(this._originalDragTarget,!0)},n.prototype._renderLines=function(){var e=this.props,n=e.zoom,r=e.hideDefaultLines,o=e.hideChildMoveableDefaultLines,i=e.parentMoveable;if(r||i&&o)return[];var s=this.getState().renderPoses,a={createElement:t.createElement};return[[0,1],[1,3],[3,2],[2,0]].map(function(t,e){var r=nM(t,2),o=r[0],i=r[1];return xO(a,"",s[o],s[i],n,"render-line-".concat(e))})},n.prototype._isTargetChanged=function(t){var e=this.props,n=e.dragTarget||e.target,r=this._prevOriginalDragTarget,o=this._prevDragArea,i=e.dragArea;return!i&&r!==n||(t||i)&&o!==i||this._prevPropTarget!=this._propTarget},n.prototype._updateNativeEvents=function(){var t=this,e=this.props.dragArea?this.areaElement:this.state.target,n=this.events,r=cS(n);if(this._isTargetChanged())for(var o in n){var i=n[o];i&&i.destroy(),n[o]=null}if(e){var s=this.enabledAbles;r.forEach(function(r){var o=PA(s,[r]),i=o.length>0,a=n[r];i?(a||(a=new JT(e,t,r),n[r]=a),a.setAbles(o)):a&&(a.destroy(),n[r]=null)})}},n.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=WA(t,!0))},n.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=WA(t,!0)),this._viewContainer&&this._changeAbleViewClassNames(rM(rM([],nM(this._getAbleViewClassNames()),!1),[this.isDragging()?fT:""],!1))},n.prototype._changeAbleViewClassNames=function(t){var e=this._viewContainer,n=IA(t.filter(Boolean),function(t){return t}).map(function(t){return nM(t,1)[0]}),r=this._viewClassNames,o=fD(r,n),i=o.removed,s=o.added;i.forEach(function(t){kS(e,r[t])}),s.forEach(function(t){wS(e,n[t])}),this._viewClassNames=n},n.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(e){var n;return(null===(n=e.viewClassName)||void 0===n?void 0:n.call(e,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},n.prototype._getAbleClassName=function(t){var e=this;void 0===t&&(t="");var n=this.getEnabledAbles(),r=this.targetGesto,o=this.controlGesto,i=(null==r?void 0:r.isFlag())?r.getEventData():{},s=(null==o?void 0:o.isFlag())?o.getEventData():{};return n.map(function(n){var r,o,a,l=n.name,c=(null===(r=n.className)||void 0===r?void 0:r.call(n,e))||"";return((null===(o=i[l])||void 0===o?void 0:o.isEventStart)||(null===(a=s[l])||void 0===a?void 0:a.isEventStart))&&(c+=" ".concat(G_("".concat(l).concat(t,"-dragging")))),c.trim()}).filter(Boolean).join(" ")},n.prototype._updateResizeObserver=function(t){var e,n=this.props,r=n.target,o=OS(this.getControlBoxElement());if(o.ResizeObserver&&r&&n.useResizeObserver){if(t.target!==r||!this._reiszeObserver){var i=new o.ResizeObserver(this.checkUpdateRect);i.observe(r,{box:"border-box"}),this._reiszeObserver=i}}else null===(e=this._reiszeObserver)||void 0===e||e.disconnect()},n.prototype._updateMutationObserver=function(t){var e,n=this,r=this.props,o=r.target,i=OS(this.getControlBoxElement());if(i.MutationObserver&&o&&r.useMutationObserver){if(t.target!==o||!this._mutationObserver){var s=new i.MutationObserver(function(t){var e,r;try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),i=o.next();!i.done;i=o.next()){var s=i.value;"attributes"===s.type&&"style"===s.attributeName&&n.checkUpdateRect()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}});s.observe(o,{attributes:!0}),this._mutationObserver=s}}else null===(e=this._mutationObserver)||void 0===e||e.disconnect()},n.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:U_,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},n}(r.PureComponent),nR={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var n,r=t.props,o=r.targets||[],i=t.getState(),s=i.left,a=i.top,l=i.isPersisted,c=r.zoom||1,u=t.renderGroupRects,d=(null===(n=r.persistData)||void 0===n?void 0:n.children)||[];l?o=d.map(function(){return null}):d=[];var p=QA(t,"parentPosition",[s,a],function(t){return t.join(",")}),f=QA(t,"requestStyles",t.getRequestChildStyles(),function(t){return t.join(",")});return t.moveables=t.moveables.slice(0,o.length),rM(rM([],nM(o.map(function(n,o){return e.createElement(eR,{key:"moveable"+o,ref:zC(t,"moveables",o),target:n,origin:!1,requestStyles:f,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,a],persistData:d[o],zoom:c})})),!1),nM(zA(u.map(function(t,n){var r=[t.pos1,t.pos2,t.pos3,t.pos4];return[[0,1],[1,3],[3,2],[2,0]].map(function(t,o){var i=nM(t,2),s=i[0],a=i[1];return xO(e,"",$S(r[s],p),$S(r[a],p),c,"group-rect-".concat(n,"-").concat(o))})}))),!1)}},rR=oM("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var n=t.props.target,r=e.inputEvent,o=e.inputTarget,i=!t.isMoveableElement(o)&&t.controlBox.contains(o);if(r&&o&&!e.isDrag&&!t.isMoveableElement(o)&&!i){var s=n.contains(o);RA(t,"onClick",_A(t,e,{isDouble:e.isDouble,inputTarget:o,isTarget:n===o,moveableTarget:t.props.target,containsTarget:s}))}},dragGroupEnd:function(t,e){var n=e.inputEvent,r=e.inputTarget;if(n&&r&&!e.isDrag&&!t.isMoveableElement(r)&&e.datas.inputTarget!==r){var o=t.props.targets,i=o.indexOf(r),s=i>-1,a=!1;-1===i&&(a=(i=iS(o,function(t){return t.contains(r)}))>-1),RA(t,"onClickGroup",_A(t,e,{isDouble:e.isDouble,targets:o,inputTarget:r,targetIndex:i,isTarget:s,containsTarget:a,moveableTarget:o[i]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function oR(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),eM(eM({},t),{datas:e})}var iR=oM("edgeDraggable",{css:[".edge.edgeDraggable.line {\ncursor: move;\n}"],render:function(t,e){var n=t.props,r=n.edgeDraggable;return r?wO(e,"edgeDraggable",r,t.getState().renderPoses,n.zoom):[]},dragCondition:function(t,e){var n,r=t.props,o=null===(n=e.inputEvent)||void 0===n?void 0:n.target;return!(!r.edgeDraggable||!o)&&(!r.draggable&&xS(o,G_("direction"))&&xS(o,G_("edge"))&&xS(o,G_("edgeDraggable")))},dragStart:function(t,e){return u_.dragStart(t,oR(e))},drag:function(t,e){return u_.drag(t,oR(e))},dragEnd:function(t,e){return u_.dragEnd(t,oR(e))},dragGroupCondition:function(t,e){var n,r=t.props,o=null===(n=e.inputEvent)||void 0===n?void 0:n.target;return!(!r.edgeDraggable||!o)&&(!r.draggable&&xS(o,G_("direction"))&&xS(o,G_("line")))},dragGroupStart:function(t,e){return u_.dragGroupStart(t,oR(e))},dragGroup:function(t,e){return u_.dragGroup(t,oR(e))},dragGroupEnd:function(t,e){return u_.dragGroupEnd(t,oR(e))},unset:function(t){return u_.unset(t)}}),sR={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},aR=[WT,xT,W_,oT,u_,iR,h_,sT,cT,w_,bT,wT,vT,jT,BT,VT,nR,sR,rR,gT,GT];function lR(t,e){var n=nM(t,3),r=n[0],o=n[1],i=n[2];return(r*e[0]+o*e[1]+i)/Math.sqrt(r*r+o*o)}function cR(t,e){var n=nM(t,2),r=n[0],o=n[1];return-r*e[0]-o*e[1]}function uR(t,e){return Math.max.apply(Math,rM([],nM(t.map(function(t){var n=nM(t,4),r=n[0],o=n[1],i=n[2],s=n[3];return Math.max(r[e],o[e],i[e],s[e])})),!1))}function dR(t,e){return Math.min.apply(Math,rM([],nM(t.map(function(t){var n=nM(t,4),r=n[0],o=n[1],i=n[2],s=n[3];return Math.min(r[e],o[e],i[e],s[e])})),!1))}function pR(t,e){var n=e.map(function(e){if(UC(e)){var n=pR(t,e),r=n.length;return r>1?n:1===r?n[0]:null}var o=sS(t,function(t){return t.manager.props.target===e});return o?(o.finded=!0,o.manager):null}).filter(Boolean);return 1===n.length&&UC(n[0])?n[0]:n}var fR=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.differ=new yD,e.moveables=[],e.transformOrigin="50% 50%",e.renderGroupRects=[],e._targetGroups=[],e._hasFirstTargets=!1,e}return tM(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,e,n){var r;void 0===n&&(n=!0);var o=this.state;if(this.controlBox&&!o.isPersisted){pO(!0),this.moveables.forEach(function(e){e.updateRect(t,!1,!1)});var i=this.props,s=this.moveables,a=o.target||i.target,l=s.map(function(t){return{finded:!1,manager:t}}),c=this.props.targetGroups||[],u=pR(l,c),d=i.useDefaultGroupRotate;u.push.apply(u,rM([],nM(l.filter(function(t){return!t.finded}).map(function(t){return t.manager})),!1));var p=[],f=!e||""!==t&&i.updateGroup,h=i.defaultGroupRotate||0;if(!this._hasFirstTargets){var m=null===(r=i.persistData)||void 0===r?void 0:r.rotation;null!=m&&(h=m)}var g=function t(e,n,r){var o=e.map(function(e){if(UC(e)){var r=t(e,n),o=[r.pos1,r.pos2,r.pos3,r.pos4];return p.push(r),{poses:o,rotation:r.rotation}}return{poses:CA(e.state),rotation:e.getRotation()}}),i=o.map(function(t){return t.rotation}),s=0,a=i[0],l=i.every(function(t){return Math.abs(a-t)<.1});s=f?!d&&l?a:h:d||r||!l?n:a;var c=o.map(function(t){return t.poses}),u=function(t,e){var n,r,o,i=[0,0],s=[0,0],a=[0,0],l=[0,0],c=0,u=0;if(!t.length)return{pos1:i,pos2:s,pos3:a,pos4:l,minX:0,minY:0,maxX:0,maxY:0,width:c,height:u,rotation:e};var d=yS(e,DM);if(d%90){var p=d/180*Math.PI,f=Math.tan(p),h=-1/f,m=[OM,_M],g=[[0,0],[0,0]],v=[OM,_M],y=[[0,0],[0,0]];t.forEach(function(t){t.forEach(function(t){var e=lR([-f,1,0],t),n=lR([-h,1,0],t);m[0]>e&&(g[0]=t,m[0]=e),m[1]<e&&(g[1]=t,m[1]=e),v[0]>n&&(y[0]=t,v[0]=n),v[1]<n&&(y[1]=t,v[1]=n)})});var b=nM(g,2),x=b[0],w=b[1],k=nM(y,2),E=k[0],C=k[1],S=[-f,1,cR([-f,1],x)],D=[-f,1,cR([-f,1],w)],M=[-h,1,cR([-h,1],E)],O=[-h,1,cR([-h,1],C)];n=nM([[S,M],[S,O],[D,M],[D,O]].map(function(t){var e=nM(t,2);return ND(e[0],e[1])[0]}),4),i=n[0],s=n[1],a=n[2],l=n[3],c=v[1]-v[0],u=m[1]-m[0]}else{var _=dR(t,0),A=dR(t,1),T=uR(t,0),R=uR(t,1);i=[_,A],s=[T,A],a=[_,R],l=[T,R],c=T-_,u=R-A,d%180&&(i=(r=nM([a,i,l,s],4))[0],s=r[1],a=r[2],l=r[3],c=R-A,u=T-_)}d%360>180&&(i=(o=nM([l,a,s,i],4))[0],s=o[1],a=o[2],l=o[3]);var N=AD([i,s,a,l]);return{pos1:i,pos2:s,pos3:a,pos4:l,width:c,height:u,minX:N.minX,minY:N.minY,maxX:N.maxX,maxY:N.maxY,rotation:e}}(c,s);return u}(u,this.rotation,!0);f&&(this.rotation=g.rotation,this.transformOrigin=i.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=c,this.renderGroupRects=p;var v,y,b,x,w,k=this.transformOrigin,E=this.rotation,C=this.scale,S=g.width,D=g.height,M=g.minX,O=g.minY,_=(v=[[0,0],[S,0],[0,D],[S,D]],y=JA(k,S,D),b=this.rotation/180*Math.PI,x=v.map(function(t){return $S(t,y)}),w=x.map(function(t){return XS(t,b)}),{prev:x,next:w,result:w.map(function(t){return HS(t,y)})}),A=AD(_.result),T=A.minX,R=A.minY,N=" rotate(".concat(E,"deg)")+" scale(".concat(tT(C[0]),", ").concat(tT(C[1]),")"),P="translate(".concat(-T,"px, ").concat(-R,"px)").concat(N);this.controlBox.style.transform="translate3d(".concat(M,"px, ").concat(O,"px, ").concat(this.props.translateZ||0,")"),a.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(k,";")+"width:".concat(S,"px;height:").concat(D,"px;")+"transform: ".concat(P),o.width=S,o.height=D;var L=this.getContainer(),I=QT(this.controlBox,a,this.controlBox,this.getContainer(),this._rootContainer||L,[]),z=[I.left,I.top],F=nM(CA(I),4),B=F[0],j=F[1],H=F[2],$=F[3],q=AD([B,j,H,$]),V=[q.minX,q.minY],W=tT(C[0]*C[1]);I.pos1=$S(B,V),I.pos2=$S(j,V),I.pos3=$S(H,V),I.pos4=$S($,V),I.left=M-I.left+V[0],I.top=O-I.top+V[1],I.origin=$S(HS(z,I.origin),V),I.beforeOrigin=$S(HS(z,I.beforeOrigin),V),I.originalBeforeOrigin=HS(z,I.originalBeforeOrigin),I.transformOrigin=$S(HS(z,I.transformOrigin),V),a.style.transform="translate(".concat(-T-V[0],"px, ").concat(-R-V[1],"px)")+N,pO(),this.updateState(eM(eM({},I),{posDelta:V,direction:W,beforeDirection:W}),n)}},e.prototype.getRect=function(){return eM(eM({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(e,n,r){if(r||e.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,e,n);this._emitter.trigger(e,n)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(t,e){var n,r,o=null!==(r=null===(n=e.requestChildStyle)||void 0===n?void 0:n.call(e))&&void 0!==r?r:[];return rM(rM([],nM(t),!1),nM(o),!1)},[]);return t},e.prototype.getMoveables=function(){return rM([],nM(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,rM(rM([],nM(this.props.ables),!1),[nR],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=WA(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,e=this.props,n=this._prevDragTarget,r=e.dragTarget||this.areaElement,o=e.targets,i=this.differ.update(o),s=i.added,a=i.changed,l=i.removed,c=s.length||l.length;(c||this._prevOriginalDragTarget!==this._originalDragTarget)&&(DA(this,!1),DA(this,!0),this.updateState({gestos:{}})),n!==r&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=KT(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=XT(this,this.controlBox,"controlAbles","GroupControl")));var u=!LA(t.container,e.container);u&&(t.container=e.container),(u||c||this.transformOrigin!==(e.defaultGroupOrigin||"50% 50%")||a.length||o.length&&!ZA(this._targetGroups,e.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!c},e.prototype._updateObserver=function(){},e.defaultProps=eM(eM({},eR.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(eR),hR=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveables=[],e}return tM(e,t),e.prototype.render=function(){var t,e=this,n=this.props,o=n.cspNonce,i=n.cssStyled,s=n.persistData,a=n.targets||[],l=a.length,c=this.isUnmounted||!l,u=null!==(t=null==s?void 0:s.children)&&void 0!==t?t:[];return c&&!l&&u.length?a=u.map(function(){return null}):c||(u=[]),r.createElement(i,{cspNonce:o,ref:IC(this,"controlBox"),className:G_("control-box")},a.map(function(t,o){var i,s,a=null!==(s=null===(i=n.individualGroupableProps)||void 0===i?void 0:i.call(n,t,o))&&void 0!==s?s:{};return r.createElement(eR,eM({key:"moveable"+o,ref:zC(e,"moveables",o)},n,a,{target:t,wrapperMoveable:e,isWrapperMounted:e.isMoveableMounted,persistData:u[o]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,e,n){void 0===n&&(n=!0),pO(!0),this.moveables.forEach(function(r){r.updateRect(t,e,n)}),pO()},e.prototype.getRect=function(){return eM(eM({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,e,n){void 0===e&&(e={});var r=this.moveables.map(function(n){return n.request(t,eM(eM({},e),{isInstant:!1}),!1)}),o={request:function(t){return r.forEach(function(e){return e.request(t)}),this},requestEnd:function(){return r.forEach(function(t){return t.requestEnd()}),this}};return n||e.isInstant?o.request(e).requestEnd():o},e.prototype.dragStart=function(t){var e=t.target,n=sS(this.moveables,function(t){var n=t.getTargets()[0],r=t.getControlBoxElement(),o=t.getDragElement();return!(!n||!o)&&(o===e||o.contains(e)||o!==n&&n===e||n.contains(e)||r===e||r.contains(e))});return n&&n.dragStart(t),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return rM([],nM(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e}(eR);function mR(t,e){var n=[];return t.forEach(function(t){t&&(YC(t)?e[t]&&n.push.apply(n,rM([],nM(e[t]),!1)):UC(t)?n.push.apply(n,rM([],nM(mR(t,e)),!1)):n.push(t))}),n}function gR(t,e){var n=[];return t.forEach(function(t){t&&(YC(t)?e[t]&&n.push.apply(n,rM([],nM(e[t]),!1)):UC(t)?n.push(gR(t,e)):n.push(t))}),n}function vR(t,e){return t.length!==e.length||t.some(function(t,n){var r=e[n];return!(!t&&!r)&&(t!=r&&(!UC(t)||!UC(r)||vR(t,r)))})}var yR=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e._differ=new yD,e._elementTargets=[],e._tmpRefTargets=[],e._tmpSelectorMap={},e._onChangeTargets=null,e}var n,o;return tM(e,t),e.makeStyled=function(){var t={};this.getTotalAbles().forEach(function(e){var n=e.css;n&&n.forEach(function(e){t[e]=!0})});var e=cS(t).join("\n");this.defaultStyled=ZD("div",function(t,e){return e.replace(/([^}{]*){/gm,function(e,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}(wM,EM+e))},e.getTotalAbles=function(){return rM([xT,nR,sR,gT],nM(this.defaultAbles),!1)},e.prototype.render=function(){var t,e=this.constructor;e.defaultStyled||e.makeStyled();var n=this.props,o=n.ables,i=n.props,s=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}(n,["ables","props"]),a=nM(this._updateRefs(!0),2),l=a[0],c=a[1],u=mR(l,c),d=u.length>1,p=rM(rM([],nM(e.getTotalAbles()),!1),nM(o||[]),!1),f=eM(eM(eM({},s),i||{}),{ables:p,cssStyled:e.defaultStyled,customStyledMap:e.customStyledMap});this._elementTargets=u;var h=null,m=this.moveable,g=s.persistData;if((null==g?void 0:g.children)&&(d=!0),s.individualGroupable)return r.createElement(hR,eM({key:"individual-group",ref:IC(this,"moveable")},f,{target:null,targets:u}));if(d){var v=gR(l,c);if(m&&!m.props.groupable&&!m.props.individualGroupable){var y=m.props.target;y&&u.indexOf(y)>-1&&(h=eM({},m.state))}return r.createElement(fR,eM({key:"group",ref:IC(this,"moveable")},f,null!==(t=s.groupableProps)&&void 0!==t?t:{},{target:null,targets:u,targetGroups:v,firstRenderState:h}))}var b=u[0];if(m&&(m.props.groupable||m.props.individualGroupable)){var x=sS(m.moveables||[],function(t){return t.props.target===b});x&&(h=eM({},x.state))}return r.createElement(eR,eM({key:"single",ref:IC(this,"moveable")},f,{target:b,firstRenderState:h}))},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,e;return null!==(e=null===(t=this.moveable)||void 0===t?void 0:t.getTargets())&&void 0!==e?e:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs()},e.prototype.waitToChangeTarget=function(){var t,e=this;return this._onChangeTargets=function(){e._onChangeTargets=null,t()},new Promise(function(e){t=e})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var e=this.refTargets,n=GA(this.props.target||this.props.targets),r="undefined"!=typeof document,o=vR(e,n),i=this.selectorMap,s={};return this.refTargets.forEach(function t(e){YC(e)?i[e]?s[e]=i[e]:r&&(o=!0,s[e]=[].slice.call(document.querySelectorAll(e))):UC(e)&&e.forEach(t)}),this._tmpRefTargets=n,this._tmpSelectorMap=s,[n,s,!t&&o]},e.prototype._checkChangeTargets=function(){var t,e,n;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var r=this._differ.update(this._elementTargets),o=r.added,i=r.removed;(o.length||i.length)&&(null===(e=(t=this.props).onChangeTargets)||void 0===e||e.call(t,{moveable:this.moveable,targets:this._elementTargets}),null===(n=this._onChangeTargets)||void 0===n||n.call(this));var s=nM(this._updateRefs(),3),a=s[0],l=s[1],c=s[2];this.refTargets=a,this.selectorMap=l,c&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,function(t,e,n,r){var o,i=arguments.length,s=i<3?e:r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);i>3&&s&&Object.defineProperty(e,n,s)}([(n=NM,void 0===o&&(o={}),function(t,e){n.forEach(function(n){var r=o[n]||n;r in t||(t[r]=function(){for(var t,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=(t=this[e])[n].apply(t,r);return i===this[e]?this:i})})})],e.prototype,"moveable",void 0),e}(r.PureComponent),bR=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tM(e,t),e.defaultAbles=aR,e}(yR);const xR=({editor:t})=>React.createElement(React.Fragment,null,React.createElement(bR,{target:document.querySelector(".ProseMirror-selectednode"),container:null,origin:!1,edge:!1,throttleDrag:0,keepRatio:!0,resizable:!0,throttleResize:0,onResize:({target:t,width:e,height:n,delta:r})=>{r[0]&&(t.style.width=`${e}px`),r[1]&&(t.style.height=`${n}px`)},onResizeEnd:()=>{(()=>{const e=document.querySelector(".ProseMirror-selectednode");if(e){const n=t.state.selection;t.commands.setImage({src:e.src,width:Number(e.style.width.replace("px","")),height:Number(e.style.height.replace("px",""))}),t.commands.setNodeSelection(n.from)}})()},scalable:!0,throttleScale:0,renderDirections:["w","e"],onScale:({target:t,transform:e})=>{t.style.transform=e}}));return function({completionApi:e="/api/generate",className:n="novel-relative novel-min-h-[500px] novel-w-full novel-max-w-screen-lg novel-border-stone-200 novel-bg-white sm:novel-mb-[calc(20vh)] sm:novel-rounded-lg sm:novel-border sm:novel-shadow-lg",defaultValue:r=mb,extensions:o=[],editorProps:i={},onUpdate:s=()=>{},onDebouncedUpdate:a=()=>{},debounceDuration:l=750,storageKey:c="novel__content",disableLocalStorage:u=!1,handleImageUpload:d}){const[p,f]=((e,n)=>{const[r,o]=t.useState(n);return t.useEffect(()=>{const t=window.localStorage.getItem(e);t&&o(JSON.parse(t))},[e]),[r,t=>{o(t),window.localStorage.setItem(e,JSON.stringify(t))}]})(c,r),[h,m]=t.useState(!1),g=function(e,n,r){var o=this,i=t.useRef(null),s=t.useRef(0),a=t.useRef(null),l=t.useRef([]),c=t.useRef(),u=t.useRef(),d=t.useRef(e),p=t.useRef(!0);t.useEffect(function(){d.current=e},[e]);var f=!n&&0!==n&&"undefined"!=typeof window;if("function"!=typeof e)throw new TypeError("Expected a function");n=+n||0;var h=!!(r=r||{}).leading,m=!("trailing"in r)||!!r.trailing,g="maxWait"in r,v=g?Math.max(+r.maxWait||0,n):null;t.useEffect(function(){return p.current=!0,function(){p.current=!1}},[]);var y=t.useMemo(function(){var t=function(t){var e=l.current,n=c.current;return l.current=c.current=null,s.current=t,u.current=d.current.apply(n,e)},e=function(t,e){f&&cancelAnimationFrame(a.current),a.current=f?requestAnimationFrame(t):setTimeout(t,e)},r=function(t){if(!p.current)return!1;var e=t-i.current;return!i.current||e>=n||e<0||g&&t-s.current>=v},y=function(e){return a.current=null,m&&l.current?t(e):(l.current=c.current=null,u.current)},b=function t(){var o=Date.now();if(r(o))return y(o);if(p.current){var a=n-(o-i.current),l=g?Math.min(a,v-(o-s.current)):a;e(t,l)}},x=function(){var d=Date.now(),f=r(d);if(l.current=[].slice.call(arguments),c.current=o,i.current=d,f){if(!a.current&&p.current)return s.current=i.current,e(b,n),h?t(i.current):u.current;if(g)return e(b,n),t(i.current)}return a.current||e(b,n),u.current};return x.cancel=function(){a.current&&(f?cancelAnimationFrame(a.current):clearTimeout(a.current)),s.current=0,l.current=i.current=c.current=a.current=null},x.isPending=function(){return!!a.current},x.flush=function(){return a.current?y(Date.now()):u.current},x},[h,g,n,v,m,f]);return y}(async({editor:t})=>{const e=t.getJSON();a(t),u||f(e)},l),v=Hc({extensions:[...Zv,...o],editorProps:{...ou,...i},onUpdate:t=>{const e=t.editor.state.selection;"++"!==xC(t.editor,{chars:2})||x?(s(t.editor),g(t)):(t.editor.commands.deleteRange({from:e.from-2,to:e.from}),y(xC(t.editor,{chars:5e3})))},autofocus:"end"}),{complete:y,completion:b,isLoading:x,stop:w}=function({api:e="/api/completion",id:n,initialCompletion:r="",initialInput:o="",credentials:i,headers:s,body:a,onResponse:l,onFinish:c,onError:u}={}){const d=t.useId(),p=n||d,{data:f,mutate:h}=Jy([e,p],null,{fallbackData:r}),{data:m=!1,mutate:g}=Jy([p,"loading"],null),{data:v,mutate:y}=Jy([p,"streamData"],null),[b,x]=t.useState(void 0),w=f,[k,E]=t.useState(null),C=t.useRef({credentials:i,headers:s,body:a});t.useEffect(()=>{C.current={credentials:i,headers:s,body:a}},[i,s,a]);const S=t.useCallback(async(t,n)=>hb({api:e,prompt:t,credentials:C.current.credentials,headers:{...C.current.headers,...null==n?void 0:n.headers},body:{...C.current.body,...null==n?void 0:n.body},setCompletion:t=>h(t,!1),setLoading:g,setError:x,setAbortController:E,onResponse:l,onFinish:c,onError:u,onData:t=>{y([...v||[],...t||[]],!1)}}),[h,g,e,C,E,l,c,u,x,v,y]),D=t.useCallback(()=>{k&&(k.abort(),E(null))},[k]),M=t.useCallback(t=>{h(t,!1)},[h]),O=t.useCallback(async(t,e)=>S(t,e),[S]),[_,A]=t.useState(o),T=t.useCallback(t=>{if(t.preventDefault(),_)return O(_)},[_,O]);return{completion:w,complete:O,error:b,setCompletion:M,stop:D,input:_,setInput:A,handleInputChange:t=>{A(t.target.value)},handleSubmit:T,isLoading:m,data:v}}({id:"novel",api:e,onFinish:(t,e)=>{null==v||v.commands.setTextSelection({from:v.state.selection.from-e.length,to:v.state.selection.from})},onError:t=>{Jc.error(t.message)}}),k=t.useRef("");return t.useEffect(()=>{const t=b.slice(k.current.length);k.current=b,null==v||v.commands.insertContent(t)},[x,v,b]),t.useEffect(()=>{const t=t=>{("Escape"===t.key||t.metaKey&&"z"===t.key)&&(w(),"Escape"===t.key&&(null==v||v.commands.deleteRange({from:v.state.selection.from-b.length,to:v.state.selection.from})),null==v||v.commands.insertContent("++"))},e=t=>{t.preventDefault(),t.stopPropagation(),w(),window.confirm("AI writing paused. Continue?")&&y((null==v?void 0:v.getText())||"")};return x?(document.addEventListener("keydown",t),window.addEventListener("mousedown",e)):(document.removeEventListener("keydown",t),window.removeEventListener("mousedown",e)),()=>{document.removeEventListener("keydown",t),window.removeEventListener("mousedown",e)}},[w,x,v,y,b.length]),t.useEffect(()=>{if(!v||h)return;const t=u?r:p;t&&(v.commands.setContent(t),m(!0))},[v,r,p,h,u]),React.createElement($v.Provider,{value:{completionApi:e,handleUserImageUpload:d}},React.createElement("div",{onClick:()=>{null==v||v.chain().focus().run()},className:n},v&&React.createElement(bC,{editor:v}),(null==v?void 0:v.isActive("image"))&&React.createElement(xR,{editor:v}),React.createElement(Dc,{editor:v})))}});
