{"version":3,"file":"slash-command.jsx","sourceRoot":"","sources":["slash-command.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, {\r\n  useState,\r\n  useEffect,\r\n  useCallback,\r\n  ReactNode,\r\n  useRef,\r\n  useLayoutEffect,\r\n  useContext,\r\n} from \"react\";\r\nimport { Editor, Range, Extension } from \"@tiptap/core\";\r\nimport Suggestion from \"@tiptap/suggestion\";\r\nimport { ReactRenderer } from \"@tiptap/react\";\r\nimport tippy from \"tippy.js\";\r\nimport {\r\n  Heading1,\r\n  Heading2,\r\n  Heading3,\r\n  List,\r\n  ListOrdered,\r\n  Text,\r\n  TextQuote,\r\n  Image as ImageIcon,\r\n  Code,\r\n  CheckSquare,\r\n} from \"lucide-react\";\r\nimport { LoadingCircle } from \"@/ui/icons\";\r\nimport { toast } from \"sonner\";\r\nimport { startImageUpload } from \"../plugins/upload-images\";\r\nimport { NovelContext } from \"../provider\";\r\n\r\ninterface CommandItemProps {\r\n  title: string;\r\n  description: string;\r\n  icon: ReactNode;\r\n}\r\n\r\ninterface CommandProps {\r\n  editor: Editor;\r\n  range: Range;\r\n}\r\n\r\nconst Command = Extension.create({\r\n  name: \"slash-command\",\r\n  addOptions() {\r\n    return {\r\n      suggestion: {\r\n        char: \"/\",\r\n        command: ({\r\n          editor,\r\n          range,\r\n          props,\r\n        }: {\r\n          editor: Editor;\r\n          range: Range;\r\n          props: any;\r\n        }) => {\r\n          props.command({ editor, range });\r\n        },\r\n      },\r\n    };\r\n  },\r\n  addProseMirrorPlugins() {\r\n    return [\r\n      Suggestion({\r\n        editor: this.editor,\r\n        ...this.options.suggestion,\r\n      }),\r\n    ];\r\n  },\r\n});\r\n\r\nconst getSuggestionItems = ({ query }: { query: string }) => {\r\n  return [    \r\n    {\r\n      title: \"Text\",\r\n      description: \"Just start typing with plain text.\",\r\n      searchTerms: [\"p\", \"paragraph\"],\r\n      icon: <Text size={18} />,\r\n      command: ({ editor, range }: CommandProps) => {\r\n        editor\r\n          .chain()\r\n          .focus()\r\n          .deleteRange(range)\r\n          .toggleNode(\"paragraph\", \"paragraph\")\r\n          .run();\r\n      },\r\n    },\r\n    {\r\n      title: \"To-do List\",\r\n      description: \"Track tasks with a to-do list.\",\r\n      searchTerms: [\"todo\", \"task\", \"list\", \"check\", \"checkbox\"],\r\n      icon: <CheckSquare size={18} />,\r\n      command: ({ editor, range }: CommandProps) => {\r\n        editor.chain().focus().deleteRange(range).toggleTaskList().run();\r\n      },\r\n    },\r\n    {\r\n      title: \"Heading 1\",\r\n      description: \"Big section heading.\",\r\n      searchTerms: [\"title\", \"big\", \"large\"],\r\n      icon: <Heading1 size={18} />,\r\n      command: ({ editor, range }: CommandProps) => {\r\n        editor\r\n          .chain()\r\n          .focus()\r\n          .deleteRange(range)\r\n          .setNode(\"heading\", { level: 1 })\r\n          .run();\r\n      },\r\n    },\r\n    {\r\n      title: \"Heading 2\",\r\n      description: \"Medium section heading.\",\r\n      searchTerms: [\"subtitle\", \"medium\"],\r\n      icon: <Heading2 size={18} />,\r\n      command: ({ editor, range }: CommandProps) => {\r\n        editor\r\n          .chain()\r\n          .focus()\r\n          .deleteRange(range)\r\n          .setNode(\"heading\", { level: 2 })\r\n          .run();\r\n      },\r\n    },\r\n    {\r\n      title: \"Heading 3\",\r\n      description: \"Small section heading.\",\r\n      searchTerms: [\"subtitle\", \"small\"],\r\n      icon: <Heading3 size={18} />,\r\n      command: ({ editor, range }: CommandProps) => {\r\n        editor\r\n          .chain()\r\n          .focus()\r\n          .deleteRange(range)\r\n          .setNode(\"heading\", { level: 3 })\r\n          .run();\r\n      },\r\n    },\r\n    {\r\n      title: \"Bullet List\",\r\n      description: \"Create a simple bullet list.\",\r\n      searchTerms: [\"unordered\", \"point\"],\r\n      icon: <List size={18} />,\r\n      command: ({ editor, range }: CommandProps) => {\r\n        editor.chain().focus().deleteRange(range).toggleBulletList().run();\r\n      },\r\n    },\r\n    {\r\n      title: \"Numbered List\",\r\n      description: \"Create a list with numbering.\",\r\n      searchTerms: [\"ordered\"],\r\n      icon: <ListOrdered size={18} />,\r\n      command: ({ editor, range }: CommandProps) => {\r\n        editor.chain().focus().deleteRange(range).toggleOrderedList().run();\r\n      },\r\n    },\r\n    {\r\n      title: \"Quote\",\r\n      description: \"Capture a quote.\",\r\n      searchTerms: [\"blockquote\"],\r\n      icon: <TextQuote size={18} />,\r\n      command: ({ editor, range }: CommandProps) =>\r\n        editor\r\n          .chain()\r\n          .focus()\r\n          .deleteRange(range)\r\n          .toggleNode(\"paragraph\", \"paragraph\")\r\n          .toggleBlockquote()\r\n          .run(),\r\n    },\r\n    {\r\n      title: \"Code\",\r\n      description: \"Capture a code snippet.\",\r\n      searchTerms: [\"codeblock\"],\r\n      icon: <Code size={18} />,\r\n      command: ({ editor, range }: CommandProps) =>\r\n        editor.chain().focus().deleteRange(range).toggleCodeBlock().run(),\r\n    },\r\n    {\r\n      title: \"Image\",\r\n      description: \"Upload an image from your computer.\",\r\n      searchTerms: [\"photo\", \"picture\", \"media\"],\r\n      icon: <ImageIcon size={18} />,\r\n    },\r\n  ].filter((item) => {\r\n    if (typeof query === \"string\" && query.length > 0) {\r\n      const search = query.toLowerCase();\r\n      return (\r\n        item.title.toLowerCase().includes(search) ||\r\n        item.description.toLowerCase().includes(search) ||\r\n        (item.searchTerms &&\r\n          item.searchTerms.some((term: string) => term.includes(search)))\r\n      );\r\n    }\r\n    return true;\r\n  });\r\n};\r\n\r\nexport const updateScrollView = (container: HTMLElement, item: HTMLElement) => {\r\n  const containerHeight = container.offsetHeight;\r\n  const itemHeight = item ? item.offsetHeight : 0;\r\n\r\n  const top = item.offsetTop;\r\n  const bottom = top + itemHeight;\r\n\r\n  if (top < container.scrollTop) {\r\n    container.scrollTop -= container.scrollTop - top + 5;\r\n  } else if (bottom > containerHeight + container.scrollTop) {\r\n    container.scrollTop += bottom - containerHeight - container.scrollTop + 5;\r\n  }\r\n};\r\n\r\nconst CommandList = ({\r\n  items,\r\n  command,\r\n  editor,\r\n  range,\r\n}: {\r\n  items: CommandItemProps[];\r\n  command: any;\r\n  editor: any;\r\n  range: any;\r\n}) => {\r\n  const [selectedIndex, setSelectedIndex] = useState(0);\r\n\r\n  const { handleUserImageUpload } = useContext(NovelContext);\r\n\r\n  const selectItem = useCallback(\r\n  (index: number) => {\r\n    const item = items[index];\r\n    if (item) {\r\n      if (item.title === \"Image\") {\r\n        editor.chain().focus().deleteRange(range).run();\r\n        const input = document.createElement(\"input\");\r\n        input.type = \"file\";\r\n        input.accept = \"image/*\";\r\n        input.onchange = async () => {\r\n          if (input.files?.length) {\r\n            const file = input.files[0];\r\n            const pos = editor.view.state.selection.from;\r\n            startImageUpload(file, editor.view, pos, handleUserImageUpload);\r\n          }\r\n        };\r\n        input.click();\r\n      } else {\r\n        command(item);\r\n      }\r\n    }\r\n  },\r\n  [command, editor, items, range, handleUserImageUpload]\r\n);\r\n\r\n\r\n  useEffect(() => {\r\n    const navigationKeys = [\"ArrowUp\", \"ArrowDown\", \"Enter\"];\r\n    const onKeyDown = (e: KeyboardEvent) => {\r\n      if (navigationKeys.includes(e.key)) {\r\n        e.preventDefault();\r\n        if (e.key === \"ArrowUp\") {\r\n          setSelectedIndex((selectedIndex + items.length - 1) % items.length);\r\n          return true;\r\n        }\r\n        if (e.key === \"ArrowDown\") {\r\n          setSelectedIndex((selectedIndex + 1) % items.length);\r\n          return true;\r\n        }\r\n        if (e.key === \"Enter\") {\r\n          selectItem(selectedIndex);\r\n          return true;\r\n        }\r\n        return false;\r\n      }\r\n    };\r\n    document.addEventListener(\"keydown\", onKeyDown);\r\n    return () => {\r\n      document.removeEventListener(\"keydown\", onKeyDown);\r\n    };\r\n  }, [items, selectedIndex, setSelectedIndex, selectItem]);\r\n\r\n  useEffect(() => {\r\n    setSelectedIndex(0);\r\n  }, [items]);\r\n\r\n  const commandListContainer = useRef<HTMLDivElement>(null);\r\n\r\n  useLayoutEffect(() => {\r\n    const container = commandListContainer?.current;\r\n\r\n    const item = container?.children[selectedIndex] as HTMLElement;\r\n\r\n    if (item && container) updateScrollView(container, item);\r\n  }, [selectedIndex]);\r\n\r\n  return items.length > 0 ? (\r\n    <div\r\n      id=\"slash-command\"\r\n      ref={commandListContainer}\r\n      className=\"novel-z-50 novel-h-auto novel-max-h-[330px] novel-w-72 novel-overflow-y-auto novel-rounded-md novel-border novel-border-stone-200 novel-bg-white novel-px-1 novel-py-2 novel-shadow-md novel-transition-all\"\r\n    >\r\n      {items.map((item: CommandItemProps, index: number) => {\r\n        return (\r\n          <button\r\n            className={`novel-flex novel-w-full novel-items-center novel-space-x-2 novel-rounded-md novel-px-2 novel-py-1 novel-text-left novel-text-sm novel-text-stone-900 hover:novel-bg-stone-100 ${\r\n              index === selectedIndex\r\n                ? \"novel-bg-stone-100 novel-text-stone-900\"\r\n                : \"\"\r\n            }`}\r\n            key={index}\r\n            onClick={() => selectItem(index)}\r\n          >\r\n            <div className=\"novel-flex novel-h-10 novel-w-10 novel-items-center novel-justify-center novel-rounded-md novel-border novel-border-stone-200 novel-bg-white\">\r\n              {item.title === \"Continue writing\" && isLoading ? (\r\n                <LoadingCircle />\r\n              ) : (\r\n                item.icon\r\n              )}\r\n            </div>\r\n            <div>\r\n              <p className=\"novel-font-medium\">{item.title}</p>\r\n              <p className=\"novel-text-xs novel-text-stone-500\">\r\n                {item.description}\r\n              </p>\r\n            </div>\r\n          </button>\r\n        );\r\n      })}\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nconst renderItems = () => {\r\n  let component: ReactRenderer | null = null;\r\n  let popup: any | null = null;\r\n\r\n  return {\r\n    onStart: (props: { editor: Editor; clientRect: DOMRect }) => {\r\n      component = new ReactRenderer(CommandList, {\r\n        props,\r\n        editor: props.editor,\r\n      });\r\n\r\n      // @ts-ignore\r\n      popup = tippy(\"body\", {\r\n        getReferenceClientRect: props.clientRect,\r\n        appendTo: () => document.body,\r\n        content: component.element,\r\n        showOnCreate: true,\r\n        interactive: true,\r\n        trigger: \"manual\",\r\n        placement: \"bottom-start\",\r\n      });\r\n    },\r\n    onUpdate: (props: { editor: Editor; clientRect: DOMRect }) => {\r\n      component?.updateProps(props);\r\n\r\n      popup &&\r\n        popup[0].setProps({\r\n          getReferenceClientRect: props.clientRect,\r\n        });\r\n    },\r\n    onKeyDown: (props: { event: KeyboardEvent }) => {\r\n      if (props.event.key === \"Escape\") {\r\n        popup?.[0].hide();\r\n\r\n        return true;\r\n      }\r\n\r\n      // @ts-ignore\r\n      return component?.ref?.onKeyDown(props);\r\n    },\r\n    onExit: () => {\r\n      popup?.[0].destroy();\r\n      component?.destroy();\r\n    },\r\n  };\r\n};\r\n\r\nconst SlashCommand = Command.configure({\r\n  suggestion: {\r\n    items: getSuggestionItems,\r\n    render: renderItems,\r\n  },\r\n});\r\n\r\nexport default SlashCommand;\r\n"]}